{"title": "struts2（一）之初识struts2", "url": "http://www.cnblogs.com/zhangyinhua/p/7772430.html", "author": "苦水润喉", "article_desc": "前言 我们都知道struts2是一个框架，那什么是框架呢？很多人其实不太明白，其实框架就是一个半成品，别人将一些功能已经写好了，我们只需要拿来用即可，像我们之前 使用的dbutils框架，操作数据，只需要两行代码，不用像一开始一样，老老实实的写一大堆代码，这就是开发框架的意义所在。简化开发(个人对框 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/zhangyinhua/p/7772430.html\">struts2（一）之初识struts2</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><span style=\"color: #ff0000;\"><strong>前言</strong></span></p>\r\n<p>　　我们都知道struts2是一个框架，那什么是框架呢？很多人其实不太明白，其实框架就是一个半成品，别人将一些功能已经写好了，我们只需要拿来用即可，像我们之前</p>\r\n<p>　　使用的dbutils框架，操作数据，只需要两行代码，不用像一开始一样，老老实实的写一大堆代码，这就是开发框架的意义所在。<span style=\"color: #ff0000;\">简化开发</span>(个人对框架认识的理解，其他</p>\r\n<p>　　还有在框架上加自己的代码这些就不说了，肯定还有别的很多功能，这只是我最好理解的一种方式)。</p>\r\n<p>　　框架的定义和作用：</p>\r\n<p>　　　　<span style=\"color: #ff0000;\">把一些繁琐的重复性代码封装起来，使程序员在编码中把更多的经历放到业务需求的分析和理解上面。</span><br>\t\t\t　　　　特点：<span style=\"color: #ff0000;\">封装了很多细节</span>，程序员在使用的时候会非常简单。</p>\r\n<p>　　Struts2就是一个web层框架，并且是使用MVC设计模式实现的的一个框架，之前使用的是Serlvet+JSP来开发web项目，现在用Struts2框架来替代他，那Struts2到底有</p>\r\n<p>　　哪些优点呢？</p>\r\n<p>　　　　请求    -----------　　Servlet      --------------  JSP　　　　serlvet+JSP</p>\r\n<p>　　　　请求    -----------      Action 　　--------------  JSP　　　　Struts</p>\r\n<h1>一、struts2概述</h1>\r\n<h2>1.1、简介</h2>\r\n<p>　　百度上说的是：</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102131905904-1237473670.png\" alt=\"\" width=\"637\" height=\"158\"></p>\r\n<p>　　　　Struts2<span style=\"color: #ff0000;\">是Apache发行的MVC开源框架。注意：它只是表现层（MVC）框架</span>。</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102142953201-282610932.png\" alt=\"\" width=\"885\" height=\"478\"></p>\r\n<h2>1.2、来历</h2>\r\n<p>　　Struts1：也是apache开发的一套mvc的开源框架。在2005年之前非常流行。<br>　　　　　　弊端：<span style=\"color: #ff0000;\">Struts1的核心控制器就是一个Servlet</span>。随着使用者的增多，弊端开始出现。<br>　　Struts2：在long long ago，有一个设计超前的框架XWork，后来推出了XWork1和WebWork2。Struts2就是apache和OpenSymphony组织合并开发出来。<br>　　　　　　里面包含了WebWork2的核心及Struts的一些特性和功能。除此之外，和Struts1没有任何关系了。</p>\r\n<h1>二、struts2架构分析</h1>\r\n<p>　　首先了解前，必须先要知道Struts2的架构图，知道是如何工作的，做了哪些事情，可以不必那么详细的知道每一块具体的细节，先让我们自己有个大概的了解，</p>\r\n<p>　　这样我们就更容易去接受它，使用它。</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102132123920-1474002064.png\" alt=\"\" width=\"748\" height=\"392\"></p>\r\n<p>　　第一步：请求action，那么就会经过<span style=\"color: #ff0000;\">StrutsPrepareAndExecuteFilter</span>，这里会做两件事情，就是下面的两步</p>\r\n<p>　　第二步：通过<span style=\"color: #ff0000;\">ActionMapping将请求中的各种数据封装起来，拿到请求中的各种参数数据</span>，比如我们的action的名称DemoAction</p>\r\n<p>　　第三步：给自己<span style=\"color: #ff0000;\">找一个代理对象ActionProxy，来帮助我们处理事情。注意，这个ActionProxy实际上不做任何实事的，而是指挥别人做</span>。</p>\r\n<p>　　第四步：ActionProxy叫<span style=\"color: #ff0000;\">ConfigManager获取struts.xml中的各种配置信息，其中struts.xml就有action的类全限定类名等信息，这样就可以通过action的名字找到其位置了</span>。</p>\r\n<p>　　第五步：有了<span style=\"color: #ff0000;\">actionMapping获取的请求数据和ConfigManager获取的struts.xml中的数据，就叫ActionInvacation来查找对应的action了</span></p>\r\n<p>　　第六步：在<span style=\"color: #ff0000;\">找到action之前会经过一系列的拦截器，struts内部默认实现的</span>。找到action后，就相当于我们的servlet，在其中执行一些业务代码，然后跳转到目标页面，</p>\r\n<p>　　　　　　响应回去。struts的整个过程即结束了。</p>\r\n<p>　　就是这么简单，struts2的整个执行过程就这样，而现在我们要写一个struts2的hello world的话，根据struts2的架构图，我们需要配置2个东西，</p>\r\n<p>　　第一个最关键的，<span style=\"color: #ff0000;\">在web.xml中配置strutsPrepareAndExecuteFilter即过滤器，配置了该过滤器，请求才会走struts2框架</span>，</p>\r\n<p>　　第二个，<span style=\"color: #ff0000;\">struts.xml文件，其中应该有的内容是通过action的名字就能够找到其位置在哪里</span>，稍微会详细讲解。 </p>\r\n<h1>三、搭建struts2环境</h1>\r\n<p>　　我们只需要三步就可以完成：导入jar包、在web.xml中配置过滤器、配置struts.xml。</p>\r\n<h2>3.1、导入jar包</h2>\r\n<p>　　1）下载struts2jar包</p>\r\n<p>　　　　http://struts.apache.org（struts-2.3.15.3）</p>\r\n<p>　　2）开发包目录结构</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102133515295-1490885275.png\" alt=\"\" width=\"506\" height=\"243\"></p>\r\n<p>　　3）需要的jar包</p>\r\n<p>　　　　这里注意一点，lib下面有100多个jar包，并不需要导入这么多，我们在apps(案例)中找jar包即可，apps-blank.war是最简单的案例，</p>\r\n<p>　　　　我们把其后缀名改为zip，然后解压，找到其中的lib目录下的jar包复制就行了。</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102133648326-1830786003.png\" alt=\"\" width=\"649\" height=\"217\"></p>\r\n<p>　　　　拷贝jar包到classpath中（也就是WEN-INF下面的lib包）</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102142010435-806119078.png\" alt=\"\"></p>\r\n<h2>3.2、在web.xml中配置过滤器</h2>\r\n<p>　　配置的位置：web.xml中</p>\r\n<p>　　配置的是什么：Struts已经写好的过滤器</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102134123935-906529260.png\" alt=\"\" width=\"650\" height=\"135\"></p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('2088026b-d59f-4e16-aa9c-85e6d0553eb3')\"><img id=\"code_img_closed_2088026b-d59f-4e16-aa9c-85e6d0553eb3\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_2088026b-d59f-4e16-aa9c-85e6d0553eb3\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('2088026b-d59f-4e16-aa9c-85e6d0553eb3',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_2088026b-d59f-4e16-aa9c-85e6d0553eb3\" class=\"cnblogs_code_hide\">\r\n<pre>&lt;?xml version=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">1.0</span><span style=\"color: #800000;\">\"</span> encoding=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">UTF-8</span><span style=\"color: #800000;\">\"</span>?&gt;\r\n&lt;web-app xmlns:xsi=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">http://www.w3.org/2001/XMLSchema-instance</span><span style=\"color: #800000;\">\"</span> xmlns=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">http://java.sun.com/xml/ns/javaee</span><span style=\"color: #800000;\">\"</span> xsi:schemaLocation=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd</span><span style=\"color: #800000;\">\"</span> version=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">3.0</span><span style=\"color: #800000;\">\"</span>&gt;\r\n  &lt;filter&gt;\r\n    &lt;filter-name&gt;struts2&lt;/filter-name&gt;\r\n    &lt;filter-<span style=\"color: #0000ff;\">class</span>&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-<span style=\"color: #0000ff;\">class</span>&gt;\r\n  &lt;/filter&gt;\r\n  &lt;filter-mapping&gt;\r\n    &lt;filter-name&gt;struts2&lt;/filter-name&gt;\r\n    &lt;url-pattern&gt;<span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">&lt;/url-pattern&gt;\r\n  &lt;/filter-mapping&gt;\r\n&lt;/web-app&gt;</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">web.xml</span></div>\r\n<h2>3.3、配置struts.xml</h2>\r\n<p>　　在src目录下创建一个默认名称为struts.xml的配置文件　</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>&lt;?xml version=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">1.0</span><span style=\"color: #800000;\">\"</span> encoding=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">UTF-8</span><span style=\"color: #800000;\">\"</span>?&gt;\r\n&lt;!<span style=\"color: #000000;\">DOCTYPE struts PUBLIC\r\n    </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">-//Apache Software Foundation//DTD Struts Configuration 2.3//EN</span><span style=\"color: #800000;\">\"</span>\r\n    <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">http://struts.apache.org/dtds/struts-2.3.dtd</span><span style=\"color: #800000;\">\"</span>&gt;\r\n&lt;struts&gt;\r\n&lt;/struts&gt;</pre>\r\n</div>\r\n<p>　　注意：文件名的大小写、创建的位置、该文件名允许被修改但是我们一般不修改它。</p>\r\n<p>　　这是我们可以验证是否搭建成功：</p>\r\n<p>　　　　部署应用，启动tomcat，不报错表示配置成功</p>\r\n<h1>四、写一个demo</h1>\r\n<p>　　1）创建一个jsp文件（index.jsp）</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102135905982-53831212.png\" alt=\"\" width=\"892\" height=\"248\"></p>\r\n<p>　　2）在struts.xml中配置</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102140034451-7803139.png\" alt=\"\" width=\"635\" height=\"276\"></p>\r\n<p>　　配置信息详解：</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102143613685-1676104369.png\" alt=\"\" width=\"971\" height=\"282\"></p>\r\n<p>　　3）创建动作类和动作方法</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102140630185-1342920448.png\" alt=\"\" width=\"443\" height=\"324\"></p>\r\n<p>　　4）结果视图</p>\r\n<p>　　success.jsp</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102140817966-1058241665.png\" alt=\"\"></p>\r\n<p>　　5）测试</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102142106685-1095915745.png\" alt=\"\"></p>\r\n<p>　　　　点击以.action结尾：</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102142246357-183752651.png\" alt=\"\"></p>\r\n<p>　　　　点击不以.action结尾：</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102142330451-353216255.png\" alt=\"\"></p>\r\n<p>问题：关于struts.xml没有提示的问题</p>\r\n<p>　　原因：没有找到相应的dtd约束文件</p>\r\n<p>　　解决办法：</p>\r\n<p>　　　　1.上网</p>\r\n<p>　　　　2.不能上网</p>\r\n<p>　　　　找到struts jar包中的struts-2.3.dtd文件</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102142508591-1755189358.png\" alt=\"\"></p>\r\n<p>　　　　在项目中与lib包同级目录下创建一个dtd文件夹把jar包放进去</p>\r\n<p>　　　　在myeclipse中配置</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102142534873-1368211542.png\" alt=\"\" width=\"579\" height=\"402\"></p>\r\n<h1>五、测试例子执行过程分析</h1>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102143230029-1152009919.png\" alt=\"\" width=\"1177\" height=\"544\"></p>\r\n<p>　　详细的过程：</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102143333451-953544814.png\" alt=\"\" width=\"672\" height=\"637\"></p>\r\n<h1>六、struts的配置文件</h1>\r\n<p>　　加载时机：当应用被tomcat加载的时候，struts2的配置文件就已经被加载过了。</p>\r\n<h2>6.1、配置文件加载顺序</h2>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102144121545-78392186.png\" alt=\"\" width=\"688\" height=\"466\"></p>\r\n<p>　　注意：　　</p>\r\n<p>　　　　1）Struts2提供了两种配置的方式。<span style=\"color: #ff0000;\">一种是key=value的方式，即使用.properties文件。另一种是xml文件配置。我们推荐使用xml文件</span>（它能描述层级关系）。</p>\r\n<p>　　　　2）当多个配置文件中，有相同的参数，后面的会把前面的值给覆盖了。</p>\r\n<h2>6.2、struts-default.xml文件</h2>\r\n<p>　　这里解释一下struts.xml中的package继承问题。上面继承了一个struts-default的包，想要查看它中的内容很简单，在我们加入的struts2-core-2.3.15.1.jar包</p>\r\n<p>　　找到struts-default.xml，在该配置文件中就有package为struts-default的内容。</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102144740076-996989022.png\" alt=\"\" width=\"199\" height=\"433\"></p>\r\n<p>　　从名字上看，就应该知道该是struts的一个默认的配置文件，而我们前面编写的一个struts.xml中应该会使用该默认配置文件中的内容，其中的格式跟我们写的struts.xml是一样的。</p>\r\n<p>　　分两大部分：</p>\r\n<p>　　　　第一部分 全是bean开头的配置，暂时不管他是干嘛用的，后面会学习，而我们的重点是第二部分</p>\r\n<p>　　　　第二部分 看到了熟悉的内容，package，并且该package的名字为struts-default。这就是我们需要查找的包，其中的内容包括了三个部分：</p>\r\n<p>　　　　　　1）&lt;result-types&gt;&lt;/result-types&gt;看到这里我们就<span style=\"color: #ff0000;\">明白为什么我们的结果中跳转页面的方式默认是dispatcher(转发)</span>，因为<span style=\"color: #ff0000;\">在继承的struts-default包中将其设置成了默认的，</span></p>\r\n<p><span style=\"color: #ff0000;\">　　　　　　　还有很多其他的type可选择，比如其中的redirect，就是重定向，比如redirectAction，从一个action跳到另一个action中执行。</span>比如stream，文件上传时用的，等等这些等</p>\r\n<p>　　　　　　   后面会详细讲到。有个大概映像即可。</p>\r\n<p>　　　　　　2）&lt;interceptors&gt;&lt;/interceptors&gt;,这里是一系列的过滤器，就是我们讲的架构图中的那一系列拦截器，就是在这里给配置的。</p>\r\n<p>　　　　　　3）最后一个是两个零碎的配置</p>\r\n<p>　　　　　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102145134060-1967389887.png\" alt=\"\" width=\"617\" height=\"63\"></p>\r\n<p>　　　　　　　　321行：配置说默认的一个拦截器为defaultStack，这是一个拦截器栈，其内容在第二部分中。</p>\r\n<p>　　　　　　　　323行：这里说的class为在我们action中的class，如果不写则为com.opensymphony.xwork2.ActionSupport。ActionSupport这个类就我们下面要讲解的action继承它来当</p>\r\n<p>　　　　　　　　　　　　action，那时候再与普通类当action有什么区别。</p>\r\n<p>　　　　总结：struts-default.xml的功能就是<span style=\"color: #ff0000;\">将一些已经有的功能加入到配置文件中，然后让我们编写的struts.xml继承其中的包</span>，那么我们就具备了这些功能，不用自己手动编写了，如果想</p>\r\n<p>　　　　　　在上面添加功能，<span style=\"color: #ff0000;\">在编写即可。到这里为止应该就解决了为什么要继承struts-default这个包了把</span>。</p>\r\n<h2>6.3、default.properties配置文件</h2>\r\n<p>　　default.properties，这是一个常量的配置文件。其中放的都是常量。</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102145441763-888935000.png\" alt=\"\" width=\"201\" height=\"418\"></p>\r\n<p>　　常量定义在了default.properties配置文件中，体现形式都是key=value。所有的struts2应用都会用到这些常量。</p>\r\n<p>　　常用的常量有 :</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102145555310-1944838168.png\" alt=\"\" width=\"708\" height=\"384\"></p>\r\n<h2>6.3、覆盖常量的三种方式</h2>\r\n<p>　　1）在struts.xml中覆盖常量</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102145722623-851955491.png\" alt=\"\" width=\"713\" height=\"192\"></p>\r\n<p>　　注意：与package是同级目录。</p>\r\n<p>　　2）创建struts.properties文件覆盖　　</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102145910091-611357377.png\" alt=\"\" width=\"511\" height=\"150\"></p>\r\n<p>　　3）在web.xml文件中配置过滤器参数</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171102150042451-557831931.png\" alt=\"\" width=\"519\" height=\"200\"></p>\r\n<p> </p>\r\n<p><span style=\"color: #ff0000;\"><strong>喜欢就推荐哦！</strong></span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 15:16</span> <a href=\"http://www.cnblogs.com/zhangyinhua/\">苦水润喉</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7772430\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7772430);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=320169,cb_entryId=7772430,cb_blogApp=currentBlogApp,cb_blogUserGuid='e9bdb417-3c54-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/2 15:16:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 54, "image_url": ["https://pic.cnblogs.com/face/999804/20170729235406.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "如何线上部署node.js项目", "url": "http://www.cnblogs.com/xiuber/p/7772550.html", "author": "xiuber", "article_desc": "来源：http://blog.csdn.net/chenlinIT/article/details/73343793 前言 最近工作不是很忙，在空闲时间学习用node+express搭建自己的个人博客。目前进度大概进行到一半了，等不及想部署上线看下效果（学习阶段的人总是很兴奋，有一点点小成果就想马上 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/xiuber/p/7772550.html\">如何线上部署node.js项目</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h3 id=\"参考\">来源：<a href=\"http://blog.csdn.net/chenlinIT/article/details/73343793\" target=\"_blank\">http://blog.csdn.net/chenlinIT/article/details/73343793</a></h3>\n<h3 id=\"前言\">前言</h3>\n<p><span style=\"font-family: 宋体\">最近工作不是很忙，在空闲时间学习用node+express搭建自己的个人博客。目前进度大概进行到一半了，等不及想部署上线看下效果（学习阶段的人总是很兴奋，有一点点小成果就想马上看看 =_=！）。 </span><br><span style=\"font-family: 宋体\">于是买了个阿里云服务器，自己尝试来部署一下，捣鼓了两天终于捣鼓好了，这里来记录一下，以免后面又忘了。</span></p>\n<h3 id=\"参考\">参考：</h3>\n<p><a href=\"https://help.aliyun.com/document_detail/50775.html?spm=5176.product25365.6.715.fD2PQ6%20%20%E9%98%BF%E9%87%8C%E4%BA%91%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3%EF%BC%9A%E9%83%A8%E7%BD%B2Node.js%E9%A1%B9%E7%9B%AE%EF%BC%88CentOS%EF%BC%89\" target=\"_blank\">阿里云帮助文档： 部署Node.js项目（CentOS）</a> <br><a href=\"http://www.tuicool.com/articles/AfqyYze\" target=\"_blank\">推酷文章</a> <br><a href=\"http://www.jianshu.com/p/0496ef49b2a5\" target=\"_blank\">简书文章</a> <br><a href=\"https://segmentfault.com/a/1190000004051670\" target=\"_blank\">segmentfault文章</a> <br><a href=\"https://cnodejs.org/topic/58a9aa707872ea0864fedebb\" target=\"_blank\">pm2使用方法</a></p>\n<h3 id=\"一买服务器\">一、买服务器</h3>\n<p>比较穷，选了最低配的。30/月，1核，1G内存，1M带宽，操作系统：CentOS 7.2 64位。作为一个从来没有解除过阿里云的菜鸟，这两天真是踩了无数坑，不过也学到了很多东西。</p>\n<h3 id=\"二开始捣鼓来看看怎么部署\"><a name=\"t3\"></a>二、开始捣鼓，来看看怎么部署。</h3>\n<p>网上的教程很多，但还是想自己来写一下，这样自己好理解，也能加深记忆。首先远程链接，阿里云的远程连接功能不会用，输入用户名后然后输入登录密码，总是输入不完就跳了，不知道咋回事。因为服务器系统是Linux的，我电脑是windows 7的系统。如果服务器是windows server的系统可以使用电脑的远程桌面连接，这里就不细说了，不会的上网搜一下就行了。windows远程连接Linux网上说有两种常用的远程连接工具：Putty和Xshell，我选择的是Xshell。</p>\n<h4 id=\"1远程连接服务器\">1、远程连接服务器</h4>\n<p><a href=\"http://dlsw.baidu.com/sw-search-sp/soft/7b/15201/Xshell_5.0.0.37_setup.1459931786.exe%20%E4%B8%8B%E8%BD%BDXshell\" target=\"_blank\">下载Xshell</a> 并安装，打开软件你会看到会话框：</p>\n<p><img title=\"\" src=\"http://img.blog.csdn.net/20170616170532987?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"打开Xshell连接软件\"></p>\n<p>点击新建并设置和填写如下信息:</p>\n<p><img title=\"\" src=\"http://img.blog.csdn.net/20170616170823137?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"设置Xshell连接\"></p>\n<p>填好后先不要点确定，点击左侧树状图中“用户身份验证”，填写信息：</p>\n<p><img title=\"\" src=\"http://img.blog.csdn.net/20170616171045545?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"设置Xshell连接\"></p>\n<p>然后点击确定后，就会像上面第一张图显示的，然后点击连接，连接成功如图显示：</p>\n<p><img title=\"\" src=\"http://img.blog.csdn.net/20170616171319294?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"链接成功\"></p>\n<h4 id=\"2安装nodejs\">2、安装Node.js</h4>\n<p>按照<a href=\"https://help.aliyun.com/document_detail/50775.html?spm=5176.product25365.6.715.fD2PQ6%20%20%E9%98%BF%E9%87%8C%E4%BA%91%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3%EF%BC%9A%E9%83%A8%E7%BD%B2Node.js%E9%A1%B9%E7%9B%AE%EF%BC%88CentOS%EF%BC%89\" target=\"_blank\">阿里云帮助文档： 部署Node.js项目（CentOS）</a> 教程中步骤2操作（<a href=\"http://www.cnblogs.com/laov/p/3541414.html\" target=\"_blank\">linux系统指令大全</a>）；</p>\n<h5 id=\"1wget命令下载nodejs安装包\">(1)、wget命令下载Node.js安装包。</h5>\n<p>该安装包是编译好的文件，解压之后，在bin文件夹中就已存在node和npm，无需重复编译。</p>\n<pre class=\"prettyprint\"><code class=\"hljs avrasm has-numbering\">wget https://nodejs<span class=\"hljs-preprocessor\">.org/dist/v6<span class=\"hljs-number\">.9<span class=\"hljs-number\">.5/node-v6<span class=\"hljs-number\">.9<span class=\"hljs-number\">.5-linux-x64<span class=\"hljs-preprocessor\">.tar<span class=\"hljs-preprocessor\">.xz</span></span></span></span></span></span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n</ul>\n<h5 id=\"2解压文件\">(2)、解压文件。</h5>\n<pre class=\"prettyprint\"><code class=\"hljs lasso has-numbering\">tar xvf node<span class=\"hljs-attribute\">-v6<span class=\"hljs-number\">.9<span class=\"hljs-number\">.5<span class=\"hljs-attribute\">-linux<span class=\"hljs-attribute\">-x64<span class=\"hljs-built_in\">.tar<span class=\"hljs-built_in\">.xz</span></span></span></span></span></span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n</ul>\n<h5 id=\"3软件默认安装在rootnode-v695-linux-x64目录下如果需要将该软件安装到其他目录如optnode下请进行如下操作\">(3)、软件默认安装在/root/node-v6.9.5-linux-x64/目录下。如果需要将该软件安装到其他目录（如：/opt/node/）下，请进行如下操作：</h5>\n<pre class=\"prettyprint\"><code class=\"hljs coffeescript has-numbering\">mkdir -p <span class=\"hljs-regexp\">/opt/node/\nmv <span class=\"hljs-regexp\">/root/node-v6.9.5-linux-x64/* <span class=\"hljs-regexp\">/opt/node/\nrm -f /usr/local/bin/node\nrm -f /usr/local/bin/<span class=\"hljs-built_in\">npm\nln -s /opt/node/bin/node /usr/local/bin/node\nln -s /opt/node/bin/<span class=\"hljs-built_in\">npm /usr/local/bin/<span class=\"hljs-built_in\">npm</span></span></span></span></span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n<li>2</li>\n<li>3</li>\n<li>4</li>\n<li>5</li>\n<li>6</li>\n</ul>\n<h5 id=\"4查看nodejs和npm版本\">(4)、查看node.js和npm版本：</h5>\n<pre class=\"prettyprint\"><code class=\"hljs lasso has-numbering\">node <span class=\"hljs-attribute\">-v\nnpm <span class=\"hljs-attribute\">-v</span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n<li>2</li>\n</ul>\n<p>完成以上步骤node.js就算安装成功了</p>\n<h4 id=\"3安装mongodb\">3、安装mongodb</h4>\n<p>参考 <a href=\"http://www.jianshu.com/p/0496ef49b2a5\" target=\"_blank\">简书文章</a>：</p>\n<blockquote>\n<p>软件安装位置：/usr/local/mongodb <br>数据存放位置：/var/mongodb/data <br>日志存放位置：/var/mongodb/logs</p>\n\n</blockquote>\n<h5 id=\"1进入-usrlocal\">(1)、进入 /usr/local/：</h5>\n<p><code>cd /usr/local</code></p>\n<h5 id=\"2安装mongodb\">(2)、安装mongodb：</h5>\n<pre class=\"prettyprint\"><code class=\"hljs avrasm has-numbering\">wget https://fastdl<span class=\"hljs-preprocessor\">.mongodb<span class=\"hljs-preprocessor\">.org/linux/mongodb-linux-x86_64-<span class=\"hljs-number\">3.4<span class=\"hljs-number\">.5<span class=\"hljs-preprocessor\">.tgz</span></span></span></span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n</ul>\n<p>其他版本链接可以去官网查看 <br><img title=\"\" src=\"http://img.blog.csdn.net/20170619123409446?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"mongodb版本选择\"></p>\n<h5 id=\"3解压安装包并重命名文件夹为mongodb\">(3)、解压安装包，并重命名文件夹为mongodb</h5>\n<pre class=\"prettyprint\"><code class=\"hljs lasso has-numbering\">tar zxvf mongodb<span class=\"hljs-attribute\">-linux<span class=\"hljs-attribute\">-x86_64<span class=\"hljs-subst\">-<span class=\"hljs-number\">3.4<span class=\"hljs-number\">.5<span class=\"hljs-built_in\">.tgz\nmv mongodb<span class=\"hljs-attribute\">-linux<span class=\"hljs-attribute\">-x86_64<span class=\"hljs-subst\">-<span class=\"hljs-number\">3.4<span class=\"hljs-number\">.5 mongodb</span></span></span></span></span></span></span></span></span></span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n<li>2</li>\n</ul>\n<h5 id=\"4创建数据和日志存放目录\">(4)、创建数据和日志存放目录</h5>\n<pre class=\"prettyprint\"><code class=\"hljs lasso has-numbering\">mkdir /<span class=\"hljs-built_in\">var/mongodb\nmkdir /<span class=\"hljs-built_in\">var/mongodb/<span class=\"hljs-built_in\">data\nmkdir /<span class=\"hljs-built_in\">var/mongodb/logs</span></span></span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n<li>2</li>\n<li>3</li>\n</ul>\n<h5 id=\"5设置开机启动项\">(5)、设置开机启动项</h5>\n<p>打开rc.local文件，添加CentOS开机启动项： <br>不熟悉linux命令的可以参考：<a href=\"http://www.cnblogs.com/laov/p/3541414.html\" target=\"_blank\">linux系统指令大全</a></p>\n<pre class=\"prettyprint\"><code class=\"hljs avrasm has-numbering\">vim /etc/rc<span class=\"hljs-preprocessor\">.d/rc<span class=\"hljs-preprocessor\">.local</span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n</ul>\n<p>打开文件后输入‘i’启用编辑。将mongodb启动命令追加到本文件中，让mongodb开机自启动：</p>\n<pre class=\"prettyprint\"><code class=\"hljs lasso has-numbering\">/opt/mongodb/bin/mongod <span class=\"hljs-subst\">--dbpath<span class=\"hljs-subst\">=/<span class=\"hljs-built_in\">var/mongodb/<span class=\"hljs-built_in\">data <span class=\"hljs-subst\">--logpath /<span class=\"hljs-built_in\">var/mongodb/logs/<span class=\"hljs-keyword\">log<span class=\"hljs-built_in\">.<span class=\"hljs-keyword\">log <span class=\"hljs-attribute\">-fork</span></span></span></span></span></span></span></span></span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n</ul>\n<p><img title=\"\" src=\"http://img.blog.csdn.net/20170619124632854?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"设置开机启动项\"></p>\n<p>按 <code>Esc</code> 退出编辑，输入 <code>:wq</code> (冒号wq)，回车保存并关闭文件。</p>\n<p><img title=\"\" src=\"http://img.blog.csdn.net/20170619124748909?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"保存并关闭文件\"></p>\n<h5 id=\"6手动启动mongodb\">(6)、手动启动mongodb</h5>\n<pre class=\"prettyprint\"><code class=\"hljs lasso has-numbering\">/opt/mongodb/bin/mongod <span class=\"hljs-subst\">--dbpath<span class=\"hljs-subst\">=/<span class=\"hljs-built_in\">var/mongodb/<span class=\"hljs-built_in\">data <span class=\"hljs-subst\">--logpath /<span class=\"hljs-built_in\">var/mongodb/logs/<span class=\"hljs-keyword\">log<span class=\"hljs-built_in\">.<span class=\"hljs-keyword\">log <span class=\"hljs-attribute\">-fork</span></span></span></span></span></span></span></span></span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n</ul>\n<p>数据库安装和启动已完成，下面安装pm2</p>\n<h4 id=\"4安装pm2\">4、安装pm2</h4>\n<h5 id=\"1通过npm全局安装\">(1)、通过npm全局安装：</h5>\n<pre class=\"prettyprint\"><code class=\"hljs cmake has-numbering\">npm <span class=\"hljs-keyword\">install pm2 -g</span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n</ul>\n<p>这个时候使用 <code>pm2 -v</code> 查看版本可能会报错，需要设置一下环境变量</p>\n<h5 id=\"2设置环境变量\">(2)、设置环境变量</h5>\n<p>使用 <code>vim</code> 命令打开文件 /etc/profile</p>\n<pre class=\"prettyprint\"><code class=\"hljs  has-numbering\">vim /etc/profile</code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n</ul>\n<p>同样，按‘i’启动编辑，将pm2的路径添加到环境变量中；</p>\n<p><img title=\"\" src=\"http://img.blog.csdn.net/20170619130337573?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"pm2路径\"></p>\n<pre class=\"prettyprint\"><code class=\"hljs ruby has-numbering\"><span class=\"hljs-constant\">PATH=<span class=\"hljs-variable\">$PATH<span class=\"hljs-symbol\">:/opt/node/lib/node_modules/pm2/bin</span></span></span></code></pre>\n<ul class=\"pre-numbering\">\n<li>1</li>\n</ul>\n<p><img title=\"\" src=\"http://img.blog.csdn.net/20170619130407276?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"添加环境变量\"></p>\n<p>保存退出之后输入：<code>source /etc/profile</code> 可以让变量生效。</p>\n<h4 id=\"5上传项目\">5、上传项目</h4>\n<p>上传项目使用的是Xftp</p>\n<h5 id=\"1下载\">(1)、下载</h5>\n<p><a href=\"http://sw.bos.baidu.com/sw-search-sp/software/28f092744fe45/Xftp_5.0.1028.exe\" target=\"_blank\">下载Xftp</a></p>\n<h5 id=\"2连接服务器\">(2)、连接服务器</h5>\n<p>如果已经安装，可以点击Xshell中‘新建文件传输’，直接链接到服务器（前提是Xshell已连接）； <br>手动配置连接和Xshell差不多：</p>\n<p><img title=\"\" src=\"http://img.blog.csdn.net/20170619131604847?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"配置Xftp链接\"></p>\n<h5 id=\"3上传项目目录\">(3)、上传项目目录</h5>\n<p><a href=\"https://segmentfault.com/a/1190000004051670\" target=\"_blank\">参考</a> <br>我把代码上传到了/home目录文件夹下。</p>\n<p><img title=\"\" src=\"http://img.blog.csdn.net/20170619132423341?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmxpbklU/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"这里写图片描述\"></p>\n<h4 id=\"6启动项目\">6、启动项目</h4>\n<h5 id=\"1使用pm2启动项目\">(1)、使用pm2启动项目</h5>\n<p>控制台进入存放代码的目录，和本地操作类似，本地使用<code>node /bin/www</code> 启动项目，这里换成<code>pm2 start /bin/www</code> ; <br>项目启动成功后就可以使用 IP:端口 号访问了。IP是你服务器的公网IP，端口号是你代码中设置的监听端口。</p>\n<h3 id=\"三结束\"><a name=\"t4\"></a>三、结束</h3>\n<p>至此，部署过程全部结束，我也是小白，从来没碰过linux，实际操作中也遇到了各种问题。但是多尝试，多搜索，细心一点一般都能部署成功。写个博客记录一下部署过程，好记性不如烂笔头，以后忘记了查一下博客很快就能弄明白。也希望能够帮助其他刚接触linux部署的小伙伴。这个博客也不算是原创，算是整理其他博友的教程，各位可以随意转载。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 15:38</span> <a href=\"http://www.cnblogs.com/xiuber/\">xiuber</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7772550\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7772550);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=252745,cb_entryId=7772550,cb_blogApp=currentBlogApp,cb_blogUserGuid='49c4c799-1584-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/2 15:38:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 65, "image_url": ["https://pic.cnblogs.com/face/832892/20151106234750.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "iOS动画学习 -隐式动画", "url": "http://www.cnblogs.com/Devhwl/p/animation.html", "author": "雨月星缘", "article_desc": "\r\n    事务 Core Animation基于一个假设，说屏幕上的任何东西都可以（或者可能）做动画。你并不需要在Core Animation中手动打开动画，但是你需要明确地关闭它，否则它会一直存在。 当你改变CALayer一个可做动画的属性时，这个改变并不会立刻在屏幕上体现出来。相反，该属性会从先前的值平滑 ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/Devhwl/p/animation.html\">iOS动画学习 -隐式动画</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h3>事务</h3>\r\n<p><span style=\"font-family: 'Microsoft YaHei';\">Core Animation基于一个假设，说屏幕上的任何东西都可以（或者可能）做动画。你并不需要在Core Animation中手动打开动画，但是你需要明确地关闭它，否则它会一直存在。</span></p>\r\n<p><span style=\"font-family: 'Microsoft YaHei';\">当你改变<code>CALayer</code>一个可做动画的属性时，这个改变并不会立刻在屏幕上体现出来。相反，该属性会从先前的值平滑过渡到新的值。这一切都是默认的行为，你不需要做额外的操作。</span></p>\r\n<p><span style=\"font-family: 'Microsoft YaHei';\">接下来看一个例子，老样子，先上代码 </span></p>\r\n<p> </p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">@interface</span><span style=\"color: #000000;\"> ViewController ()\r\n@property (nonatomic, strong) CALayer </span>*<span style=\"color: #000000;\">colorLayer;\r\n</span><span style=\"color: #0000ff;\">@end</span>\r\n\r\n\r\n<span style=\"color: #0000ff;\">@implementation</span><span style=\"color: #000000;\"> ViewController\r\n\r\n</span>- (<span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\">)viewDidLoad {\r\n    [super viewDidLoad];</span></pre>\r\n<p>　　　// 创建colorLayer，注意一定要另外创建一个CALayer对象，不要用与视图关联的layer，原因我们后续会讲到</p>\r\n<pre>    self.colorLayer =<span style=\"color: #000000;\"> [CALayer layer];\r\n    self.colorLayer.frame </span>= CGRectMake(<span style=\"color: #800080;\">50.0f</span>, <span style=\"color: #800080;\">50.0f</span>, <span style=\"color: #800080;\">100.0f</span>, <span style=\"color: #800080;\">100.0f</span><span style=\"color: #000000;\">);\r\n    self.colorLayer.backgroundColor </span>=<span style=\"color: #000000;\"> [UIColor blueColor].CGColor;\r\n    \r\n    \r\n    [self.view.layer addSublayer:self.colorLayer];\r\n    \r\n</span><span style=\"color: #000000;\">}\r\n<br></span></pre>\r\n<p>- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event {</p>\r\n<p>    CGFloat red = arc4random() / (CGFloat)INT_MAX;</p>\r\n<p>    CGFloat green = arc4random() / (CGFloat)INT_MAX;</p>\r\n<p>    CGFloat blue = arc4random() / (CGFloat)INT_MAX;</p>\r\n<p>    self.colorLayer.backgroundColor = [UIColor colorWithRed:red green:green blue:blue alpha:1.0].CGColor;</p>\r\n<p>}</p>\r\n<pre><span style=\"color: #000000;\"><br>\r\n</span><span style=\"color: #0000ff;\">@end</span></pre>\r\n</div>\r\n<p> </p>\r\n<p>运行之后的初始状态</p>\r\n<p style=\"text-align: center;\"><img src=\"http://images2017.cnblogs.com/blog/975660/201711/975660-20171102150804482-422420503.png\" alt=\"\" width=\"311\" height=\"553\"></p>\r\n<p>这里为了方便，我们将改变layer背景色的代码放在了touchesBegan中，点击视图，我们可以看到layer的背景色缓慢的变化为一个新的颜色（系统默认的动画周期是0.25秒，可能不太明显），像这种不显示创建动画对象的方式，称之为<strong>隐式动画。</strong></p>\r\n<p> </p>\r\n<p>但当你改变一个属性，Core Animation是如何判断动画类型和持续时间的呢？实际上动画执行的时间取决于当前<em>事务</em>的设置，动画类型取决于<em>图层行为</em>。</p>\r\n<p>事务实际上是Core Animation用来包含一系列属性动画集合的机制，任何用指定事务去改变可以做动画的图层属性都不会立刻发生变化，而是当事务一旦<em>提交</em>的时候开始用一个动画过渡到新值。</p>\r\n<p>事务是通过<code>CATransaction</code>类来做管理，这个类的设计有些奇怪，不像你从它的命名预期的那样去管理一个简单的事务，而是管理了一叠你不能访问的事务。<code>CATransaction</code>没有属性或者实例方法，并且也不能用<code>+alloc</code>和<code>-init</code>方法创建它。而是用类方法<code>+begin</code>和<code>+commit</code>分别来入栈或者出栈。任何可以做动画的图层属性都可以添加到栈顶的事务。</p>\r\n<p> </p>\r\n<p>接下来我们对之前的代码进行更改，用CATransaction进行一些控制</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>- (<span style=\"color: #0000ff;\">void</span>)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)<span style=\"color: #0000ff;\">event</span><span style=\"color: #000000;\"> {\r\n    [CATransaction begin];\r\n    [CATransaction setAnimationDuration:</span><span style=\"color: #800080;\">1.0</span><span style=\"color: #000000;\">];\r\n    \r\n    CGFloat red </span>= arc4random() /<span style=\"color: #000000;\"> (CGFloat)INT_MAX;\r\n    CGFloat green </span>= arc4random() /<span style=\"color: #000000;\"> (CGFloat)INT_MAX;\r\n    CGFloat blue </span>= arc4random() /<span style=\"color: #000000;\"> (CGFloat)INT_MAX;\r\n    self.colorLayer.backgroundColor </span>= [UIColor colorWithRed:red green:green blue:blue alpha:<span style=\"color: #800080;\">1.0</span><span style=\"color: #000000;\">].CGColor;\r\n    \r\n    [CATransaction commit];\r\n}</span></pre>\r\n</div>\r\n<p>我们通过CATransaction对动画周期做了设置，可以明显看出动画过程</p>\r\n<h3>完成块</h3>\r\n<p>CATransaction中有一个完成动画后的回调，我们添加上可以看看</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>- (<span style=\"color: #0000ff;\">void</span>)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)<span style=\"color: #0000ff;\">event</span><span style=\"color: #000000;\"> {\r\n    [CATransaction begin];\r\n    [CATransaction setAnimationDuration:</span><span style=\"color: #800080;\">1.0</span><span style=\"color: #000000;\">];\r\n    [CATransaction setCompletionBlock:</span>^<span style=\"color: #000000;\">{\r\n        CGAffineTransform transform </span>=<span style=\"color: #000000;\"> self.colorLayer.affineTransform;\r\n        transform </span>=<span style=\"color: #000000;\"> CGAffineTransformRotate(transform, M_PI_4);\r\n        self.colorLayer.affineTransform </span>=<span style=\"color: #000000;\"> transform;\r\n    }];\r\n    CGFloat red </span>= arc4random() /<span style=\"color: #000000;\"> (CGFloat)INT_MAX;\r\n    CGFloat green </span>= arc4random() /<span style=\"color: #000000;\"> (CGFloat)INT_MAX;\r\n    CGFloat blue </span>= arc4random() /<span style=\"color: #000000;\"> (CGFloat)INT_MAX;\r\n    self.colorLayer.backgroundColor </span>= [UIColor colorWithRed:red green:green blue:blue alpha:<span style=\"color: #800080;\">1.0</span><span style=\"color: #000000;\">].CGColor;\r\n    \r\n    [CATransaction commit];\r\n}</span></pre>\r\n</div>\r\n<p>运行后点击视图，可以看到如下图</p>\r\n<p style=\"text-align: center;\"><img src=\"http://images2017.cnblogs.com/blog/975660/201711/975660-20171102151037951-1115331817.png\" alt=\"\" width=\"286\" height=\"508\"></p>\r\n<p style=\"text-align: left;\">注意旋转动画要比颜色渐变快得多，这是因为完成块是在颜色渐变的事务提交并出栈之后才被执行，于是，用默认的事务做变换，默认的时间也就变成了0.25秒。</p>\r\n<p style=\"text-align: left;\"> </p>\r\n<h3 style=\"text-align: left;\">图层行为</h3>\r\n<p>接下来就到了解释为什么不要直接操作与视图关联的图层，这里我们先添加一个按钮和一个视图，添加完之后这个样子</p>\r\n<p style=\"text-align: center;\"><img src=\"http://images2017.cnblogs.com/blog/975660/201711/975660-20171102151733951-1811963719.png\" alt=\"\" width=\"308\" height=\"548\"></p>\r\n<p style=\"text-align: left;\">点击按钮时，要响应如下方法</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">@interface</span><span style=\"color: #000000;\"> ViewController ()\r\n@property (weak, nonatomic) IBOutlet UIView </span>*<span style=\"color: #000000;\">animationView;\r\n</span><span style=\"color: #0000ff;\">@end</span>\r\n\r\n- (IBAction)changeColor:(UIButton *<span style=\"color: #000000;\">)sender {\r\n    [CATransaction begin];\r\n    [CATransaction setAnimationDuration:</span><span style=\"color: #800080;\">1.0</span><span style=\"color: #000000;\">];\r\n    \r\n    CGFloat red </span>= arc4random() /<span style=\"color: #000000;\"> (CGFloat)INT_MAX;\r\n    CGFloat green </span>= arc4random() /<span style=\"color: #000000;\"> (CGFloat)INT_MAX;\r\n    CGFloat blue </span>= arc4random() /<span style=\"color: #000000;\"> (CGFloat)INT_MAX;\r\n    self.animationView.layer.backgroundColor </span>= [UIColor colorWithRed:red green:green blue:blue alpha:<span style=\"color: #800080;\">1.0</span><span style=\"color: #000000;\">].CGColor;\r\n    \r\n    [CATransaction commit];\r\n    \r\n}</span></pre>\r\n</div>\r\n<p>当点击按钮时，我们并没有看到视图的背景慢慢过渡到新颜色，而是立刻变化的，这是为什么呢？</p>\r\n<p>试想一下，如果<code>UIView</code>的属性都有动画特性的话，那么无论在什么时候修改它，我们都应该能注意到的。所以，如果说UIKit建立在Core Animation（默认对所有东西都做动画）之上，那么隐式动画是如何被UIKit禁用掉呢？</p>\r\n<p> </p>\r\n<p>我们把改变属性时<code>CALayer</code>自动应用的动画称作<em>行为</em>，当<code>CALayer</code>的属性被修改时候，它会调用<code>-actionForKey:</code>方法，传递属性的名称。剩下的操作都在<code>CALayer</code>的头文件中有详细的说明，实质上是如下几步：</p>\r\n<ul>\r\n<li>图层首先检测它是否有委托，并且是否实现<code>CALayerDelegate</code>协议指定的<code>-actionForLayer:forKey</code>方法。如果有，直接调用并返回结果。</li>\r\n<li>如果没有委托，或者委托没有实现<code>-actionForLayer:forKey</code>方法，图层接着检查包含属性名称对应行为映射的<code>actions</code>字典。</li>\r\n<li>如果<code>actions字典</code>没有包含对应的属性，那么图层接着在它的<code>style</code>字典接着搜索属性名。</li>\r\n<li>最后，如果在<code>style</code>里面也找不到对应的行为，那么图层将会直接调用定义了每个属性的标准行为的<code>-defaultActionForKey:</code>方法。</li>\r\n</ul>\r\n<p>所以一轮完整的搜索结束之后，<code>-actionForKey:</code>要么返回空（这种情况下将不会有动画发生），要么是<code>CAAction</code>协议对应的对象，最后<code>CALayer</code>拿这个结果去对先前和当前的值做动画。</p>\r\n<p>于是这就解释了UIKit是如何禁用隐式动画的：每个<code>UIView</code>对它关联的图层都扮演了一个委托，并且提供了<code>-actionForLayer:forKey</code>的实现方法。当不在一个动画块的实现中，<code>UIView</code>对所有图层行为返回<code>nil</code>，但是在动画block范围之内，它就返回了一个非空值。我们可以用一个demo做个简单的实验</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>- (<span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\">)viewDidLoad {\r\n    [super viewDidLoad];\r\n    \r\n    NSLog(</span><span style=\"color: #800000;\">@\"</span><span style=\"color: #800000;\">Outside: %@</span><span style=\"color: #800000;\">\"</span>, [self.animationView actionForLayer:self.animationView.layer forKey:<span style=\"color: #800000;\">@\"</span><span style=\"color: #800000;\">backgroundColor</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">]);\r\n  \r\n    [UIView beginAnimations:nil context:nil];\r\n    \r\n    NSLog(</span><span style=\"color: #800000;\">@\"</span><span style=\"color: #800000;\">Inside: %@</span><span style=\"color: #800000;\">\"</span>, [self.animationView actionForLayer:self.animationView.layer forKey:<span style=\"color: #800000;\">@\"</span><span style=\"color: #800000;\">backgroundColor</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">]);\r\n   \r\n    [UIView commitAnimations];\r\n    \r\n \r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Do any additional setup after loading the view, typically from a nib.</span>\r\n}</pre>\r\n</div>\r\n<p>控制台打印结果</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #800080;\">2017</span>-<span style=\"color: #800080;\">11</span>-<span style=\"color: #800080;\">02</span> <span style=\"color: #800080;\">15</span>:<span style=\"color: #800080;\">26</span>:<span style=\"color: #800080;\">05.397157</span>+<span style=\"color: #800080;\">0800</span> Animation[<span style=\"color: #800080;\">3801</span>:<span style=\"color: #800080;\">286395</span>] Outside: &lt;<span style=\"color: #0000ff;\">null</span>&gt;\r\n<span style=\"color: #800080;\">2017</span>-<span style=\"color: #800080;\">11</span>-<span style=\"color: #800080;\">02</span> <span style=\"color: #800080;\">15</span>:<span style=\"color: #800080;\">26</span>:<span style=\"color: #800080;\">05.398090</span>+<span style=\"color: #800080;\">0800</span> Animation[<span style=\"color: #800080;\">3801</span>:<span style=\"color: #800080;\">286395</span>] Inside: &lt;CABasicAnimation: <span style=\"color: #800080;\">0x6040004362a0</span>&gt;</pre>\r\n</div>\r\n<p>所以跟猜测的一样，当属性在动画块之外发生改变，<code>UIView</code>直接通过返回<code>nil</code>来禁用隐式动画。但如果在动画块范围之内，根据动画具体类型返回相应的属性，在这个例子就是<code>CABasicAnimation</code></p>\r\n<p>当然返回<code>nil</code>并不是禁用隐式动画唯一的办法，<code>CATransaction</code>有个方法叫做<code>+setDisableActions:</code>，可以用来对所有属性打开或者关闭隐式动画。</p>\r\n<h3> 总结</h3>\r\n<p>这一章讨论了隐式动画，还有Core Animation对指定属性选择合适的动画行为的机制。同时你知道了UIKit是如何充分利用Core Animation的隐式动画机制来强化它的显式系统，以及动画是如何被默认禁用并且当需要的时候启用的。</p>\r\n<p><a title=\"下载\" href=\"https://gitee.com/yyxy/LayerAnimation\" target=\"_blank\">代码下载</a></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 15:47</span> <a href=\"http://www.cnblogs.com/Devhwl/\">雨月星缘</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7772504\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7772504);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=290260,cb_entryId=7772504,cb_blogApp=currentBlogApp,cb_blogUserGuid='e9ecad81-162d-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/2 15:47:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 12, "image_url": ["https:"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "Quart.Net分布式任务管理平台（续）", "url": "http://www.cnblogs.com/clly/p/7772642.html", "author": "不明白的某某某", "article_desc": "感谢@Taking园友得建议，我这边确实多做了一步上传，导致后面还需处理同步上传到其他服务器来支持分布式得操作。所有才有了上篇文章得完善。 首先看一下新的项目结构图： 这个图和上篇文章中的图大家可以看到有不一样的地方，那就是我们取消了任务子类。 首先我们添加任务子类的目的是想别人开发任务的时候程序集 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/clly/p/7772642.html\">Quart.Net分布式任务管理平台（续）</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><strong>       感谢</strong>@Taking园友得建议，我这边确实多做了一步上传，导致后面还需处理同步上传到其他服务器来支持分布式得操作。所有才有了上篇文章得完善。</p>\r\n<hr>\r\n<p>首先看一下新的项目结构图：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171102151349216-139896116.jpg\" alt=\"\"></p>\r\n<p>这个图和上篇文章中的图大家可以看到有不一样的地方，那就是我们取消了任务子类。</p>\r\n<p>首先我们添加任务子类的目的是想别人开发任务的时候程序集尽量的干净，而对于我们Quartz来说真正运行的还是我们基类中的Excute方法，我们Web中需要通过反射子任务类来添加到Quartz中而现在我们通过直接反射任务基类添加到Quartz当中，这样我们依然保持了干净的程序集，同时我们也回归了本质，子任务类在Quartz中并没有起作用这一点要弄明白。</p>\r\n<p>其次按原来的模式我们添加一个任务我们需要添加一个类库然后去继承基类然后设置url编译，添加任务的时候上传这将导致两个问题，</p>\r\n<p>一：当任务过多时我们项目会变的类库特别大，每次建类库也很麻烦</p>\r\n<p>二：我们为了做分布式意味着 我们要将上传的dll同时保存到三台服务器中的Web，和Quartz的服务节点，这个我们将需要额外的逻辑去处理麻烦。</p>\r\n<p>那么现在这样的结构无论是对编写任务的人，还是做分布式就相对于说变得简单的多了。</p>\r\n<p>现在看一下项目得改变：首先子任务的类库取消，任务基类改变如下：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span>   <span style=\"color: #0000ff;\">public</span>  <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> JobBase : IJob\r\n</span><span style=\"color: #008080;\"> 2</span> <span style=\"color: #000000;\">    {\r\n</span><span style=\"color: #008080;\"> 3</span>         <span style=\"color: #0000ff;\">public</span>  <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Execute(IJobExecutionContext context)\r\n</span><span style=\"color: #008080;\"> 4</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\"> 5</span>             <span style=\"color: #0000ff;\">try</span>\r\n<span style=\"color: #008080;\"> 6</span> <span style=\"color: #000000;\">            {\r\n</span><span style=\"color: #008080;\"> 7</span>                 HttpClient hc = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> HttpClient();\r\n</span><span style=\"color: #008080;\"> 8</span>                 hc.GetAsync(context.JobDetail.JobDataMap[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">requestUrl</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">].ToString());\r\n</span><span style=\"color: #008080;\"> 9</span> <span style=\"color: #000000;\">            }\r\n</span><span style=\"color: #008080;\">10</span>             <span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception ex)\r\n</span><span style=\"color: #008080;\">11</span> <span style=\"color: #000000;\">            {\r\n</span><span style=\"color: #008080;\">12</span>                 <span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Exception(ex.ToString());\r\n</span><span style=\"color: #008080;\">13</span> <span style=\"color: #000000;\">            }\r\n</span><span style=\"color: #008080;\">14</span> <span style=\"color: #000000;\">        }\r\n</span><span style=\"color: #008080;\">15</span> \r\n<span style=\"color: #008080;\">16</span>     }</pre>\r\n</div>\r\n<p>这边取得任务被添加到Quartz时附带得信息也就是requestUrl,这一步我们在下面任务运行得时候会看到；同时我们得添加任务得界面输入得信息会变少：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171102153930170-2020725731.jpg\" alt=\"\"></p>\r\n<p>这边添加任务的时候跟上一篇中对比我们不需要上传程序集，不需要程序集的名字和任务的类名，因为这些东西我们都已经知道就是我们现在的JobBase，而我们现在需要的是上篇文章中的子类设置请求地址现在放到添加任务得时候，保存到数据库中，添加任务得代码也会变得更简单：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span> <span style=\"color: #000000;\">   [HttpPost]\r\n</span><span style=\"color: #008080;\"> 2</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n<span style=\"color: #008080;\"> 3</span>         <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 添加任务\r\n</span><span style=\"color: #008080;\"> 4</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n<span style=\"color: #008080;\"> 5</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobName\"&gt;</span><span style=\"color: #008000;\">任务名称</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 6</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobGroupName\"&gt;</span><span style=\"color: #008000;\">任务所在组名称</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 7</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"triggerName\"&gt;</span><span style=\"color: #008000;\">触发器名称</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 8</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"triggerGroupName\"&gt;</span><span style=\"color: #008000;\">触发器所在的组名称</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 9</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"cron\"&gt;</span><span style=\"color: #008000;\">执行周期表达式</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\">10</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobDescription\"&gt;</span><span style=\"color: #008000;\">任务描述</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\">11</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"requestUrl\"&gt;</span><span style=\"color: #008000;\">请求地址</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\">12</span> \r\n<span style=\"color: #008080;\">13</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;returns&gt;&lt;/returns&gt;</span>\r\n<span style=\"color: #008080;\">14</span> \r\n<span style=\"color: #008080;\">15</span>         <span style=\"color: #0000ff;\">public</span> JsonResult AddJob(<span style=\"color: #0000ff;\">string</span> jobName, <span style=\"color: #0000ff;\">string</span> jobGroupName, <span style=\"color: #0000ff;\">string</span> triggerName, <span style=\"color: #0000ff;\">string</span> triggerGroupName, <span style=\"color: #0000ff;\">string</span> cron,  <span style=\"color: #0000ff;\">string</span> jobDescription,<span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\"> requestUrl)\r\n</span><span style=\"color: #008080;\">16</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\">17</span>             <span style=\"color: #0000ff;\">var</span> jobId =<span style=\"color: #000000;\"> _customerJobInfoRepository.AddCustomerJobInfo(jobName, jobGroupName, triggerName, triggerGroupName, cron, jobDescription, requestUrl);\r\n</span><span style=\"color: #008080;\">18</span>             <span style=\"color: #0000ff;\">return</span> Json(ResponseDataFactory.CreateAjaxResponseData(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">1</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">添加成功</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, jobId));\r\n</span><span style=\"color: #008080;\">19</span> \r\n<span style=\"color: #008080;\">20</span>         }</pre>\r\n</div>\r\n<p>当任务运行得时候去除设置到Quartz中，现在运行任务得方法更改如下：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span>     <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n<span style=\"color: #008080;\"> 2</span>         <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 运行任务\r\n</span><span style=\"color: #008080;\"> 3</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n<span style=\"color: #008080;\"> 4</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobInfo\"&gt;</span><span style=\"color: #008000;\">任务信息</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 5</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;returns&gt;&lt;/returns&gt;</span>\r\n<span style=\"color: #008080;\"> 6</span>         <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">bool</span><span style=\"color: #000000;\"> RunJob(Customer_JobInfo jobInfo)\r\n</span><span style=\"color: #008080;\"> 7</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\"> 8</span>             Assembly assembly = Assembly.LoadFile(AppDomain.CurrentDomain.BaseDirectory + $<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">bin/{jobInfo.DLLName}</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n</span><span style=\"color: #008080;\"> 9</span>             <span style=\"color: #0000ff;\">var</span> type =<span style=\"color: #000000;\"> assembly.GetType(jobInfo.FullJobName);\r\n</span><span style=\"color: #008080;\">10</span>             JobKey jobKey =<span style=\"color: #000000;\"> _createJobKey(jobInfo.JobName, jobInfo.JobGroupName);\r\n</span><span style=\"color: #008080;\">11</span>             <span style=\"color: #0000ff;\">if</span> (!<span style=\"color: #000000;\">_scheduler.CheckExists(jobKey))\r\n</span><span style=\"color: #008080;\">12</span> <span style=\"color: #000000;\">            {\r\n</span><span style=\"color: #008080;\">13</span>                 IJobDetail job =<span style=\"color: #000000;\"> JobBuilder.Create(type)\r\n</span><span style=\"color: #008080;\">14</span> <span style=\"color: #000000;\">                    .WithIdentity(jobKey)\r\n</span><span style=\"color: #008080;\">15</span>                     .UsingJobData(_createJobDataMap(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jobId</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, jobInfo.Id))\r\n</span><span style=\"color: #008080;\">16</span>                     .UsingJobData(_createJobDataMap(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">requestUrl</span><span style=\"color: #800000;\">\"</span>,jobInfo.RequestUrl))<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">添加此任务请求地址附带到Context上下文中</span>\r\n<span style=\"color: #008080;\">17</span> <span style=\"color: #000000;\">                    .Build();\r\n</span><span style=\"color: #008080;\">18</span> \r\n<span style=\"color: #008080;\">19</span>                 CronScheduleBuilder scheduleBuilder =<span style=\"color: #000000;\"> CronScheduleBuilder.CronSchedule(jobInfo.Cron);\r\n</span><span style=\"color: #008080;\">20</span>                 ITrigger trigger = TriggerBuilder.Create().StartNow()<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">StartAt(DateTime.SpecifyKind(jobInfo.JobStartTime, DateTimeKind.Local))</span>\r\n<span style=\"color: #008080;\">21</span> <span style=\"color: #000000;\">                    .WithIdentity(jobInfo.TriggerName, jobInfo.TriggerGroupName)\r\n</span><span style=\"color: #008080;\">22</span> <span style=\"color: #000000;\">                    .ForJob(jobKey)\r\n</span><span style=\"color: #008080;\">23</span> <span style=\"color: #000000;\">                    .WithSchedule(scheduleBuilder.WithMisfireHandlingInstructionDoNothing())\r\n</span><span style=\"color: #008080;\">24</span> <span style=\"color: #000000;\">                    .Build();\r\n</span><span style=\"color: #008080;\">25</span>                 <span style=\"color: #0000ff;\">#region</span> Quartz 任务miss之后三种操作\r\n<span style=\"color: #008080;\">26</span>                 <span style=\"color: #008000;\">/*</span>\r\n<span style=\"color: #008080;\">27</span> <span style=\"color: #008000;\">             withMisfireHandlingInstructionDoNothing\r\n</span><span style=\"color: #008080;\">28</span> <span style=\"color: #008000;\">——不触发立即执行\r\n</span><span style=\"color: #008080;\">29</span> <span style=\"color: #008000;\">——等待下次Cron触发频率到达时刻开始按照Cron频率依次执行\r\n</span><span style=\"color: #008080;\">30</span> \r\n<span style=\"color: #008080;\">31</span> <span style=\"color: #008000;\">withMisfireHandlingInstructionIgnoreMisfires\r\n</span><span style=\"color: #008080;\">32</span> <span style=\"color: #008000;\">——以错过的第一个频率时间立刻开始执行\r\n</span><span style=\"color: #008080;\">33</span> <span style=\"color: #008000;\">——重做错过的所有频率周期后\r\n</span><span style=\"color: #008080;\">34</span> <span style=\"color: #008000;\">——当下一次触发频率发生时间大于当前时间后，再按照正常的Cron频率依次执行\r\n</span><span style=\"color: #008080;\">35</span> \r\n<span style=\"color: #008080;\">36</span> <span style=\"color: #008000;\">withMisfireHandlingInstructionFireAndProceed\r\n</span><span style=\"color: #008080;\">37</span> <span style=\"color: #008000;\">——以当前时间为触发频率立刻触发一次执行\r\n</span><span style=\"color: #008080;\">38</span> <span style=\"color: #008000;\">——然后按照Cron频率依次执行</span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #008080;\">39</span>                 <span style=\"color: #0000ff;\">#endregion</span>\r\n<span style=\"color: #008080;\">40</span> \r\n<span style=\"color: #008080;\">41</span> <span style=\"color: #000000;\">                _scheduler.ScheduleJob(job, trigger);\r\n</span><span style=\"color: #008080;\">42</span> \r\n<span style=\"color: #008080;\">43</span> <span style=\"color: #000000;\">            }\r\n</span><span style=\"color: #008080;\">44</span>             <span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">45</span>         }</pre>\r\n</div>\r\n<p>其实上篇我们添加监听器时往这个里面增加的jobId，当时没有想到把requestUrl运用上，再次感谢园友提醒。那么现在我们这次发现得问题得已解决：</p>\r\n<p>一：现在对于编写任务得人就只需要在界面操作添加requestUrl了，不需要编写任务代码</p>\r\n<p>二：不会见到一大推子任务程序集在项目中，</p>\r\n<p>三：使得分布式更加简单只要我们的Web负载就可以了</p>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 15:50</span> <a href=\"http://www.cnblogs.com/clly/\">不明白的某某某</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7772642\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7772642);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=198644,cb_entryId=7772642,cb_blogApp=currentBlogApp,cb_blogUserGuid='7dc3324a-a93f-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/11/2 15:50:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 58, "image_url": ["https://pic.cnblogs.com/face/674112/20160114143847.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "给资源文件添加指纹（Gulp版）", "url": "http://www.cnblogs.com/iovec/p/7772567.html", "author": "IoveC", "article_desc": "至于为什么要费尽心思地给文件添加指纹，请参看上一篇文章——前端静态资源缓存控制策略。这次要达到的小目标就是生成的资源文件能够被客户端缓存，而在文件内容变化后，能够请求到最新的文件。 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/iovec/p/7772567.html\">给资源文件添加指纹（Gulp版）</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>至于为什么要费尽心思地给文件添加指纹，请参看<a href=\"https://www.cnblogs.com/iovec/p/7676210.html\">前端静态资源缓存控制策略</a>。这次要达到的小目标就是<span style=\"color: #e00\">生成的资源文件能够被客户端缓存，而在文件内容变化后，能够请求到最新的文件。</span></p>\n<p>需要用到的 gulp 插件是 <a href=\"https://www.npmjs.com/package/gulp-rev2\">gulp-rev2</a> ，看清楚了，不是 gulp-rev + gulp-rev-collector 的蹩脚组合，而是 <a href=\"https://www.npmjs.com/package/gulp-rev2\">gulp-rev2</a>。</p>\n<p><strong>gulp-rev2 的设计思路：</strong></p>\n<ol>\n<li><p>根据文件的内容 <code>file.contents</code> 生成文件指纹（<code>hash</code>值）；</p></li>\n<li><p>根据前面生成的文件指纹集合成一张<code>（源文件，构建文件）</code>映射对照表（并保存在清单文件 rev-manifest.json 中）；</p></li>\n<li><p>根据前面生成的映射对照表级联更新存在引用的父文件；</p></li>\n</ol>\n<p>下面以一个<a href=\"https://github.com/makemoretime/gulp-rev2-demo\">具体的栗子</a>为例进行实践。</p>\n<p>栗子的目录结构是这样的：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/882926/201711/882926-20171102153842623-1447615564.png\"></p>\n<p>其中包含一个 css 样式源文件 <strong>.demo/demo.css</strong>，内容如下</p>\n<pre><code>a { background: url(../images/road.jpg); }\ndiv { background: url(../images/a+b.jpg); }</code></pre>\n<p>接下来使用 gulp 进行构建，新建两个任务，一个构建 image，一个构建 css，</p>\n<pre><code>const gulp = require('gulp');\nconst rev2 = require('gulp-rev2');\n\ngulp.task('build:image', ()=&gt;{\n    return gulp.src('./demo/**/*.{png,jpg,gif,ico}')\n        .pipe(rev2())               // 生成文件指纹并修改文件名\n        .pipe(gulp.dest('dist'))    // 输出到 dist 目录\n        .pipe(rev2.manifest())      // 生成映射对照表 rev-manifest.js\n        .pipe(gulp.dest('.'));      // 输出到 gulpfile.js 同级目录\n});\n\ngulp.task('build:css', ['build:image'], ()=&gt;{\n    return gulp.src('./demo/**/*.css')\n        .pipe(rev2.update())        // 根据映射对照表更新存在引用的父文件\n        .pipe(gulp.dest('dist'))\n});</code></pre>\n<p>然后执行 <code>gulp build:css</code>，会发现根目录下生成了 dist 目录，并在里面存放了构建后的文件，</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/882926/201711/882926-20171102153920966-346416550.png\"></p>\n<p>细心的同学可能已经发现在构建之后 <strong>./demo/image/</strong> 目录下的图片资源已经添加了文件指纹，</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/882926/201711/882926-20171102153931623-794185918.png\"></p>\n<p>这时候打开生成的 <strong>./dist/demo.css</strong>，内容如下</p>\n<pre><code>a { background: url(../images/road-f7ee61d96b.jpg); }\ndiv { background: url(../images/a+b-d41d8cd98f.jpg); }</code></pre>\n<p>可以看到引用了图片资源的 css 文件内容也得到了相应更新。只要图片资源发生更新（文件指纹就会发生变化），引用者（css文件）也应该级联更新。这两个应该是始终同步的，否则就会出现<del>驴唇不对马嘴</del>引用错乱。</p>\n<p>文件指纹总算加上了，但是这种修改文件名的方式并不总是所希望的。有时我们可能需要更简单传统的方式，也就是通过url参数（query string）的形式进行关联。也就是我们期望的 css 可能是这样的：</p>\n<pre><code>a { background: url(../images/road.jpg?_v_=f7ee61d96b); }\ndiv { background: url(../images/a+b.jpg?_v_=d41d8cd98f); }</code></pre>\n<p><a href=\"https://www.npmjs.com/package/gulp-rev2\">gulp-rev2</a> 已经提供了这个选项，可以说是服务非常周到。只需要在原来的 gulp 代码上简单加一行配置项：</p>\n<pre><code>. . .\n    .pipe(rev2({                // 生成文件指纹并修改文件名\n        query: true,            // 以query string的方式进行指纹关联\n    }))\n. . .</code></pre>\n<p>重新执行 <code>gulp build:css</code>，打开 <strong>./dist/demo.css</strong>，会发现样式表已经变成了我们预期的样子：</p>\n<pre><code>a { background: url(../images/road.jpg?_v_=f7ee61d96b); }\ndiv { background: url(../images/a+b.jpg?_v_=d41d8cd98f); }</code></pre>\n<p>你可以尝试对单个图片资源进行更新（比如 override 操作），<a href=\"https://www.npmjs.com/package/gulp-rev2\">gulp-rev2</a> 只会更新发生变动的资源的指纹，这也是所期望的。</p>\n<h2 id=\"注意点\">注意点</h2>\n<pre><code>...\n.pipe(rev2.manifest())      // 生成映射对照表 rev-manifest.js\n.pipe(gulp.dest('.'));      // 输出到 gulpfile.js 同级目录</code></pre>\n<p><span style=\"color: #e00\">请确保 <a href=\"https://www.npmjs.com/package/gulp-rev2\">gulp-rev2</a> 生成的清单文件 <strong>rev-manifest.js</strong> 输出在 <strong>gulpfile.js</strong> 同级目录下。</span>这是因为 <a href=\"https://www.npmjs.com/package/gulp-rev2\">gulp-rev2</a> 会在这个目录进行读取，否则将会导致错误。建议你在 <strong>.gitignore</strong> 文件中忽略掉该文件，因为它是构建生成的，没有任何加入版本控制的需要。</p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 15:54</span> <a href=\"http://www.cnblogs.com/iovec/\">IoveC</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7772567\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7772567);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=268174,cb_entryId=7772567,cb_blogApp=currentBlogApp,cb_blogUserGuid='2f8f4794-fabc-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/2 15:54:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 25, "image_url": ["https://pic.cnblogs.com/face/882926/20160224183612.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "Unity3D手机斗地主游戏开发实战（02）_叫地主功能实现(不定期更新中~~~)", "url": "http://www.cnblogs.com/lizzie-xhu/p/7771713.html", "author": "Lancel0t", "article_desc": "系列目录 Unity3D手机斗地主游戏开发实战（01）_发牌功能实现 Unity3D手机斗地主游戏开发实战（02）_叫地主功能实现 Unity3D手机斗地主游戏开发实战（01）_发牌功能实现 Unity3D手机斗地主游戏开发实战（02）_叫地主功能实现 一、大体思路 前面我们实现了点击开始游戏按钮， ...", "content": "<div id=\"post_detail\">\r\n\t<div class=\"post\">\r\n\t\t<div class=\"posthead\">\r\n\t\t\t<h2>\r\n\t\t\t\t<a id=\"cb_post_title_url\" class=\"singleposttitle\" href=\"http://www.cnblogs.com/lizzie-xhu/p/7771713.html\">Unity3D手机斗地主游戏开发实战（02）_叫地主功能实现(不定期更新中~~~)</a>\r\n\t\t\t</h2>\r\n \t\t\tPosted on <span id=\"post-date\">2017-11-02 12:53</span> <a href=\"http://www.cnblogs.com/lizzie-xhu/\">Lancel0t</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7771713\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7771713);return false;\">收藏</a>\r\n\t\t\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=107624,cb_entryId=7771713,cb_blogApp=currentBlogApp,cb_blogUserGuid='49d7f472-3b4d-e111-aa3f-842b2b196315',cb_entryCreatedDate='2017/11/2 12:53:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<div class=\"postbody\"><div id=\"cnblogs_post_body\"><h3>系列目录</h3>\r\n<ul>\r\n<li>\r\n<p><a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/lizzie-xhu/p/7761586.html\">Unity3D手机斗地主游戏开发实战（01）_发牌功能实现</a></p>\r\n</li>\r\n<li>\r\n<p><a id=\"cb_post_title_url\" class=\"singleposttitle\" href=\"http://www.cnblogs.com/lizzie-xhu/p/7771713.html\">Unity3D手机斗地主游戏开发实战（02）_叫地主功能实现</a></p>\r\n</li>\r\n</ul>\r\n<h3>一、大体思路</h3>\r\n<p>前面我们实现了点击开始游戏按钮，系统依次给玩家发牌的逻辑和动画，并展示当前的手牌。这期我们继续实现接下来的功能--叫地主。</p>\r\n<p>1.首先这两天，学习了DOTween，这是一个强大的Unity动画插件，大家可以参考：<a href=\"http://dotween.demigiant.com/documentation.php\" target=\"_blank\">官方文档</a>，个人感觉DOTween还是比较好用的。</p>\r\n<p>好的，我们先来重构一下动画部分的代码（没有绝对牛逼的架构和设计，项目过程中不要不断的持续改进嘛）；先把之前ITween相关引用从项目中删除，然后导入DOTween插件。</p>\r\n<p>相关动画代码改造示例如下：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">移动动画，动画结束后自动销毁</span>\r\n<span style=\"color: #0000ff;\">var</span> tween = cover.transform.DOMove(playerHeapPos[termCurrentIndex].position, <span style=\"color: #800080;\">0.3f</span><span style=\"color: #000000;\">);\r\ntween.OnComplete(() </span>=&gt; Destroy(cover));</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">怎么样比，之前简洁多了吧，而且之前ITween好像不太好用，处理自动销毁时，跟协程点冲突（可能我自己用的方式不对），现在改用DOTween，一点问题也没有~官网上也有这几个动画插件的性能比较，相对来说DOTween表现还是很不错的。</span></p>\r\n<p>2.再来说说具体的设计思路</p>\r\n<p>刚开始觉得叫地主逻辑挺简单，不就是分2次发牌嘛，第一次发51张，后面谁叫到地主再发3张就好了嘛，但其实实现的过程中，发现没有那么简单，需要注意的细节挺多：</p>\r\n<p>a.发牌逻辑调整：因为发牌是按照当前玩家顺序，依次发牌，相当一个箭头一直指向当前回合玩家，发完51张牌后，箭头又开始指向开始发牌的玩家；这时候，需要判断首次发牌结束，由当前回合玩家开始叫牌；</p>\r\n<p>b.当前玩家进入叫牌阶段时，触发倒计时，倒计时内如果玩家选择叫牌，则箭头保持不变，然后开始继续给当前玩家发3张剩余的牌；</p>\r\n<p>c.倒计时内如果玩家选择不叫，则箭头继续指向下个玩家，下个玩家开始叫牌，回到分支b;</p>\r\n<p>d.倒计时内玩家如果没有任何选择，结束后默认不叫，回到分支c;</p>\r\n<p>e.如果3个玩家都没叫，则流局，重新开局（本期为实现，很容易，大家后面可以自己去尝试实现）；</p>\r\n<p>f.可以选择叫3分、2分、1分（将来需要实现，设计开发提前考虑）</p>\r\n<p>h.考虑到玩家自己和对手叫牌逻辑不一样，自己的话，通过界面点击触发，对手暂时监听按键触发（后期改智能AI判断），比如按下Q叫牌，按下W不叫；</p>\r\n<p>i.倒计时设计，叫牌的时候，需要显示玩家面前的计时器，计时结束后触发不叫，其他情况下隐藏；</p>\r\n<p>j.玩家只有自己回合才能叫地主，必须做限制；</p>\r\n<h3>二、玩家类调整</h3>\r\n<p>Player作为玩家的基类，我们需要增加ToBiding（开始叫地主），ForBid（抢地主），NotBid（不抢地主），来控制玩家在叫地主过程中的公共逻辑。</p>\r\n<p>ToBiding：转到自己回合，并设置倒计时；</p>\r\n<p>ForBid：跳出增加回合，停止倒计时，并调用卡牌管理类中的抢地主功能；</p>\r\n<p>ForBid：跳出增加回合，停止倒计时，并调用卡牌管理类中的不抢地主功能；</p>\r\n<p>然后，倒计时这块，添加一个协程Considerating，专门处理倒计时控件显示，标识玩家正在考虑中；</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('0924899b-ce18-49ca-8fda-c40aa6e1e8e4')\"><img id=\"code_img_closed_0924899b-ce18-49ca-8fda-c40aa6e1e8e4\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_0924899b-ce18-49ca-8fda-c40aa6e1e8e4\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('0924899b-ce18-49ca-8fda-c40aa6e1e8e4',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_0924899b-ce18-49ca-8fda-c40aa6e1e8e4\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Collections;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Collections.Generic;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> UnityEngine;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> UnityEngine.UI;\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">abstract</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Player : MonoBehaviour\r\n{\r\n    </span><span style=\"color: #0000ff;\">protected</span> List&lt;CardInfo&gt; cardInfos = <span style=\"color: #0000ff;\">new</span> List&lt;CardInfo&gt;();  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">个人所持卡牌</span>\r\n\r\n    <span style=\"color: #0000ff;\">private</span><span style=\"color: #000000;\"> Text cardCoutText;\r\n    </span><span style=\"color: #0000ff;\">private</span><span style=\"color: #000000;\"> Text countDownText;\r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">int</span> consideratingTime = <span style=\"color: #800080;\">6</span>; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">玩家考虑时间</span>\r\n    <span style=\"color: #0000ff;\">protected</span> <span style=\"color: #0000ff;\">bool</span> isMyTerm = <span style=\"color: #0000ff;\">false</span>;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">当前是否是自己回合</span>\r\n\r\n    <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Start()\r\n    {\r\n        cardCoutText </span>= transform.Find(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">HeapPos/Text</span><span style=\"color: #800000;\">\"</span>).GetComponent&lt;Text&gt;<span style=\"color: #000000;\">();\r\n        countDownText </span>= transform.Find(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">CountDown/Text</span><span style=\"color: #800000;\">\"</span>).GetComponent&lt;Text&gt;<span style=\"color: #000000;\">();\r\n    }\r\n\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 增加一张卡牌\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"cardName\"&gt;&lt;/param&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span> AddCard(<span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\"> cardName)\r\n    {\r\n        cardInfos.Add(</span><span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> CardInfo(cardName));\r\n        cardCoutText.text </span>=<span style=\"color: #000000;\"> cardInfos.Count.ToString();\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 清空所有卡片\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> DropCards()\r\n    {\r\n        cardInfos.Clear();\r\n    }\r\n\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 用户考虑时间\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">private</span><span style=\"color: #000000;\"> IEnumerator Considerating()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">倒计时</span>\r\n        <span style=\"color: #0000ff;\">var</span> time =<span style=\"color: #000000;\"> consideratingTime;\r\n        </span><span style=\"color: #0000ff;\">while</span> (time &gt; <span style=\"color: #800080;\">0</span><span style=\"color: #000000;\">)\r\n        {\r\n            countDownText.text </span>=<span style=\"color: #000000;\"> time.ToString();\r\n\r\n            </span><span style=\"color: #0000ff;\">yield</span> <span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">new</span> WaitForSeconds(<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">);\r\n            time</span>--<span style=\"color: #000000;\">;\r\n        }\r\n        NotBid();\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 开始叫地主\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">virtual</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> ToBiding()\r\n    {\r\n        isMyTerm </span>= <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">开始倒计时</span>\r\n        countDownText.transform.parent.gameObject.SetActive(<span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">);\r\n        StartCoroutine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Considerating</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 抢地主\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> ForBid()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">关闭倒计时</span>\r\n        countDownText.transform.parent.gameObject.SetActive(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n        StopCoroutine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Considerating</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n\r\n        CardManager._instance.ForBid();\r\n        isMyTerm </span>= <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 不抢地主\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> NotBid()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">关闭倒计时</span>\r\n        countDownText.transform.parent.gameObject.SetActive(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n        StopCoroutine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Considerating</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n\r\n        CardManager._instance.NotBid();\r\n        isMyTerm </span>= <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 卡牌排序（从大到小）\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">protected</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Sort()\r\n    {\r\n        cardInfos.Sort();\r\n        cardInfos.Reverse();\r\n    }\r\n\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<h3>三、自身玩家类调整</h3>\r\n<p>其实就是重写了基类ToBiding方法，调用显示叫牌按钮（只有自身玩家才需要）</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('41bc2183-04e3-4e1a-8849-375ee0618b05')\"><img id=\"code_img_closed_41bc2183-04e3-4e1a-8849-375ee0618b05\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_41bc2183-04e3-4e1a-8849-375ee0618b05\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('41bc2183-04e3-4e1a-8849-375ee0618b05',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_41bc2183-04e3-4e1a-8849-375ee0618b05\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Collections.Generic;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> DG.Tweening;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> UnityEngine;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> UnityEngine.EventSystems;\r\n\r\n</span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n<span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 自身玩家\r\n</span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n<span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> PlayerSelf : Player\r\n{\r\n    </span><span style=\"color: #0000ff;\">public</span> GameObject prefab;   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">预制件</span>\r\n\r\n    <span style=\"color: #0000ff;\">private</span> Transform originPos1; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">牌的初始位置</span>\r\n    <span style=\"color: #0000ff;\">private</span> Transform originPos2; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">牌的初始位置</span>\r\n    <span style=\"color: #0000ff;\">private</span> List&lt;GameObject&gt; cards = <span style=\"color: #0000ff;\">new</span> List&lt;GameObject&gt;<span style=\"color: #000000;\">();\r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">bool</span> canSelectCard = <span style=\"color: #0000ff;\">false</span>;     <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">玩家是否可以选牌</span>\r\n\r\n    <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Awake()\r\n    {\r\n        originPos1 </span>= transform.Find(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">OriginPos1</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        originPos2 </span>= transform.Find(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">OriginPos2</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n    }\r\n\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">整理手牌</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> GenerateAllCards()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">排序</span>\r\n<span style=\"color: #000000;\">        Sort();\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">计算每张牌的偏移</span>\r\n        <span style=\"color: #0000ff;\">var</span> offsetX = originPos2.position.x -<span style=\"color: #000000;\"> originPos1.position.x;\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取最左边的起点</span>\r\n        <span style=\"color: #0000ff;\">int</span> leftCount = (cardInfos.Count / <span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #0000ff;\">var</span> startPos = originPos1.position + Vector3.left * offsetX *<span style=\"color: #000000;\"> leftCount;\r\n\r\n        </span><span style=\"color: #0000ff;\">for</span> (<span style=\"color: #0000ff;\">int</span> i = <span style=\"color: #800080;\">0</span>; i &lt; cardInfos.Count; i++<span style=\"color: #000000;\">)\r\n        {\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">生成卡牌</span>\r\n            <span style=\"color: #0000ff;\">var</span> card =<span style=\"color: #000000;\"> Instantiate(prefab, originPos1.position, Quaternion.identity, transform);\r\n            card.GetComponent</span>&lt;RectTransform&gt;().localScale = Vector3.one * <span style=\"color: #800080;\">0.6f</span><span style=\"color: #000000;\">;\r\n            card.GetComponent</span>&lt;Card&gt;<span style=\"color: #000000;\">().InitImage(cardInfos[i]);\r\n            card.transform.SetAsLastSibling();\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">动画移动</span>\r\n            <span style=\"color: #0000ff;\">var</span> tween = card.transform.DOMoveX(startPos.x + offsetX *<span style=\"color: #000000;\"> i, 1f);\r\n            </span><span style=\"color: #0000ff;\">if</span> (i == cardInfos.Count - <span style=\"color: #800080;\">1</span>) <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">最后一张动画</span>\r\n<span style=\"color: #000000;\">            {\r\n                tween.OnComplete(() </span>=&gt; { canSelectCard = <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">; });\r\n            }\r\n            cards.Add(card);\r\n        }\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 销毁所有卡牌对象\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> DestroyAllCards()\r\n    {\r\n        cards.ForEach(Destroy);\r\n        cards.Clear();\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 开始叫牌\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">override</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> ToBiding()\r\n    {\r\n        </span><span style=\"color: #0000ff;\">base</span><span style=\"color: #000000;\">.ToBiding();\r\n        CardManager._instance.SetBidButtonActive(</span><span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">);\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 点击卡牌处理\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"data\"&gt;&lt;/param&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> CardClick(BaseEventData data)\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">叫牌或出牌阶段才可以选牌</span>\r\n        <span style=\"color: #0000ff;\">if</span> (canSelectCard &amp;&amp;<span style=\"color: #000000;\">\r\n            (CardManager._instance.cardManagerState </span>== CardManagerStates.Bid ||<span style=\"color: #000000;\">\r\n             CardManager._instance.cardManagerState </span>==<span style=\"color: #000000;\"> CardManagerStates.Playing))\r\n        {\r\n            </span><span style=\"color: #0000ff;\">var</span> eventData = data <span style=\"color: #0000ff;\">as</span><span style=\"color: #000000;\"> PointerEventData;\r\n            </span><span style=\"color: #0000ff;\">if</span> (eventData == <span style=\"color: #0000ff;\">null</span>) <span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\">;\r\n\r\n            </span><span style=\"color: #0000ff;\">var</span> card = eventData.pointerCurrentRaycast.gameObject.GetComponent&lt;Card&gt;<span style=\"color: #000000;\">();\r\n            </span><span style=\"color: #0000ff;\">if</span> (card == <span style=\"color: #0000ff;\">null</span>) <span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\">;\r\n\r\n            card.SetSelectState();\r\n        }\r\n    }\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<h3>四、对手玩家类调整</h3>\r\n<p>主要模拟对手叫牌，如果是玩家回合，按下Q叫牌，按下W不叫</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('2f5a44cd-e4f0-488c-9e92-888c16eeed19')\"><img id=\"code_img_closed_2f5a44cd-e4f0-488c-9e92-888c16eeed19\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_2f5a44cd-e4f0-488c-9e92-888c16eeed19\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('2f5a44cd-e4f0-488c-9e92-888c16eeed19',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_2f5a44cd-e4f0-488c-9e92-888c16eeed19\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> UnityEngine;\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> PlayerOther : Player\r\n{\r\n    </span><span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Update()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果当前是自己回合，模拟对手叫牌</span>\r\n        <span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (isMyTerm)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">if</span> (Input.GetKeyDown(KeyCode.Q))    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">叫牌</span>\r\n<span style=\"color: #000000;\">            {\r\n                ForBid();\r\n            }\r\n            </span><span style=\"color: #0000ff;\">if</span> (Input.GetKeyDown(KeyCode.W))    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">不叫</span>\r\n<span style=\"color: #000000;\">            {\r\n                NotBid();\r\n            }\r\n        }\r\n    }\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<h3>五、卡牌管理类调整</h3>\r\n<p>首先需要改造发牌方法，现在区分发牌是发普通牌还是发发地主牌，根据发牌的不同类型，取牌堆里的不同牌，再判断是依次发牌，还是只发给地主牌。</p>\r\n<p>然后具体实现玩家开始抢地主StartBiding，叫地主ForBid，不叫地主NotBid 3个方法：</p>\r\n<p>StartBiding：从当前回合玩家开始叫牌；</p>\r\n<p>ForBid：设置当前回合玩家是地主，并给地主发余下3张牌；</p>\r\n<p>NotBid ：转向下个回合玩家开始叫牌；</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('014b4b9e-e7eb-45e1-a34d-03e84ec4bc8e')\"><img id=\"code_img_closed_014b4b9e-e7eb-45e1-a34d-03e84ec4bc8e\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_014b4b9e-e7eb-45e1-a34d-03e84ec4bc8e\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('014b4b9e-e7eb-45e1-a34d-03e84ec4bc8e',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_014b4b9e-e7eb-45e1-a34d-03e84ec4bc8e\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Collections;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.IO;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Linq;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> DG.Tweening;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> UnityEngine;\r\n\r\n</span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n<span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 卡牌管理\r\n</span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n<span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> CardManager : MonoBehaviour\r\n{\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> CardManager _instance;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">单例</span>\r\n\r\n\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">float</span> dealCardSpeed = <span style=\"color: #800080;\">20</span>;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">发牌速度</span>\r\n    <span style=\"color: #0000ff;\">public</span> Player[] Players;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">玩家的集合</span>\r\n\r\n    <span style=\"color: #0000ff;\">public</span> GameObject coverPrefab;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">背面排预制件</span>\r\n    <span style=\"color: #0000ff;\">public</span> Transform heapPos;           <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">牌堆位置</span>\r\n    <span style=\"color: #0000ff;\">public</span> Transform[] playerHeapPos;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">玩家牌堆位置</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> CardManagerStates cardManagerState;\r\n\r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">string</span>[] cardNames;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">所有牌集合</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">int</span> termStartIndex;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">回合开始玩家索引</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">int</span> termCurrentIndex;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">回合当前玩家索引</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">int</span> bankerIndex;        <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">当前地主索引</span>\r\n    <span style=\"color: #0000ff;\">private</span><span style=\"color: #000000;\"> GameObject bidBtns;\r\n    </span><span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Awake()\r\n    {\r\n        _instance </span>= <span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">;\r\n        cardNames </span>=<span style=\"color: #000000;\"> GetCardNames();\r\n\r\n        bidBtns </span>= GameObject.Find(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">BidBtns</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        bidBtns.SetActive(</span><span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 洗牌\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> ShuffleCards()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">进入洗牌阶段</span>\r\n        cardManagerState =<span style=\"color: #000000;\"> CardManagerStates.ShuffleCards;\r\n        cardNames </span>= cardNames.OrderBy(c =&gt;<span style=\"color: #000000;\"> Guid.NewGuid()).ToArray();\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 开始发牌\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> IEnumerator DealCards()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">进入发牌阶段</span>\r\n        cardManagerState =<span style=\"color: #000000;\"> CardManagerStates.DealCards;\r\n        termCurrentIndex </span>=<span style=\"color: #000000;\"> termStartIndex;\r\n\r\n        </span><span style=\"color: #0000ff;\">yield</span> <span style=\"color: #0000ff;\">return</span> DealHeapCards(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 发牌堆上的牌（如果现在不是抢地主阶段，发普通牌，如果是，发地主牌）\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;returns&gt;&lt;/returns&gt;</span>\r\n    <span style=\"color: #0000ff;\">private</span> IEnumerator DealHeapCards(<span style=\"color: #0000ff;\">bool</span><span style=\"color: #000000;\"> ifForBid)\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">显示牌堆</span>\r\n        heapPos.gameObject.SetActive(<span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">);\r\n        playerHeapPos.ToList().ForEach(s </span>=&gt; { s.gameObject.SetActive(<span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">); });\r\n\r\n        </span><span style=\"color: #0000ff;\">var</span> cardNamesNeeded =<span style=\"color: #000000;\"> ifForBid\r\n            </span>? cardNames.Skip(cardNames.Length - <span style=\"color: #800080;\">3</span>).Take(<span style=\"color: #800080;\">3</span>)  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果是抢地主牌，取最后3张</span>\r\n            : cardNames.Take(cardNames.Length - <span style=\"color: #800080;\">3</span>);         <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果首次发牌</span>\r\n\r\n        <span style=\"color: #0000ff;\">foreach</span> (<span style=\"color: #0000ff;\">var</span> cardName <span style=\"color: #0000ff;\">in</span><span style=\"color: #000000;\"> cardNamesNeeded)\r\n        {\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">给当前玩家发一张牌</span>\r\n<span style=\"color: #000000;\">            Players[termCurrentIndex].AddCard(cardName);\r\n\r\n            </span><span style=\"color: #0000ff;\">var</span> cover =<span style=\"color: #000000;\"> Instantiate(coverPrefab, heapPos.position, Quaternion.identity, heapPos.transform);\r\n            cover.GetComponent</span>&lt;RectTransform&gt;().localScale =<span style=\"color: #000000;\"> Vector3.one;\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">移动动画，动画结束后自动销毁</span>\r\n            <span style=\"color: #0000ff;\">var</span> tween = cover.transform.DOMove(playerHeapPos[termCurrentIndex].position, <span style=\"color: #800080;\">0.3f</span><span style=\"color: #000000;\">);\r\n            tween.OnComplete(() </span>=&gt;<span style=\"color: #000000;\"> Destroy(cover));\r\n\r\n            </span><span style=\"color: #0000ff;\">yield</span> <span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">new</span> WaitForSeconds(<span style=\"color: #800080;\">1</span> /<span style=\"color: #000000;\"> dealCardSpeed);\r\n\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">下一个需要发牌者</span>\r\n            <span style=\"color: #0000ff;\">if</span> (!<span style=\"color: #000000;\">ifForBid)\r\n                SetNextPlayer();\r\n        }\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">隐藏牌堆</span>\r\n        heapPos.gameObject.SetActive(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n        playerHeapPos[</span><span style=\"color: #800080;\">0</span>].gameObject.SetActive(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">发普通牌</span>\r\n        <span style=\"color: #0000ff;\">if</span> (!<span style=\"color: #000000;\">ifForBid)\r\n        {\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">显示玩家手牌</span>\r\n<span style=\"color: #000000;\">            ShowPlayerSelfCards();\r\n            StartBiding();\r\n        }\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">发地主牌</span>\r\n        <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n        {\r\n            </span><span style=\"color: #0000ff;\">if</span> (Players[bankerIndex] <span style=\"color: #0000ff;\">is</span><span style=\"color: #000000;\"> PlayerSelf)\r\n            {\r\n                </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">显示玩家手牌</span>\r\n<span style=\"color: #000000;\">                ShowPlayerSelfCards();\r\n            }\r\n            cardManagerState </span>=<span style=\"color: #000000;\"> CardManagerStates.Playing;\r\n        }\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 开始抢地主\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> StartBiding()\r\n    {\r\n        cardManagerState </span>=<span style=\"color: #000000;\"> CardManagerStates.Bid;\r\n\r\n        Players[termCurrentIndex].ToBiding();\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 显示玩家手牌\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> ShowPlayerSelfCards()\r\n    {\r\n        Players.ToList().ForEach(s </span>=&gt;<span style=\"color: #000000;\">\r\n        {\r\n            </span><span style=\"color: #0000ff;\">var</span> player0 = s <span style=\"color: #0000ff;\">as</span><span style=\"color: #000000;\"> PlayerSelf;\r\n            </span><span style=\"color: #0000ff;\">if</span> (player0 != <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            {\r\n                player0.GenerateAllCards();\r\n            }\r\n        });\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 清空牌局\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> ClearCards()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">清空所有玩家卡牌</span>\r\n        Players.ToList().ForEach(s =&gt;<span style=\"color: #000000;\"> s.DropCards());\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">显示玩家手牌</span>\r\n        Players.ToList().ForEach(s =&gt;<span style=\"color: #000000;\">\r\n        {\r\n            </span><span style=\"color: #0000ff;\">var</span> player0 = s <span style=\"color: #0000ff;\">as</span><span style=\"color: #000000;\"> PlayerSelf;\r\n            </span><span style=\"color: #0000ff;\">if</span> (player0 != <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            {\r\n                player0.DestroyAllCards();\r\n            }\r\n        });\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 叫地主\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> ForBid()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">设置当前地主</span>\r\n        bankerIndex =<span style=\"color: #000000;\"> termCurrentIndex;\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">给地主发剩下的3张牌</span>\r\n        SetBidButtonActive(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n        StartCoroutine(DealHeapCards(</span><span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">));\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 不叫\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> NotBid()\r\n    {\r\n        SetBidButtonActive(</span><span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n        SetNextPlayer();\r\n        Players[termCurrentIndex].ToBiding();\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 控制叫地主按钮是否显示\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"isActive\"&gt;&lt;/param&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span> SetBidButtonActive(<span style=\"color: #0000ff;\">bool</span><span style=\"color: #000000;\"> isActive)\r\n    {\r\n        bidBtns.SetActive(isActive);\r\n    }\r\n\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 设置下一轮开始玩家\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> SetNextTerm()\r\n    {\r\n        termStartIndex </span>= (termStartIndex + <span style=\"color: #800080;\">1</span>) %<span style=\"color: #000000;\"> Players.Length;\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 设置下个回合玩家\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;returns&gt;&lt;/returns&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> SetNextPlayer()\r\n    {\r\n        termCurrentIndex </span>= (termCurrentIndex + <span style=\"color: #800080;\">1</span>) %<span style=\"color: #000000;\"> Players.Length;\r\n    }\r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\">[] GetCardNames()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">路径  </span>\r\n        <span style=\"color: #0000ff;\">string</span> fullPath = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Assets/Resources/Images/Cards/</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n\r\n        </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (Directory.Exists(fullPath))\r\n        {\r\n            DirectoryInfo direction </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> DirectoryInfo(fullPath);\r\n            FileInfo[] files </span>= direction.GetFiles(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.png</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, SearchOption.AllDirectories);\r\n\r\n            </span><span style=\"color: #0000ff;\">return</span> files.Select(s =&gt;<span style=\"color: #000000;\"> Path.GetFileNameWithoutExtension(s.Name)).ToArray();\r\n        }\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n    }\r\n\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">开始新回合</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> OnStartTermClick()\r\n    {\r\n        ClearCards();\r\n        ShuffleCards();\r\n        StartCoroutine(DealCards());\r\n    }\r\n\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<h3>六、总结</h3>\r\n<p>至此，我们【叫地主】功能大体完成了，来试试效果吧~<br><img src=\"http://images2017.cnblogs.com/blog/371995/201711/371995-20171102124950435-161166063.gif\" alt=\"\"></p>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n</div>\r\n\t</div></div>", "article_view": 226, "image_url": ["https://pic.cnblogs.com/face/371995/20171031151026.png"], "date_pub": "2017-11-02", "article_common": 5}
{"title": "记一次前端性能优化的案例", "url": "http://www.cnblogs.com/lvdabao/p/7771763.html", "author": "吕大豹", "article_desc": "前两天遇到一个前端性能相关的bug，感觉还挺典型的，整理了一下解决过程和思路，写下来分享给大家。 场景是这样的，有一个答题的界面，可以播放音频、填空、提交答案，界面是长这个样子的： 看起来还挺简单吧，但是我们在手机上跑的时候，却遇到了以下问题： 1. 填完空后，提交按钮会由灰色变为蓝色（可提交状态） ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/lvdabao/p/7771763.html\">记一次前端性能优化的案例</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>前两天遇到一个前端性能相关的bug，感觉还挺典型的，整理了一下解决过程和思路，写下来分享给大家。</p>\r\n<p>场景是这样的，有一个答题的界面，可以播放音频、填空、提交答案，界面是长这个样子的：</p>\r\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_png/Ln9Ehepfls0ZTy44okmHLxcRFTVH1Iq6kVEdFC9j7SbtzPYicElza2v2po6ugLZjCq2M5jzMLkAeibCHZEkzmPTg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1\" alt=\"\" data-s=\"300,640\" data-type=\"png\" data-src=\"https://mmbiz.qpic.cn/mmbiz_png/Ln9Ehepfls0ZTy44okmHLxcRFTVH1Iq6kVEdFC9j7SbtzPYicElza2v2po6ugLZjCq2M5jzMLkAeibCHZEkzmPTg/0?wx_fmt=png\" data-ratio=\"1.7780748663101604\" data-w=\"374\" data-fail=\"0\"></p>\r\n<p>看起来还挺简单吧，但是我们在手机上跑的时候，却遇到了以下问题：</p>\r\n<p>1. 填完空后，提交按钮会由灰色变为蓝色（可提交状态），但是播放完音频后，却无法变蓝</p>\r\n<p>2. 页面较长时，一边播音频一边滚动页面，会出现页面闪烁（短时白屏）</p>\r\n<p>我的第一反应就是：出渲染bug了。因为在一些低端手机上，经常会遇到动态修改页面，渲染没有及时生效，出现花屏或者白屏的情况。</p>\r\n<p>而修改这类bug并没有什么好方法，唯一管用的就是强制浏览器再重绘一次。常用的技术手段比如设置style.visibility=\"visible\"，或者是更新一下className。有时候这种“轻度重绘”起不到作用的话，还会修改背景色啦，或者先display:none然后在display:block，目的都是强制触发浏览器的reflow或者repaint，期望它能给渲染正常。</p>\r\n<p>因此我不假思索使出老手段。但是在尝试各种强制重绘后，并没有解决问题1。这我也是能想通的，毕竟是不稳定的hack手段，不生效也是情有可原。</p>\r\n<p>有人会问，是不是逻辑写的有问题啊？经我排查其实并没有逻辑问题，我们是用vue的:class绑定做的样式更新，此时该状态的变量已经更新了，而且class的属性值也更新了，只是视觉上没看到更新而已，还是渲染的问题没错。</p>\r\n<p>此时我有一个胆大的想法：不会是vue的bug吧！猜测如下：vue内部更新class值的时候是不是有什么机制，导致浏览器在某些特殊情况下忽略了这次渲染。其实我并不愿意这样想，毕竟vue已经是一个很稳定的框架了，不至于有这么低级的问题吧，就算真有，应该早就暴漏出来了呀。</p>\r\n<p>但是事实就摆在我眼前，而我还必须解决这个bug，所以还得想办法。</p>\r\n<p>“要不，这里就不用vue绑定了。”</p>\r\n<p>不用vue绑定，自己手动操作更新className。这实在是下下策，我甚至感到有点羞耻。因为我是有代码洁癖的，用vue本身就是为了不手动操作DOM，而现在，却要在用vue一气呵成的代码中插入一段手动操作DOM的代码。简直是一颗老鼠屎，破坏了整个代码的完美度。</p>\r\n<p>上线要紧啊，忍了。于是我把提交按钮这里，改为了手动更新className。问题解决了，提交按钮乖乖变蓝，播放音频的动作不会影响到它了。大家夸我快速解决了问题，而我的良心隐隐作痛。</p>\r\n<p>故事并没有结束，其实，重点才刚刚开始。直到遇到问题2，才让我开始重新审视这个问题。问题2是这样的：在页面高度特别长的时候，会有滚动页面的操作。当正在播放音频的时候去滚动页面，大概在播完音频的那个瞬间（页面还在滚），页面会发生一次严重的抖动，直接白屏一下，然后页面重新正常显示。</p>\r\n<p>这下好了，没法用重绘hack，也没法再用手动操作DOM的恶心方法了。此时，不得不拿出调试利器了：chrome的devtool。在Rendering工具中，勾选Paint Flashing，它能够高亮页面被重绘的区域。</p>\r\n<p>有发现了！在音频播放完毕的时候，提交按钮那块区域竟然发生了一次重绘。这怎么回事呢？它俩隔着老远，而且并没有父子关系，况且提交按钮还是绝对定位放在下面的。我想不到什么原因能让下边的提交按钮发生重绘。</p>\r\n<p>重头来了，这时我打开了Layers工具，看到的景象让我大吃一惊。看下面的动图吧：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/520134/201711/520134-20171102131249701-578158392.gif\" alt=\"\"></p>\r\n<p><img class=\"img_loading __bg_gif\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"\" data-type=\"gif\" data-src=\"https://mmbiz.qpic.cn/mmbiz_gif/Ln9Ehepfls0ZTy44okmHLxcRFTVH1Iq66W7V7O0JF5Q6pSWCen6NmrzwUfSOn8HTOD7TdRG1zwL8voeyJccgbg/0?wx_fmt=gif\" data-ratio=\"0.6451048951048951\" data-w=\"1144\" data-order=\"0\"></p>\r\n<p>音频播放组件那里的graphics layer竟然如此之乱，在开始播放的时候，发生了较多的层提升和层合并。更为奇葩的时，下方的提交按钮区域也跟着发生了层提升。如果你细细观察，还能看到右上角的那片绿叶子也发生了层提升，你这家伙跟着起哄什么啊。。。</p>\r\n<p>这下问题的症结就比较清楚了，多余的层变动，导致意外的重绘。恰逢页面正在滚动，一下遇到了渲染瓶颈，就出现了闪烁。那么，是什么原因导致的层变动呢？</p>\r\n<p>经过审查代码，查到了问题所在，总结如下：</p>\r\n<p>音频组件的布局方式存在问题，左侧旋转的圆盘是右侧进度条的子元素，通过绝对定位给定到左侧的。并且其高度是大于父元素的，通过父元素的overflow:visible才得以完整显示。大家知道元素间的遮挡以及裁切都可能会生成新的提升层（graphics layer）。而且左侧的圆盘在播放时还会通过transform进行旋转动画，transform也会进行层提升，同时浏览器还会进行层合并的判断，将可以合并的合成一个graphics layer。而这个判断是全局进行的，也就是说页面底部的提交按钮也被计算在内，可能正好命中了某些规则，所以它也被提升为单独的层。</p>\r\n<p>所以我把音频组件进行了重新的布局（减少遮挡与裁切），不让它产生那么多的提升层行为。</p>\r\n<p>至于右上角那个绿叶子，我发现他的z-index为100，感觉根本不需要这么大，改为了2，工作良好，并且不会被提升了。大家知道z-index也是层提升的一个影响因素，很多同学经常随手就写一个很大的z-index，生怕自己的元素被别人盖住。这是一个很不好的习惯，没准哪天就给命中了层提升的规则，引发重绘了。</p>\r\n<p>经过了上面的修改，再次打开Layers面板，发现此时的层已经很规整了，效果如下：</p>\r\n<p><img class=\" __bg_gif\" src=\"https://mmbiz.qpic.cn/mmbiz_gif/Ln9Ehepfls0ZTy44okmHLxcRFTVH1Iq6jhoSrrtV2ImsAyQdyuoVZCK79Ivh74h8CRTdVtD77ibKHYCich4tfiaiaw/0?wx_fmt=gif&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1\" alt=\"\" data-type=\"gif\" data-src=\"https://mmbiz.qpic.cn/mmbiz_gif/Ln9Ehepfls0ZTy44okmHLxcRFTVH1Iq6jhoSrrtV2ImsAyQdyuoVZCK79Ivh74h8CRTdVtD77ibKHYCich4tfiaiaw/0?wx_fmt=gif\" data-ratio=\"0.6451048951048951\" data-w=\"1144\" data-order=\"1\" data-fail=\"0\"></p>\r\n<p> </p>\r\n<p>感觉很清爽了有木有。而在此修改之后，问题1的根本原因也定位到了（由于层提升而引发了重绘），并且顺势恢复正常。那段让我良心隐隐作痛的代码也可以删掉啦！</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 13:14</span> <a href=\"http://www.cnblogs.com/lvdabao/\">吕大豹</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7771763\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7771763);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=148826,cb_entryId=7771763,cb_blogApp=currentBlogApp,cb_blogUserGuid='87114f06-25ab-e211-83e8-90b11c0b17d6',cb_entryCreatedDate='2017/11/2 13:14:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 438, "image_url": ["https://pic.cnblogs.com/face/520134/20160420115610.png"], "date_pub": "2017-11-02", "article_common": 6}
{"title": "微信小程序图片放大预览", "url": "http://www.cnblogs.com/Mrrabbit/p/7771910.html", "author": "兔子先生i", "article_desc": "需求：当点击图片时，当前图片放大预览，且可以左右滑动 实现方式：使用微信小程序图片预览接口 我们可以看到api需要两个参数，分别通过下面的data-list和data-src来传到js中 wxml代码： js代码： 1.给图片添加一个点击事件(imgYu) 2.使用event.currentTarg ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/Mrrabbit/p/7771910.html\">微信小程序图片放大预览</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><strong>需求：当点击图片时，当前图片放大预览，且可以左右滑动</strong></p>\n<p> </p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1119773/201711/1119773-20171102120329482-1293104221.png\" alt=\"\"></p>\n<p> </p>\n<p><strong>实现方式：使用微信小程序图片预览接口</strong></p>\n<p><strong><img src=\"http://images2017.cnblogs.com/blog/1119773/201711/1119773-20171102120643091-665270174.png\" alt=\"\"></strong></p>\n<p> </p>\n<p>我们可以看到api需要两个参数，分别通过下面的data-list和data-src来传到js中</p>\n<p>wxml代码：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\">图片描述</span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\">2</span>   <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">view </span><span style=\"color: #ff0000\">wx:if</span><span style=\"color: #0000ff\">=\"{{item.pictures}}\"</span><span style=\"color: #ff0000\"> class</span><span style=\"color: #0000ff\">=\"list-dImg\"</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">3</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">image </span><span style=\"color: #ff0000\">bindtap</span><span style=\"color: #0000ff\">=\"imgYu\"</span><span style=\"color: #ff0000\"> data-list</span><span style=\"color: #0000ff\">=\"{{item.pictures}}\"</span><span style=\"color: #ff0000\"> data-src</span><span style=\"color: #0000ff\">=\"{{dImg}}\"</span><span style=\"color: #ff0000\"> wx:for</span><span style=\"color: #0000ff\">=\"{{item.pictures}}\"</span><span style=\"color: #ff0000\"> wx:for-item</span><span style=\"color: #0000ff\">=\"dImg\"</span><span style=\"color: #ff0000\"> src</span><span style=\"color: #0000ff\">=\"{{dImg}}\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">image</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">4</span>   <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">view</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p>js代码：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span>  <span style=\"color: #008000\">//</span><span style=\"color: #008000\">图片点击事件</span>\n<span style=\"color: #008080\"> 2</span>   imgYu:<span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(event){\n</span><span style=\"color: #008080\"> 3</span>     <span style=\"color: #0000ff\">var</span> src = event.currentTarget.dataset.src;<span style=\"color: #008000\">//</span><span style=\"color: #008000\">获取data-src</span>\n<span style=\"color: #008080\"> 4</span>     <span style=\"color: #0000ff\">var</span> imgList = event.currentTarget.dataset.list;<span style=\"color: #008000\">//</span><span style=\"color: #008000\">获取data-list</span>\n<span style=\"color: #008080\"> 5</span>     <span style=\"color: #008000\">//</span><span style=\"color: #008000\">图片预览</span>\n<span style=\"color: #008080\"> 6</span> <span style=\"color: #000000\">    wx.previewImage({\n</span><span style=\"color: #008080\"> 7</span>       current: src, <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 当前显示图片的http链接</span>\n<span style=\"color: #008080\"> 8</span>       urls: imgList <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 需要预览的图片http链接列表</span>\n<span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">    })\n</span><span style=\"color: #008080\">10</span>   }</pre>\n</div>\n<p>1.给图片添加一个点击事件(imgYu) </p>\n<p>2.使用event.currentTarget.dataset.自定义属性名称   来获取data-的值 如event.currentTarget.dataset.src  (获取data-src的值)</p>\n<p>3.之后将获取的两个值 放到wx.previewImage接口 里面即可</p>\n<p> </p>\n<p>效果图片如下：可以左右滑动上一张下一张</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1119773/201711/1119773-20171102134852451-1854631644.png\" alt=\"\"></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 13:52</span> <a href=\"http://www.cnblogs.com/Mrrabbit/\">兔子先生i</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7771910\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7771910);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=337928,cb_entryId=7771910,cb_blogApp=currentBlogApp,cb_blogUserGuid='91eae4c1-e102-e711-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/2 13:52:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 163, "image_url": ["https://pic.cnblogs.com/face/1119773/20170307111752.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "d3根据数据绘制不同的形状", "url": "http://www.cnblogs.com/baize-q/p/7729847.html", "author": "白泽Q", "article_desc": "绘制力导向图的时候通常节点都是圆形，但也会遇到公司节点绘制成圆型，人绘制成方形的情况，那我们怎么依据数据绘制不同的形状。 你可能首先会想到，这很简单啊，是公司的时候append circle,是人的时候append rect。但是append并没有提供回调也就是说我们不能这样做。 下面介绍两种方案： ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/baize-q/p/7729847.html\">d3根据数据绘制不同的形状</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>   绘制力导向图的时候通常节点都是圆形，但也会遇到公司节点绘制成圆型，人绘制成方形的情况，那我们怎么依据数据绘制不同的形状。</p>\n<p>   你可能首先会想到，这很简单啊，是公司的时候append circle,是人的时候append rect。但是append并没有提供回调<strong>也就是说我们不能这样做</strong>。</p>\n<div class=\"cnblogs_code\">\n<pre>node.append((data)=&gt;<span style=\"color: #000000\">{\n   </span><span style=\"color: #0000ff\">return</span> data.type === 'person'  ? 'rect' : 'circle'<span style=\"color: #000000\">;  \n});</span></pre>\n</div>\n<p>  下面介绍两种方案：</p>\n<p>　第一种，先append一个g然后根据数据设置不同的类名</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">var</span> nodeGUpdate = <span style=\"color: #0000ff\">this</span><span style=\"color: #000000\">.nodeG\n                  .selectAll(</span>'g'<span style=\"color: #000000\">)\n                  .data(</span><span style=\"color: #0000ff\">this</span>.nodesData, (data) =&gt;<span style=\"color: #000000\"> data.id);<br><br></span><span style=\"color: #0000ff\">var</span> nodeGEnter =<span style=\"color: #000000\"> nodeGUpdate.enter();\n</span><span style=\"color: #0000ff\">var</span> nodeGExit =<span style=\"color: #000000\"> nodeGUpdate.exit();\n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 更新</span>\n<span style=\"color: #000000\">nodeGUpdate<br>.transition()\n.attr(</span>'class', (data) =&gt;<span style=\"color: #000000\"> {\n 　　</span><span style=\"color: #0000ff\">return</span> (data.hide &amp;&amp; 'hide') || (data.nodeStatus &lt; 0 &amp;&amp; 'noActive') || (data.cateType === 0 &amp;&amp; 'mainCompany') || (data.cateType === 1 &amp;&amp; 'relativeCompany') || (data.cateType === 2 &amp;&amp; 'relativePerson'<span style=\"color: #000000\">);\n })\nnodeGEnter.append(</span>'g'<span style=\"color: #000000\">)<br>.attr(</span>'class', (data)=&gt;<span style=\"color: #000000\"> {\n 　　</span><span style=\"color: #0000ff\">return</span> data.cateType === 2 ? 'person' : 'company'<span style=\"color: #000000\">;\n})</span></pre>\n</div>\n<p>然后依据类名append不同形状</p>\n<p>添加矩形</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">this</span><span style=\"color: #000000\">.nodeG\n.selectAll(</span>'.person'<span style=\"color: #000000\">)\n.append(</span>'rect'<span style=\"color: #000000\">)\n.attr(</span>'class', (data) =&gt;<span style=\"color: #000000\"> {\n  </span><span style=\"color: #0000ff\">return</span> (data.hide &amp;&amp; '.hide') || (data.cateType === 0 &amp;&amp; 'mainCompany') || (data.cateType === 1 &amp;&amp; 'relativeCompany') || (data.cateType === 2 &amp;&amp; 'relativePerson'<span style=\"color: #000000\">);\n })\n.attr(</span>'width', 20<span style=\"color: #000000\">)\n.attr(</span>'height', 20<span style=\"color: #000000\">)；<br></span></pre>\n</div>\n<p>添加圆形</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">this</span><span style=\"color: #000000\">.nodeG\n.selectAll(</span>'.company'<span style=\"color: #000000\">)\n.append(</span>'circle'<span style=\"color: #000000\">)\n.attr(</span>'class', (data) =&gt;<span style=\"color: #000000\"> {\n   </span><span style=\"color: #0000ff\">return</span> (data.hide &amp;&amp; '.hide') || (data.cateType === 0 &amp;&amp; 'mainCompany') || (data.cateType === 1 &amp;&amp; 'relativeCompany') || (data.cateType === 2 &amp;&amp; 'relativePerson'<span style=\"color: #000000\">);\n })\n.attr(</span>'r', 20<span style=\"color: #000000\">)；<br></span></pre>\n</div>\n<p>最后效果</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1112174/201711/1112174-20171101162851951-620119733.png\" alt=\"\"></p>\n<p>这有点尴尬，矩形是以它自身的左上角的为基点，所以你可能还需要根据象限进行平移。</p>\n<p>上面这种思路是我从其它文章看来的,但出处忘了，但是由于还要将矩形的中心移到线的端点太麻烦，所以最终没有采用这种方法。</p>\n<p>下面来讲另外一种方法</p>\n<p>整体思路是统一append circle 但是当是人的时候填充圆形。就是可以想象append的这个circle相当于一个透明的画布，如果fill的值是颜色，那就是用这个颜色去填充这个圆。如果fill的是一个形状，就是用这个形状填充，由于背景是透明的，所以看起来好像append了其它形状上去。</p>\n<p>首先在svg中定义一个矩形，defs简单来说就是一个容器，在这个元素里面你可以定义一些元素供你重复使用，例如箭头和这里定义的矩形。</p>\n<p>这里有几个地方需要注意：</p>\n<p><strong>矩形 x,y的值</strong></p>\n<p>x,y是矩形的左上角相对于圆形的位置，设置x,y的值将矩形移至圆的中心，这样才能确保线的端点指向矩形的中心。</p>\n<p>计算公式是 x=y = r  - 矩形宽度 / 2</p>\n<p><strong>确保矩形小于圆的内切正方形</strong></p>\n<p>打个比方，如果你透过一个圆形孔看一个较小的红色正方形，你会看到一个个完整的正方形，但如果正方形过大，你可能就只能看到一个红色的圆形了。</p>\n<p>所以正方形宽度推导公式就是 width &lt; 2*r / √2</p>\n<div class=\"cnblogs_code\">\n<pre>&lt;svg width=\"1000\" height=\"1000\"&gt;\n　　&lt;defs&gt;\n   　　&lt;pattern id=\"person\" patternUnits=\"objectBoundingBox\" width=\"1\" height=\"1\"&gt;\n       　　&lt;rect x=\"10\" y=\"10\" width=\"20\" height=\"20\" fill=\"#7FBBA1\" stroke=\"#5CA083\"/&gt;\n       &lt;/pattern&gt;\n    &lt;/defs&gt;\n &lt;/svg&gt;</pre>\n</div>\n<p><strong>确保圆是透明的</strong></p>\n<p>通俗点讲就是用于填充矩形的圆的样式中不能在设置fill和stroke了</p>\n<p> 然后在绘制圆形的地方引用</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">nodeEnter\n　　.append(</span>'circle'<span style=\"color: #000000\">)\n    .attr(</span>'class', (data) =&gt;<span style=\"color: #000000\"> {\n       </span><span style=\"color: #0000ff\">return</span> (data.hide &amp;&amp; '.hide') || (data.cateType === 0 &amp;&amp; 'mainCompany') || (data.cateType === 1 &amp;&amp; 'relativeCompany') || (data.cateType === 2 &amp;&amp; 'shape-relativePerson'<span style=\"color: #000000\">);\n    })\n    .attr(</span>'r', 20<span style=\"color: #000000\">)\n    .attr(</span>'fill', (data)=&gt;<span style=\"color: #000000\">{\n        </span><span style=\"color: #0000ff\">return</span> data.cateType === 2 ? 'url(#person)' : ''<span style=\"color: #000000\">;\n     })</span></pre>\n</div>\n<p>下面是结果图</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1112174/201711/1112174-20171101175820748-636233585.png\" alt=\"\"></p>\n<p> </p>\n<p>当然你可以扩展，例如如果是人的话绘制一个人的图片</p>\n<div>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:javascript;gutter:true;\">&lt;pattern id=\"person\" patternUnits=\"objectBoundingBox\" width=\"1\" height=\"1\"&gt;\n　　&lt;image href={user} width=\"20\" height=\"20\" x=\"10\" y=\"10\"/&gt;\n&lt;/pattern&gt;</pre>\n</div>\n<p>效果如图</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1112174/201711/1112174-20171102135343404-123754419.png\" alt=\"\"></p>\n<p> </p>\n</div>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 13:59</span> <a href=\"http://www.cnblogs.com/baize-q/\">白泽Q</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7729847\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7729847);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=334742,cb_entryId=7729847,cb_blogApp=currentBlogApp,cb_blogUserGuid='3f99bd2d-a1f9-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/2 13:59:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 48, "image_url": ["https://pic.cnblogs.com/face/1112174/20170224173118.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "Linux系列教程（十）——Linux文本编辑器vim", "url": "http://www.cnblogs.com/ysocean/p/7751270.html", "author": "YSOcean", "article_desc": "通过前面几篇博客我们终于结束了Linux常用命令的介绍，Linux常用命令主要包括以下： ①、Linux文件和目录处理命令 ②、Linux链接命令和权限管理命令 ③、Linux文件搜索命令 ④、Linux帮助和用户管理命令 ⑤、Linux压缩和解压缩命令 ⑥、Linux网络和关机重启命令 学习命令， ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/ysocean/p/7751270.html\">Linux系列教程（十）——Linux文本编辑器vim</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　通过前面几篇博客我们终于结束了Linux常用命令的介绍，Linux常用命令主要包括以下：</p>\r\n<p>　　①、<a id=\"post_title_link_7712412\" href=\"http://www.cnblogs.com/ysocean/p/7712412.html\">Linux文件和目录处理命令</a></p>\r\n<p>　　②、<a id=\"post_title_link_7712425\" href=\"http://www.cnblogs.com/ysocean/p/7712425.html\">Linux链接命令和权限管理命令</a></p>\r\n<p>　　③、<a id=\"post_title_link_7712417\" href=\"http://www.cnblogs.com/ysocean/p/7712417.html\">Linux文件搜索命令</a></p>\r\n<p>　　④、<a id=\"post_title_link_7712423\" href=\"http://www.cnblogs.com/ysocean/p/7712423.html\">Linux帮助和用户管理命令</a></p>\r\n<p>　　⑤、<a id=\"post_title_link_7746786\" href=\"http://www.cnblogs.com/ysocean/p/7746786.html\">Linux压缩和解压缩命令</a></p>\r\n<p>　　⑥、<a id=\"post_title_link_7746790\" href=\"http://www.cnblogs.com/ysocean/p/7746790.html\">Linux网络和关机重启命令</a></p>\r\n<p>　　学习命令，我们不需要记住每一条命令的详细语法格式，学完之后我们只需要知道某个命令能干什么。这样我们在实际应用中，遇到需要实现某个功能，我们脑海只要能想起来适用于某个命令就行，至于详细格式我们可以通过查资料。当我们使用的多了，会不知不觉的记住这些命令，这才是正确的学习方法。Linux命令有很多，如果初学者就想全部记住这些命令的详细格式，会对我们产生很大的学习挫败性，还没记完这些命令，或许你已经丧失了学习Linux的热情了。</p>\r\n<p>　　结束了Linux常用命令的学习，接下来我们学习Linux最常用的文本编辑器命令 vim。其实最开始Linux系统的文本编辑器命令是 vi，后来出现了一个 vi 的增强版 vim，所以实际操作中我们还是使用增强版 vim。</p>\r\n<h3>1、vim 的工作模式</h3>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030080717386-896381469.png\" alt=\"\"></p>\r\n<p>　　vim 主要有三种工作模式，分别是命令模式、插入模式和编辑模式，输入 vi 文件名 我们可以进入命令模式，输入字符 i或者a或者o我们可以进入插入模式，进入插入模式之后我们可以进行文件的内容修改，修改完成之后，可以输入 :wq 可以保存退出。这段描述出现的比如字符i、a、o等下面我们会详细描述。</p>\r\n<p> </p>\r\n<h3>2、插入命令</h3>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030081300980-1992051887.png\" alt=\"\"></p>\r\n<p>　　我们在 vi 文件名之后，通常输入上面出现的字符进入编辑模式。</p>\r\n<p> 　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030204212808-1438048418.gif\" alt=\"\"></p>\r\n<h3>3、定位命令</h3>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030081444543-145239268.png\" alt=\"\"></p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030210020886-1534196621.gif\" alt=\"\"></p>\r\n<p> </p>\r\n<h3>4、删除命令</h3>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030081512168-2127109504.png\" alt=\"\"></p>\r\n<p> </p>\r\n<h3>5、复制和剪切命令 </h3>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030081538668-867530424.png\" alt=\"\"></p>\r\n<p> </p>\r\n<h3>6、替换和取消命令</h3>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030081611715-61528113.png\" alt=\"\"></p>\r\n<h3>7、搜索和搜索替换命令</h3>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030081639027-1681253386.png\" alt=\"\"></p>\r\n<h3>8、保存和退出命令</h3>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030081700105-2038180766.png\" alt=\"\"></p>\r\n<h3> 9、vim 高级操作</h3>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171030211112605-68977115.png\" alt=\"\"></p>\r\n<h3>10、总结</h3>\r\n<p>　　本篇博客我们介绍了Linux文本编辑器vim命令的使用，vim的几种工作模式切换方法，插入命令，定位命令，删除命令，复制和剪切命令，替换和搜索等，最后别忘记如何正确的保存退出等等。内容还是挺多的，但是大家不要心急，这些操作基本上我们后续使用的多了就会慢慢的记下来。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 14:01</span> <a href=\"http://www.cnblogs.com/ysocean/\">YSOcean</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7751270\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7751270);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=338076,cb_entryId=7751270,cb_blogApp=currentBlogApp,cb_blogUserGuid='126783d2-1103-e711-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/2 14:01:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 128, "image_url": ["https://pic.cnblogs.com/face/1120165/20170526223410.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "Angular5.0.0新特性", "url": "http://www.cnblogs.com/besuccess/p/Angular.html", "author": "迷惘却坚定", "article_desc": "文章来自官网部分翻译https://blog.angular.io/version-5-0-0-of-angular-now-available-37e414935ced Angular5.0.0版本已经正式发布 总结一下v5.0.0带来的新变化都有哪些。 1.构建优化 5.0版本默认采用CLI构建 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/besuccess/p/Angular.html\">Angular5.0.0新特性</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>文章来自官网部分翻译<br><code>https://blog.angular.io/version-5-0-0-of-angular-now-available-37e414935ced</code></p>\r\n<p>Angular5.0.0版本已经正式发布</p>\r\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/2/98416703141cce18cf73e3f1c8314e85?imageView2/0/w/1280/h/960/ignore-error/1\" alt=\"\"></p>\r\n<p> </p>\r\n<p><span style=\"font-size: 14pt;\">总结一下v5.0.0带来的新变化都有哪些。</span></p>\r\n<p> </p>\r\n<p><strong>1.构建优化</strong><br>　　5.0版本默认采用CLI构建和打包。构建优化器是包含在CLI里面的一个工具，通过对你的应用程序更加语义化的理解可以使得你的打包程序(bundle)更小。<br>构建优化器有两个主要工作。<br>第一，我们可以将应用程序的一部分标记为纯应用(pure)，改进了现有工具提供的摇树优化，删除了应用中其它不需要的部分。<br>第二，从你的应用程序在运行时删除装饰符代码(decorators),装饰(decorators)是由编译器使用的，而在运行时并不需要可以被删除。这些工作减少了生成的JavaScript bundles的大小，并增加了你的用户应用程序的启动速度。</p>\r\n<p><strong>2.服务端状态转换和DOM支持</strong><br>　　有了这个支持，可以让应用程序在服务器端和客户端版之间共享状态更容易。<br>Angular Universal是一个帮助开发者实现SSR的开源项目，通过在服务端渲染<br>Angular应用程序，然后在客户端引导启动程序并生成HTML，由此更好的支持那些对javascript不太友好的化境来提高应用程序性能。<br>5.0版本中，Angular开发团队添加了ServerTransferStateModule(与之对应的BrowserTransferStateModule),这个模块允许你在服务端生成模块信息并传输到客户端，不需要在客户端重复创建。这一点在通过HTTP获取数据并展示时非常有用。通过服务端状态转移，客户端不需要在发送第二个HTTP数据请求，状态转移的API文档将在未来几周内发布。<br>此处另一个改变是AngularUniversal团队添加了Domino渲染工具，Domino的加入意味着我们在服务器端上下文中将可以支持更多的DOM操作，改进了对第三方JS和组件库的支持。</p>\r\n<p><strong>3.编译器改进</strong><br>　　改进了Angular编译器来支持增量编译,重新构建变得更快，特别是对生产环境的构建和AOT编译，增强的装饰器可以通过更精细化的去除空格来减小产生的包.<br>改进后的AOT编译的性能大幅度,提升可以节省约95%的构建时间，40s可以提升至2s完成一次构建。<br>Preserve Whitespace<br>通过编译器，模板开发中的制表符、换行符、空格等可以原样的保留下来，并提供选项可以自选是否使用Preserve Whitespace来保留这些东西。</p>\r\n<p> </p>\r\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/2/cbe0a4a3d0bbb8f3710bd27789fb613a?imageView2/0/w/1280/h/960/ignore-error/1\" alt=\"\"><br>也可以在tsconfig.json设置作用到全局</p>\r\n<p> </p>\r\n<p> </p>\r\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/2/1868ed3ad039e1f11f16595c24ec5d0d?imageView2/0/w/1280/h/960/ignore-error/1\" alt=\"\"><br>注：组件级别的选项会覆盖应用程序级别的设置。</p>\r\n<p><br>增强的装饰符支持<br>装饰符降低了在使用useValue、useFactory、data对lambda表达式的要求，开发者也可以使用一个lamdba表示来代替一个已定义的命名函数,也就意味着你可以不事先在*.d.ts中声明而直接执行代码。</p>\r\n<p> </p>\r\n<p> </p>\r\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/2/45fc983921fc79d0be77e69fce2923d4?imageView2/0/w/1280/h/960/ignore-error/1\" alt=\"\"><br>去掉表达式方式</p>\r\n<p> </p>\r\n<p> </p>\r\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/2/aca0a0adc59eee8f0834fbafaf948a0c?imageView2/0/w/1280/h/960/ignore-error/1\" alt=\"\"></p>\r\n<p> </p>\r\n<p><strong>4.国际化号码、日期和货币管道</strong><br>　　Angular5中已经建立了新的号码，日期和货币管道，增加了跨浏览器的标准化实现，消除国际化在不同环境中的差异。<br>在5.0中管道可以使用我们自己的实现，可以在任何地方实现本地化的支持和配置。<br>V4 V5之间管道差异对比<br><code>https://docs.google.com/spreadsheets/d/12iygt-_cakNP1VO7MV9g4lq9NsxVWG4tSfc98HpHb0k/edit#gid=0</code></p>\r\n<p><strong>5.StaticInjector取代ReflectiveInjector依赖注入器</strong><br>　　为了更多的减少polyfills，5.0中使用了StaticInjector注入器来替换原有的ReflectiveInjector注入器，这种注入器不再里来与ReflectPolyfill，可以大幅减少应用程序体积<br>在4.x中，依赖注入器一共有两种，即Injector的抽象类子类：<br>1._NullInjector (该类的实例用于表示空的注入器)<br>2.ReflectiveInjector (表示一个依赖注入容器，用于实例化对象和解析依赖)</p>\r\n<pre><code class=\"hljs bash\" lang=\"bash\">之前提供依赖注入方式：\r\nReflectiveInjector.resolveAndCreate(providers);\r\n\r\n5.0中方式：\r\nInjector.create(providers);</code></pre>\r\n<p><strong>6.Zone执行速度的提升</strong><br>　　5.0中默认提供的zones已经优化过，速度大幅提升，并且在应用程序中绕过zonee区域更加关于应用程序的性能。<br>绕过zone引导启动应用程序的方式：</p>\r\n<pre><code class=\"hljs bash\" lang=\"bash\">platformBrowserDynamic().bootstrapModule(AppModule,{ngZone:<span class=\"hljs-string\">'noop'}).then( ref =&gt; {} );</span></code></pre>\r\n<p><strong>7.exportAs多命名支持</strong><br>　　5.0中提供了组件/指令的多命名支持，在对用户不修改代码情况下进行组件的迁移操作等非常有用，将一个组件导出多个名字，可以让组件已一个新名字来使用而达到不破坏现有代码的目的。</p>\r\n<p> </p>\r\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/2/951b9ce299c1090f6a596cedea85d2da?imageView2/0/w/1280/h/960/ignore-error/1\" alt=\"\"></p>\r\n<p> </p>\r\n<p><strong>8.HttpClient</strong><br>　　在4.3中HttpClient模块被封装在@angular/common中，新的HttpClient被封装在@angular/common/http中，更新Http模块后，需要使用HttpClientModule替换原有HttpModule，并在使用http服务时，可以去掉map(res=&gt;res.json())的调用，新模块中已经不再需要这么写了。</p>\r\n<p><strong>9.CLI v1.5</strong><br>　　Angular CLI v1.5版本中已经添加了对5.0版本的支持，后期将会把v5.0.0作为CLI的默认版本。这个版本中已经默认开启了构建优化，所以开发者可以直接感受到更小的js打包优化带来的收益。同时也更新了.tsconfig将更严格的遵循TypeScript标准，</p>\r\n<p><strong>10.Angular Forms adds updateOn Blur / Submit</strong><br>　　可以使用blur/submit来进行事件更新，而不用每个input都写一个事件了。</p>\r\n<pre><code class=\"hljs bash\" lang=\"bash\">Template Driven Forms\r\nBefore\r\n&lt;input name=<span class=\"hljs-string\">\"firstName\" ngModel&gt;\r\nAfter\r\n&lt;input name=<span class=\"hljs-string\">\"firstName\" ngModel [ngModelOptions]=<span class=\"hljs-string\">\"{updateOn: 'blur'}\"&gt;\r\nor\r\n&lt;form [ngFormOptions]=<span class=\"hljs-string\">\"{updateOn: 'submit'}\"&gt;\r\n\r\n\r\nReactive Forms\r\nBefore\r\nnew FormGroup(value);\r\nnew FormControl(value, [], [myValidator])\r\nAfter\r\nnew FormGroup(value, {updateOn: <span class=\"hljs-string\">'blur'}));\r\nnew FormControl(value, {updateOn: <span class=\"hljs-string\">'blur', asyncValidators: [myValidator]})\r\nasyncValidators可以不再是作为一个参数传递 而是直接作用到表单上了。<br><br></span></span></span></span></span></span></code></pre>\r\n<p><strong>11.RxJS 5.5</strong><br>　　支持V5.2+ 5.5在bundle上更加优化了</p>\r\n<p> </p>\r\n<p><strong>12.New Router Lifecycle Events</strong><br>　　GuardsCheckStart<br>　　ChildActivationStart<br>　　ActivationStart<br>　　GuardsCheckEnd<br>　　ResolveStart<br>　　ResolveEnd<br>　　ActivationEnd<br>　　ChildActivationEnd</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 14:03</span> <a href=\"http://www.cnblogs.com/besuccess/\">迷惘却坚定</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7771982\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7771982);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=171735,cb_entryId=7771982,cb_blogApp=currentBlogApp,cb_blogUserGuid='c1bb9ee4-4165-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/11/2 14:03:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 105, "image_url": ["https://pic.cnblogs.com/face/591729/20161221150603.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "基于Vue.js的大型报告页项目实现过程及问题总结（一）", "url": "http://www.cnblogs.com/Smiled/p/7755628.html", "author": "SmiledL", "article_desc": "今年5月份的时候做了一个测评报告项目，需要在网页正常显示的同时且可打印为pdf，当时的技术方案采用jquery+template的方式，因为是固定模板所以并没有考虑报告的模块化区分，九月底产品提出新的需求，由于报告页数动辄上千页，所以希望用户自行选择内容生成报告，这个时候原项目就不够灵活了，与小伙伴 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/Smiled/p/7755628.html\">基于Vue.js的大型报告页项目实现过程及问题总结（一）</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>今年5月份的时候做了一个测评报告项目，需要在网页正常显示的同时且可打印为pdf，当时的技术方案采用jquery+template的方式，因为是固定模板所以并没有考虑报告的模块化区分，九月底产品提出新的需求，由于报告页数动辄上千页，所以希望用户自行选择内容生成报告，这个时候原项目就不够灵活了，与小伙伴商量决定将这个项目使用vue进行重构，对报告模块进行细分封装组件复用，大概一个月的工期，中途遇到n多坑，趁着今天有时间将实现思路整理出来并将出现的问题总结一下</p>\n<p>整体的实现思维导图如下：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1055667/201710/1055667-20171030174242965-1313817532.png\" alt=\"\"></p>\n<p><span style=\"font-size: 16px\">需要考虑的：</span></p>\n<p><span style=\"font-size: 16px\">1.可生成PDF版且可打印</span></p>\n<p><span style=\"font-size: 16px\">2.根据后台获取的json生成包含相应模块的报告</span></p>\n<p><span style=\"font-size: 16px\">3.组件内基于echarts封装图表的引用</span></p>\n<p><span style=\"font-size: 16px\">4.目录模块的页码定位</span></p>\n<p><span style=\"font-size: 16px\">5.如何进行模块内的细分（如1.2.1.3）；</span></p>\n<p><span style=\"font-size: 16px\">6.webpack对多页面编译的配置</span></p>\n<p> </p>\n<p><span style=\"font-size: 18.6667px\"><span style=\"font-size: 16px\"><span style=\"color: #008000\">Ps</span>：转PDF插件使用的是<strong><span style=\"color: #ff0000\">OpenHtmlToPdf</span></strong>具体配置方法可自行百度，在这里不过多赘述。</span></span></p>\n<p><span style=\"font-size: 16px\">关于pdf的一点小坑（<span style=\"color: #ff0000\">知识点朋友们！</span>）：</span></p>\n<p><span style=\"font-size: 16px\">网页打印A4纸的尺寸是（<span style=\"color: #ff0000\"><strong>1123*793</strong></span>），在使用<span style=\"color: #ff0000\">OpenHtmlToPdf<span style=\"color: #000000\">时无法使用css3百分之八十的属性，像translate等，还有就是margin-top不会生效，使用padding-top代替吧，打印生无法请求ajax，如需打印请将数据先存储到本地再行打印，可根据不同浏览方式判断两种方案。</span><span style=\"color: #000000\"><br></span></span></span></p>\n<p><span style=\"font-size: 16px\">以下实现全部是基于Vue-cli快速构建的项目中实现的，vue-cli的安装网上有很多详细的教程不过多说了</span></p>\n<p><span style=\"font-size: 16px\">1.新建项目，命令行执行代码：</span></p>\n<div class=\"cnblogs_code\">\n<pre>vue init webpack vuetest</pre>\n</div>\n<div>\n<p>命令输入后，会进入安装阶段，需要用户输入一些信息</p>\n<p>Project name (vuetest)                    项目名称，可以自己指定，也可直接回车，按照括号中默认名字（注意这里的名字不能有大写字母，如果有会报错Sorry, name can no longer contain capital letters），阮一峰老师博客<a href=\"http://www.ruanyifeng.com/blog/2017/02/filename-should-be-lowercase.html\" target=\"_blank\">为什么文件名要小写</a> ，可以参考一下。</p>\n<p>Project description (A Vue.js project)  项目描述，也可直接点击回车，使用默认名字</p>\n<p>Author (........)       作者，不用说了，你想输什么就输什么吧</p>\n<p>接下来会让用户选择</p>\n<p>Runtime + Compiler: recommended for most users    运行加编译，既然已经说了推荐，就选它了</p>\n<p>Runtime-only: about 6KB lighter min+gzip, but templates (or any Vue-specificHTML) are ONLY allowed in .vue files - render functions are required elsewhere   仅运行时，已经有推荐了就选择第一个了</p>\n<p>Install vue-router? (Y/n)    是否安装vue-router，这是官方的路由，大多数情况下都使用，<a href=\"http://router.vuejs.org/zh-cn/\" target=\"_blank\">vue-router官网</a> 。这里就输入“y”后回车即可。</p>\n<p>Use ESLint to lint your code? (Y/n)      是否使用ESLint管理代码，ESLint是个代码风格管理工具，是用来统一代码风格的，并不会影响整体的运行，这也是为了多人协作，新手就不用了，一般项目中都会使用。<a href=\"http://eslint.org/\" target=\"_blank\">ESLint官网</a></p>\n<p>接下来也是选择题Pick an ESLint preset (Use arrow keys)            选择一个ESLint预设，编写vue项目时的代码风格，因为我选择了使用ESLint</p>\n<p>Standard (https://github.com/feross/standard)    标准，有些看不明白，什么标准呢，去给提示的<a href=\"https://github.com/feross/standard\" target=\"_blank\">standard</a>github地址看一下， 原来时js的标准风格</p>\n<p>AirBNB (https://github.com/airbnb/javascript)    JavaScript最合理的方法，这个github地址说的是JavaScript最合理的方法</p>\n<p>none (configure it yourself)    这个不用说，自己定义风格</p>\n<p>具体选择哪个因人而异吧  ，我选择标准风格</p>\n<p>Setup unit tests with Karma + Mocha? (Y/n)  是否安装单元测试，我选择安装</p>\n<p>Setup e2e tests with Nightwatch(Y/n)?     是否安装e2e测试 ，我选择安装</p>\n<p>完成</p>\n</div>\n<p> 初始的目录结构大概是这样的</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1055667/201711/1055667-20171102134155841-497989146.png\" alt=\"\"></p>\n<p>由于是多页面应用所以需要在src下建一个modle文件夹里面是两个不同的项目</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1055667/201711/1055667-20171102140743201-73947929.png\" alt=\"\"></p>\n<p> </p>\n<p><span style=\"color: #ff0000\">注意：</span></p>\n<p> 这里的index.html是入口文件，一定不能少，这这里做中转默认进入demo1的页面</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">body</span><span style=\"color: #0000ff\">&gt;</span>\n    <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">script</span><span style=\"color: #0000ff\">&gt;</span><span style=\"background-color: #f5f5f5; color: #000000\">\n        location.href </span><span style=\"background-color: #f5f5f5; color: #000000\">=</span> <span style=\"background-color: #f5f5f5; color: #000000\">\"</span><span style=\"background-color: #f5f5f5; color: #000000\">module/demo1.html</span><span style=\"background-color: #f5f5f5; color: #000000\">\"</span><span style=\"background-color: #f5f5f5; color: #000000\">;\n    </span><span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">script</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">body</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p>下面对多页面进行配置，主要操作config和build这两个文件夹</p>\n<div class=\"cnblogs_code\">\n<pre></pre>\n<pre class=\"hljs stylus\"><code>/build\n    build<span class=\"hljs-selector-class\">.js               #构建生产代码\n    dev-client<span class=\"hljs-selector-class\">.js \n    dev-server<span class=\"hljs-selector-class\">.js          #执行本地服务器\n    utils<span class=\"hljs-selector-class\">.js               #额外的通用方法\n    webpack<span class=\"hljs-selector-class\">.base<span class=\"hljs-selector-class\">.conf<span class=\"hljs-selector-class\">.js   #默认的webpack配置\n    webpack<span class=\"hljs-selector-class\">.dev<span class=\"hljs-selector-class\">.conf<span class=\"hljs-selector-class\">.js    #本地开发的webpack配置\n    webpack<span class=\"hljs-selector-class\">.prod<span class=\"hljs-selector-class\">.conf<span class=\"hljs-selector-class\">.js   #构建生产的webpack配置\n/config   配置文件\n    dev<span class=\"hljs-selector-class\">.env<span class=\"hljs-selector-class\">.js\n    index<span class=\"hljs-selector-class\">.js\n    pord<span class=\"hljs-selector-class\">.env<span class=\"hljs-selector-class\">.js\n    test<span class=\"hljs-selector-class\">.env<span class=\"hljs-selector-class\">.js\n/src\n    assets                  #放资源\n    components              #组件\n    /module                 #页面模块\n        /home               #子页面\n            index<span class=\"hljs-selector-class\">.html      #模版页面\n            index<span class=\"hljs-selector-class\">.js        #js入口\n        <span class=\"hljs-comment\">// 注意，这里的html和js的文件名要一致，如上面就是index    \n/dist                       #最后打包生成的资源\n    /js                \n    /css\n    /home</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>\n<pre><span style=\"color: #008000\"> </span></pre>\n</div>\n<h2 id=\"articleHeader1\">修改默认的webpack配置webpack.base.conf.js</h2>\n<div class=\"cnblogs_code\">\n<pre>生成需要的入口文件</pre>\n</div>\n<div class=\"cnblogs_code\">\n<p>var path = require('path')<br>var config = require('../config')<br>var utils = require('./utils')<br>var projectRoot = path.resolve(__dirname, '../')<br>var glob = require('glob');<br>var entries = getEntry(['./src/demo1/index/*.js', './src/module/demo2/*.js']); // 获得入口js文件</p>\n<p>var env = process.env.NODE_ENV<br>// check env &amp; config/index.js to decide weither to enable CSS Sourcemaps for the<br>// various preprocessor loaders added to vue-loader at the end of this file<br>var cssSourceMapDev = (env === 'development' &amp;&amp; config.dev.cssSourceMap)<br>var cssSourceMapProd = (env === 'production' &amp;&amp; config.build.productionSourceMap)<br>var useCssSourceMap = cssSourceMapDev || cssSourceMapProd</p>\n<p>module.exports = {<br>  entry: entries,<br>  output: {<br>    path: config.build.assetsRoot,<br>    publicPath: process.env.NODE_ENV === 'production' ? config.build.assetsPublicPath : config.dev.assetsPublicPath,<br>    filename: '[name].js'<br>  },<br>  resolve: {<br>    extensions: ['', '.js', '.vue','.json'],<br>    <br>    fallback: [path.join(__dirname, '../node_modules')],<br>    alias: {<br>      'vue$': 'vue/dist/vue',<br>      'src': path.resolve(__dirname, '../src'),<br>      'common': path.resolve(__dirname, '../src/common'),<br>      'components': path.resolve(__dirname, '../src/components')<br>    }<br>  },<br>  resolveLoader: {<br>    fallback: [path.join(__dirname, '../node_modules')]<br>  },<br>  module: {<br>    loaders: [{<br>        test: /\\.vue$/,<br>        loader: 'vue'<br>      },<br>      {<br>        test: /\\.js$/,<br>        loader: 'babel',<br>        include: projectRoot,<br>        exclude: /node_modules/<br>      },<br>      {<br>        test: /\\.json$/,<br>        loader: 'json'<br>      },<br>      {<br>        test: /\\.(png|jpe?g|gif|svg)(\\?.*)?$/,<br>        loader: 'url',<br>        query: {<br>          limit: 10000,<br>          name: utils.assetsPath('img/[name].[hash:7].[ext]')<br>        }<br>      },<br>      {<br>        test: /\\.(woff2?|eot|ttf|otf)(\\?.*)?$/,<br>        loader: 'url',<br>        query: {<br>          limit: 10000,<br>          name: utils.assetsPath('fonts/[name].[hash:7].[ext]')<br>        }<br>      }<br>    ]<br>  },<br>  vue: {<br>    loaders: utils.cssLoaders({<br>      sourceMap: useCssSourceMap<br>    }),<br>    postcss: [<br>      require('autoprefixer')({<br>        browsers: ['last 2 versions']<br>      })<br>    ]<br>  }<br>}</p>\n<p>function getEntry(globPath) {<br>  var entries = {},<br>    basename, tmp, pathname;<br>  if (typeof (globPath) != \"object\") {<br>    globPath = [globPath]<br>  }<br>  globPath.forEach((itemPath) =&gt; {<br>    glob.sync(itemPath).forEach(function (entry) {<br>      basename = path.basename(entry, path.extname(entry));<br>      if (entry.split('/').length &gt; 4) {<br>        tmp = entry.split('/').splice(-3);<br>        pathname = tmp.splice(0, 1) + '/' + basename; // 正确输出js和html的路径<br>        entries[pathname] = entry;<br>      } else {<br>        entries[basename] = entry;<br>      }<br>    });<br>  });<br>  return entries;<br>}</p>\n\n</div>\n<h2>修改本地开发的webpack配置webpack.dev.conf.js</h2>\n<div class=\"cnblogs_code\">\n<pre>这里是和本地服务器有关的配置</pre>\n</div>\n<p>这里是根据目录生成对应的页面</p>\n<div class=\"cnblogs_code\">\n<p>var path = require('path');<br>var config = require('../config')<br>var webpack = require('webpack')<br>var merge = require('webpack-merge')<br>var utils = require('./utils')<br>var baseWebpackConfig = require('./webpack.base.conf')<br>var HtmlWebpackPlugin = require('html-webpack-plugin')<br>var glob = require('glob')<br>// add hot-reload related code to entry chunks<br>Object.keys(baseWebpackConfig.entry).forEach(function (name) {<br>  baseWebpackConfig.entry[name] = ['./build/dev-client'].concat(baseWebpackConfig.entry[name])<br>})<br>module.exports = merge(baseWebpackConfig, {<br>  module: {<br>    loaders: utils.styleLoaders({ sourceMap: config.dev.cssSourceMap })<br>  },<br>  // eval-source-map is faster for development<br>  devtool: '#eval-source-map',<br>  plugins: [<br>    new webpack.DefinePlugin({<br>      'process.env': config.dev.env<br>    }),<br>    // https://github.com/glenjamin/webpack-hot-middleware#installation--usage<br>    new webpack.optimize.OccurenceOrderPlugin(),<br>    new webpack.HotModuleReplacementPlugin(),<br>    new webpack.NoErrorsPlugin()<br>  ]<br>})</p>\n<p>function getEntry(globPath) {<br>  var entries = {},<br>    basename, tmp, pathname;<br>  if (typeof (globPath) != \"object\") {<br>    globPath = [globPath]<br>  }<br>  globPath.forEach((itemPath) =&gt; {<br>    glob.sync(itemPath).forEach(function (entry) {<br>      basename = path.basename(entry, path.extname(entry));<br>      if (entry.split('/').length &gt; 4) {<br>        tmp = entry.split('/').splice(-3);<br>        pathname = tmp.splice(0, 1) + '/' + basename; // 正确输出js和html的路径<br>        entries[pathname] = entry;<br>      } else {<br>        entries[basename] = entry;<br>      }<br>    });<br>  });<br>  return entries;<br>}</p>\n<p>var pages = getEntry(['./src/module/*.html','./src/module/**/*.html']);</p>\n<p>for (var pathname in pages) {<br>  // 配置生成的html文件，定义路径等<br>  var conf = {<br>    filename: pathname + '.html',<br>    template: pages[pathname],   // 模板路径<br>    inject: true,              // js插入位置<br>    // necessary to consistently work with multiple chunks via CommonsChunkPlugin<br>    chunksSortMode: 'dependency'</p>\n<p>  };</p>\n<p>  if (pathname in module.exports.entry) {<br>    conf.chunks = ['manifest', 'vendor', pathname];<br>    conf.hash = true;<br>  }</p>\n<p>  module.exports.plugins.push(new HtmlWebpackPlugin(conf));<br>}</p>\n\n</div>\n<h2 id=\"articleHeader3\">修改构建生产的webpack配置webpack.prod.conf.js</h2>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">var</span> path = require('path'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> config = require('../config'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> utils = require('./utils'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> webpack = require('webpack'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> merge = require('webpack-merge'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> baseWebpackConfig = require('./webpack.base.conf'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> ExtractTextPlugin = require('extract-text-webpack-plugin'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> HtmlWebpackPlugin = require('html-webpack-plugin'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> CleanPlugin = require('clean-webpack-plugin')<span style=\"color: #008000\">//</span><span style=\"color: #008000\">webpack插件，用于清除目录文件</span>\n<span style=\"color: #0000ff\">var</span> glob = require('glob'<span style=\"color: #000000\">);\n</span><span style=\"color: #0000ff\">var</span> env =<span style=\"color: #000000\"> config.build.env\n\n</span><span style=\"color: #0000ff\">var</span> webpackConfig =<span style=\"color: #000000\"> merge(baseWebpackConfig, {\n  module: {\n    loaders: utils.styleLoaders({ sourceMap: config.build.productionSourceMap, extract: </span><span style=\"color: #0000ff\">true</span><span style=\"color: #000000\"> })\n  },\n  devtool: config.build.productionSourceMap </span>? '#source-map' : <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">,\n  output: {\n    path: config.build.assetsRoot,\n    filename: utils.assetsPath(</span>'js/[name].[chunkhash].js'<span style=\"color: #000000\">),\n    chunkFilename: utils.assetsPath(</span>'js/[id].[chunkhash].js'<span style=\"color: #000000\">)\n  },\n  vue: {\n    loaders: utils.cssLoaders({\n      sourceMap: config.build.productionSourceMap,\n      extract: </span><span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">\n    })\n  },\n  plugins: [\n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> http://vuejs.github.io/vue-loader/workflow/production.html</span>\n    <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> webpack.DefinePlugin({\n      </span>'process.env'<span style=\"color: #000000\">: env\n    }),\n    </span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> webpack.optimize.UglifyJsPlugin({\n      compress: {\n        warnings: </span><span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">\n      }\n    }),\n    </span><span style=\"color: #0000ff\">new</span> CleanPlugin(['../dist']), <span style=\"color: #008000\">//</span><span style=\"color: #008000\">清空生成目录</span>\n    <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> webpack.optimize.OccurenceOrderPlugin(),\n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> extract css into its own file</span>\n    <span style=\"color: #0000ff\">new</span> ExtractTextPlugin(utils.assetsPath('css/[name].[contenthash].css'<span style=\"color: #000000\">)),\n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> generate dist index.html with correct asset hash for caching.</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> you can customize output by editing /index.html</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> see https://github.com/ampedandwired/html-webpack-plugin</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> split vendor js into its own file</span>\n    <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> webpack.optimize.CommonsChunkPlugin({\n      name: </span>'vendor'<span style=\"color: #000000\">,\n      minChunks: </span><span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> (module, count) {\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> any required modules inside node_modules are extracted to vendor</span>\n        <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> (\n          module.resource </span>&amp;&amp;\n          /\\.js$/.test(module.resource) &amp;&amp;<span style=\"color: #000000\">\n          module.resource.indexOf(\n            path.join(__dirname, </span>'../node_modules'<span style=\"color: #000000\">)\n          ) </span>=== 0<span style=\"color: #000000\">\n        )\n      }\n    }),\n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> extract webpack runtime and module manifest to its own file in order to</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> prevent vendor hash from being updated whenever app bundle is updated</span>\n    <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> webpack.optimize.CommonsChunkPlugin({\n      name: </span>'manifest'<span style=\"color: #000000\">,\n      chunks: [</span>'vendor'<span style=\"color: #000000\">]\n    })\n  ]\n})\n\n</span><span style=\"color: #0000ff\">if</span><span style=\"color: #000000\"> (config.build.productionGzip) {\n  </span><span style=\"color: #0000ff\">var</span> CompressionWebpackPlugin = require('compression-webpack-plugin'<span style=\"color: #000000\">)\n\n  webpackConfig.plugins.push(\n    </span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> CompressionWebpackPlugin({\n      asset: </span>'[path].gz[query]'<span style=\"color: #000000\">,\n      algorithm: </span>'gzip'<span style=\"color: #000000\">,\n      test: </span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> RegExp(\n        </span>'\\\\.(' +<span style=\"color: #000000\">\n        config.build.productionGzipExtensions.join(</span>'|') +\n        ')$'<span style=\"color: #000000\">\n      ),\n      threshold: </span>10240<span style=\"color: #000000\">,\n      minRatio: </span>0.8<span style=\"color: #000000\">\n    })\n  )\n}\n\nmodule.exports </span>=<span style=\"color: #000000\"> webpackConfig\n\n</span><span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> getEntry(globPath) {\n  </span><span style=\"color: #0000ff\">var</span> entries =<span style=\"color: #000000\"> {},\n    basename, tmp, pathname;\n  </span><span style=\"color: #0000ff\">if</span> (<span style=\"color: #0000ff\">typeof</span> (globPath) != \"object\"<span style=\"color: #000000\">) {\n    globPath </span>=<span style=\"color: #000000\"> [globPath]\n  }\n  globPath.forEach((itemPath) </span>=&gt;<span style=\"color: #000000\"> {\n    glob.sync(itemPath).forEach(</span><span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> (entry) {\n      basename </span>=<span style=\"color: #000000\"> path.basename(entry, path.extname(entry));\n      </span><span style=\"color: #0000ff\">if</span> (entry.split('/').length &gt; 4<span style=\"color: #000000\">) {\n        tmp </span>= entry.split('/').splice(-3<span style=\"color: #000000\">);\n        pathname </span>= tmp.splice(0, 1) + '/' + basename; <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 正确输出js和html的路径</span>\n        entries[pathname] =<span style=\"color: #000000\"> entry;\n      } </span><span style=\"color: #0000ff\">else</span><span style=\"color: #000000\"> {\n        entries[basename] </span>=<span style=\"color: #000000\"> entry;\n      }\n    });\n  });\n  </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> entries;\n}\n\n</span><span style=\"color: #0000ff\">var</span> pages = getEntry(['./src/module/*.html','./src/module/**/*.html'<span style=\"color: #000000\">]);\n\n</span><span style=\"color: #0000ff\">for</span> (<span style=\"color: #0000ff\">var</span> pathname <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> pages) {\n  </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 配置生成的html文件，定义路径等</span>\n  <span style=\"color: #0000ff\">var</span> conf =<span style=\"color: #000000\"> {\n    filename: pathname </span>+ '.html'<span style=\"color: #000000\">,\n    template: pages[pathname],   </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 模板路径</span>\n    inject: <span style=\"color: #0000ff\">true</span>,              <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> js插入位置</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> necessary to consistently work with multiple chunks via CommonsChunkPlugin</span>\n    chunksSortMode: 'dependency'<span style=\"color: #000000\">\n  };\n\n  </span><span style=\"color: #0000ff\">if</span> (pathname <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> module.exports.entry) {\n    conf.chunks </span>= ['manifest', 'vendor'<span style=\"color: #000000\">, pathname];\n    conf.hash </span>= <span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">;\n  }\n\n  module.exports.plugins.push(</span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> HtmlWebpackPlugin(conf));\n}</span></pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">var</span> path = require('path'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> config = require('../config'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> utils = require('./utils'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> webpack = require('webpack'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> merge = require('webpack-merge'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> baseWebpackConfig = require('./webpack.base.conf'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> ExtractTextPlugin = require('extract-text-webpack-plugin'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> HtmlWebpackPlugin = require('html-webpack-plugin'<span style=\"color: #000000\">)\n</span><span style=\"color: #0000ff\">var</span> CleanPlugin = require('clean-webpack-plugin')<span style=\"color: #008000\">//</span><span style=\"color: #008000\">webpack插件，用于清除目录文件</span>\n<span style=\"color: #0000ff\">var</span> glob = require('glob'<span style=\"color: #000000\">);\n</span><span style=\"color: #0000ff\">var</span> env =<span style=\"color: #000000\"> config.build.env\n\n</span><span style=\"color: #0000ff\">var</span> webpackConfig =<span style=\"color: #000000\"> merge(baseWebpackConfig, {\n  module: {\n    loaders: utils.styleLoaders({ sourceMap: config.build.productionSourceMap, extract: </span><span style=\"color: #0000ff\">true</span><span style=\"color: #000000\"> })\n  },\n  devtool: config.build.productionSourceMap </span>? '#source-map' : <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">,\n  output: {\n    path: config.build.assetsRoot,\n    filename: utils.assetsPath(</span>'js/[name].[chunkhash].js'<span style=\"color: #000000\">),\n    chunkFilename: utils.assetsPath(</span>'js/[id].[chunkhash].js'<span style=\"color: #000000\">)\n  },\n  vue: {\n    loaders: utils.cssLoaders({\n      sourceMap: config.build.productionSourceMap,\n      extract: </span><span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">\n    })\n  },\n  plugins: [\n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> http://vuejs.github.io/vue-loader/workflow/production.html</span>\n    <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> webpack.DefinePlugin({\n      </span>'process.env'<span style=\"color: #000000\">: env\n    }),\n    </span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> webpack.optimize.UglifyJsPlugin({\n      compress: {\n        warnings: </span><span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">\n      }\n    }),\n    </span><span style=\"color: #0000ff\">new</span> CleanPlugin(['../dist']), <span style=\"color: #008000\">//</span><span style=\"color: #008000\">清空生成目录</span>\n    <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> webpack.optimize.OccurenceOrderPlugin(),\n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> extract css into its own file</span>\n    <span style=\"color: #0000ff\">new</span> ExtractTextPlugin(utils.assetsPath('css/[name].[contenthash].css'<span style=\"color: #000000\">)),\n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> generate dist index.html with correct asset hash for caching.</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> you can customize output by editing /index.html</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> see https://github.com/ampedandwired/html-webpack-plugin</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> split vendor js into its own file</span>\n    <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> webpack.optimize.CommonsChunkPlugin({\n      name: </span>'vendor'<span style=\"color: #000000\">,\n      minChunks: </span><span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> (module, count) {\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> any required modules inside node_modules are extracted to vendor</span>\n        <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> (\n          module.resource </span>&amp;&amp;\n          /\\.js$/.test(module.resource) &amp;&amp;<span style=\"color: #000000\">\n          module.resource.indexOf(\n            path.join(__dirname, </span>'../node_modules'<span style=\"color: #000000\">)\n          ) </span>=== 0<span style=\"color: #000000\">\n        )\n      }\n    }),\n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> extract webpack runtime and module manifest to its own file in order to</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> prevent vendor hash from being updated whenever app bundle is updated</span>\n    <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> webpack.optimize.CommonsChunkPlugin({\n      name: </span>'manifest'<span style=\"color: #000000\">,\n      chunks: [</span>'vendor'<span style=\"color: #000000\">]\n    })\n  ]\n})\n\n</span><span style=\"color: #0000ff\">if</span><span style=\"color: #000000\"> (config.build.productionGzip) {\n  </span><span style=\"color: #0000ff\">var</span> CompressionWebpackPlugin = require('compression-webpack-plugin'<span style=\"color: #000000\">)\n\n  webpackConfig.plugins.push(\n    </span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> CompressionWebpackPlugin({\n      asset: </span>'[path].gz[query]'<span style=\"color: #000000\">,\n      algorithm: </span>'gzip'<span style=\"color: #000000\">,\n      test: </span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> RegExp(\n        </span>'\\\\.(' +<span style=\"color: #000000\">\n        config.build.productionGzipExtensions.join(</span>'|') +\n        ')$'<span style=\"color: #000000\">\n      ),\n      threshold: </span>10240<span style=\"color: #000000\">,\n      minRatio: </span>0.8<span style=\"color: #000000\">\n    })\n  )\n}\n\nmodule.exports </span>=<span style=\"color: #000000\"> webpackConfig\n\n</span><span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> getEntry(globPath) {\n  </span><span style=\"color: #0000ff\">var</span> entries =<span style=\"color: #000000\"> {},\n    basename, tmp, pathname;\n  </span><span style=\"color: #0000ff\">if</span> (<span style=\"color: #0000ff\">typeof</span> (globPath) != \"object\"<span style=\"color: #000000\">) {\n    globPath </span>=<span style=\"color: #000000\"> [globPath]\n  }\n  globPath.forEach((itemPath) </span>=&gt;<span style=\"color: #000000\"> {\n    glob.sync(itemPath).forEach(</span><span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> (entry) {\n      basename </span>=<span style=\"color: #000000\"> path.basename(entry, path.extname(entry));\n      </span><span style=\"color: #0000ff\">if</span> (entry.split('/').length &gt; 4<span style=\"color: #000000\">) {\n        tmp </span>= entry.split('/').splice(-3<span style=\"color: #000000\">);\n        pathname </span>= tmp.splice(0, 1) + '/' + basename; <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 正确输出js和html的路径</span>\n        entries[pathname] =<span style=\"color: #000000\"> entry;\n      } </span><span style=\"color: #0000ff\">else</span><span style=\"color: #000000\"> {\n        entries[basename] </span>=<span style=\"color: #000000\"> entry;\n      }\n    });\n  });\n  </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> entries;\n}\n\n</span><span style=\"color: #0000ff\">var</span> pages = getEntry(['./src/module/*.html','./src/module/**/*.html'<span style=\"color: #000000\">]);\n\n</span><span style=\"color: #0000ff\">for</span> (<span style=\"color: #0000ff\">var</span> pathname <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> pages) {\n  </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 配置生成的html文件，定义路径等</span>\n  <span style=\"color: #0000ff\">var</span> conf =<span style=\"color: #000000\"> {\n    filename: pathname </span>+ '.html'<span style=\"color: #000000\">,\n    template: pages[pathname],   </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 模板路径</span>\n    inject: <span style=\"color: #0000ff\">true</span>,              <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> js插入位置</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> necessary to consistently work with multiple chunks via CommonsChunkPlugin</span>\n    chunksSortMode: 'dependency'<span style=\"color: #000000\">\n  };\n\n  </span><span style=\"color: #0000ff\">if</span> (pathname <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> module.exports.entry) {\n    conf.chunks </span>= ['manifest', 'vendor'<span style=\"color: #000000\">, pathname];\n    conf.hash </span>= <span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">;\n  }\n\n  module.exports.plugins.push(</span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> HtmlWebpackPlugin(conf));\n}</span></pre>\n</div>\n<h2 id=\"articleHeader4\">修改配置文件config</h2>\n<div class=\"cnblogs_code\">\n<pre>修改index.js</pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">在build.js中会引用assetsRoot，这里就是对应的根目录，改成你想要输出的地址就好了。ps：这里是相对地址\nassetsPublicPath会被引用插入到页面的模版中，这个是你资源的根目录</span></pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> see http://vuejs-templates.github.io/webpack for documentation.</span>\n<span style=\"color: #0000ff\">var</span> path = require('path'<span style=\"color: #000000\">)\n\nmodule.exports </span>=<span style=\"color: #000000\"> {\n  build: {\n    env: require(</span>'./prod.env'<span style=\"color: #000000\">),\n    index: path.resolve(__dirname, </span>'../dist/index.html'<span style=\"color: #000000\">),\n    assetsRoot: path.resolve(__dirname, </span>'../dist'<span style=\"color: #000000\">),\n    assetsSubDirectory: </span>'static'<span style=\"color: #000000\">,\n    assetsPublicPath: </span>'../'<span style=\"color: #000000\">,\n    productionSourceMap: </span><span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> Gzip off by default as many popular static hosts such as</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> Surge or Netlify already gzip all static assets for you.</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> Before setting to `true`, make sure to:</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> npm install --save-dev compression-webpack-plugin</span>\n    productionGzip: <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">,\n    productionGzipExtensions: [</span>'js', 'css'<span style=\"color: #000000\">]\n  },\n  dev: {\n    env: require(</span>'./dev.env'<span style=\"color: #000000\">),\n    port: </span>8080<span style=\"color: #000000\">,\n    assetsSubDirectory: </span>'static'<span style=\"color: #000000\">,\n    assetsPublicPath: </span>'/'<span style=\"color: #000000\">,\n    proxyTable: {},\n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> CSS Sourcemaps off by default because relative paths are \"buggy\"</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> with this option, according to the CSS-Loader README</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> (https://github.com/webpack/css-loader#sourcemaps)</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> In our experience, they generally work as expected,</span>\n    <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> just be aware of this issue when enabling this option.</span>\n    cssSourceMap: <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">\n  }\n}</span></pre>\n</div>\n<p>ok，配置结束，一个基本的多页面应用已经成功建成</p>\n<p>接下来就进入正题了，放在下一篇来写。。。。。。。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 14:19</span> <a href=\"http://www.cnblogs.com/Smiled/\">SmiledL</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7755628\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7755628);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=314936,cb_entryId=7755628,cb_blogApp=currentBlogApp,cb_blogUserGuid='15861613-e2a0-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/2 14:19:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 219, "image_url": ["https://pic.cnblogs.com/face/1055667/20161102213239.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "DOM详解", "url": "http://www.cnblogs.com/fzz9/p/7772149.html", "author": "风之之", "article_desc": "\r\n    一、简介 DOM即（Document Object Model）：文档对象模型，用来将标记型文档封装成对象，并将标记型文档中的所有内容（标签、文本、属性等）都封装成对象。即标记型文档的一种解析方式。因为封装为对象就可以对其中的属性和行为进行调用，以便于对这些文档及文档中的内容进行更方便的操作。 DO ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/fzz9/p/7772149.html\">DOM详解</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h2>一、简介</h2>\n<p><span style=\"font-size: 16px\">DOM即（Document Object Model）：文档对象模型，<span style=\"color: #ff0000\">用来将标记型文档封装成对象</span>，并将标记型文档中的所有内容（标签、文本、属性等）都封装成对象。即标记型文档的一种解析方式。</span><span style=\"font-size: 16px\">因为封装为对象就可以对其中的属性和行为进行调用，以便于对这些文档及文档中的内容进行更方便的操作。</span></p>\n<p><span style=\"font-size: 16px\">DOM解析方式：将标记型文档解析为一颗dom树，而树中的内容都封装为节点对象。</span><br><span style=\"font-size: 16px\">按照标签的层次关系体现出标签的所属，形成一个树状结构。所以我们将DOM解析文档形成的document对象称为dom树，而树中的标签以及文本甚至属性称为节点。这个节点也称为对象。标签通常也称为页面中的元素。</span><br><span style=\"font-size: 16px\">注意：这个DOM解析的好处是可以对树中的节点进行任意操作，如增删查改。但也有弊端：这种解析需要将标记型文档加载进内存。意味着如果文档体积很大时较为浪费空间。</span></p>\n<h2>二、另一种解析方式：SAX</h2>\n<p><span style=\"font-size: 16px\">是由一些组织定义的一种民间常用的解析方式，并不是w3c标准，而DOM是w3c的标准。</span><br><span style=\"font-size: 16px\">SAX的解析方式：基于事件驱动的解析。好处：获取数据的速度快。弊端：不遵从增删查改操作。</span></p>\n<h2>三、DOM三种模型</h2>\n<p><span style=\"font-size: 16px\">DOM level 1：将html文档封装成对象。</span><br><span style=\"font-size: 16px\">DOM level 2：在level1的基础上加入了新功能，比如解析名称空间。</span><br><span style=\"font-size: 16px\">DOM level 3：将xml文档封装成了对象。</span></p>\n<h2>四、DHTML:动态html</h2>\n<p><span style=\"font-size: 16px\">不是一门语言，而是多项技术综合体的简称，这些技术包括HTML、CSS、DOM、JavaScript。</span><br><span style=\"font-size: 16px\">四种技术(语言)在动态html中扮演的角色：</span><br><span style=\"font-size: 16px\">HTML:用标签封装数据。即负责提供标签，对数据进行封装，目的是便于对该标签中的数据进行操作。</span><br><span style=\"font-size: 16px\">CSS：对数据样式进行定义。即负责提供样式属性，对标签中的数据进行样式的定义。</span><br><span style=\"font-size: 16px\">DOM：将文档和标签等所有内容进行解析。即负责将标记型文档及文档中的内容进行解析。并封装成对象，在对象中定义了更多的属性和行为，便于对对象进行操作。</span><br><span style=\"font-size: 16px\">JS:对页面行为进行定义（页面动态效果）。即负责提供程序设计语言，对页面中的对象进行逻辑操作。</span><br><span style=\"font-size: 16px\">所以JavaScript是DHTML的主力编程语言。</span></p>\n<h2>五、BOM：Browser Object Model（浏览器对象模型）</h2>\n<p><span style=\"font-size: 16px\">这个模型方便于操作浏览器。浏览器对应的对象就是Window对象。</span></p>\n<h2>六、获取节点对象</h2>\n<p><span style=\"font-size: 16px\">DOM将标记型文档封装为了document对象，而文档中的内容封装成了节点对象。常见的节点对象有：标签、属性、文本。</span><br><span style=\"font-size: 16px\">获取节点对象的方法：</span><br><span style=\"font-size: 16px\"><span style=\"color: #ff0000\">方式一：</span>通过id获取：getElementByID();</span></p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_444b8ef0-b570-4cdc-95ba-134c5c1d87bb\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_444b8ef0-b570-4cdc-95ba-134c5c1d87bb\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_444b8ef0-b570-4cdc-95ba-134c5c1d87bb\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #008080\"> 1</span> &lt;script type=\"text/javascript\"&gt;\n<span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> changeDiv(){\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\">通过id获取div标签</span>\n<span style=\"color: #008080\"> 4</span> <span style=\"color: #0000ff\">var</span> divNode = document.getElementById(\"divId\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 5</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\">操作该节点,如获取该节点的nodeName、nodeType、nodeValue</span>\n<span style=\"color: #008080\"> 6</span> \n<span style=\"color: #008080\"> 7</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\">获取并修改文本数据</span>\n<span style=\"color: #008080\"> 8</span> divNode.innerHTML = \"???????\".fontcolor(\"red\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">}\n</span><span style=\"color: #008080\">10</span> &lt;/script&gt;\n<span style=\"color: #008080\">11</span> &lt;input type=\"button\" value=\"点击查看效果\" onclick=\"changeDiv()\"/&gt;\n<span style=\"color: #008080\">12</span> &lt;div id=\"divId\"&gt;这是一个div节点&lt;/div&gt;</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<p><span style=\"font-size: 16px\"><span style=\"color: #ff0000\">方式二</span>：通过name属性获取节点(因为name可以相同，所以返回的是一个数组)getElementsByName();</span></p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_93ed8b82-04ce-43af-82a3-5e38e66a3645\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_93ed8b82-04ce-43af-82a3-5e38e66a3645\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_93ed8b82-04ce-43af-82a3-5e38e66a3645\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #008080\"> 1</span> &lt;script type=\"text/javascript\"&gt;\n<span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> show(){\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\">通过name获取节点数组</span>\n<span style=\"color: #008080\"> 4</span> <span style=\"color: #0000ff\">var</span> nodes = document.getElementsByName(\"haha\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 5</span> <span style=\"color: #008000\">//\n</span><span style=\"color: #008080\"> 6</span> <span style=\"color: #0000ff\">var</span> divNode = nodes[0<span style=\"color: #000000\">];\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #0000ff\">var</span> textNode = nodes[1<span style=\"color: #000000\">];\n</span><span style=\"color: #008080\"> 8</span> \n<span style=\"color: #008080\"> 9</span> document.write(divNode.innerHTML+\"&lt;br/&gt;\"+<span style=\"color: #000000\">textNode.value);\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #000000\">}\n</span><span style=\"color: #008080\">11</span> &lt;/script&gt;\n<span style=\"color: #008080\">12</span> &lt;input type=\"button\" value=\"点击查看效果\" onclick=\"show()\"/&gt;\n<span style=\"color: #008080\">13</span> &lt;div name=\"haha\"&gt;这是一个div节点&lt;/div&gt;\n<span style=\"color: #008080\">14</span> &lt;input type=\"text\" value=\"请输入任意内容...\" name =\"haha\"/&gt;</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<p><span style=\"font-size: 16px\"><span style=\"color: #ff0000\">方式三：</span>对所以标签都适用的方法：像&lt;a&gt;这样的标签既没有id，也没有name，就可以直接通过标签名来获取：getElementsByTagName();</span></p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_893f022c-f0b6-462e-920d-cd463b790597\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_893f022c-f0b6-462e-920d-cd463b790597\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_893f022c-f0b6-462e-920d-cd463b790597\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #008080\"> 1</span> &lt;script type=\"text/javascript\"&gt;\n<span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> show(){\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\">通过标签名获取节点数组</span>\n<span style=\"color: #008080\"> 4</span> <span style=\"color: #0000ff\">var</span> nodes = document.getElementsByTagName(\"a\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 5</span> <span style=\"color: #008000\">//\n</span><span style=\"color: #008080\"> 6</span> <span style=\"color: #0000ff\">var</span> node1 = nodes[0<span style=\"color: #000000\">];\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #0000ff\">var</span> node2 = nodes[1<span style=\"color: #000000\">];\n</span><span style=\"color: #008080\"> 8</span> \n<span style=\"color: #008080\"> 9</span> document.write(node1.href+\"&lt;br/&gt;\"+<span style=\"color: #000000\">node2.href);\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #000000\">}\n</span><span style=\"color: #008080\">11</span> &lt;/script&gt;\n<span style=\"color: #008080\">12</span> &lt;input type=\"button\" value=\"获取以下链接地址\" onclick=\"show()\"/&gt;\n<span style=\"color: #008080\">13</span> &lt;a href=\"http://www.w3school.com.cn\"&gt;W3C官网&lt;/a&gt;\n<span style=\"color: #008080\">14</span> &lt;a href=\"http://www.cnblogs.com/fzz9/\"&gt;博客园主页&lt;/a&gt;</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<h2>七、通过节点层次关系获取节点</h2>\n<p><span style=\"font-size: 16px; color: #ff0000\">节点的层次关系：</span><br><span style=\"font-size: 16px\">1、父节点：parentNode(一个父节点)</span><br><span style=\"font-size: 16px\">2、子节点：childNodes(若干个子节点)</span><br><span style=\"font-size: 16px\">3、兄弟节点：上一个兄弟节点：previousSibling；下一个兄弟节点：nextSibling</span></p>\n<h2>八、节点的一般操作</h2>\n<p><span style=\"font-size: 16px\">1、创建并添加</span><br><span style=\"font-size: 16px\">2、删除节点</span><br><span style=\"font-size: 16px\">3、替换&amp;克隆节点</span></p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_8e1d565d-7a3a-4fd7-a937-fbe951a09b54\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_8e1d565d-7a3a-4fd7-a937-fbe951a09b54\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_8e1d565d-7a3a-4fd7-a937-fbe951a09b54\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #008080\"> 1</span> &lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n<span style=\"color: #008080\"> 2</span> &lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n<span style=\"color: #008080\"> 3</span> &lt;head&gt;\n<span style=\"color: #008080\"> 4</span> &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" /&gt;\n<span style=\"color: #008080\"> 5</span> &lt;title&gt;节点的一般操作&lt;/title&gt;\n<span style=\"color: #008080\"> 6</span> &lt;style type=\"text/css\"&gt;\n<span style=\"color: #008080\"> 7</span> <span style=\"color: #000000\">    div{\n</span><span style=\"color: #008080\"> 8</span> <span style=\"color: #000000\">        border:#FFFFFF 1px solid;\n</span><span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">        width:200px;\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #000000\">        padding:20px;\n</span><span style=\"color: #008080\">11</span> <span style=\"color: #000000\">        margin:10px;\n</span><span style=\"color: #008080\">12</span>         font-family:\"华文中宋\"<span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">13</span>         font-<span style=\"color: #000000\">size:20px;\n</span><span style=\"color: #008080\">14</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">15</span> <span style=\"color: #000000\">    #divTitle{\n</span><span style=\"color: #008080\">16</span>         border-left-<span style=\"color: #000000\">width:80px;\n</span><span style=\"color: #008080\">17</span> <span style=\"color: #000000\">        width:50px;\n</span><span style=\"color: #008080\">18</span> <span style=\"color: #000000\">        padding:10px;\n</span><span style=\"color: #008080\">19</span> <span style=\"color: #000000\">        margin:10px;\n</span><span style=\"color: #008080\">20</span> <span style=\"color: #000000\">        background:#00dd66;\n</span><span style=\"color: #008080\">21</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">22</span> <span style=\"color: #000000\">    #div1{\n</span><span style=\"color: #008080\">23</span> <span style=\"color: #000000\">        background:#0066FF;\n</span><span style=\"color: #008080\">24</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">25</span> <span style=\"color: #000000\">    #div2{\n</span><span style=\"color: #008080\">26</span> <span style=\"color: #000000\">        background:#6600FF;\n</span><span style=\"color: #008080\">27</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">28</span> <span style=\"color: #000000\">    #div3{\n</span><span style=\"color: #008080\">29</span> <span style=\"color: #000000\">        background:#66FF00;\n</span><span style=\"color: #008080\">30</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">31</span> <span style=\"color: #000000\">    #div4{\n</span><span style=\"color: #008080\">32</span> <span style=\"color: #000000\">        background:#FF0066;\n</span><span style=\"color: #008080\">33</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">34</span> <span style=\"color: #000000\">    hr{\n</span><span style=\"color: #008080\">35</span> <span style=\"color: #000000\">        border:#CCFF00 1px solid;\n</span><span style=\"color: #008080\">36</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">37</span> &lt;/style&gt;\n<span style=\"color: #008080\">38</span> &lt;/head&gt;\n<span style=\"color: #008080\">39</span> \n<span style=\"color: #008080\">40</span> &lt;body&gt;\n<span style=\"color: #008080\">41</span>     &lt;script type=\"text/javascript\"&gt;\n<span style=\"color: #008080\">42</span>         <span style=\"color: #008000\">//</span><span style=\"color: #008000\">在div3中添加一个文本节点</span>\n<span style=\"color: #008080\">43</span>         <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> creNode(){\n</span><span style=\"color: #008080\">44</span>             <span style=\"color: #008000\">//</span><span style=\"color: #008000\">创建文本节点</span>\n<span style=\"color: #008080\">45</span>             <span style=\"color: #0000ff\">var</span> newText = document.createTextNode(\"蜡炬成灰泪始干\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">46</span>             <span style=\"color: #008000\">//</span><span style=\"color: #008000\">获取div3节点</span>\n<span style=\"color: #008080\">47</span>             <span style=\"color: #0000ff\">var</span> div3 = document.getElementById(\"div3\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">48</span>             <span style=\"color: #008000\">//</span><span style=\"color: #008000\">添加</span>\n<span style=\"color: #008080\">49</span> <span style=\"color: #000000\">            div3.appendChild(newText);\n</span><span style=\"color: #008080\">50</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">51</span>         <span style=\"color: #008000\">//</span><span style=\"color: #008000\">删除节点</span>\n<span style=\"color: #008080\">52</span>         <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> delNode(){\n</span><span style=\"color: #008080\">53</span>             <span style=\"color: #0000ff\">var</span> divNode3 = document.getElementById(\"div3\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">54</span>             <span style=\"color: #008000\">//</span><span style=\"color: #008000\">方法一：删除节点,参数为true时，连同子节点也一起上删除，此方法在IE中有效 </span>\n<span style=\"color: #008080\">55</span>            <span style=\"color: #008000\">//</span><span style=\"color: #008000\">divNode3.removeNode(true);</span>\n<span style=\"color: #008080\">56</span>            <span style=\"color: #008000\">//</span><span style=\"color: #008000\">方法二：使用父节点删除(推荐)</span>\n<span style=\"color: #008080\">57</span> <span style=\"color: #000000\">           divNode3.parentNode.removeChild(divNode3);\n</span><span style=\"color: #008080\">58</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">59</span>         \n<span style=\"color: #008080\">60</span>         <span style=\"color: #008000\">//</span><span style=\"color: #008000\">克隆节点</span>\n<span style=\"color: #008080\">61</span>         <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> updateNode(){\n</span><span style=\"color: #008080\">62</span>             <span style=\"color: #0000ff\">var</span> div1 = document.getElementById(\"div1\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">63</span>             <span style=\"color: #0000ff\">var</span> div3 = document.getElementById(\"div3\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">64</span>             <span style=\"color: #0000ff\">var</span> copyDiv = div3.cloneNode(<span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">65</span> <span style=\"color: #000000\">            div1.parentNode.replaceChild(copyDiv,div1);\n</span><span style=\"color: #008080\">66</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">67</span>         \n<span style=\"color: #008080\">68</span>         <span style=\"color: #008000\">//</span><span style=\"color: #008000\">添加标题连接</span>\n<span style=\"color: #008080\">69</span>         <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> setTitle(){\n</span><span style=\"color: #008080\">70</span>             <span style=\"color: #008000\">//</span><span style=\"color: #008000\">创建链接元素</span>\n<span style=\"color: #008080\">71</span>             <span style=\"color: #0000ff\">var</span> title = document.createElement(\"a\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">72</span>             title.href = \"http://hanyu.baidu.com/shici/detail?pid=1d4e20feb969440989a03d6e0700f077&amp;from=kg0\"<span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">73</span>             title.innerHTML = \"无题\"<span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">74</span>             title.target = \"_blank\"<span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">75</span>             <span style=\"color: #008000\">//</span><span style=\"color: #008000\">获取divTitle节点</span>\n<span style=\"color: #008080\">76</span>             <span style=\"color: #0000ff\">var</span> divTitle = document.getElementById(\"divTitle\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">77</span>             <span style=\"color: #008000\">//</span><span style=\"color: #008000\">添加</span>\n<span style=\"color: #008080\">78</span> <span style=\"color: #000000\">            divTitle.appendChild(title);\n</span><span style=\"color: #008080\">79</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">80</span>     &lt;/script&gt;\n<span style=\"color: #008080\">81</span>     \n<span style=\"color: #008080\">82</span>     &lt;input type=\"button\" value=\"创建并添加节点\" onclick=\"creNode()\" /&gt;\n<span style=\"color: #008080\">83</span>     &lt;input type=\"button\" value=\"删除节点\" onclick=\"delNode()\" /&gt;\n<span style=\"color: #008080\">84</span>     &lt;input type=\"button\" value=\"克隆节点\" onclick=\"updateNode()\" /&gt;\n<span style=\"color: #008080\">85</span>     &lt;input type=\"button\" value=\"查看\" onclick=\"setTitle()\" /&gt;\n<span style=\"color: #008080\">86</span>     &lt;hr/&gt;\n<span style=\"color: #008080\">87</span>     &lt;div id=\"divTitle\"&gt;&lt;/div&gt;\n<span style=\"color: #008080\">88</span>     &lt;div id=\"div1\"&gt;相见时难别亦难&lt;/div&gt;\n<span style=\"color: #008080\">89</span>     &lt;div id=\"div2\"&gt;东风无力百花残&lt;/div&gt;\n<span style=\"color: #008080\">90</span>     &lt;div id=\"div3\"&gt;&lt;/div&gt;\n<span style=\"color: #008080\">91</span>     &lt;div id=\"div4\"&gt;蜡炬成灰泪始干&lt;/div&gt;\n<span style=\"color: #008080\">92</span> &lt;/body&gt;\n<span style=\"color: #008080\">93</span> &lt;/html&gt;</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 14:29</span> <a href=\"http://www.cnblogs.com/fzz9/\">风之之</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7772149\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7772149);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=385822,cb_entryId=7772149,cb_blogApp=currentBlogApp,cb_blogUserGuid='fb36efe8-b7c7-4dde-0023-08d4ef52ecb6',cb_entryCreatedDate='2017/11/2 14:29:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 73, "image_url": ["https:"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "C#设计模式之十一外观模式（Facade）【结构型】", "url": "http://www.cnblogs.com/PatrickLiu/p/7772184.html", "author": "PatrickLiu", "article_desc": "\r\n    一、引言 快12点半了，要开始今天的写作了。很快，转眼设计模式已经写了十个了，今天我们要讲【结构型】设计模式的第五个模式，该模式是【外观模式】，英文名称是：Facade Pattern。我们先从名字上来理解一下“外观模式”。我看到了“外观”这个词语，就想到了“外表”这个词语，两者有着很相近的意思。就 ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div class=\"post\">\r\n\t<div class=\"postTitle\">\r\n\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/PatrickLiu/p/7772184.html\">C#设计模式之十一外观模式（Facade）【结构型】</a>\r\n\t</div>\r\n\t<div id=\"cnblogs_post_body\"><p><strong>一、引言</strong><br><br>   快12点半了，要开始今天的写作了。很快，转眼设计模式已经写了十个了，今天我们要讲【结构型】设计模式的第五个模式，该模式是【外观模式】，英文名称是：Facade Pattern。我们先从名字上来理解一下“外观模式”。我看到了“外观”这个词语，就想到了“外表”这个词语，两者有着很相近的意思。就拿谈恋爱来说，“外表”很重要，如果第一眼看着很舒服、有眼缘，那就有交往下去的可能。如果长的“三寸钉、枯树皮”，估计就够呛了。在这方面，“外观”和“外表”有着相同的作用。在软件系统中，要完成一个功能，需要很多接口调用，不仅增加了开发难度，也增加了调试成本和维护的复杂度。不如我们把这些接口再封装一次，给一个很好的“外观”，让使用者使用更方便，只需调用一个接口，就可以完成以前调用多个接口的来完成任务，这就方便了。这个模式很简单，大家很容易理解，可能大家在编码的过程中已经不止一次使用过该模式了，只是不知道名字罢了。现实生活中这样的例子很多，举不胜举，来一幅图，大家看看就明白了。<br> 图一：<br><img src=\"http://images2017.cnblogs.com/blog/1048776/201711/1048776-20171102143221826-2069292490.png\" alt=\"\"><br><br><strong>二、外观模式的详细介绍</strong><br><br><strong>2.1、动机（Motivate）</strong><br><br>   在软件系统开发的过程中，当组件的客户（即外部接口，或客户程序）和组件中各种复杂的子系统有了过多的耦合，随着外部客户程序和各子系统的演化，这种过多的耦合面临很多变化的挑战。如何简化外部客户程序和系统间的交互接口？如何将外部客户程序的演化和内部子系统的变化之间的依赖相互解耦？<br><br><strong>2.2、意图（Intent）</strong><br><br>   为子系统中的一组接口提供一个一致的界面，Facade模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。　　　　　　——《设计模式》GoF<br><br><strong>2.3、结构图</strong><br><br>       <img src=\"http://images2017.cnblogs.com/blog/1048776/201711/1048776-20171102143312091-1683302818.png\" alt=\"\"><br><br><strong>2.4、模式的组成</strong><br>    <br>    外观模式包含如下两个角色：<br><br>      . Facade（外观角色）：在客户端可以调用它的方法，在外观角色中可以知道相关的（一个或者多个）子系统的功能和责任；在正常情况下，它将所有从客户端发来的请求委派到相应的子系统去，传递给相应的子系统对象处理。<br><br>      . SubSystem（子系统角色）：在软件系统中可以有一个或者多个子系统角色，每一个子系统可以不是一个单独的类，而是一个类的集合，它实现子系统的功能；每一个子系统都可以被客户端直接调用，或者被外观角色调用，它处理由外观类传过来的请求；子系统并不知道外观的存在，对于子系统而言，外观角色仅仅是另外一个客户端而已。<br><br><strong>2.5、外观模式的具体实现</strong><br><br>    马上就到“双十一”了，人们又开始疯狂的购买了。其实购买的过程很复杂，但是我们在购买的过程只需要选择自己喜欢的商品，也可以加入购物车，最后点击付款就完成了。其实这个过程没有那么简单。我们下面就模仿一下购买的过程吧。<br><br>    购买过程有几点必须要做的事情：<br><br>     1、身份验证安全，没有认证是无效用户。<br><br>     2、系统安全，检查系统环境，防止注入、跨站和伪造等攻击<br><br>     3、网银安全，检查付款地址的有效性，检查网关是否正常</p>\n<p>   </p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> 外观模式的实现\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #000000\">{\n</span><span style=\"color: #008080\"> 3</span>     <span style=\"color: #808080\">///</span> <span style=\"color: #808080\">&lt;summary&gt;</span>\n<span style=\"color: #008080\"> 4</span>     <span style=\"color: #808080\">///</span><span style=\"color: #008000\"> 不使用外观模式的情况\n</span><span style=\"color: #008080\"> 5</span>     <span style=\"color: #808080\">///</span><span style=\"color: #008000\"> 此时客户端与三个子系统都发送了耦合，使得客户端程序依赖与子系统\n</span><span style=\"color: #008080\"> 6</span>     <span style=\"color: #808080\">///</span><span style=\"color: #008000\"> 为了解决这样的问题，我们可以使用外观模式来为所有子系统设计一个统一的接口\n</span><span style=\"color: #008080\"> 7</span>     <span style=\"color: #808080\">///</span><span style=\"color: #008000\"> 客户端只需要调用外观类中的方法就可以了，简化了客户端的操作\n</span><span style=\"color: #008080\"> 8</span>     <span style=\"color: #808080\">///</span><span style=\"color: #008000\"> 从而让客户和子系统之间避免了紧耦合\n</span><span style=\"color: #008080\"> 9</span>     <span style=\"color: #808080\">///</span> <span style=\"color: #808080\">&lt;/summary&gt;</span>\n<span style=\"color: #008080\">10</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Client\n</span><span style=\"color: #008080\">11</span> <span style=\"color: #000000\">    {\n</span><span style=\"color: #008080\">12</span>         <span style=\"color: #0000ff\">static</span> <span style=\"color: #0000ff\">void</span> Main(<span style=\"color: #0000ff\">string</span><span style=\"color: #000000\">[] args)\n</span><span style=\"color: #008080\">13</span> <span style=\"color: #000000\">        {\n</span><span style=\"color: #008080\">14</span>             SystemFacade facade=<span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> SystemFacade();\n</span><span style=\"color: #008080\">15</span> <span style=\"color: #000000\">            facade.Buy();\n</span><span style=\"color: #008080\">16</span> <span style=\"color: #000000\">            Console.Read();\n</span><span style=\"color: #008080\">17</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">18</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">19</span>  \n<span style=\"color: #008080\">20</span>     <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 身份认证子系统A</span>\n<span style=\"color: #008080\">21</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> AuthoriationSystemA\n</span><span style=\"color: #008080\">22</span> <span style=\"color: #000000\">    {\n</span><span style=\"color: #008080\">23</span>         <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> MethodA()\n</span><span style=\"color: #008080\">24</span> <span style=\"color: #000000\">        {\n</span><span style=\"color: #008080\">25</span>             Console.WriteLine(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">执行身份认证</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">26</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">27</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">28</span>  \n<span style=\"color: #008080\">29</span>     <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 系统安全子系统B</span>\n<span style=\"color: #008080\">30</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> SecuritySystemB\n</span><span style=\"color: #008080\">31</span> <span style=\"color: #000000\">    {\n</span><span style=\"color: #008080\">32</span>         <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> MethodB()\n</span><span style=\"color: #008080\">33</span> <span style=\"color: #000000\">        {\n</span><span style=\"color: #008080\">34</span>             Console.WriteLine(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">执行系统安全检查</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">35</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">36</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">37</span>  \n<span style=\"color: #008080\">38</span>     <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 网银安全子系统C</span>\n<span style=\"color: #008080\">39</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> NetBankSystemC\n</span><span style=\"color: #008080\">40</span> <span style=\"color: #000000\">    {\n</span><span style=\"color: #008080\">41</span>         <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> MethodC()\n</span><span style=\"color: #008080\">42</span> <span style=\"color: #000000\">        {\n</span><span style=\"color: #008080\">43</span>             Console.WriteLine(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">执行网银安全检测</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">44</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">45</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">46</span> \n<span style=\"color: #008080\">47</span>    <span style=\"color: #008000\">//</span><span style=\"color: #008000\">更高层的Facade</span>\n<span style=\"color: #008080\">48</span>    <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> SystemFacade\n</span><span style=\"color: #008080\">49</span> <span style=\"color: #000000\">   {\n</span><span style=\"color: #008080\">50</span>       <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> AuthoriationSystemA auth;\n</span><span style=\"color: #008080\">51</span>       <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> SecuritySystemB security;\n</span><span style=\"color: #008080\">52</span>       <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> NetBankSystemC netbank;\n</span><span style=\"color: #008080\">53</span> \n<span style=\"color: #008080\">54</span>       <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> SystemFacade()\n</span><span style=\"color: #008080\">55</span> <span style=\"color: #000000\">      {\n</span><span style=\"color: #008080\">56</span>          auth=<span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> AuthoriationSystemA();\n</span><span style=\"color: #008080\">57</span>          security=<span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> SecuritySystemB();\n</span><span style=\"color: #008080\">58</span>          netbank=<span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> NetBankSystemC();\n</span><span style=\"color: #008080\">59</span> <span style=\"color: #000000\">      }\n</span><span style=\"color: #008080\">60</span> \n<span style=\"color: #008080\">61</span>       <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Buy()\n</span><span style=\"color: #008080\">62</span> <span style=\"color: #000000\">      {\n</span><span style=\"color: #008080\">63</span>           auth.MethodA();<span style=\"color: #008000\">//</span><span style=\"color: #008000\">身份认证子系统</span>\n<span style=\"color: #008080\">64</span>           security.MethodB();<span style=\"color: #008000\">//</span><span style=\"color: #008000\">系统安全子系统</span>\n<span style=\"color: #008080\">65</span>           netbank.MethodC();<span style=\"color: #008000\">//</span><span style=\"color: #008000\">网银安全子系统</span>\n<span style=\"color: #008080\">66</span> \n<span style=\"color: #008080\">67</span>           Console.WriteLine(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">我已经成功购买了！</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">68</span> <span style=\"color: #000000\">      }\n</span><span style=\"color: #008080\">69</span> <span style=\"color: #000000\">   }\n</span><span style=\"color: #008080\">70</span> }</pre>\n</div>\n<p><br>     这个模式很简单，就话不多说了。<br><br><strong>三、外观模式的实现要点：</strong><br>    <br>    1、一个系统可以有几个门面类<br><br>　　   在门面模式中，通常只需要一个门面类，并且此门面类只有一个实例，换言之它是一个单例类。当然这并不意味着在整个系统里只有一个门面类，而仅仅是说对每一个子系统只有一个门面类。或者说，如果一个系统有好几个子系统的话，每一个子系统都有一个门面类，整个系统可以有数个门面类。<br><br>    2、为子系统增加新行为<br><br>　　   初学者往往以为通过继承一个门面类便可在子系统中加入新的行为，这是错误的。门面模式的用意是为子系统提供一个集中化和简化的沟通管道，而不能向子系统加入新的行为。比如医院中的接待员并不是医护人员，接待员并不能为病人提供医疗服务。<br><br>    3、Facade有助于建立层次结构的系统，实现了子系统与客户之间的松耦合关系，子系统内部的功能组件往往是紧耦合的。松耦合关系使得子系统的组件变化不会影响到它的客户。Facade消除了复杂的循环依赖关系。这一点在客户程序与子系统分别实现的时候格外重要。<br><br>    4、从客户程序的角度来看，Facade模式不仅简化了整个组件系统的接口，同时对于组件内部与外部客户程序来说，从某种程度上也达到了一种“解耦”的效果——内部子系统的任何变化不会影响到Facade接口的变化。<br><br><strong>四、.NET 中外观模式的实现</strong><br><br>    外观模式在FCL里面运用还是很多的，多数情况是单个类的情况，在Asp.Net里面，有很多复合控件，比如：Login控件，可以登录，可以认证，可以保存登录用户信息。其实，外观模式更多的是应用在业务系统当中，效果更好。<br><br><strong>五、总结</strong><br><br>  这个模式很简单，就不说了，就稍微做一下小结。Facade设计模式更注重从架构的层次去看整个系统，而不是单个类的层次。Facade很多时候更是一种架构设计模式。注意区分Facade模式、Adapter模式、Bridge模式与Decorator模式：<br><br>　　Facade模式注重简化接口<br><br>　　Adapter模式注重转换接口<br><br>　　Bridge模式注重分离接口（抽象）与其实现<br><br>　　Decorator模式注重稳定接口的前提下为对象扩展功能</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t<div class=\"postDesc\">posted on <span id=\"post-date\">2017-11-02 14:35</span> <a href=\"http://www.cnblogs.com/PatrickLiu/\">PatrickLiu</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7772184\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7772184);return false;\">收藏</a></div>\r\n</div>\r\n<script type=\"text/javascript\">var allowComments=true,cb_blogId=313078,cb_entryId=7772184,cb_blogApp=currentBlogApp,cb_blogUserGuid='cb77865f-c599-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/2 14:35:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\r\n</div>", "article_view": 97, "image_url": ["https:"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "记小曼巴初次的设计心得", "url": "http://www.cnblogs.com/1315925303zxz/p/7772154.html", "author": "禁心尽力", "article_desc": "公元2017-10-24，星期一，手机上还不断刷着知乎，嘴里搞着东西坐在那小工位上走着心呢，突然，\"小忠，你过来，给你讲讲任务调度这块的一些业务重构的需求吧\"，还没缓过神儿，就被源哥叫到小黑板前开始上课了； \"我们做个任务调度的功能吧，现在这个制单速度没有达到最大化，很多客户端不能同时进行制单，只能 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/1315925303zxz/p/7772154.html\">记小曼巴初次的设计心得</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　公元2017-10-24，星期一，手机上还不断刷着知乎，嘴里搞着东西坐在那小工位上走着心呢，突然，\"小忠，你过来，给你讲讲任务调度这块的一些业务重构的需求吧\"，还没缓过神儿，就被源哥叫到小黑板前开始上课了；</p>\r\n<p>　　\"我们做个任务调度的功能吧，现在这个制单速度没有达到最大化，很多客户端不能同时进行制单，只能有一台机器能够自动制单，其它的只能人工手动制单，不行，这个得重新设计一下，重构吧。\"老大简明下达了这次作战任务，接着就是他老人家的一些方案，大概进行了1个多小时，我们下课了，最后这次的设计老大交给了我，让我来设计这次的任务调度模块，其实我心里是非常接受的，因为这是我第一次设计，兴奋感一直在心头涌动着；老大也知道我是第一次，所以私下就不断给我灌输了很多他老人家的设计经验，说真的，这几天学到最好的也是嘱咐最多一句话：\"小忠，设计不要局限在自己的那块，要跳出来，一定要跳出来，要掌控全局\"。</p>\r\n<p>　　经过2天多的设计，我如愿以偿的交上了V1.0版的设计文档，周三下午；</p>\r\n<p>　　\"源哥，设计文档发过去了，你有时间的话看一眼吧，哪些地方还需要改进\"，当时我还是有点自信的，因为很多逻辑我都想了一遍，突发情况也想好了相应的解决方案。</p>\r\n<p>　　10分钟，就10分钟，源哥叫我了，\"小忠，你过来一下\"，我以为要给我说明天就开发吧；然而我错了，错的一塌糊涂，连毛都不剩；</p>\r\n<p>　　\"小忠啊，我现在把你这个设计文档给其他人，其他人能快速定位到自己需要开发和重构的地方吗，好，不说这个，就你，你现在拿着这个文档去开发，你能列出个满意的计划给我吗？\"因为我了解，老大质疑你的东西，那十有八九就是你做的不到位；</p>\r\n<p>　　接着，\"好，先不说你这个设计方案是否可行，但是你这个入门的基本功首先就没学到位，你没用心，知道吗，你这个文档上处处标记着你<strong>没有用心</strong>\"，最后那几个字儿源哥还是拉着很长，然后说了好多这V1.0版本的毛病，这次是我第一次感觉从一次对话中学到了很多道理的时候。</p>\r\n<p>　　又经过3天多的调整，我终于将V1.1版的设计文档搞出来了啦，在周一早上就发出去了，但是这次我不是态度的问题，而真的是经验和格局的问题了。起初我是站在自己负责的那块来改造，针对自己的品牌进行了设计，是的不错确实对于我来说真的是一个完美的设计，但是我抛下了很多重要的业务分支，根本没有考虑过其他品牌是否符合你的设计，也没有和任何其他模块的开发者去沟通过，最终导致设计方案覆盖范围极小。\"设计者，不要佩带着任何角色去设计，接着，源哥又给我从整个公司的用户下单开始，清晰的描述了整个业务链的运作，以及各个模块之间是如何配合工作的\"，听完这次的描述，我心里又有了一百种方案，真的，这就是所谓的人生格局越大，看到的景色越美的道理。</p>\r\n<p> </p>\r\n<p>　　以下是我这次总结的失败经验，给大家分享一下，如果有不对的地方，请各位也不要谩骂我误导大家，因为是第一次，如果有好的地方，也希望能够对各位有用。</p>\r\n<p>　　　　1、设计千万不要把自己局限在自己负责的那块和邻近了解的那块，一定要跳出来，掌控全局，了解整个业务链的运作，有胆量将自己设计的东西放在任何点来重构整个业务链。</p>\r\n<p>　　　　2、设计过程中在文档上做任何决定时，一定要遵循，先寻求现有的，后决定是否自己开发，然后将问题逐一抛给现有的和要开发的方案，进行对比，当然，这是需要全方面的对比，比如：成本、效率和扩展性等。</p>\r\n<p>　　　　3、设计过程中遇到或者别人抛出的问题，一定要记录(必要时刻直接写在设计文档中)，这个也是我这次最轻视的地方，每次想到一个问题，经过一番讨论，就完事，也没有将问题记录下来，最后当有人第二次提出同样的问题时，我又开始当场思考，想解决方案，而且还远远不如第一次的。</p>\r\n<p>　　　　4、多沟通，一定要多沟通，厚着脸皮就算是扯淡也要跑着去了解一下有可能涉及到的模块业务，因为就算是扯淡也不至于到最后让你后悔没有去了解一下这块的情况，也不会出现：\"卧槽，要是把这次的设计放到这块多好啊\"。</p>\r\n<p> </p>\r\n<p>　　直到今天，我跟这个设计文档整整周旋了快9天，今天早上交付了V1.2版本的文档和一些模块框图过去，其中还加了一些功能分布图和一些对应的描述信息，得到很不错的反馈，因为源哥说看着舒服多了，我心里也舒服多了。估计下周就可以开始实施了，好开心，终于可以看到自己设计的功能了。（初次设计，望各位照顾）</p>\r\n<p>　　最后，分享一句老大给我说的话。一个设计文档的好坏，最重要的就是要看，当你把你的设计文档丢给别人，别人和沟通的次数多不多，如果说别人每做一点你都在给人解释，那么你的这个设计文档就烂，而且很烂，甚至可以说不是设计文档，而是你在设计过程的做的笔记，我们设计的目的就是，把模块功能设计好之后组织成文档，交给执行者去实现，最后你再过来看是否和你设计的预期效果一致，话不多说，效果达到就好。</p>\r\n<p>　　感谢默默教我道理的人，感谢所有共勉的朋友。</p>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 14:48</span> <a href=\"http://www.cnblogs.com/1315925303zxz/\">禁心尽力</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7772154\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7772154);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=279778,cb_entryId=7772154,cb_blogApp=currentBlogApp,cb_blogUserGuid='1bd907d6-d89f-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/2 14:48:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 177, "image_url": ["https://pic.cnblogs.com/face/855612/20170918112247.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "Java项目打包方式分析", "url": "http://www.cnblogs.com/ywjy/p/7771042.html", "author": "何以堪", "article_desc": "介绍java原生打包，Maven原生打包，Maven的shade插件打包和Maven的spring-boot插件打包的方式，及其间的区别。 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/ywjy/p/7771042.html\">Java项目打包方式分析</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>[TOC]</p>\n<h1 id=\"概述\">概述</h1>\n<p>在项目实践过程中，有个需求需要做一个引擎能执行指定jar包的指定main方法。</p>\n<p>起初我们以一个简单的spring-boot项目进行测试，使用<code>spring-boot-maven-plugin</code>进行打包，使用<code>java -cp demo.jar &lt;package&gt;.&lt;MainClass&gt;</code>执行，结果报错找不到对应的类。</p>\n<p>我分析了<code>spring-boot-maven-plugin</code>打包的结构，又回头复习了java原生<code>jar</code>命令打包的结果，以及其他Maven打包插件打包的结果，然后写成这边文章。</p>\n<p>这篇文章里会简单介绍java原生的打包方式，maven原生的打包方式，使用maven shade插件将项目打成一个<strong>大一统</strong>的jar包的方式，使用<code>spring-boot-maven-plugin</code>将项目打成一个<strong>大一统</strong>的jar包的方式，并比较它们的差异，给出使用建议。</p>\n<h1 id=\"java原生打包\">Java原生打包</h1>\n<p>为了简单起见，假设我们的项目只有一个<code>HelloWorld.java</code>，不使用Maven。假设当前目录为<code>.</code>，初始目录下没有任何内容。</p>\n<p>首先，我们在当前目录新建文件<code>HelloWorld.java</code>。为了演示如何让编译的class文件自动放置到与<code>package</code>对应的目录结构中，特地添加<code>package</code>命令。</p>\n<pre><code>package com.hikvision.demo;\n\npublic class HelloWorld {\n    public static void main(String[] args) {\n        System.out.println(\"Hello World\");\n    }\n}</code></pre>\n<p>在当前目录新建<code>target</code>子目录，此时，目录结构如下：</p>\n<pre><code> ./\n  ├─ HelloWorld.java\n  ├─ target/</code></pre>\n<h2 id=\"编译\">编译</h2>\n<p>命令：<code>javac HelloWorld.java -d target</code>。目录结构变为：</p>\n<pre><code> ./\n  ├─ HelloWorld.java\n  ├─ target/\n        ├─ com/hikvision/demo/\n              ├─ HelloWorld.class</code></pre>\n<h2 id=\"打包\">打包</h2>\n<p>命令：<code>jar cvf demo-algorithm.jar -C target/ .</code>。目录结构变为：</p>\n<pre><code> ./\n  ├─ HelloWorld.java\n  ├─ target/\n  │     └─ com/hikvision/demo/\n  │           └─ HelloWorld.class\n  ├─ demo-algorithm.jar</code></pre>\n<p>打包的结果<code>demo-algorithm.jar</code>，其内部结构为：</p>\n<pre><code>demo-algorithm.jar\n  ├─ com\n  │   └─ hikvision\n  │       └─ demo\n  │           └─ HelloWorld.class\n  └─ META-INF\n      └─ MANIFEST.MF</code></pre>\n<p>其中，MANIFEST.MF的内容为：</p>\n<pre><code>Manifest-Version: 1.0\nCreated-By: 1.8.0_144 (Oracle Corporation)</code></pre>\n<h2 id=\"运行\">运行</h2>\n<p>命令：<code>java -cp demo-algorithm.jar com.hikvision.demo.HelloWorld</code>。</p>\n<p>留意上面的jar包的结构，如果我们希望以<code>java -cp</code>的方式运行jar包中的某一个类的main方法，class的package必须对应jar包内部的一级目录。</p>\n<p>这种结构我们称之为java标准jar包结构。</p>\n<h1 id=\"maven原生打包\">Maven原生打包</h1>\n<p>我一般使用<code>mvn clean package</code>命令打包。</p>\n<p>maven打包的结果，jar包名称是根据artifactId和version来生成的，比如对于<code>com.hikvision.algorithm:demo-algorithm:0.0.1-SNAPSHOT</code>的打包结果是：<code>demo-algorithm-0.0.1-SNAPSHOT.jar</code>。</p>\n<p>分析这个jar包的结构：</p>\n<pre><code>.\n├─com\n│  └─hikvision\n│      └─algorithm\n│          └─HelloWorld.class\n├─META-INF\n│   ├─maven\n│   │   └─com.hikvision.algorithm\n│   │       └─demo-algorithm\n│   │           ├─pom.properties\n│   │           └─pom.xml\n│   └─MANIFEST.MF\n└─application.properties</code></pre>\n<p>除META-INF目录之外，其他的都是class path，这一点符合java标准jar结构。不同的是META-INF有一级子目录maven，放置项目的maven信息。</p>\n<p>对于maven原生的打包结果，可以使用<code>java -cp</code>的方式执行其中某个主类。但是需要注意它并没有包含所以来的jar包，这需要另外提供。</p>\n<h1 id=\"使用maven-shade插件打包\">使用Maven shade插件打包</h1>\n<p>Maven打包插件应该不止一种，这里使用的是<code>maven-shade-plugin</code>。</p>\n<p>在pom文件中添加插件配置：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode xml\"><code class=\"sourceCode xml\"><span class=\"kw\">&lt;plugin&gt;</span>\n    <span class=\"kw\">&lt;groupId&gt;</span>org.apache.maven.plugins<span class=\"kw\">&lt;/groupId&gt;</span>\n    <span class=\"kw\">&lt;artifactId&gt;</span>maven-shade-plugin<span class=\"kw\">&lt;/artifactId&gt;</span>\n    <span class=\"kw\">&lt;version&gt;</span>2.4.3<span class=\"kw\">&lt;/version&gt;</span>\n    <span class=\"kw\">&lt;executions&gt;</span>\n        <span class=\"kw\">&lt;execution&gt;</span>\n            <span class=\"kw\">&lt;phase&gt;</span>package<span class=\"kw\">&lt;/phase&gt;</span>\n            <span class=\"kw\">&lt;goals&gt;</span>\n                <span class=\"kw\">&lt;goal&gt;</span>shade<span class=\"kw\">&lt;/goal&gt;</span>\n            <span class=\"kw\">&lt;/goals&gt;</span>\n        <span class=\"kw\">&lt;/execution&gt;</span>\n    <span class=\"kw\">&lt;/executions&gt;</span>\n<span class=\"kw\">&lt;/plugin&gt;</span></code></pre></div>\n<p>根据上面的配置，在package阶段，会自动执行插件的<code>shade</code>目标，这个目标负责将项目的class文件，以及项目依赖的class文件都会统一打到一个jar包里。</p>\n<p>我们可以执行<code>mvn clean package</code>来自动触发<code>shade</code>，或者直接执行<code>mvn shade:shade</code>。</p>\n<p>target目录会生成2个jar包，一个是maven原生的jar包，一个是插件的jar包：</p>\n<pre><code>target/\n ├─ original-demo-algorithm-0.0.1-SNAPSHOT.jar (4KB)\n └─ demo-algorithm-0.0.1-SNAPSHOT.jar (6.24MB)</code></pre>\n<p><code>original-demo-algorithm-0.0.1-SNAPSHOT.jar</code>是原生的jar包，不包含任何依赖，只有4KB。<code>demo-algorithm-0.0.1-SNAPSHOT.jar</code>是包含依赖的jar包，有6.24MB。</p>\n<p>对照上文可以猜测shade插件对maven原生打包结果进行重命名之后，使用这个名字又打出一个集成了依赖的jar包。</p>\n<p>注意，这表示如果执行了<code>mvn install</code>，最终被安装到本地仓库的是插件打出的jar包，而不是maven原生的打包结果。可以配置插件，修改打包结果的名称：</p>\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.4.3&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;shade&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;configuration&gt;\n                &lt;finalName&gt;demo-algorithm-0.0.1-SNAPSHOT-assembly&lt;/finalName&gt;\n            &lt;/configuration&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;</code></pre>\n<p>使用这个配置，最终的打包结果：</p>\n<pre><code>target/\n ├─ demo-algorithm-0.0.1-SNAPSHOT.jar (4KB)\n └─ demo-algorithm-0.0.1-SNAPSHOT-assembly.jar (6.24MB)</code></pre>\n<p>此时，demo-algorithm-0.0.1-SNAPSHOT.jar是maven原生的打包结果，demo-algorithm-0.0.1-SNAPSHOT-assembly.jar是插件的打包结果。</p>\n<p>插件打包结果的内部结构如下：</p>\n<pre><code>├─ch\n│  └─qos\n│      └─logback\n│          ├─classic\n│          │  ├─boolex\n│          │  ├─db\n│          │  │  ├─names\n│          │  │  └─script\n│          │  ├─encoder\n│          │  └─util\n│          └─core\n│              ├─boolex\n│              ├─db\n│              │  └─dialect\n│              ├─encoder\n│              ├─joran\n│              │  ├─action\n│              │  ├─conditional\n│              │  ├─event\n│              │  │  └─stax\n│              │  ├─node\n│              │  ├─spi\n│              │  └─util\n│              │      └─beans\n│              ├─subst\n│              └─util\n├─com\n│  └─hikvision\n│      └─algorithm\n├─META-INF\n│  ├─maven\n│  │  ├─ch.qos.logback\n│  │  │  ├─logback-classic\n│  │  │  └─logback-core\n│  │  ├─com.hikvision.algorithm\n│  │  │  └─demo-algorithm\n│  │  ├─org.slf4j\n│  │  │  ├─jcl-over-slf4j\n│  │  │  ├─jul-to-slf4j\n│  │  │  ├─log4j-over-slf4j\n│  │  │  └─slf4j-api\n│  │  ├─org.springframework.boot\n│  │  │  ├─spring-boot\n│  │  │  ├─spring-boot-autoconfigure\n│  │  │  ├─spring-boot-starter\n│  │  │  └─spring-boot-starter-logging\n│  │  └─org.yaml\n│  │      └─snakeyaml\n│  ├─org\n│  │  └─apache\n│  │      └─logging\n│  │          └─log4j\n│  │              └─core\n│  │                  └─config\n│  │                      └─plugins\n│  └─services\n└─org\n    ├─apache\n    │  ├─commons\n    │  │  └─logging\n    │  │      └─impl\n    │  └─log4j\n    │      ├─helpers\n    │      ├─spi\n    │      └─xml\n    ├─slf4j\n    │  ├─bridge\n    │  ├─event\n    │  ├─helpers\n    │  ├─impl\n    │  └─spi\n    ├─springframework\n    │  ├─boot\n    │  │  ├─admin\n    │  │  ├─ansi\n    │  │  ├─web\n    │  │  │  ├─client\n    │  │  │  ├─filter\n    │  │  │  ├─servlet\n    │  │  │  └─support\n    │  │  └─yaml\n    │  └─validation\n    │      ├─annotation\n    │      ├─beanvalidation\n    │      └─support\n    └─yaml\n        └─snakeyaml\n            ├─error\n            ├─tokens\n            └─util</code></pre>\n<p>这里省略了所有的文件，以及大部分的子目录。</p>\n<p>除<code>META-INF</code>目录外的其他所有目录，都是classpath，结构和Maven原生的打包结构相同。不同的是shade插件将所有的依赖jar解压缩之后，和项目的class文件一起重新打成jar包；并且在<code>META-INF/maven</code>下包含了项目本身及所依赖的项目的pom信息。</p>\n<p>如果在pom文件中，声明某个依赖是<code>provided</code>的，它就不会被集成到jar包里。</p>\n<p>总的来说，使用<code>maven-shade-plugin</code>打出的jar包的结构依然符合java标准jar包结构，所以我们可以通过<code>java -cp</code>的方式运行jar包中的某一个类的main方法。</p>\n<h1 id=\"使用spring-boot-maven-plugin插件打包\">使用<code>spring-boot-maven-plugin</code>插件打包</h1>\n<p>项目首先必须是spring-boot项目，即项目直接或间接继承了<code>org.springframework.boot:spring-boot-starter-parent</code>。</p>\n<p>在pom文件中配置<code>spring-boot-maven-plugin</code>插件：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode xml\"><code class=\"sourceCode xml\"><span class=\"kw\">&lt;plugin&gt;</span>\n    <span class=\"kw\">&lt;groupId&gt;</span>org.springframework.boot<span class=\"kw\">&lt;/groupId&gt;</span>\n    <span class=\"kw\">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class=\"kw\">&lt;/artifactId&gt;</span>\n<span class=\"kw\">&lt;/plugin&gt;</span></code></pre></div>\n<p>这个插件默认将打包绑定在了maven生命周期的<code>package</code>阶段，即执行<code>package</code>命令会自动触发插件打包。</p>\n<p>插件会将Maven原生的打包结果重命名，然后将自己的打包结果使用之前那个名字。比如：</p>\n<pre><code>target/\n  ├─ ...\n  ├─ demo-algorithm-0.0.1-SNAPSHOT.jar.original\n  └─ demo-algorithm-0.0.1-SNAPSHOT.jar</code></pre>\n<p>如上，<code>demo-algorithm-0.0.1-SNAPSHOT.jar.original</code>是Maven原生的打包结果，被重命名之后追加了<code>.original</code>后缀。<code>demo-algorithm-0.0.1-SNAPSHOT.jar</code>是插件的打包结果。</p>\n<p>这里需要注意，如果运行了<code>mvn install</code>，会将这个大一统的jar包安装到本地仓库。这一点可以配置，使用下面的插件配置，可以确保安装到本地仓库的是原生的打包结果：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode xml\"><code class=\"sourceCode xml\"><span class=\"kw\">&lt;plugin&gt;</span>\n    <span class=\"kw\">&lt;groupId&gt;</span>org.springframework.boot<span class=\"kw\">&lt;/groupId&gt;</span>\n    <span class=\"kw\">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class=\"kw\">&lt;/artifactId&gt;</span>\n    <span class=\"kw\">&lt;configuration&gt;</span>\n        <span class=\"co\">&lt;!--将原始的包作为install和deploy的对象，而不是包含了依赖的包--&gt;</span>\n        <span class=\"kw\">&lt;attach&gt;</span>false<span class=\"kw\">&lt;/attach&gt;</span>\n    <span class=\"kw\">&lt;/configuration&gt;</span>\n<span class=\"kw\">&lt;/plugin&gt;</span></code></pre></div>\n<p>spring-boot-maven-plugin打包的结构如下：</p>\n<pre><code>.\n├─BOOT-INF\n│  ├─classes\n│  │  └─com\n│  │      └─hikvision\n│  │          └─algorithm\n│  └─lib\n├─META-INF\n│  └─maven\n│      └─com.hikvision.algorithm\n│          └─demo-algorithm\n└─org\n    └─springframework\n        └─boot\n            └─loader\n                ├─archive\n                ├─data\n                ├─jar\n                └─util</code></pre>\n<p>这里忽略了所有的文件。</p>\n<p>分析这个结构，spring-boot插件将项目本身的class放到了目录<code>BOOT-INF/classes</code>下，将所有依赖的jar放到了<code>BOOT-INF/lib</code>下。在jar包的顶层有一个子目录<code>org</code>，是spring-boot loader相关的classes。</p>\n<p>所以，这个与java标准jar包结构是不同的，和maven原生的打包结构也是不同的。</p>\n<p>另外，需要注意的是，即使设置为provided的依赖，依然会被集成到jar包里，这一点与上文的shade插件不同。</p>\n<p>分析<code>META-INF/MANIFEST.MF</code>文件内容：</p>\n<pre><code>Manifest-Version: 1.0\nImplementation-Title: demo-algorithm\nImplementation-Version: 0.0.1-SNAPSHOT\nArchiver-Version: Plexus Archiver\nBuilt-By: lijinlong9\nImplementation-Vendor-Id: com.hikvision.algorithm\nSpring-Boot-Version: 1.5.8.RELEASE\nImplementation-Vendor: Pivotal Software, Inc.\nMain-Class: org.springframework.boot.loader.JarLauncher\nStart-Class: com.hikvision.algorithm.HelloWorld\nSpring-Boot-Classes: BOOT-INF/classes/\nSpring-Boot-Lib: BOOT-INF/lib/\nCreated-By: Apache Maven 3.3.9\nBuild-Jdk: 1.8.0_144\nImplementation-URL: http://projects.spring.io/spring-boot/demo-algorithm/</code></pre>\n<p>注意，这里配置了<code>Main-Class</code>，这表示我们可以以<code>java -jar</code>的方式执行这个jar包。<code>Main-Class</code>对应的值为<code>org.springframework.boot.loader.JarLauncher</code>，这表示具体的加载过程是由spring-boot定义的。</p>\n<p>这里有一篇文章分析<a href=\"http://blog.csdn.net/u012734441/article/details/78325300\">spring boot<br>\njar的启动过程</a>。我简单看了下这篇文章，并没有细读，我大概猜测到spring-boot实现了一套自己的加载机制，与这个机制相对应的，spring-boot也自定义了一套自己的jar包结构。对我这说，目前了解到这个程度就够了。</p>\n<p>因为不符合Java标准jar包结构，所以无法通过<code>java -cp &lt;package&gt;.&lt;MainClass&gt;</code>的方式运行jar包里的某个类，因为按照标准的jar包结构是找不到这个类的。</p>\n<p>从这一点来看，我们需要重新思考什么样的项目或者module应该做成spring-boot项目？到目前为止，我认为只有完整、可运行的项目或module才需要做成spring-boot项目，比如对外提供rest服务的module。而像common类的module，对外提供公共类库，其本身无法独立运行，则不应该作为spring-boot项目。</p>\n<p>更何况对于多module的项目，将最顶层的module定义为spring-boot项目，而让所有的子module都通过继承顶层module来间接继承<code>spring-boot-starter-parent</code>的做法，应该是大谬的吧。</p>\n<h1 id=\"总结\">总结</h1>\n<ol>\n<li>Java原生打包、Maven原生打包、shade插件打包的结果，其结构都是一致的。可以使用<code>java -cp</code>的方式执行，一般无法直接使用<code>java -jar</code>的方式执行。</li>\n<li>使用spring-boot插件打包，其结构和上述的结构不同。不能使用<code>java -cp</code>的方式执行，可以使用<code>java -jar</code>的方式执行。</li>\n<li>shade插件会忽略provided的依赖，不集成到jar包里；spring-boot插件会将所有的依赖都集成到jar包里。</li>\n<li>默认的情况下，shade插件和spring-boot插件的打包结果，会代替Maven原生打包结果被安装到本地仓库（执行<code>mvn install</code>时），可以通过配置改变这一点。</li>\n</ol>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 10:34</span> <a href=\"http://www.cnblogs.com/ywjy/\">何以堪</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7771042\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7771042);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=214561,cb_entryId=7771042,cb_blogApp=currentBlogApp,cb_blogUserGuid='f520952b-5cac-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/11/2 10:34:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 237, "image_url": ["https://pic.cnblogs.com/face/721161/20151217095040.png"], "date_pub": "2017-11-02", "article_common": 1}
{"title": "看了程序员的未来在哪里，有感（一）", "url": "http://www.cnblogs.com/senlinmu/p/7771080.html", "author": "Hello森林木", "article_desc": "程序员的未来在哪里？ 这里面透着茫然。 你问我未来在哪里，我指手画脚一通说，没用。 说说我的历程吧。 一、入行那一年 2013年入行，一开始在厦门的一个新三板的公司当普通的程序员。试用期2500，转正3000。 做了半年左右，我主动找经理谈话，希望涨工资。经理同意了。给了4500的工资。经理的原话大 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/senlinmu/p/7771080.html\">看了程序员的未来在哪里，有感（一）</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"程序员的未来在哪里\">程序员的未来在哪里？</h1>\n<p>这里面透着茫然。</p>\n<p>你问我未来在哪里，我指手画脚一通说，没用。</p>\n<p>说说我的历程吧。</p>\n<h2 id=\"一入行那一年\">一、入行那一年</h2>\n<p>2013年入行，一开始在厦门的一个新三板的公司当普通的程序员。试用期2500，转正3000。</p>\n<p>做了半年左右，我主动找经理谈话，希望涨工资。经理同意了。给了4500的工资。经理的原话大概是这样：“现在你和XX的水平差不多，就是相同的薪资”。</p>\n<p>那个同事，已经工作两年多，我试用期的时候2500，他4000。</p>\n<p>后来跟之前的朋友谈起这件事，那个朋友大吐槽说自己不懂，以为公司会自己涨。他离职的时候发现，水平比自己低，工作比自己懒的同事，工资居然比他高。</p>\n<p><strong>总结：涨薪该谈就得谈，有胆子、有底气。</strong></p>\n<h2 id=\"二入行第二年\">二、入行第二年</h2>\n<p>大概过了一年，我老婆怀孕，只好回老家，福建漳州，一个四线的小城市，进了一家小公司。整个技术部 就4个人。两个前端两个后端。</p>\n<p>新公司事情不多，老板是个业务型的，常常不在公司。所以闲下来的时候，那些同事就喝茶聊天，而我不，我看我的教程，我继续我的代码。</p>\n<p>时间久了，有些比较复杂的程序，其他人无法实现，而我可以。</p>\n<p>老板都不是傻子，看得出来，谁有能力。</p>\n<p>后来，提拔我当了部门经理。</p>\n<p>在新公司一共待了两年。公司业务不多，对有些人来说乐得开花，不用干事，白领工资。我也乐得开花，因为我有时间做我想做的事情。</p>\n<p>比如要做商城、论坛、综合门户，我可以花两个星期，看GITHUB上别人成熟的项目；然后再花4个星期，把别人的代码，一步步改成我需要的样子。</p>\n<p>看优秀项目的代码，并且改造项目的过程中，最是能提高代码能力。</p>\n<p>你会惊叹：原来可以这样这样写，原来还有这个内置函数，原来还有这个内置方法。以前很多自己想破头，搞出来的破东西，其实已经有成熟的第三方可以使用。</p>\n<p><strong>总结：成长之路，最有效的路径就是看优秀源码，并且动手实现它或者改造它。</strong></p>\n<h2 id=\"三入行第四年\">三、入行第四年</h2>\n<p>后来公司经营不善，解散了公司。</p>\n<p>而我却也不迷茫。</p>\n<p>为什么呢？</p>\n<p>在公司项目越来越少，并且时不时拖欠薪资的时候，我已经给自己注册了公司、给自己的公司做了官网。</p>\n<p>公司倒闭，所以，我自己当了老板。</p>\n<p>愁是什么？迷茫是什么？</p>\n<p><strong>总结：是你的偷懒，没有给自己留好后路，没有给自己定一个未来的方向！</strong></p>\n<p>未完待续</p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 10:40</span> <a href=\"http://www.cnblogs.com/senlinmu/\">Hello森林木</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7771080\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7771080);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=198199,cb_entryId=7771080,cb_blogApp=currentBlogApp,cb_blogUserGuid='b30fad32-9928-e211-aa8f-842b2b196315',cb_entryCreatedDate='2017/11/2 10:40:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 1450, "image_url": ["https://pic.cnblogs.com/face/465471/20130228173958.png"], "date_pub": "2017-11-02", "article_common": 6}
{"title": "Python CRM项目一", "url": "http://www.cnblogs.com/luhuajun/p/7771196.html", "author": "月上贺兰", "article_desc": "\r\n    开发环境: 运行环境 项目需求:重写Django Admin的功能,实现对表动态的增删改查,实现权限的动态分配,实现自定义Action,等一系列组件扩展功能 项目功能图: 项目表UML表关系图 models.py表关系创建 1 from django.db import models 2 from  ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/luhuajun/p/7771196.html\">Python CRM项目一</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>开发环境:</p>\n<ol>\n<li>语言Python3.X以上</li>\n<li>MTV WEB框架 Django</li>\n<li>前端框架 jQuery+bootstrap</li>\n<li>数据库 MySQL</li>\n</ol>\n<p>运行环境</p>\n<ol>\n<li>安装Python3.x</li>\n<li>安装Django</li>\n<li>除IE8以上的浏览器</li>\n</ol>\n<p>项目需求:重写Django Admin的功能,实现对表动态的增删改查,实现权限的动态分配,实现自定义Action,等一系列组件扩展功能</p>\n<p>项目功能图:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1173792/201711/1173792-20171102091750607-1224100710.png\" alt=\"\"></p>\n<p>项目表UML表关系图</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1173792/201711/1173792-20171102102400779-941570563.png\" alt=\"\"></p>\n<p>models.py表关系创建</p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_4b43689a-5118-4590-8cd7-dd5f4cf21cb7\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_4b43689a-5118-4590-8cd7-dd5f4cf21cb7\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_4b43689a-5118-4590-8cd7-dd5f4cf21cb7\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #008080\">  1</span> <span style=\"color: #0000ff\">from</span> django.db <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> models\n</span><span style=\"color: #008080\">  2</span> <span style=\"color: #0000ff\">from</span> django.contrib.auth.models <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> User\n</span><span style=\"color: #008080\">  3</span> <span style=\"color: #008000\">#</span><span style=\"color: #008000\"> Create your models here.</span>\n<span style=\"color: #008080\">  4</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Customer(models.Model):\n</span><span style=\"color: #008080\">  5</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">客户信息表</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\">  6</span>     name = models.CharField(max_length=32,null=True,blank=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\">  7</span>     qq = models.CharField(max_length=64,unique=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\">  8</span>     qq_name = models.CharField(max_length=64,null=True,blank=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\">  9</span>     phone = models.CharField(max_length=64,null=True,blank=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 10</span>     source_choices = ((0,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">转介绍</span><span style=\"color: #800000\">'</span>),(1,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">QQ群</span><span style=\"color: #800000\">'</span>),(2,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">官网</span><span style=\"color: #800000\">'</span>),(3,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">百度推广</span><span style=\"color: #800000\">'</span>),(4,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">51cto</span><span style=\"color: #800000\">'</span>),(5,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">知乎推荐</span><span style=\"color: #800000\">'</span>),(6,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">市场推广</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">))\n</span><span style=\"color: #008080\"> 11</span>     source = models.SmallIntegerField(choices=<span style=\"color: #000000\">source_choices)\n</span><span style=\"color: #008080\"> 12</span>     referral_from = models.CharField(verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">转介绍人QQ</span><span style=\"color: #800000\">'</span>,max_length=64,null=True,blank=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 13</span>     consult_course = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Course</span><span style=\"color: #800000\">'</span>,verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">咨询课程</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 14</span>     content = models.TextField(verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">咨询详情</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 15</span>     consultant = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">UserProfile</span><span style=\"color: #800000\">'</span>,verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">销售</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 16</span>     tags = models.ManyToManyField(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Tag</span><span style=\"color: #800000\">'</span>,blank=True,null=<span style=\"color: #000000\">True);\n</span><span style=\"color: #008080\"> 17</span>     memo = models.TextField(blank=True,null=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 18</span>     status_choice = ((<span style=\"color: #800000\">'</span><span style=\"color: #800000\">signed</span><span style=\"color: #800000\">'</span>,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">已报名</span><span style=\"color: #800000\">'</span>),(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">unregistered</span><span style=\"color: #800000\">'</span>,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">未报名</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">))\n</span><span style=\"color: #008080\"> 19</span>     status = models.CharField(max_length=64,choices=status_choice,default=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">unregistered</span><span style=\"color: #800000\">'</span>,verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">客户状态</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 20</span>     date = models.DateTimeField(auto_now_add=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 21</span> \n<span style=\"color: #008080\"> 22</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\"> 23</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">客户</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\"> 24</span> \n<span style=\"color: #008080\"> 25</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\"> 26</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> self.name\n</span><span style=\"color: #008080\"> 27</span> \n<span style=\"color: #008080\"> 28</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> CustomerFollowUp(models.Model):\n</span><span style=\"color: #008080\"> 29</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">客户跟进表</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\"> 30</span>     customer = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Customer</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 31</span>     content = models.TextField(verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">跟进内容</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 32</span>     consultant = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">UserProfile</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 33</span>     intention_choices = ((0,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">2周内报名</span><span style=\"color: #800000\">'</span>),(1,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">1个月报名</span><span style=\"color: #800000\">'</span>),(2,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">近期无报名计划</span><span style=\"color: #800000\">'</span>),(3,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">已在其他机构报名</span><span style=\"color: #800000\">'</span>),(4,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">已报名</span><span style=\"color: #800000\">'</span>),(5,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">已拉黑</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">))\n</span><span style=\"color: #008080\"> 34</span>     intention = models.SmallIntegerField(choices=<span style=\"color: #000000\">intention_choices)\n</span><span style=\"color: #008080\"> 35</span>     date = models.DateTimeField(auto_now_add=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 36</span> \n<span style=\"color: #008080\"> 37</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\"> 38</span>         <span style=\"color: #0000ff\">return</span> <span style=\"color: #800000\">'</span><span style=\"color: #800000\">%s %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (self.customer.qq, self.intention)\n</span><span style=\"color: #008080\"> 39</span> \n<span style=\"color: #008080\"> 40</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\"> 41</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">客户跟进记录</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\"> 42</span> \n<span style=\"color: #008080\"> 43</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Course(models.Model):\n</span><span style=\"color: #008080\"> 44</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">课程表</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\"> 45</span>     name = models.CharField(max_length=128,unique=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 46</span>     price =<span style=\"color: #000000\"> models.PositiveSmallIntegerField()\n</span><span style=\"color: #008080\"> 47</span>     period = models.PositiveSmallIntegerField(verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">周期(月)</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 48</span>     outline =<span style=\"color: #000000\"> models.TextField()\n</span><span style=\"color: #008080\"> 49</span> \n<span style=\"color: #008080\"> 50</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\"> 51</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> self.name\n</span><span style=\"color: #008080\"> 52</span> \n<span style=\"color: #008080\"> 53</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\"> 54</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">课程</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\"> 55</span> \n<span style=\"color: #008080\"> 56</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Branch(models.Model):\n</span><span style=\"color: #008080\"> 57</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">校区表</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\"> 58</span>     name = models.CharField(max_length=128,unique=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 59</span>     addr = models.CharField(max_length=512<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 60</span> \n<span style=\"color: #008080\"> 61</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\"> 62</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> self.name\n</span><span style=\"color: #008080\"> 63</span> \n<span style=\"color: #008080\"> 64</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\"> 65</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">校区</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\"> 66</span> \n<span style=\"color: #008080\"> 67</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> ClassList(models.Model):\n</span><span style=\"color: #008080\"> 68</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">班级表</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\"> 69</span>     branch = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Branch</span><span style=\"color: #800000\">'</span>,verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">分校</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 70</span>     course = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Course</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 71</span>     semester = models.PositiveSmallIntegerField(verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">学期</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 72</span>     teachers =  models.ManyToManyField(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">UserProfile</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 73</span>     class_type_choice = ((0,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">面授班(脱产)</span><span style=\"color: #800000\">'</span>),(1,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">面授班(周末)</span><span style=\"color: #800000\">'</span>),(2,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">网络班</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">))\n</span><span style=\"color: #008080\"> 74</span>     class_type = models.SmallIntegerField(choices=<span style=\"color: #000000\">class_type_choice)\n</span><span style=\"color: #008080\"> 75</span>     start_date = models.DateField(verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">开班日期</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 76</span>     end_date = models.DateField(verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">结业日期</span><span style=\"color: #800000\">'</span>,blank=True,null=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 77</span> \n<span style=\"color: #008080\"> 78</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\"> 79</span>         <span style=\"color: #0000ff\">return</span> <span style=\"color: #800000\">'</span><span style=\"color: #800000\">%s %s %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (self.branch, self.course, self.semester)\n</span><span style=\"color: #008080\"> 80</span> \n<span style=\"color: #008080\"> 81</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\"> 82</span>         unique_together = (<span style=\"color: #800000\">'</span><span style=\"color: #800000\">branch</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">course</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">semester</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 83</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">班级</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\"> 84</span> \n<span style=\"color: #008080\"> 85</span> \n<span style=\"color: #008080\"> 86</span> \n<span style=\"color: #008080\"> 87</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> CourseRecord(models.Model):\n</span><span style=\"color: #008080\"> 88</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">上课记录表</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\"> 89</span>     from_class = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">ClassList</span><span style=\"color: #800000\">'</span>,verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">班级</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 90</span>     day_num = models.PositiveSmallIntegerField(verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">第几节(天)</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 91</span>     teacher = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">UserProfile</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 92</span>     has_homework = models.BooleanField(default=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 93</span>     homework_title = models.CharField(max_length=256,blank=True,null=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 94</span>     homework_content = models.TextField(blank=True,null=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 95</span>     outline = models.TextField(verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">本节课大纲</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 96</span>     date = models.DateTimeField(auto_now_add=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\"> 97</span> \n<span style=\"color: #008080\"> 98</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\"> 99</span>         <span style=\"color: #0000ff\">return</span> <span style=\"color: #800000\">'</span><span style=\"color: #800000\">%s %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (self.from_class, self.day_num)\n</span><span style=\"color: #008080\">100</span> \n<span style=\"color: #008080\">101</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\">102</span>         unique_together = (<span style=\"color: #800000\">'</span><span style=\"color: #800000\">from_class</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">day_num</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">103</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">上课记录</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\">104</span> \n<span style=\"color: #008080\">105</span> \n<span style=\"color: #008080\">106</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> StudyRecord(models.Model):\n</span><span style=\"color: #008080\">107</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">学习记录表</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\">108</span>     student = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Enrollment</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">109</span>     course_record = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">CourseRecord</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">110</span>     attendance_choice = ((0,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">已签到</span><span style=\"color: #800000\">'</span>),(1,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">迟到</span><span style=\"color: #800000\">'</span>),(2,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">缺勤</span><span style=\"color: #800000\">'</span>),(3,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">早退</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">))\n</span><span style=\"color: #008080\">111</span>     attendance = models.SmallIntegerField(choices=attendance_choice,default=<span style=\"color: #000000\">0)\n</span><span style=\"color: #008080\">112</span>     score_choices = ((100,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">A+</span><span style=\"color: #800000\">'</span>),(90,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">A</span><span style=\"color: #800000\">'</span>),(85,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">B+</span><span style=\"color: #800000\">'</span>),(80,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">B</span><span style=\"color: #800000\">'</span>),(75,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">B-</span><span style=\"color: #800000\">'</span>),(70,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">C+</span><span style=\"color: #800000\">'</span>),(60,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">C</span><span style=\"color: #800000\">'</span>),(40,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">C-</span><span style=\"color: #800000\">'</span>),(-50,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">D</span><span style=\"color: #800000\">'</span>),(-100,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">COPY</span><span style=\"color: #800000\">'</span>),(0,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">N/A</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">))\n</span><span style=\"color: #008080\">113</span>     score = models.SmallIntegerField(choices=<span style=\"color: #000000\">score_choices)\n</span><span style=\"color: #008080\">114</span>     memo = models.TextField(blank=True,null=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\">115</span>     date = models.DateTimeField(auto_now_add=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\">116</span> \n<span style=\"color: #008080\">117</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\">118</span>         <span style=\"color: #0000ff\">return</span> <span style=\"color: #800000\">'</span><span style=\"color: #800000\">%s %s %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (self.student, self.course_record, self.score)\n</span><span style=\"color: #008080\">119</span> \n<span style=\"color: #008080\">120</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\">121</span>         unique_together = (<span style=\"color: #800000\">'</span><span style=\"color: #800000\">student</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">course_record</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">122</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">学习记录</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\">123</span> \n<span style=\"color: #008080\">124</span> \n<span style=\"color: #008080\">125</span> \n<span style=\"color: #008080\">126</span> \n<span style=\"color: #008080\">127</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Enrollment(models.Model):\n</span><span style=\"color: #008080\">128</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">学生报名表(学生报名信息,合同,入学日期,所报班级)</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\">129</span>     customer = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Customer</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">130</span>     enrolled_class = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">ClassList</span><span style=\"color: #800000\">'</span>,verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">所报班级</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">131</span>     consultant = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">UserProfile</span><span style=\"color: #800000\">'</span>,verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">课程顾问</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">132</span>     contact_agreed = models.BooleanField(default=False,verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">学生已同意合同条款</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">133</span>     contact_approved = models.BooleanField(default=False,verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">合同已审核</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">134</span>     date = models.DateTimeField(auto_now_add=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\">135</span> \n<span style=\"color: #008080\">136</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\">137</span>         <span style=\"color: #0000ff\">return</span> <span style=\"color: #800000\">'</span><span style=\"color: #800000\">%s %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (self.customer, self.enrolled_class)\n</span><span style=\"color: #008080\">138</span> \n<span style=\"color: #008080\">139</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\">140</span>         unique_together = (<span style=\"color: #800000\">'</span><span style=\"color: #800000\">customer</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">enrolled_class</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">141</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">报名</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\">142</span> \n<span style=\"color: #008080\">143</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Payment(models.Model):\n</span><span style=\"color: #008080\">144</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">缴费记录</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\">145</span>     customer = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Customer</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">146</span>     course = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Course</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">147</span>     amount = models.PositiveIntegerField(verbose_name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">数额</span><span style=\"color: #800000\">'</span>,default=500<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">148</span>     consultant = models.ForeignKey(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">UserProfile</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">149</span>     date = models.DateTimeField(auto_now_add=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\">150</span> \n<span style=\"color: #008080\">151</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\">152</span>         <span style=\"color: #0000ff\">return</span> <span style=\"color: #800000\">'</span><span style=\"color: #800000\">%s %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (self.customer, self.amount)\n</span><span style=\"color: #008080\">153</span> \n<span style=\"color: #008080\">154</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\">155</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">缴费记录</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\">156</span> \n<span style=\"color: #008080\">157</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> UserProfile(models.Model):\n</span><span style=\"color: #008080\">158</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">账号表</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\">159</span>     user =<span style=\"color: #000000\"> models.OneToOneField(User)\n</span><span style=\"color: #008080\">160</span>     name = models.CharField(max_length=32<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">161</span>     roles = models.ManyToManyField(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Role</span><span style=\"color: #800000\">'</span>,blank=True,null=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\">162</span> \n<span style=\"color: #008080\">163</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\">164</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> self.name\n</span><span style=\"color: #008080\">165</span> \n<span style=\"color: #008080\">166</span> \n<span style=\"color: #008080\">167</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Role(models.Model):\n</span><span style=\"color: #008080\">168</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">角色表</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\">169</span>     name = models.CharField(max_length=64,unique=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\">170</span> \n<span style=\"color: #008080\">171</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\">172</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> self.name\n</span><span style=\"color: #008080\">173</span> \n<span style=\"color: #008080\">174</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\">175</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">角色</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\">176</span> \n<span style=\"color: #008080\">177</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Tag(models.Model):\n</span><span style=\"color: #008080\">178</span>     <span style=\"color: #800000\">'''</span><span style=\"color: #800000\">标签备注</span><span style=\"color: #800000\">'''</span>\n<span style=\"color: #008080\">179</span>     name = models.CharField(max_length=64,unique=<span style=\"color: #000000\">True)\n</span><span style=\"color: #008080\">180</span> \n<span style=\"color: #008080\">181</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__str__</span><span style=\"color: #000000\">(self):\n</span><span style=\"color: #008080\">182</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> self.name\n</span><span style=\"color: #008080\">183</span>     <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Meta:\n</span><span style=\"color: #008080\">184</span>         verbose_name_plural = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">标签</span><span style=\"color: #800000\">'</span></pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<p>在Settings文件中配置静态文件路径</p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_9bf19b3b-eaf6-4d4c-918c-cfd8460c152a\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_9bf19b3b-eaf6-4d4c-918c-cfd8460c152a\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_9bf19b3b-eaf6-4d4c-918c-cfd8460c152a\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #008080\">1</span> STATIC_URL = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">/static/</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\">2</span> STATICFILES_DIRS =<span style=\"color: #000000\">(\n</span><span style=\"color: #008080\">3</span>     os.path.join(BASE_DIR,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">static</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">),\n</span><span style=\"color: #008080\">4</span> )</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<p>更改默认的数据库</p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_42b30b8c-7559-4ee9-a636-58f8b94ab127\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_42b30b8c-7559-4ee9-a636-58f8b94ab127\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_42b30b8c-7559-4ee9-a636-58f8b94ab127\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #008080\"> 1</span> DATABASES =<span style=\"color: #000000\"> {\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #800000\">'</span><span style=\"color: #800000\">default</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">: {\n</span><span style=\"color: #008080\"> 3</span>         <span style=\"color: #800000\">'</span><span style=\"color: #800000\">ENGINE</span><span style=\"color: #800000\">'</span>: <span style=\"color: #800000\">'</span><span style=\"color: #800000\">django.db.backends.mysql</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 4</span>         <span style=\"color: #800000\">'</span><span style=\"color: #800000\">NAME</span><span style=\"color: #800000\">'</span>: <span style=\"color: #800000\">'</span><span style=\"color: #800000\">prefect_crm</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 5</span>         <span style=\"color: #800000\">'</span><span style=\"color: #800000\">USER</span><span style=\"color: #800000\">'</span>: <span style=\"color: #800000\">'</span><span style=\"color: #800000\">root</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 6</span>         <span style=\"color: #800000\">'</span><span style=\"color: #800000\">PASSWORD</span><span style=\"color: #800000\">'</span>: <span style=\"color: #800000\">'</span><span style=\"color: #800000\">oldboy</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 7</span>         <span style=\"color: #800000\">'</span><span style=\"color: #800000\">HOST</span><span style=\"color: #800000\">'</span>: <span style=\"color: #800000\">'</span><span style=\"color: #800000\">127.0.0.1</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 8</span>         <span style=\"color: #800000\">'</span><span style=\"color: #800000\">PORT</span><span style=\"color: #800000\">'</span>: <span style=\"color: #800000\">'</span><span style=\"color: #800000\">3306</span><span style=\"color: #800000\">'</span>\n<span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">10</span> }</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<p>在app下的__init__.py中插入</p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_57801764-bcf3-47d8-9458-267d510739fe\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_57801764-bcf3-47d8-9458-267d510739fe\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_57801764-bcf3-47d8-9458-267d510739fe\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> pymysql\n</span><span style=\"color: #008080\">2</span> pymysql.install_as_MySQLdb()</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 11:01</span> <a href=\"http://www.cnblogs.com/luhuajun/\">月上贺兰</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7771196\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7771196);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=358309,cb_entryId=7771196,cb_blogApp=currentBlogApp,cb_blogUserGuid='c14f2657-6838-4b27-ee1e-08d49c350eca',cb_entryCreatedDate='2017/11/2 11:01:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 277, "image_url": ["https:"], "date_pub": "2017-11-02", "article_common": 4}
{"title": "Elasticsearch索引别名、Filtered索引别名、Template", "url": "http://www.cnblogs.com/kangoroo/p/7768221.html", "author": "扎心了老铁", "article_desc": "在使用elasticsearch的时候，经常会遇到需要淘汰掉历史数据的场景。 为了方便数据淘汰，并使得数据管理更加灵活，我们经常会以时间为粒度建立索引，例如： 每个月建立一个索引：monthly-201709、monthly-201710、monthly-201711 每天建立一个索引：daily- ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/kangoroo/p/7768221.html\">Elasticsearch索引别名、Filtered索引别名、Template</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><span style=\"font-size: 15px\">在使用elasticsearch的时候，经常会遇到需要淘汰掉历史数据的场景。</span></p>\n<p><span style=\"font-size: 15px\">为了方便数据淘汰，并使得数据管理更加灵活，我们经常会以时间为粒度建立索引，例如：</span></p>\n<ul>\n<li><span style=\"font-size: 14px\"><strong>每个月建立一个索引：monthly-201709、monthly-201710、monthly-201711</strong></span></li>\n<li><span style=\"font-size: 14px\"><strong>每天建立一个索引：daily-20171015、daily-20171016、daily-20171017、daily-20171018</strong></span></li>\n</ul>\n<p><span style=\"font-size: 15px\">当不需要再继续使用历史数据的时候，我们就可以将索引删除，释放资源。</span></p>\n<p> </p>\n<p><span style=\"font-size: 15px\">为了很好的支撑这个场景，需要使用到Elasticsearch里的两个东西，索引别名和Template。</span></p>\n<ul>\n<li><span style=\"font-size: 14px\"><strong>索引别名：建立索引对外的统一视图</strong></span></li>\n</ul>\n<p><span style=\"font-size: 15px\">例如，如果建立了上述类似的索引时间序列，在查询的时候以wildcards的方式指定索引，例如index=monthly-*，或者index=daily-201710*。</span><span style=\"font-size: 15px\">当然也可以使用索引别名index=monthly。</span></p>\n<ul>\n<li><span style=\"font-size: 14px\"><strong>Template：修改建立索引的默认配置</strong></span></li>\n</ul>\n<p><span style=\"font-size: 15px\">例如，你不想承担定期去维护索引的风险和工作量，可以在插入数据时自动创建索引，Template可以提供自动创建索引时候的默认配置。</span></p>\n<p> </p>\n<p><span style=\"font-size: 15px\">下面详细解释一下。</span></p>\n<p> </p>\n<p><span style=\"font-size: 18px\"><em><strong>1、索引别名</strong></em></span></p>\n<p><span style=\"font-size: 15px\">一个索引别名就好比一个快捷方式(Shortcut)或一个符号链接(Symbolic Link)，索引别名可以指向一个或者多个索引，可以在任何需要索引名的API中使用。使用别名可以给我们非常多的灵活性。它能够让我们：</span></p>\n<ul class=\"task-list\">\n<li><span style=\"font-size: 15px\">在一个运行的集群中透明地从一个索引切换到另一个索引</span></li>\n<li><span style=\"font-size: 15px\">让多个索引形成一个组，比如<code>last_three_months</code></span></li>\n<li><span style=\"font-size: 15px\">为一个索引中的一部分文档创建一个视图(View)</span></li>\n</ul>\n<p><span style=\"font-size: 15px\"> </span></p>\n<p><span style=\"font-size: 15px\">如何创建索引别名呢？</span></p>\n<p><span style=\"font-size: 16px\"><strong>1）创建索引</strong></span></p>\n<p><span style=\"font-size: 15px\">我这里创建audit-201710、audit-201711两个索引</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XPOST <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">http://10.93.21.21:8049/kangaroo-201710?pretty</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\ncurl </span>-XPOST <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">http://10.93.21.21:8049/kangaroo-201711?pretty</span><span style=\"color: #800000\">\"</span></span></pre>\n</div>\n<p><span style=\"font-size: 15px\">如果安装了head，你可以在可视化页面看到</span></p>\n<p><span style=\"font-size: 15px\"><img src=\"http://images2017.cnblogs.com/blog/1061021/201711/1061021-20171101205257748-852256013.png\" alt=\"\"></span></p>\n<p><span style=\"font-size: 15px\">从索引信息可以看到，我们没有配置mapping和alias，shards和replicas也使用的默认值。</span></p>\n<p><span style=\"font-size: 16px\"><strong>2）建立索引别名</strong></span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XPOST <span style=\"color: #800000\">'</span><span style=\"color: #800000\">http://10.93.21.21:8049/_aliases</span><span style=\"color: #800000\">'</span> -d <span style=\"color: #800000\">'\n</span><span style=\"color: #000000\">{\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">actions</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: [\n        {</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">add</span><span style=\"color: #800000\">\"</span>: {<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">index</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">kangaroo-201710</span><span style=\"color: #800000\">\"</span>, <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">alias</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">kangaroo</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">}},\n        {</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">add</span><span style=\"color: #800000\">\"</span>: {<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">index</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">kangaroo-201711</span><span style=\"color: #800000\">\"</span>, <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">alias</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">kangaroo</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">}} \n    ]\n}</span><span style=\"color: #800000\">'</span></span></pre>\n</div>\n<p><span style=\"font-size: 15px\">这样就对kangaroo-201710和kangaroo-201711建立了索引别名kangaroo，再看head可视化</span></p>\n<p><span style=\"font-size: 15px\"><img src=\"http://images2017.cnblogs.com/blog/1061021/201711/1061021-20171101210345732-786190487.png\" alt=\"\"></span></p>\n<p><span style=\"font-size: 15px\">可以看到索引别名已经建立。</span></p>\n<p><span style=\"font-size: 16px\"><strong>3）注意</strong></span></p>\n<p><span style=\"font-size: 15px\">写：不能直接对索引别名进行写入。所以在写数据的时候，要直接使用普通索引。</span></p>\n<p><span style=\"font-size: 15px\">读：查询，对索引别名进行查询，查询会透明的下发到别名下挂的所有索引执行，设置的路由也会随之下发。</span></p>\n<p> </p>\n<p><em><span style=\"font-size: 18px\"><strong>2、带filtered的索引别名</strong></span></em></p>\n<p><span style=\"font-size: 15px\">对于同一个索引，例如zoo，我们如何给不同人看到不同的数据，即，所谓的多租户。</span></p>\n<p><span style=\"font-size: 15px\"> </span></p>\n<p><span style=\"font-size: 15px\">假设索引zoo的数据有个字段是group，group字段记录了该数据是那个“租户”的。多租户之间的数据应该是不可见的。</span></p>\n<p><span style=\"font-size: 15px\">我们模拟一下这个场景</span></p>\n<p><span style=\"font-size: 16px\"><strong>1）创建索引zoo</strong></span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XPOST <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">http://10.93.21.21:8049/zoo?pretty</span><span style=\"color: #800000\">\"</span> </span></pre>\n</div>\n<p><span style=\"font-size: 16px\"><strong>2）设置mappings</strong></span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XPOST <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">http://10.93.21.21:8049/zoo/animal/_mapping?pretty</span><span style=\"color: #800000\">\"</span> -d <span style=\"color: #800000\">'\n</span><span style=\"color: #000000\">{ \n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">animal</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">properties</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n            </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">name</span><span style=\"color: #800000\">\"</span>: {<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">type</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">string</span><span style=\"color: #800000\">\"</span>, index: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">not_analyzed</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">},\n            </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">group</span><span style=\"color: #800000\">\"</span>: {<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">type</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">string</span><span style=\"color: #800000\">\"</span>, index: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">not_analyzed</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">}\n        }\n    }\n}</span><span style=\"color: #800000\">'</span></span></pre>\n</div>\n<p><span style=\"font-size: 16px\"><strong>3）设置带filter的别名</strong></span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XPOST <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">http://10.93.21.21:8049/_aliases?pretty</span><span style=\"color: #800000\">\"</span> -d <span style=\"color: #800000\">'\n</span><span style=\"color: #000000\">{\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">actions</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: [\n    {\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">add</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">index</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">zoo</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">alias</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">zoo_animal_vegetarian</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">filter</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:{\n            </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">term</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:{\n                </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">group</span><span style=\"color: #800000\">\"</span>:<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">vegetarian</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n            }\n        }\n      }\n    },\n    {\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">add</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">index</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">zoo</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">alias</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">zoo_animal_carnivorous</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">filter</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:{\n            </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">term</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:{\n                </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">group</span><span style=\"color: #800000\">\"</span>:<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">carnivorous</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n            }\n        }\n      }\n    }\n  ]\n}</span><span style=\"color: #800000\">'</span></span></pre>\n</div>\n<p><span style=\"font-size: 15px\">通过head看一下</span></p>\n<p><span style=\"font-size: 15px\"><img src=\"http://images2017.cnblogs.com/blog/1061021/201711/1061021-20171102122724841-1806535758.png\" alt=\"\"></span></p>\n<p><span style=\"font-size: 15px\"> </span></p>\n<p><span style=\"font-size: 15px\"><strong>我们索引两条数据进去</strong></span></p>\n<p><span style=\"font-size: 15px\">老虎-肉食</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XPUT <span style=\"color: #800000\">'</span><span style=\"color: #800000\">http://10.93.21.21:8049/zoo/animal/1</span><span style=\"color: #800000\">'</span> -d <span style=\"color: #800000\">'</span><span style=\"color: #800000\">{</span>\n    <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">name</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">tiger</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">group</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">carnivorous</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n}</span><span style=\"color: #800000\">'</span></span></pre>\n</div>\n<p><span style=\"font-size: 15px\">兔子-素食</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XPUT <span style=\"color: #800000\">'</span><span style=\"color: #800000\">http://10.93.21.21:8049/zoo/animal/2</span><span style=\"color: #800000\">'</span> -d <span style=\"color: #800000\">'</span><span style=\"color: #800000\">{</span>\n    <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">name</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">rabbit</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">group</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">vegetarian</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n}</span><span style=\"color: #800000\">'</span></span></pre>\n</div>\n<p><span style=\"font-size: 15px\"><strong>使用带filter的索引查一下</strong></span></p>\n<p><span style=\"font-size: 15px\">素食的只有兔子</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XGET <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">http://10.93.21.21:8049/zoo_animal_vegetarian/_search?pretty</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n{\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">took</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">32</span><span style=\"color: #000000\">,\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">timed_out</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">,\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_shards</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">total</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">5</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">successful</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">5</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">failed</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">0</span><span style=\"color: #000000\">\n  },\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">hits</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">total</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">1</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">max_score</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">1.0</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">hits</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : [ {\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_index</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">zoo</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_type</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">animal</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_id</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">2</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_score</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">1.0</span><span style=\"color: #000000\">,\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_source</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:{\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">name</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">rabbit</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">group</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">vegetarian</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n}\n    } ]\n  }\n}</span></span></pre>\n</div>\n<p><span style=\"font-size: 15px\">肉食的只有老虎</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XGET <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">http://10.93.21.21:8049/zoo_animal_carnivorous/_search?pretty</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n{\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">took</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">33</span><span style=\"color: #000000\">,\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">timed_out</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">,\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_shards</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">total</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">5</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">successful</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">5</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">failed</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">0</span><span style=\"color: #000000\">\n  },\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">hits</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">total</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">1</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">max_score</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">1.0</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">hits</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : [ {\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_index</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">zoo</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_type</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">animal</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_id</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">1</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_score</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">1.0</span><span style=\"color: #000000\">,\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_source</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:{\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">name</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">tiger</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">group</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">carnivorous</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n}\n    } ]\n  }\n}</span></span></pre>\n</div>\n<p> </p>\n<p> </p>\n<p> </p>\n<p><span style=\"font-size: 15px\">当你建立索引时间序列的时候，遇到的问题是，需要不断的建立新索引，例如到了11月份，你可以需要新建kangaroo-201711这个索引。</span></p>\n<p><span style=\"font-size: 15px\">当然，如果不创建索引，直接写入数据的话，ES会为你分析你写入的document的字段类型，并使用默认配置建立索引。</span></p>\n<p><span style=\"font-size: 15px\">但是默认配置可能并不是你想要的。例如ES对string类型默认是分析的，即，对string类型会进行分词，但是你的数据中可能有一些string类型的字段不希望被分析。</span></p>\n<p><span style=\"font-size: 15px\">那么怎么修改默认配置呢？可以创建一个template。</span></p>\n<p><span style=\"font-size: 15px\"> </span></p>\n<p><span style=\"font-size: 18px\"><em><strong>3、Template</strong></em></span></p>\n<p><span style=\"font-size: 15px\">template可以修改索引的默认配置。我们以下面这个template为例说明一下。</span></p>\n<p><span style=\"font-size: 15px\">1）我们建立了一个template名称为kangaroo_template</span></p>\n<p><span style=\"font-size: 15px\">2）\"template\": \"kangaroo*\"，表示对于所有以kangaroo*开头的索引，默认配置使用template中的配置。</span></p>\n<p><span style=\"font-size: 15px\">3）\"settings\"，\"mappings\"，\"aliases\"，可以修改这些类型的默认配置</span></p>\n<p><span style=\"font-size: 15px\">4）禁用了_source，对name字段设置string类型且不分析，索引别名设置为kangaroo</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XPUT <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">http://10.93.21.21:8049/_template/kangaroo_template?pretty</span><span style=\"color: #800000\">\"</span> -d <span style=\"color: #800000\">'</span><span style=\"color: #800000\">{</span>\n  <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">template</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">kangaroo*</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">settings</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">number_of_shards</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800080\">10</span><span style=\"color: #000000\">\n  },\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">mappings</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">data</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_source</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">enabled</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">\n      },\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">properties</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">name</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n          </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">type</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">string</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n          </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">index</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">not_analyzed</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n        },\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">id</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">: {\n          </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">type</span><span style=\"color: #800000\">\"</span>: <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">long</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n        }\n      }\n    }\n  },\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">aliases</span><span style=\"color: #800000\">\"</span>: {<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">kangaroo</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:{}}\n}</span><span style=\"color: #800000\">'</span></span></pre>\n</div>\n<p><span style=\"font-size: 15px\">执行生效后，看一下template生效的内容，这里注意有一个\"order\"字段，该字段跟多template合并有关，后面我们会讲。</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XGET <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">http://10.93.21.21:8049/_template/kangaroo_template?pretty</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n{\n  </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">kangaroo_template</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">order</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800080\">0</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">template</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">kangaroo*</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">settings</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">index</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">number_of_shards</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">10</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n      }\n    },\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">mappings</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">data</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">_source</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n          </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">enabled</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">\n        },\n        </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">properties</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n          </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">name</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n            </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">index</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">not_analyzed</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n            </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">type</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">string</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n          },\n          </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">id</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n            </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">type</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">long</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n          }\n        }\n      }\n    },\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">aliases</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : {\n      </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">kangaroo</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> : { }\n    }\n  }\n}</span></span></pre>\n</div>\n<p><span style=\"font-size: 15px\">我们可以向一个不存在的索引写入数据，这个操作会使用默认配置，如果索引名称命中template中的规则，就会使用template的配置创建索引。</span></p>\n<p><span style=\"font-size: 15px\">这里我们向kangaroo-201712写入数据，会命中之前创建的kangaroo_template。</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 15px\">curl -XPUT <span style=\"color: #800000\">'</span><span style=\"color: #800000\">http://10.93.21.21:8049/kangaroo-201712/data/1</span><span style=\"color: #800000\">'</span> -d <span style=\"color: #800000\">'</span><span style=\"color: #800000\">{</span>\n    <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">name</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">yang</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">id</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">1001</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,\n    </span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">weight</span><span style=\"color: #800000\">\"</span> : <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">70 kg</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n}</span><span style=\"color: #800000\">'</span></span></pre>\n</div>\n<p><span style=\"font-size: 15px\">通过head看一下，可以看到，索引别名已经建立，分片数=10，source禁用生效，name不分析。这就是我们想要的结果。</span></p>\n<p><span style=\"font-size: 15px\"><img src=\"http://images2017.cnblogs.com/blog/1061021/201711/1061021-20171101223739670-1552288588.png\" alt=\"\" width=\"435\" height=\"666\"></span></p>\n<p><span style=\"font-size: 15px\"> </span></p>\n<p><span style=\"font-size: 16px\"><strong>多个template配置的合并</strong></span></p>\n<p><span style=\"font-size: 15px\">这个场景是这样的，一个索引命中了多个template配置，例如：有两个template配置分别为：a*, ab*，那么如果有一个索引名字是abc，就会命中了两个template，这时候会怎么样呢？</span></p>\n<p><span style=\"font-size: 15px\">配置会merge，merge的法则可以参见<a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-templates.html\" target=\"_blank\">官方文档</a>，简单来说，就是跟order值有关，较小order值的配置会先生效，较大order值的配置会继而覆盖。</span></p>\n<p><span style=\"font-size: 15px\"> </span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 11:01</span> <a href=\"http://www.cnblogs.com/kangoroo/\">扎心了老铁</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7768221\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7768221);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=316323,cb_entryId=7768221,cb_blogApp=currentBlogApp,cb_blogUserGuid='a32874ef-71a6-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/2 11:01:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div>\r\n<!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 142, "image_url": ["https://pic.cnblogs.com/face/1061021/20170802161652.png"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "学习一门新语言需要了解的基础-14 匿名函数", "url": "http://www.cnblogs.com/lyj/p/foundation_14_anonymous_function.html", "author": "李永京", "article_desc": "本节内容  - 匿名函数符号名 - 匿名函数调用方式 - 作为返回值的匿名函数 - 直接调用匿名函数 ...", "content": "<div id=\"post_detail\">\r\n<div class=\"post\" id=\"post\">\r\n    <a name=\"top\"></a>\r\n    <h2><a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/lyj/p/foundation_14_anonymous_function.html\">学习一门新语言需要了解的基础-14 匿名函数</a></h2>\r\n    <small>2017-11-02 10:15 by 李永京, <span id=\"post_view_count\">...</span> 阅读, <span id=\"post_comment_count\">...</span> 评论, <a href=\"#\" onclick=\"AddToWz(7751339);return false;\">收藏</a>,  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7751339\" rel=\"nofollow\">编辑</a></small>\r\n    <div class=\"entry\">\r\n        <div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>本节内容</p>\n<ul>\n<li>匿名函数符号名</li>\n<li>匿名函数调用方式[付费阅读]</li>\n<li>作为返回值的匿名函数</li>\n<li>直接调用匿名函数</li>\n</ul>\n<p>普通函数和匿名函数有什么不同？像js里面大量使用匿名函数，Java或者C#类似Lambda表达式，匿名函数已经成为现在语言很重点的标志。为什么会有匿名函数。</p>\n<p>匿名函数编译器会生成随机的符号名，调用上会有差别么？普通函数和匿名函数会有性能差别？今天就验证这个事情。</p>\n<p>go语言算是规则比较少的语言，所以使用它验证具有一定的代表性，虽然不是和其他语言一模一样，但是这种思路具有代表性。就用go语言作为例子：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode bash\"><code class=\"sourceCode bash\">$ <span class=\"kw\">cat</span> test.go </code></pre></div>\n<div class=\"sourceCode\"><pre class=\"sourceCode go\"><code class=\"sourceCode go\"><span class=\"kw\">package</span> main\n\n<span class=\"kw\">func</span> test() <span class=\"kw\">func</span>(<span class=\"dt\">int</span>) <span class=\"dt\">int</span> {\n    <span class=\"kw\">return</span> <span class=\"kw\">func</span>(x <span class=\"dt\">int</span>) <span class=\"dt\">int</span> {\n        x += <span class=\"dv\">100</span>\n        <span class=\"kw\">return</span> x\n    }\n}\n\n<span class=\"kw\">func</span> main() {\n<span class=\"co\">//    func() {</span>\n<span class=\"co\">//        println(\"hello, world!\");</span>\n<span class=\"co\">//    }()</span>\n\n    f := test()\n    z := f(<span class=\"dv\">100</span>)\n    <span class=\"fu\">println</span>(z)\n}</code></pre></div>\n<p>这是很简单匿名函数做法，test返回一个匿名函数，然后调用这个匿名函数。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode bash\"><code class=\"sourceCode bash\">$ <span class=\"kw\">go</span> build -gcflags <span class=\"st\">\"-N -l -m\"</span> -o test test.go <span class=\"co\">#编译，-m输出哪些优化信息</span></code></pre></div>\n<p>起码我们搞明白一点是匿名函数有符号名。</p>\n<h2 id=\"匿名函数符号名\">匿名函数符号名</h2>\n<p>包名.在哪个函数下创建的.func1</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode bash\"><code class=\"sourceCode bash\">$ <span class=\"kw\">nm</span> test <span class=\"kw\">|</span> <span class=\"kw\">grep</span> <span class=\"st\">\"main\\.\"</span> <span class=\"co\">#查看符号</span></code></pre></div>\n<pre><code>0000000000450a80 T main.init\n00000000004c9800 B main.initdone.\n00000000004509d0 T main.main\n00000000004509b0 T main.test\n0000000000450a40 T main.test.func1\n00000000004476e0 T runtime.main.func1\n0000000000447730 T runtime.main.func2</code></pre>\n<p>带runtime的我们不管，main.init、main.initdone系统生成的不管，main.main、main.test是代码里有的。<br>\nT代表text代表代码，R代表readonly代表数据。main.test.func1就是由编译器生成的随机的符号名。</p>\n<h2 id=\"匿名函数调用方式付费阅读\">匿名函数调用方式[付费阅读]</h2>\n<h2 id=\"作为返回值的匿名函数\">作为返回值的匿名函数</h2>\n<p>作为返回值的匿名函数并不是函数地址，而是个包装对象。</p>\n<h2 id=\"直接调用匿名函数\">直接调用匿名函数</h2>\n<p>如果我们直接调用匿名函数的时候，会有什么区别呢？</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode bash\"><code class=\"sourceCode bash\">$ <span class=\"kw\">vim</span> test.go <span class=\"co\">#使用println(\"hello, world!\");段代码</span></code></pre></div>\n<div class=\"sourceCode\"><pre class=\"sourceCode bash\"><code class=\"sourceCode bash\">$ <span class=\"kw\">go</span> build -gcflags <span class=\"st\">\"-N -l -m\"</span> -o test test.go <span class=\"co\">#编译</span></code></pre></div>\n<div class=\"sourceCode\"><pre class=\"sourceCode bash\"><code class=\"sourceCode bash\">$ <span class=\"kw\">gdb</span> test\n$ <span class=\"kw\">l</span>\n$ <span class=\"kw\">l</span>\n$ <span class=\"kw\">b</span> 11 <span class=\"co\">#打断点</span>\n$ <span class=\"kw\">r</span> <span class=\"co\">#执行</span>\n$ <span class=\"kw\">set</span> <span class=\"kw\">disassembly-flavor</span> intel <span class=\"co\">#设置intel样式</span>\n$ <span class=\"kw\">disass</span> <span class=\"co\">#反汇编</span></code></pre></div>\n<pre><code>Dump of assembler code for function main.main.func1:\n=&gt; 0x0000000000450a90 &lt;+0&gt;: mov    rcx,QWORD PTR fs:0xfffffffffffffff8\n   0x0000000000450a99 &lt;+9&gt;: cmp    rsp,QWORD PTR [rcx+0x10]\n   0x0000000000450a9d &lt;+13&gt;:    jbe    0x450adf &lt;main.main.func1+79&gt;\n   0x0000000000450a9f &lt;+15&gt;:    sub    rsp,0x18\n   0x0000000000450aa3 &lt;+19&gt;:    mov    QWORD PTR [rsp+0x10],rbp\n   0x0000000000450aa8 &lt;+24&gt;:    lea    rbp,[rsp+0x10]\n   0x0000000000450aad &lt;+29&gt;:    call   0x423890 &lt;runtime.printlock&gt;\n   0x0000000000450ab2 &lt;+34&gt;:    lea    rax,[rip+0x1e1d9]        # 0x46ec92\n   0x0000000000450ab9 &lt;+41&gt;:    mov    QWORD PTR [rsp],rax\n   0x0000000000450abd &lt;+45&gt;:    mov    QWORD PTR [rsp+0x8],0xd\n   0x0000000000450ac6 &lt;+54&gt;:    call   0x424230 &lt;runtime.printstring&gt;\n   0x0000000000450acb &lt;+59&gt;:    call   0x423b40 &lt;runtime.printnl&gt;\n   0x0000000000450ad0 &lt;+64&gt;:    call   0x423920 &lt;runtime.printunlock&gt;\n   0x0000000000450ad5 &lt;+69&gt;:    mov    rbp,QWORD PTR [rsp+0x10]\n   0x0000000000450ada &lt;+74&gt;:    add    rsp,0x18\n   0x0000000000450ade &lt;+78&gt;:    ret    \n   0x0000000000450adf &lt;+79&gt;:    call   0x448790 &lt;runtime.morestack_noctxt&gt;\n   0x0000000000450ae4 &lt;+84&gt;:    jmp    0x450a90 &lt;main.main.func1&gt;</code></pre>\n<p>我们注意到当它不是作为返回值的时候，好像和普通调用没有什么区别。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode bash\"><code class=\"sourceCode bash\">$ <span class=\"kw\">set</span> <span class=\"kw\">disassembly-flavor</span> intel <span class=\"co\">#设置intel样式</span>\n$ <span class=\"kw\">disass</span> main.main <span class=\"co\">#反汇编main.main</span></code></pre></div>\n<pre><code>Dump of assembler code for function main.main:\n   0x00000000004509d0 &lt;+0&gt;: mov    rcx,QWORD PTR fs:0xfffffffffffffff8\n   0x00000000004509d9 &lt;+9&gt;: cmp    rsp,QWORD PTR [rcx+0x10]\n   0x00000000004509dd &lt;+13&gt;:    jbe    0x450a3e &lt;main.main+110&gt;\n   0x00000000004509df &lt;+15&gt;:    sub    rsp,0x28\n   0x00000000004509e3 &lt;+19&gt;:    mov    QWORD PTR [rsp+0x20],rbp\n   0x00000000004509e8 &lt;+24&gt;:    lea    rbp,[rsp+0x20]\n   0x00000000004509ed &lt;+29&gt;:    call   0x450a90 &lt;main.main.func1&gt;\n   0x00000000004509f2 &lt;+34&gt;:    call   0x4509b0 &lt;main.test&gt;\n   0x00000000004509f7 &lt;+39&gt;:    mov    rdx,QWORD PTR [rsp]\n   0x00000000004509fb &lt;+43&gt;:    mov    QWORD PTR [rsp+0x18],rdx\n   0x0000000000450a00 &lt;+48&gt;:    mov    QWORD PTR [rsp],0x64\n   0x0000000000450a08 &lt;+56&gt;:    mov    rax,QWORD PTR [rdx]\n   0x0000000000450a0b &lt;+59&gt;:    call   rax\n   0x0000000000450a0d &lt;+61&gt;:    mov    rax,QWORD PTR [rsp+0x8]\n   0x0000000000450a12 &lt;+66&gt;:    mov    QWORD PTR [rsp+0x10],rax\n   0x0000000000450a17 &lt;+71&gt;:    call   0x423890 &lt;runtime.printlock&gt;\n   0x0000000000450a1c &lt;+76&gt;:    mov    rax,QWORD PTR [rsp+0x10]\n   0x0000000000450a21 &lt;+81&gt;:    mov    QWORD PTR [rsp],rax\n   0x0000000000450a25 &lt;+85&gt;:    call   0x424070 &lt;runtime.printint&gt;\n   0x0000000000450a2a &lt;+90&gt;:    call   0x423b40 &lt;runtime.printnl&gt;\n   0x0000000000450a2f &lt;+95&gt;:    call   0x423920 &lt;runtime.printunlock&gt;\n   0x0000000000450a34 &lt;+100&gt;:   mov    rbp,QWORD PTR [rsp+0x20]\n   0x0000000000450a39 &lt;+105&gt;:   add    rsp,0x28\n   0x0000000000450a3d &lt;+109&gt;:   ret    \n   0x0000000000450a3e &lt;+110&gt;:   call   0x448790 &lt;runtime.morestack_noctxt&gt;\n   0x0000000000450a43 &lt;+115&gt;:   jmp    0x4509d0 &lt;main.main&gt;</code></pre>\n<p>可以看到call main.main.func1实际上就是func(){}匿名函数，它生成的名字是main.main.func1，直接call用它的地址了。</p>\n<p>很显然，如果匿名函数直接调用的时候，它和普通函数调用根本没有任何区别，只有当它作为返回值的时候才有差别。</p>\n<p>现在有两个疑问，第一个匿名函数作为普通函数直接调用的时候，它直接是使用call来执行的，没有什么区别。第二个当我们把匿名函数当作返回值的时候，这时候就有个包装对象的创建，进行二次调用的，需要做二次寻址。</p>\n<p>这就告诉我们同样是匿名函数，在不同的情况下，它可能是有差别的，这种差别从代码上来看显然是有性能差异的。</p>\n<p>当你学习语言的时候，任何东西和最终调用未必是一致的，任何一门语言的语言规范里面官方文档里都不会告诉你细节，而这些细节需要自己去挖掘，你挖掘出来了，你就掌握了一种优化层面的信息，这个信息作为你的储备条件，比如说有些时候避免使用把匿名函数当作返回值来用可能会存在性能问题，以后做重构或者调优时，你积累的大量信息，你拥有这些信息的时候，你才知道选择什么样的方式最合理，而这些信息显然不会来自于官方文档，官方文档对很多细节描述都会很简单一带而过。自己得有手段处理这些事情。</p>\n</div><div id=\"MySignature\"></div>\r\n        <div class=\"clear\"></div>\r\n        <div id=\"blog_post_info_block\">\r\n        <div id=\"blog_post_info\">\r\n        </div>\r\n        <div class=\"clear\"></div>\r\n        <div id=\"post_next_prev\"></div>\r\n    </div>\r\n</div>\r\n    <ul class=\"postmetadata\">\r\n        <li class=\"icon_cat\" id=\"BlogPostCategory\">\r\n        <li class=\"icon_bullet\" id=\"EntryTag\">\r\n    </ul>\r\n</div>\r\n<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=23571,cb_entryId=7751339,cb_blogApp=currentBlogApp,cb_blogUserGuid='4968360b-63cf-dd11-9e4d-001cf0cd104b',cb_entryCreatedDate='2017/11/2 10:15:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n<script type=\"text/javascript\">\r\n    var m = window.__blog.postRendered;\r\n    if (m) { m(__$(\"post\")); }\r\n</script>\r\n<script type=\"text/javascript\">\r\n    var m = window.__blog.postRenderPosts;\r\n    if (m) { m(); }\r\n</script>\r\n</div>", "article_view": 160, "image_url": ["https://pic.cnblogs.com/face/20012/20140709190845.png"], "date_pub": "2017-11-02", "article_common": 1}
{"title": "ASP.NET Core中间件实现分布式 Session", "url": "http://www.cnblogs.com/vipyoumay/p/7771237.html", "author": "行动派Xdpie", "article_desc": "ASP.NET Core 中用中间件简单实现分布式Session ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/vipyoumay/p/7771237.html\">ASP.NET Core中间件实现分布式 Session</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><!-- TOC -->\n<ul>\n<li><a href=\"#1-aspnet-core%E4%B8%AD%E9%97%B4%E4%BB%B6%E8%AF%A6%E8%A7%A3\">1. ASP.NET Core中间件详解</a>\n<ul>\n<li><a href=\"#11-%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%8E%9F%E7%90%86\">1.1. 中间件原理</a>\n<ul>\n<li><a href=\"#111-%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%AD%E9%97%B4%E4%BB%B6\">1.1.1. 什么是中间件</a></li>\n<li><a href=\"#112-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B\">1.1.2. 中间件执行过程</a></li>\n<li><a href=\"#113-%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E9%85%8D%E7%BD%AE\">1.1.3. 中间件的配置</a></li>\n</ul></li>\n<li><a href=\"#12-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E4%B8%AD%E9%97%B4%E4%BB%B6\">1.2. 依赖注入中间件</a></li>\n<li><a href=\"#13-cookies%E5%92%8Csession%E4%B8%AD%E9%97%B4%E4%BB%B6\">1.3. Cookies和session中间件</a>\n<ul>\n<li><a href=\"#131-session\">1.3.1. Session</a></li>\n<li><a href=\"#132-session%E4%BF%9D%E5%AD%98%E5%88%B0redis%E4%B8%AD\">1.3.2. Session保存到Redis中</a></li>\n<li><a href=\"#133-%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83session\">1.3.3. 实现分布Session</a></li>\n</ul></li>\n<li><a href=\"#14-%E6%80%BB%E7%BB%93\">1.4. 总结</a></li>\n</ul></li>\n</ul>\n<!-- /TOC -->\n<p><a id=\"markdown-11-中间件原理\" name=\"11-%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%8E%9F%E7%90%86\"></a></p>\n<h2 id=\"中间件原理\">1.1. 中间件原理</h2>\n<p><a id=\"markdown-111-什么是中间件\" name=\"111-%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%AD%E9%97%B4%E4%BB%B6\"></a></p>\n<h3 id=\"什么是中间件\">1.1.1. 什么是中间件</h3>\n<p>中间件是段代码用于处理请求和响应，通常多个中间件链接起来形成管道，由每个中间件自己来决定是否要调用下一个中间件。</p>\n<p><img src=\"http://qiniu.xdpie.com/2017-10-10-21-47-00.png\" alt=\"2017-10-10-21-47-00\"></p>\n<p><a id=\"markdown-112-中间件执行过程\" name=\"112-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B\"></a></p>\n<h3 id=\"中间件执行过程\">1.1.2. 中间件执行过程</h3>\n<p>举一个示例来演示中间件的执行过程（分别有三个中间件：日志记录、权限验证和路由）：当请求进入应用程序时，执行执行日志记录的中间件，它记录请求属性并调用链中的下一个中间件权限验证，如果权限验证通过则将控制权传递给下一个中间件，不通过则设置401 HTTP代码并返回响应，响应传递给日志中间件进行返回。</p>\n<p><img src=\"http://qiniu.xdpie.com/2017-10-10-22-47-32.png\" alt=\"2017-10-10-22-47-32\"></p>\n<p><a id=\"markdown-113-中间件的配置\" name=\"113-%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E9%85%8D%E7%BD%AE\"></a></p>\n<h3 id=\"中间件的配置\">1.1.3. 中间件的配置</h3>\n<p>中间件配置主要是用<code>Run</code>、<code>Map</code>和<code>Use</code>方法进行配置，三者的不同参见上篇<a href=\"http://www.cnblogs.com/vipyoumay/p/7567573.html\">ASP.NET Core 运行原理剖析</a>；简单的中间件可以直接使用匿名方法就可以搞定，如下代码：</p>\n<pre class=\"csharp\"><code>app.Run(async (context,next) =&gt;\n        {\n            await context.Response.WriteAsync(\"environment \" + env);\n            await next();\n        });</code></pre>\n<p>如果想重用中间件，就需要单独封装到一个类中进行调用。</p>\n<!-- https://docs.microsoft.com/en-us/aspnet/core/fundamentals/middleware\n\nhttps://www.tutorialspoint.com/asp.net_core/asp.net_core_middleware.htm\n\nhttp://odetocode.com/blogs/scott/archive/2016/11/22/asp-net-core-and-the-enterprise-part-3-middleware.aspx -->\n<p><a id=\"markdown-12-依赖注入中间件\" name=\"12-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E4%B8%AD%E9%97%B4%E4%BB%B6\"></a></p>\n<h2 id=\"依赖注入中间件\">1.2. 依赖注入中间件</h2>\n<p>在实际项目中，中间件往往需要调用其它对象的方法。所以要创建对象之间的依赖,由于ASP.NET Core 内置的依赖注入系统，写程序的时候可以创建更优雅的代码。</p>\n<p>首先需要要在IOC容器中注册类，就是<code>Startup</code>类中的<code>ConfigureServices</code>方法中进行注册，<code>ConfigureServices</code>方法会在<code>Configure</code>方法之前被执行。以便在用中间件时所有依赖都准备好了。</p>\n<p>现在有一个Greeter类：</p>\n<pre class=\"csharp\"><code>public class Greeter : IGreeter\n{\n    public string Greet()\n    {\n        return \"Hello from Greeter!\";\n    }\n}\n\npublic interface IGreeter\n{\n    string Greet();\n}</code></pre>\n<p>第一步在<code>ConfigureServices</code>方法中进行注册</p>\n<pre class=\"csharp\"><code>\npublic void ConfigureServices(IServiceCollection services)\n{\n    services.AddTransient&lt;IGreeter, Greeter&gt;();\n}\n</code></pre>\n<p>笔者这里使用的是AddTransient进行注册，该方法在每次请求时创建该类的新实例。可以选择其它方法：AddSingleton，AddScoped或简单的Add（所有在幕后前使用）。整个DI系统在<a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection\">官方文档</a>中有所描述。</p>\n<p>在注册了依赖项后，就可以使用它们了。<code>IApplicationBuilder</code>实例允许在<code>Configure</code>方法中有一个<code>RequestServices</code>属性用于获取<code>Greeter</code>实例。由于已经注册了这个<code>IGreeter</code>接口，所以不需要将中间件与具体的<code>Greeter</code>实现相结合。</p>\n<pre class=\"csharp\"><code>\napp.Use(async (ctx, next) =&gt;\n    {\n        IGreeter greeter = ctx.RequestServices.GetService&lt;IGreeter&gt;();\n        await ctx.Response.WriteAsync(greeter.Greet());\n        await next();\n    });\n</code></pre>\n<p>如果<code>Greeter</code>类有一个参数化的构造函数，它的依赖关系也必须在其中注册<code>ConfigureServices</code>。</p>\n<p>中间件可以很容易解决依赖关系。可以向中间件构造函数添加其他参数：</p>\n<pre class=\"csharp\"><code>\npublic class MyMiddleware\n{\n    private readonly RequestDelegate _next;\n    private readonly IGreeter _greeter;\n\n    public MyMiddleware(RequestDelegate next, IGreeter greeter)\n    {\n        _next = next;\n        greeter = greeter;\n    }\n\n    public async Task Invoke(HttpContext context)\n    {\n        await context.Response.WriteAsync(_greeter.Greet());\n        await _next(context);\n    }\n}\n</code></pre>\n<p>或者，可以将此依赖关系添加到Invoke方法中：</p>\n<pre class=\"csharp\"><code>\npublic async Task Invoke(HttpContext context, IGreeter greeter)\n{\n    await context.Response.WriteAsync(greeter.Greet());\n    await _next(context);\n}\n</code></pre>\n<p>如果DI系统知道这些参数的类型，则在类被实例化时，它们将被自动解析。很简单！<br>\n<!-- https://blog.dudak.me/2014/custom-middleware-with-dependency-injection-in-asp-net-core/ --></p>\n<p><a id=\"markdown-13-cookies和session中间件\" name=\"13-cookies%E5%92%8Csession%E4%B8%AD%E9%97%B4%E4%BB%B6\"></a></p>\n<h2 id=\"cookies和session中间件\">1.3. Cookies和session中间件</h2>\n<p><a id=\"markdown-131-session\" name=\"131-session\"></a></p>\n<h3 id=\"session\">1.3.1. Session</h3>\n<p>HTTP是一个无状态协议，Web服务器将每一个请求都视为独立请求。并且不保存之前请求中用户的值。</p>\n<p>Session 状态是ASP.NET Core提供的一个功能，它可以在用户通应用访问网络服务器的时候保存和存储用户数据。由服务器上的字典和散列表组成，Session状态通过浏览器的请求中得到，Session的数据保存到缓存中。</p>\n<p>ASP.NET Core通过包含Session ID的Cookie来维护会话状态，每个请求都会携带此Session ID。</p>\n<p>在<code>Microsoft.AspNetCore.Session</code>包中提供的中间件用来管理Session状态。要启用Session中间件，<code>Startup</code>类里面需要做以下几个操作：</p>\n<ul>\n<li>使用任何一个实现了<code>IDistributedCache</code>接口的服务来启用内存缓存，</li>\n<li>设置<code>AddSession</code>回调，由于<code>AddSession</code>是在<code>Microsoft.AspNetCore.Session</code>包内实现的，所以必须在Nuget中添加<code>Microsoft.AspNetCore.Session</code>包</li>\n<li><code>UseSession</code>回调</li>\n</ul>\n<p>具体示例代码如下：</p>\n<pre class=\"csharp\"><code>\nusing Microsoft.AspNetCore.Builder;\nusing Microsoft.Extensions.DependencyInjection;\nusing System;\n\npublic class Startup\n{\n    public void ConfigureServices(IServiceCollection services)\n    {\n        services.AddMvc();\n\n        // 添加一个内存缓存\n        services.AddDistributedMemoryCache();\n\n        services.AddSession(options =&gt;\n        {\n            // 设置10秒钟Session过期来测试\n            options.IdleTimeout = TimeSpan.FromSeconds(10);\n            options.Cookie.HttpOnly = true;\n        });\n    }\n\n    public void Configure(IApplicationBuilder app)\n    {\n        app.UseSession();\n        app.UseMvcWithDefaultRoute();\n    }\n}</code></pre>\n<p>上面代码中<code>IdleTimeout</code>属性用来确定用户多久没有操作时丢弃Session。此属性和Cookie超时无关，通过Session中间件的每个请求都会重置超时时间。</p>\n<p><a id=\"markdown-132-session保存到redis中\" name=\"132-session%E4%BF%9D%E5%AD%98%E5%88%B0redis%E4%B8%AD\"></a></p>\n<h3 id=\"session保存到redis中\">1.3.2. Session保存到Redis中</h3>\n<p>实现分布式Session方法官方提供有Redis、Sql Server等。但是Sql Server效率对于这种以key/value获取值的方式远远不及Redis效率高，所以这里笔者选用Redis来作示例实现分布式Session。</p>\n<blockquote>\n<p>准备Redis</p>\n</blockquote>\n<p>由于目前Redis还不支持windows，所以大家在安装Redis的时候准备一台linux操作系统，笔者这里的系统是ubuntu 16.04；下载及安装方式可以参考<a href=\"https://redis.io/download\">官方</a>示例。</p>\n<p>安装成功以后启动Redis 服务，如果看到以下信息，就代表Redis启动成功：</p>\n<p><img src=\"http://qiniu.xdpie.com/2017-10-30-20-33-47.png\" alt=\"2017-10-30-20-33-47\"></p>\n<blockquote>\n<p>相关配置</p>\n</blockquote>\n<p>首先需要用<code>Nuget</code>安装包<code>Microsoft.Extensions.Caching.Redis</code>，安装成功以后就可以在<code>app.csproj</code>文件中可以看到。</p>\n<p><img src=\"http://qiniu.xdpie.com/2017-10-30-20-12-20.png\" alt=\"2017-10-30-20-12-20\"></p>\n<p>在<code>Configure</code>方法中添加<code>app.UseSession()</code>；然后再<code>ConfigureServices</code>添加Redis服务</p>\n<pre class=\"csharp\"><code>\npublic void ConfigureServices(IServiceCollection services){\n    services.AddDistributedRedisCache(options=&gt;{\n        options.Configuration=\"127.0.0.1\"; //多个redis服务器：{RedisIP}:{Redis端口},{RedisIP}:{Redis端口}\n        options.InstanceName=\"sampleInstance\";\n    });\n    services.AddMvc();\n    services.AddSession();\n}\n</code></pre>\n<p>以上代码中笔者只用一个Redis服务器来作测试，实际项目中需要多个Redis服务器；配置方法如：<code>options.Configuration=\"地址1:端口,地址2:端口\";</code>，这里笔者并没有给端口而是用的默认端口<code>6379</code></p>\n<blockquote>\n<p>完整代码</p>\n</blockquote>\n<p>Startup.cs</p>\n<pre class=\"csharp\"><code>\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing Microsoft.AspNetCore.Builder;\nusing Microsoft.AspNetCore.Hosting;\nusing Microsoft.Extensions.Configuration;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.Caching.Redis;\nusing Microsoft.Extensions.Caching.Distributed;\n\nnamespace app{    \n    public class Startup{        \n        public Startup(IConfiguration configuration)        \n        {            \n            Configuration = configuration;        \n        }\n        public IConfiguration Configuration { get; }\n\n        public void ConfigureServices(IServiceCollection services){                     \n            services.AddDistributedRedisCache(options =&gt;{                \n                options.Configuration = \"127.0.0.1\";                \n                options.InstanceName = \"sampleInstance\";            \n            });            \n            services.AddMvc();            \n            services.AddSession();        \n        }\n\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env){            \n            if (env.IsDevelopment())\n            {                \n                app.UseDeveloperExceptionPage();            \n            }            \n            else            \n            {                \n                app.UseExceptionHandler(\"/Home/Error\");            \n            }\n            app.UseSession();\n            app.UseStaticFiles();\n            app.UseMvc(routes =&gt;{                \n                routes.MapRoute(name: \"default\",template: \"{controller=Home}/{action=Index}/{id?}\");           \n            });        \n        }    \n    }\n}\n</code></pre>\n<p>HomeControler.cs</p>\n<pre class=\"csharp\"><code>\npublic class HomeController : Controller   \n{        \n    public IActionResult Index()       \n    {            \n        HttpContext.Session.Set(\"apptest\",Encoding.UTF8.GetBytes(\"apptestvalue\"));\n        return View();        \n    }\n    public IActionResult ShowRedis()        \n    {            \n        byte[] temp;\n        if(HttpContext.Session.TryGetValue(\"apptest\",out temp))\n        {                \n            ViewData[\"Redis\"]=Encoding.UTF8.GetString(temp);            \n        }            \n        return View();        \n    }\n}\n</code></pre>\n<p>Index页面只做一件事给Session设置值：\"apptestvalue\"，ShowRedis页面显示Session值。</p>\n<p>ShowRedis.cshtml</p>\n<pre class=\"csharp\"><code>\nRedis Session Value:ViewData[\"Redis\"]\n</code></pre>\n<blockquote>\n<p>演示结果</p>\n</blockquote>\n<p>现在开始运行页面，首先直接进入到ShowRedis页面，Session值显示为空</p>\n<p><img src=\"http://qiniu.xdpie.com/2017-10-31-06-47-24.png\" alt=\"2017-10-31-06-47-24\"></p>\n<p>当点击<code>SetSessionValue</code>以后，再次回到<code>ShowRedis</code>页面，Session就值显示出来了</p>\n<p><img src=\"http://qiniu.xdpie.com/2017-10-31-23-56-58.png\" alt=\"2017-10-31-23-56-58\"></p>\n<p>看到<code>apptestvalue</code>代表Session值已经存到Redis里面，怎样证明<code>apptestvalue</code>值是从Redis里面取到呢？接下来就证明给大家看。</p>\n<p><a id=\"markdown-133-实现分布session\" name=\"133-%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83session\"></a></p>\n<h3 id=\"实现分布session\">1.3.3. 实现分布Session</h3>\n<p>前面已经将Session保存到Redis中，但是大家不清楚这个值是否是真的保存到Redis里面去了还是在项目内存中；所以这里就实现在两个不的应用程序（或两台不同的机器）中共享Session，也就是实现分布式Session，分布式即代表了不同的机器不同的应用程序，但往往有下面的一种尴尬的情况，就算是每个HTTP请求时都携带了相同的cookie值。</p>\n<p><img src=\"http://qiniu.xdpie.com/2017-10-30-20-35-19.png\" alt=\"2017-10-30-20-35-19\"></p>\n<p>造成这个的问题的原因是每个机器上面的ASP.NET Core的应用程序的密钥是不一样的，所以没有办法得到前一个应用程序保存的Session数据;为了解决这个问题，.NET Core团队为提供了<code>Microsoft.AspNetCore.DataProtection.AzureStorage</code>和<code>Microsoft.AspNetCore.DataProtection.Redis</code>包将密钥保存到Azure或Redis中。这里选择将密钥保存到Redis。</p>\n<p><img src=\"http://7xphqb.com1.z0.glb.clouddn.com/94886d1fc57592eea4da9aebd8a71674.png\" alt=\"共享密钥\"></p>\n<p>利用<code>Microsoft.AspNetCore.DataProtection.Redis</code>包提供的<code>PersistKeysToRedis</code>重载方法将密钥保存到Redis里面去。所以这里需要在<code>ConfigureServices</code>方法中添<code>AddDataProtection()</code></p>\n<pre class=\"csharp\"><code>\nvar redis = ConnectionMultiplexer.Connect(\"127.0.0.1:6379\");\n    services.AddDataProtection()\n        .SetApplicationName(\"session_application_name\")\n        .PersistKeysToRedis(redis, \"DataProtection-Keys\");\n</code></pre>\n<p>下面演示怎样实现分布式Session</p>\n<blockquote>\n<p>配置步骤</p>\n</blockquote>\n<ul>\n<li>同时创建两个项目，分别为app1和app2</li>\n<li>添加<code>Microsoft.AspNetCore.DataProtection.Redis</code>和<code>StackExchange.Redis.StrongName</code>包</li>\n</ul>\n<p><img src=\"http://qiniu.xdpie.com/2017-10-31-23-41-37.png\" alt=\"2017-10-31-23-41-37\"></p>\n<ul>\n<li>由于在同一台机器上，ASP.NET Core程序默认启动的时候端口为5000，由于app1已经占用了，所以将app2的启端口设置为5001</li>\n</ul>\n<p><img src=\"http://qiniu.xdpie.com/2017-10-31-23-54-19.png\" alt=\"2017-10-31-23-54-19\"></p>\n<blockquote>\n<p>完整代码</p>\n</blockquote>\n<ul>\n<li>app1项目</li>\n</ul>\n<p>Startup.cs</p>\n<pre class=\"csharp\"><code>\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing Microsoft.AspNetCore.Builder;\nusing Microsoft.AspNetCore.Hosting;\nusing Microsoft.Extensions.Configuration;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.Caching.Redis;\nusing Microsoft.Extensions.Caching.Distributed;\n\nnamespace app1{    \n    public class Startup{        \n        public Startup(IConfiguration configuration)        \n        {            \n            Configuration = configuration;        \n        }\n        public IConfiguration Configuration { get; }\n\n        public void ConfigureServices(IServiceCollection services){\n            var redis = ConnectionMultiplexer.Connect(\"127.0.0.1:6379\");\n            services.AddDataProtection()\n                .SetApplicationName(\"session_application_name\")\n                .PersistKeysToRedis(redis, \"DataProtection-Keys\");          \n            services.AddDistributedRedisCache(options =&gt;{                \n                options.Configuration = \"127.0.0.1\";                \n                options.InstanceName = \"sampleInstance\";            \n            });            \n            services.AddMvc();            \n            services.AddSession();        \n        }\n\n        public void Configure(IApplicationBuilder app, IHostingEnvironment env){            \n            if (env.IsDevelopment())\n            {                \n                app.UseDeveloperExceptionPage();            \n            }            \n            else            \n            {                \n                app.UseExceptionHandler(\"/Home/Error\");            \n            }\n            app.UseSession();\n            app.UseStaticFiles();\n            app.UseMvc(routes =&gt;{                \n                routes.MapRoute(name: \"default\",template: \"{controller=Home}/{action=Index}/{id?}\");           \n            });        \n        }    \n    }\n}\n</code></pre>\n<p>HomeControler.cs</p>\n<pre class=\"csharp\"><code>\npublic class HomeController : Controller   \n{        \n    public IActionResult Index()       \n    {            \n        HttpContext.Session.Set(\"app1test\",Encoding.UTF8.GetBytes(\"app1testvalue\"));\n        return View();        \n    }\n    public IActionResult ShowRedis()        \n    {            \n        byte[] temp;\n        if(HttpContext.Session.TryGetValue(\"app1test\",out temp))\n        {                \n            ViewData[\"Redis\"]=Encoding.UTF8.GetString(temp);            \n        }            \n        return View();        \n    }\n}\n</code></pre>\n<p>ShowRedis.cshtml</p>\n<pre class=\"csharp\"><code>\nRedis Session Value:ViewData[\"Redis\"]\n</code></pre>\n<ul>\n<li>app2项目</li>\n</ul>\n<p>Startup.cs<br>\n配置同app1配置一样。</p>\n<p>HomeControler.cs</p>\n<pre class=\"csharp\"><code>\npublic class HomeController : Controller   \n{        \n    public IActionResult Index()       \n    {            \n        byte[] temp;\n        if(HttpContext.Session.TryGetValue(\"app1test\",out temp))\n        {                \n            ViewData[\"Redis\"]=Encoding.UTF8.GetString(temp);            \n        }  \n        return View();        \n    }\n}\n</code></pre>\n<p>Index.cshtml</p>\n<pre class=\"csharp\"><code>\nViewData[\"Redis\"]\n</code></pre>\n<blockquote>\n<p>运行效果</p>\n</blockquote>\n<ul>\n<li>app1 项目</li>\n</ul>\n<p>首次打开进入ShowRedis页面，Session值为空</p>\n<p><img src=\"http://qiniu.xdpie.com/2017-10-31-06-47-24.png\" alt=\"2017-10-31-06-47-24\"></p>\n<p>点击<code>SetSessionValue</code>以后，再回到ShowRedis页面：</p>\n<p><img src=\"http://qiniu.xdpie.com/2017-11-01-00-04-13.png\" alt=\"2017-11-01-00-04-13\"></p>\n<ul>\n<li>app2项目，直接在浏览器访问：<a href=\"http://localhost:5001\" class=\"uri\">http://localhost:5001</a></li>\n</ul>\n<p><img src=\"http://qiniu.xdpie.com/2017-11-01-00-00-30.png\" alt=\"2017-11-01-00-00-30\"></p>\n<p>以上是用Redis实现分布式Session示例。</p>\n<!-- https://docs.microsoft.com/en-us/aspnet/core/fundamentals/app-state?tabs=aspnetcore2x -->\n<p><a id=\"markdown-14-总结\" name=\"14-%E6%80%BB%E7%BB%93\"></a></p>\n<h2 id=\"总结\">1.4. 总结</h2>\n<p>本节讲解了中间件的运行原理及配置过程，中间件之间对象依赖关系的配置和平时项目中常用到Session的配置问题。并在实际代码展示了怎样使用中间件实现分布式Session。</p>\n<blockquote>\n<p>作者：xdpie 出处： <a href=\"http://www.cnblogs.com/vipyoumay/p/7771237.html\" class=\"uri\">http://www.cnblogs.com/vipyoumay/p/7771237.html</a></p>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 11:30</span> <a href=\"http://www.cnblogs.com/vipyoumay/\">行动派Xdpie</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7771237\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7771237);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=77791,cb_entryId=7771237,cb_blogApp=currentBlogApp,cb_blogUserGuid='94e0ac0c-b550-de11-9510-001cf0cd104b',cb_entryCreatedDate='2017/11/2 11:30:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 367, "image_url": ["https://pic.cnblogs.com/face/69407/20160329095514.png"], "date_pub": "2017-11-02", "article_common": 4}
{"title": "SIP简介，第1部分：SIP初探", "url": "http://www.cnblogs.com/space-place/p/7770931.html", "author": "Splace", "article_desc": "\r\n    说明：以下内容来着之前下载的一份文档，现将概念部分摘录在BLog，如需要完整文档将放在文件中或留言。 SIP简介，第1部分：SIP初探 时间：2006-04-07作者：Emmanuel Proulx浏览次数： 21367 本文关键字：SIP, JAIN, RFC 3261signaling, Web ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/space-place/p/7770931.html\">SIP简介，第1部分：SIP初探</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p> </p>\n<p><strong>说明：以下内容来着之前下载的一份文档，现将概念部分摘录在BLog，如需要完整文档将放在文件中或留言。</strong></p>\n<p><strong>SIP<span style=\"font-family: 宋体\">简介，第</span><span style=\"font-family: Arial\">1</span><span style=\"font-family: 宋体\">部分：</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">初探</span></strong></p>\n<table>\n<tbody>\n<tr>\n<td valign=\"center\" width=\"391\">\n<p>时间：<span style=\"font-family: Arial\">2006-04-07</span><br>作者：<a href=\"http://dev2dev.bea.com.cn/author/281.html\">Emmanuel Proulx</a><br>浏览次数： 21367 <br>本文关键字：<a href=\"http://dev2dev.bea.com.cn/products/search.jsp?searchtype=keywords&amp;keywords=SIP\">SIP</a>, <a href=\"http://dev2dev.bea.com.cn/products/search.jsp?searchtype=keywords&amp;keywords=%20JAIN\"> JAIN</a>, <a href=\"http://dev2dev.bea.com.cn/products/search.jsp?searchtype=keywords&amp;keywords=%20RFC%203261signaling\"> RFC 3261signaling</a>, <a href=\"http://dev2dev.bea.com.cn/products/search.jsp?searchtype=keywords&amp;keywords=%20WebLogic%20Communications%20Platform\"> WebLogic Communications Platform</a>, <a href=\"http://dev2dev.bea.com.cn/products/search.jsp?searchtype=keywords&amp;keywords=%20%E4%BC%9A%E8%AF%9D%E5%8F%91%E8%B5%B7%E5%8D%8F%E8%AE%AE\"> 会话发起协议</a>, <a href=\"http://dev2dev.bea.com.cn/products/search.jsp?searchtype=keywords&amp;keywords=%20%E4%BF%A1%E4%BB%A4\"> 信令</a></p>\n\n\n\n\n</td>\n<td valign=\"center\" width=\"184\">\n<table>\n<tbody>\n<tr>\n<td valign=\"center\" width=\"178\">\n<p><strong>文章工具</strong><br> 推荐给朋友<br> 打印文章</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n\n\n\n\n</tbody>\n\n\n\n\n</table>\n<p> </p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n\n\n\n\n</tbody>\n\n\n\n\n</table>\n<p> </p>\n<h3><strong><span style=\"font-family: 宋体\">摘要</span></strong></h3>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　会话发起协议（</span>Session Initiation Protocol<span style=\"font-family: 宋体\">，</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">）是一种信令协议，它对于通信业有着重要的意义。本文从技术上对</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">进行了一般性的介绍，并说明了</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">如何为通信解决方案提供重要支持。</span></p>\n<h3><strong><span style=\"font-family: 宋体\">简介</span></strong></h3>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　我曾经构想过一种软件，它可以</span>“<span style=\"font-family: 宋体\">浮于</span><span style=\"font-family: Arial\">”</span><span style=\"font-family: 宋体\">应用程序之上，提供辅助作用。这不是一个哑的</span><span style=\"font-family: Arial\">“</span><span style=\"font-family: 宋体\">帮助</span><span style=\"font-family: Arial\">”</span><span style=\"font-family: 宋体\">系统，而是一个活动的技术支持代理，可以在</span><span style=\"font-family: Arial\">Internet</span><span style=\"font-family: 宋体\">上进行讨论。那时曾有人告诉我，</span><span style=\"font-family: Arial\">“</span><span style=\"font-family: 宋体\">现有的工具、库、协议或带宽实现不了这样的要求！</span><span style=\"font-family: Arial\">”</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　时代已经不同了！</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　许多人家中已经拥有基于</span>DSL<span style=\"font-family: 宋体\">、光纤和其他技术的宽带网络。存在大量高质量的工具和库，无论是商业的还是开源的。标准驱动应用。现在是时候来实现上述创新思路了。</span></p>\n<h3><strong><span style=\"font-family: 宋体\">了解</span>SIP</strong></h3>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　首先，我将向您介绍</span>SIP<span style=\"font-family: 宋体\">，也就是会话发起协议。</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">是一种轻量级的可扩展请求</span><span style=\"font-family: Arial\">/</span><span style=\"font-family: 宋体\">响应协议，用于在两个端点之间开始通信会话。这听起来是不是很熟悉？</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">在概念上源自于</span><span style=\"font-family: Arial\">HTTP</span><span style=\"font-family: 宋体\">和</span><span style=\"font-family: Arial\">SMTP</span><span style=\"font-family: 宋体\">，但是它的目的却不同。可以把</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">消息与</span><a href=\"http://en.wikipedia.org/wiki/Citizen%27s_Band\">CB</a><span style=\"font-family: 宋体\">（民用波段）隐语</span><a href=\"http://ursine.ca/CB\">10-code<span style=\"font-family: 宋体\">和</span><span style=\"font-family: Arial\">Q-signal</span></a><span style=\"font-family: 宋体\">进行比较。</span></p>\n<p class=\"p\" align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/884095/201711/884095-20171102102351904-1624373639.png\" alt=\"\"></p>\n<p> </p>\n<p class=\"p\" align=\"center\"><br><span style=\"font-family: 宋体\">图</span>1.<span style=\"font-family: 宋体\">用于管理</span><span style=\"font-family: Arial\">CB</span><span style=\"font-family: 宋体\">呼叫的隐语</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　在这个例子中，真正的消息包含在专用的呼叫协商消息中。</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　</span>SIP<span style=\"font-family: 宋体\">是</span><span style=\"font-family: Arial\">IETF</span><span style=\"font-family: 宋体\">于</span><span style=\"font-family: Arial\">1999</span><span style=\"font-family: 宋体\">年提出的，在</span><span style=\"font-family: Arial\">2002</span><span style=\"font-family: 宋体\">年进行了修订。</span><a href=\"http://www.ietf.org/rfc/rfc3261.txt\">RFC 3261</a><span style=\"font-family: 宋体\">对它进行了描述。本文中有关</span>SIP<span style=\"font-family: 宋体\">的信息就选自</span><span style=\"font-family: Arial\">RFC</span><span style=\"font-family: 宋体\">。对</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">存在很多扩展，这些扩展中的很多都能在</span><a href=\"http://www.cs.columbia.edu/sip/drafts.html\">SIP-related RFCs and drafts</a><span style=\"font-family: 宋体\">清单中找到。</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　</span>SIP<span style=\"font-family: 宋体\">有哪些优点呢？通常情况下，两个端点使用它来协商一次</span><span style=\"font-family: Arial\">“</span><span style=\"font-family: 宋体\">呼叫</span><span style=\"font-family: Arial\">”</span><span style=\"font-family: 宋体\">。这里的协商包括介质（文本、语音等）、传输（通常是</span><a href=\"http://www.cs.columbia.edu/~hgs/rtp/\">RTP<span style=\"font-family: 宋体\">、</span><span style=\"font-family: Arial\">Real Time Protocol</span></a><span style=\"font-family: 宋体\">）和编码（</span>codec<span style=\"font-family: 宋体\">）。一旦协商成功，两个端点就会使用选中的方法相互交谈</span><span style=\"font-family: Arial\">——</span><span style=\"font-family: 宋体\">这就与</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">无关了。</span><span style=\"font-family: Arial\">“</span><span style=\"font-family: 宋体\">呼叫</span><span style=\"font-family: Arial\">”</span><span style=\"font-family: 宋体\">完成之后，</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">用于指示断开连接。因此，</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">最好用作一种信令机制。</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">及其扩展还提供一些相关功能，比如即时消息传递、注册和到场。</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　</span>SIP<span style=\"font-family: 宋体\">术语中的端点叫做用户代理。它可以是</span><span style=\"font-family: Arial\">“</span><span style=\"font-family: 宋体\">软件电话</span><span style=\"font-family: Arial\">”</span><span style=\"font-family: 宋体\">、即时消息收发器、</span><span style=\"font-family: Arial\">IP</span><span style=\"font-family: 宋体\">电话，甚至是手机。服务器用户代理提供集中式的服务，比如登记员、代理或应用服务器。</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　听起来</span>SIP<span style=\"font-family: 宋体\">非常简单，而且它也确实简单。这种简单性对于协议的稳定很重要，而且它也没有降低协议的有用性，所以该协议得到了广泛的应用。</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　例如，考虑一下</span>HTTP<span style=\"font-family: 宋体\">。协议本身的定义很少。但是使用它的方式多不胜数。</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">也是可以扩展的。存在大量针对</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">的扩展，它们涵盖了很多应用。现在，我们进一步来考察</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">，并分析它为什么会如此重要。</span></p>\n<h3><strong>SIP<span style=\"font-family: 宋体\">的重要性</span></strong></h3>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　有人说，</span>SIP<span style=\"font-family: 宋体\">对于通信，就像</span><span style=\"font-family: Arial\">HTTP</span><span style=\"font-family: 宋体\">对于</span><span style=\"font-family: Arial\">Web</span><span style=\"font-family: 宋体\">一样。</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　</span>SIP<span style=\"font-family: 宋体\">对通信业产生了巨大的影响。从事蜂窝技术的公司已经决定为了未来的应用，对</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">进行标准化。</span><span style=\"font-family: Arial\">VoIP (Voice over IP)</span><span style=\"font-family: 宋体\">供应商、</span><span style=\"font-family: Arial\">Internet</span><span style=\"font-family: 宋体\">电话和即时消息传递应用程序（例如，</span><span style=\"font-family: Arial\">Microsoft MSN Messenger</span><span style=\"font-family: 宋体\">）都准备基于</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">进行标准化。</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　目前已经存在一些信令协议和</span>P2P<span style=\"font-family: 宋体\">技术。这就引发了一个问题：</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">相对于这些协议和技术有何优势？</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">具有以下的明显优点：</span></p>\n<ul>\n<li><span style=\"font-family: 宋体\">稳定性。该协议已经使用了多年，现在十分稳定。</span> </li>\n<li><span style=\"font-family: 宋体\">速度。基于</span>UDP<span style=\"font-family: 宋体\">的小型协议效率特别高。 </span></li>\n<li><span style=\"font-family: 宋体\">灵活性。这个基于文本的协议十分容易扩展。</span> </li>\n<li><span style=\"font-family: 宋体\">安全性。它提供像加密</span>(SSL<span style=\"font-family: 宋体\">、</span><span style=\"font-family: Arial\">S/MIME)</span><span style=\"font-family: 宋体\">和身份验证这样的功能。对</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">的扩展还提供其他安全性功能。 </span></li>\n<li><span style=\"font-family: 宋体\">标准化。随着整个通信行业都在向</span>SIP<span style=\"font-family: 宋体\">靠拢，</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">已经讯速成为一种标准。其他技术可能具有</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">所没有的优势，但是它们没有得到全球范围内的采用。 </span></li>\n\n\n\n\n</ul>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　这意味着，如果您想让您的应用程序与其他工具、设备和服务器进行互操作，</span>SIP<span style=\"font-family: 宋体\">是最佳选择。供应商对互操作性是很关注的，会定期开会对其产品进行测试。这些会议称为</span><span style=\"font-family: Arial\">SIPit for SIP Interoperability Tests</span><span style=\"font-family: 宋体\">（以前叫做</span><span style=\"font-family: Arial\">Bakeoff</span><span style=\"font-family: 宋体\">，是</span><span style=\"font-family: Arial\">Pillsbury</span><a href=\"http://www.cs.columbia.edu/sip/sipit/pillsbury.html\"><span style=\"font-family: 宋体\">提出</span></a><span style=\"font-family: 宋体\">更改的）。</span></p>\n<h3><strong><span style=\"font-family: 宋体\">剖析</span>SIP<span style=\"font-family: 宋体\">呼叫</span></strong></h3>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　现在，让我们更深入地了解这门技术。</span>SIP<span style=\"font-family: 宋体\">通常基于</span><span style=\"font-family: Arial\">UDP</span><span style=\"font-family: 宋体\">进行传输，但是</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">工具必须同时支持</span><span style=\"font-family: Arial\">TCP</span><span style=\"font-family: 宋体\">。一条</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">消息由两部分组成：</span></p>\n<ul>\n<li><span style=\"font-family: 宋体\">信封（</span>envelope<span style=\"font-family: 宋体\">），以头字段的形式描述一个请求或请求的结果（响应）。 </span></li>\n<li><span style=\"font-family: 宋体\">有效负载（</span>payload<span style=\"font-family: 宋体\">），即内容（可选），包含有关请求的数据。 </span></li>\n\n\n\n\n</ul>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　信封是文本格式，但是内容可以是文本，也可以是二进制格式。</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　例如，让我们具体分析一次典型的</span>SIP<span style=\"font-family: 宋体\">呼叫。在这个场景中，用户</span><span style=\"font-family: Arial\">A</span><span style=\"font-family: 宋体\">想呼叫用户</span><span style=\"font-family: Arial\">B</span><span style=\"font-family: 宋体\">。图</span><span style=\"font-family: Arial\">2</span><span style=\"font-family: 宋体\">说明了这次呼叫：</span></p>\n<p class=\"p\" align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/884095/201711/884095-20171102102403029-1834859061.png\" alt=\"\"></p>\n<p> </p>\n<p class=\"p\" align=\"center\"><br><br><span style=\"font-family: 宋体\">图</span>2. <span style=\"font-family: 宋体\">一次典型的</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">呼叫</span></p>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　下面对所有的消息进行了解释：</span></p>\n<table>\n<tbody>\n<tr>\n<td valign=\"center\" width=\"288\">\n<p align=\"center\"><strong> </strong></p>\n\n\n\n\n</td>\n<td valign=\"center\" width=\"288\">\n<p align=\"center\"><strong> </strong></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"288\">\n<p>1. User Agent A<span style=\"font-family: 宋体\">发送一个</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">请求</span><span style=\"font-family: Arial\">INVITE</span><span style=\"font-family: 宋体\">给</span><span style=\"font-family: Arial\">User Agent B</span><span style=\"font-family: 宋体\">，表达</span><span style=\"font-family: Arial\">User A</span><span style=\"font-family: 宋体\">想跟</span><span style=\"font-family: Arial\">User B</span><span style=\"font-family: 宋体\">进行谈话的愿望。这个请求包含语音流协议的细节。</span><span style=\"font-family: Arial\">payload</span><span style=\"font-family: 宋体\">中使用会话描述协议（</span><span style=\"font-family: Arial\">Session Description Protocol</span><span style=\"font-family: 宋体\">，</span><a href=\"http://www.ietf.org/rfc/rfc2327.txt\">SDP</a>)<span style=\"font-family: 宋体\">就是为此目的。</span><span style=\"font-family: Arial\">SDP</span><span style=\"font-family: 宋体\">消息包含一个清单，其内容为</span><span style=\"font-family: Arial\">User A</span><span style=\"font-family: 宋体\">支持的所有介质编码。（这些编码使用</span><span style=\"font-family: Arial\">RTP</span><span style=\"font-family: 宋体\">进行传输。）</span></p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"288\">\n<p>INVITE<br>sip:UAB@example.com<br>SIP/2.0<br>Via: SIP/2.0/UDP 10.20.30.40:5060<br>From: UserA &lt;sip:UAA@example.com&gt;;tag=589304<br>To: UserB &lt;sip:UAB@example.com&gt;<br>Call-ID: 8204589102@example.com<br>CSeq: 1 INVITE<br>Contact: &lt;sip:UserA@10.20.30.40&gt;<br>Content-Type: application/sdp<br>Content-Length: 141<br> <br>v=0<br>o=UserA 2890844526 2890844526 IN IP4 10.20.30.40<br>s=Session SDP<br>c=IN IP4 10.20.30.40<br>t=3034423619 0<br>m=audio 49170 RTP/AVP 0<br>a=rtpmap:0 PCMU/8000</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"288\">\n<p>2. User Agent B<span style=\"font-family: 宋体\">读取该请求，然后告诉</span><span style=\"font-family: Arial\">User Agent A</span><span style=\"font-family: 宋体\">它已经收到请求。</span></p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"288\">\n<p>SIP/2.0<br>100 Trying<br>From: UserA &lt;sip:UAA@example.com&gt;;tag=589304<br>To: UserB &lt;sip:UAB@example.com&gt;<br>Call-ID: 8204589102@example.com<br>CSeq: 1 INVITE<br>Content-Length: 0</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"288\">\n<p>3.<span style=\"font-family: 宋体\">当电话响铃时，</span><span style=\"font-family: Arial\">User Agent B</span><span style=\"font-family: 宋体\">发送临时消息（响铃）给</span><span style=\"font-family: Arial\">User Agent A</span><span style=\"font-family: 宋体\">，这样它就不会超时和放弃。</span></p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"288\">\n<p>SIP/2.0<br>180 Ringing<br>From: UserA &lt;sip:UAA@example.com&gt;;tag=589304<br>To: UserB &lt;sip:UAB@example.com&gt;;tag=314159<br>Call-ID: 8204589102@example.com<br>CSeq: 1 INVITE<br>Content Length: 0</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"288\">\n<p>4.<span style=\"font-family: 宋体\">最终，</span><span style=\"font-family: Arial\">User B</span><span style=\"font-family: 宋体\">决定接受呼叫。此时，</span><span style=\"font-family: Arial\">User Agent B</span><span style=\"font-family: 宋体\">发送一个</span><span style=\"font-family: Arial\">OK</span><span style=\"font-family: 宋体\">响应给</span><span style=\"font-family: Arial\">User Agent A</span><span style=\"font-family: 宋体\">。在响应的</span><span style=\"font-family: Arial\">payload</span><span style=\"font-family: 宋体\">中，还有另一条</span><span style=\"font-family: Arial\">SDP</span><span style=\"font-family: 宋体\">消息。它包含一组两个用户代理都支持的介质编码。此时，双方正式处于呼叫中。使用</span><span style=\"font-family: Arial\">200</span><span style=\"font-family: 宋体\">类型的响应可以接受所有类型的</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">请求。</span></p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"288\">\n<p>SIP/2.0<br>200 OK<br>From: UserA &lt;sip:UAA@example.com&gt;;tag=589304<br>To: UserB &lt;sip:UAB@example.com&gt;;tag=314159<br>Call-ID: 8204589102@example.com<br>CSeq: 1 INVITE<br>Contact: &lt;sip:UserB@10.20.30.41&gt;<br>Content-Type: application/sdp<br>Content-Length: 140<br> <br>v=0<br>o=UserB 2890844527 2890844527 IN IP4 10.20.30.41<br>s=Session SDP<br>c=IN IP4 10.20.30.41<br>t=3034423619 0<br>m=audio 3456 RTP/AVP 0<br>a=rtpmap:0 PCMU/8000</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"288\">\n<p>5. User Agent A<span style=\"font-family: 宋体\">最后使用一条</span><span style=\"font-family: Arial\">ACK</span><span style=\"font-family: 宋体\">消息进行确认。对于这种请求类型来说，没有重试和响应消息，即使消息丢失。</span><span style=\"font-family: Arial\">ACK</span><span style=\"font-family: 宋体\">只在</span><span style=\"font-family: Arial\">INVITE</span><span style=\"font-family: 宋体\">消息中使用。</span></p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"288\">\n<p>ACK<br>sip:UAB@example.com SIP/2.0<br>Via: SIP/2.0/UDP 10.20.30.41:5060<br>Route: &lt;sip:UserB@10.20.30.41&gt;<br>From: UserA &lt;sip:UAA@example.com&gt;;tag=589304<br>To: UserB &lt;sip:UAB@example.com&gt;;tag=314159<br>Call-ID: 8204589102@example.com<br>CSeq: 1 ACK<br>Content-Length: 0</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"288\">\n<p>6..<span style=\"font-family: 宋体\">两个用户代理现在使用最后一条</span><span style=\"font-family: Arial\">SDP</span><span style=\"font-family: 宋体\">消息中选定的方法进行连接。</span></p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"288\">\n<p>RTP<span style=\"font-family: 宋体\">使用</span><span style=\"font-family: Arial\">PCMU/8000</span><span style=\"font-family: 宋体\">编码对在端口</span><span style=\"font-family: Arial\">49170 &amp; 3456</span><span style=\"font-family: 宋体\">上双向传输的音频数据进行打包。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"288\">\n<p>7.<span style=\"font-family: 宋体\">在通信会话结束时，其中一个用户挂断。此时，这个用户的用户代理发送一个新的请求</span><span style=\"font-family: Arial\">BYE</span><span style=\"font-family: 宋体\">。这条消息可以由任一方发送。</span></p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"288\">\n<p>BYE<br>sip:UAB@example.com SIP/2.0<br>Via: SIP/2.0/UDP 10.20.30.41:5060<br>To: UserB &lt;sip:UAB@example.com&gt;;tag=314159<br>From: UserA &lt;sip:UAA@example.com&gt;;tag=589304<br>Call-ID: 8204589102@example.com<br>CSeq: 1 BYE<br>Content-Length: 0</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"288\">\n<p>8.<span style=\"font-family: 宋体\">另一用户的用户代理接受该请求，然后使用一条</span><span style=\"font-family: Arial\">OK</span><span style=\"font-family: 宋体\">消息作为应答。呼叫连接至此断开。</span></p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"288\">\n<p>SIP/2.0<br>200 OK<br>To: UserB &lt;sip:UAB@example.com&gt;;tag=314159<br>From: UserA &lt;sip:UAA@example.com&gt;;tag=589304<br>Call-ID: 8204589102@example.com<br>CSeq: 1 BYE<br>Content-Length: 0</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n\n\n\n\n</tbody>\n\n\n\n\n</table>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　</span>SIP<span style=\"font-family: 宋体\">消息的第一行包含消息的类型和所使用的</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">版本（</span><span style=\"font-family: Arial\">2.0</span><span style=\"font-family: 宋体\">）。在请求中，这一行还包含一个叫做</span><span style=\"font-family: Arial\">SIP URI</span><span style=\"font-family: 宋体\">的地址。这代表消息的目的地。 </span><br><span style=\"font-family: 宋体\">这个例子说明了如何使用请求消息</span>INVITE<span style=\"font-family: 宋体\">、</span><span style=\"font-family: Arial\">ACK</span><span style=\"font-family: 宋体\">和</span><span style=\"font-family: Arial\">BYE</span><span style=\"font-family: 宋体\">，以及</span><span style=\"font-family: Arial\">200 OK</span><span style=\"font-family: 宋体\">响应消息。</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">中还存在许多其他消息。下面给出一些请求：</span></p>\n<table>\n<tbody>\n<tr>\n<td valign=\"center\" width=\"173\">\n<p align=\"center\"><strong>消息</strong></p>\n\n\n\n\n</td>\n<td valign=\"center\" width=\"404\">\n<p align=\"center\"><strong>用法</strong></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>INVITE</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>呼叫一个用户代理，传送一次呼叫。</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>ACK</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>确认呼叫。</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>BYE</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>终止呼叫。</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>CANCEL</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>终止还未<span style=\"font-family: Arial\">OK</span><span style=\"font-family: 宋体\">的呼叫。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>REGISTER</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>提供一项注册服务，带有一个联系地址和可以用来代替的别名。例如，在前面的例子中，地址<span style=\"font-family: Arial\">sip:UAA@example.com</span><span style=\"font-family: 宋体\">就是</span><span style=\"font-family: Arial\">sip:UserA@10.20.30.40</span><span style=\"font-family: 宋体\">的别名。然后，注册服务器</span><span style=\"font-family: Arial\">example.com</span><span style=\"font-family: 宋体\">就可以把呼叫转发给地址</span><span style=\"font-family: Arial\">10.20.30.40</span><span style=\"font-family: 宋体\">。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>OPTIONS</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>询问一个用户代理的<span style=\"font-family: Arial\">“</span><span style=\"font-family: 宋体\">能力</span><span style=\"font-family: Arial\">”</span><span style=\"font-family: 宋体\">（例如，该用户代理能够识别的消息和编码）。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n\n\n\n\n</tbody>\n\n\n\n\n</table>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　现在给出一些经常使用的响应消息：</span></p>\n<table>\n<tbody>\n<tr>\n<td valign=\"center\" width=\"173\">\n<p align=\"center\"><strong>消息</strong></p>\n\n\n\n\n</td>\n<td valign=\"center\" width=\"404\">\n<p align=\"center\"><strong>用法</strong></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>100 Trying</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>消息已收到，但是最终用户代理尚未进行处理。请等待。</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>180 Ringing</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>最终用户代理已经收到消息，正在提示用户。请等待。</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>200 OK</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>最终用户已经接受消息。</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>301 Moved Permanently &amp; 302 Moved Temporarily</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>用户代理的地址已经改变，新的永久或临时地址位于<span style=\"font-family: Arial\">Contact</span><span style=\"font-family: 宋体\">字段中。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>400 Bad Request</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>普通错误消息。客户端不能识别消息。</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>401 Unauthorized &amp; 407 Proxy Authentication Required</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>请使用证书重试。</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>404 Not Found</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>要联系的用户不存在或尚未注册。</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>408 Request Timeout</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>另一方没有响应。这意味着<span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">消息永远不会</span><span style=\"font-family: Arial\">OK</span><span style=\"font-family: 宋体\">。所有重试都将被丢弃。这并不意味着电话响太长时间（电话可以永远响铃）。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n\n\n\n\n</tbody>\n\n\n\n\n</table>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　消息使用类似的头字段类型。下面给出其中的一些：</span></p>\n<table>\n<tbody>\n<tr>\n<td valign=\"center\" width=\"173\">\n<p align=\"center\"><strong>头字段</strong></p>\n\n\n\n\n</td>\n<td valign=\"center\" width=\"404\">\n<p align=\"center\"><strong>用法</strong></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>From</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>SIP<span style=\"font-family: 宋体\">请求的发送者。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>To</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>SIP<span style=\"font-family: 宋体\">请求的接受者。这通常与</span><span style=\"font-family: Arial\">SIP URI</span><span style=\"font-family: 宋体\">相同（可以是一个</span><span style=\"font-family: Arial\">“</span><span style=\"font-family: 宋体\">别名</span><span style=\"font-family: Arial\">”</span><span style=\"font-family: 宋体\">或一个实际地址）。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>Contact</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>用户代理的实际地址。</p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>Call-ID</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>这并不是呼叫者的电话号码。它惟一地代表两个用户代理之间的完整呼叫或对话。所有相关的<span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">消息都使用同一个</span><span style=\"font-family: Arial\">Call-ID</span><span style=\"font-family: 宋体\">。例如，当一个用户代理收到一条</span><span style=\"font-family: Arial\">BYE</span><span style=\"font-family: 宋体\">消息，根据</span><span style=\"font-family: Arial\">Call-ID</span><span style=\"font-family: 宋体\">，它就知道要挂断哪次呼叫。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>CSeq</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>消息的顺序编号。这在一次对话或一个<span style=\"font-family: Arial\">Call-ID</span><span style=\"font-family: 宋体\">中是惟一的。这用于区别新的消息和</span><span style=\"font-family: Arial\">“</span><span style=\"font-family: 宋体\">重试消息</span><span style=\"font-family: Arial\">”</span><span style=\"font-family: 宋体\">。当一条初始消息没有及时</span><span style=\"font-family: Arial\">OK</span><span style=\"font-family: 宋体\">时，重试就会进行，并会定时发送。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>Content-Type</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>消息内<span style=\"font-family: Arial\">payload</span><span style=\"font-family: 宋体\">的</span><span style=\"font-family: Arial\">MIME</span><span style=\"font-family: 宋体\">类型。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n<tr>\n<td valign=\"top\" width=\"173\">\n<p>Content-Length</p>\n\n\n\n\n</td>\n<td valign=\"top\" width=\"404\">\n<p>payload<span style=\"font-family: 宋体\">的大小，以字节为单位。信封和</span><span style=\"font-family: Arial\">payload</span><span style=\"font-family: 宋体\">之间由一空行隔开。</span></p>\n\n\n\n\n</td>\n\n\n\n\n</tr>\n\n\n\n\n</tbody>\n\n\n\n\n</table>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　还有一些与消息路由选择功能相关的头字段，如：</span>Via<span style=\"font-family: 宋体\">、</span><span style=\"font-family: Arial\">Route</span><span style=\"font-family: 宋体\">和</span><span style=\"font-family: Arial\">Record-Route</span><span style=\"font-family: 宋体\">。许多头字段提供像</span><span style=\"font-family: Arial\">Accept</span><span style=\"font-family: 宋体\">、</span><span style=\"font-family: Arial\">User-Agent</span><span style=\"font-family: 宋体\">和</span><span style=\"font-family: Arial\">Supported</span><span style=\"font-family: 宋体\">这样的功能。其他头字段则提供像</span><span style=\"font-family: Arial\">Authorization</span><span style=\"font-family: 宋体\">、</span><span style=\"font-family: Arial\">Privacy</span><span style=\"font-family: 宋体\">和</span><span style=\"font-family: Arial\">WWW-Authenticate</span><span style=\"font-family: 宋体\">这样的安全性功能。还有很多其他的头字段存在。此外，这些字段中许多都有缩写语法（比如，</span><span style=\"font-family: Arial\">From = f</span><span style=\"font-family: 宋体\">，</span><span style=\"font-family: Arial\">To = t</span><span style=\"font-family: 宋体\">，等等）。</span></p>\n<h3><strong>SIP<span style=\"font-family: 宋体\">的其他功能</span></strong></h3>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　使用</span>SIP<span style=\"font-family: 宋体\">及其扩展可以实现很多应用：</span></p>\n<ul>\n<li>VoIP </li>\n<li><span style=\"font-family: 宋体\">视频会议</span> </li>\n<li><span style=\"font-family: 宋体\">针对文本和数据的即时消息传递，比如</span>MSN Instant Messenger </li>\n<li><span style=\"font-family: 宋体\">注册</span>(<span style=\"font-family: 宋体\">我在线</span><span style=\"font-family: Arial\">!) </span></li>\n<li><span style=\"font-family: 宋体\">到场</span>(<span style=\"font-family: 宋体\">我的伙伴在不在</span><span style=\"font-family: Arial\">?) </span></li>\n<li>Click-to-talk(<span style=\"font-family: 宋体\">点击通话，即点击这里便可与一个技术支持代理交谈</span><span style=\"font-family: Arial\">) </span></li>\n<li><span style=\"font-family: 宋体\">应答机器</span>/<span style=\"font-family: 宋体\">互动式语音应答（</span><span style=\"font-family: Arial\">Interactive Voice Response</span><span style=\"font-family: 宋体\">，</span><span style=\"font-family: Arial\">IVR)</span><span style=\"font-family: 宋体\">系统</span><span style=\"font-family: Arial\">(“</span><span style=\"font-family: 宋体\">请输入您的密码。请记录您的姓名。英文请按</span><span style=\"font-family: Arial\">1</span><span style=\"font-family: 宋体\">，西班牙语请按</span><span style=\"font-family: Arial\">2…”) </span></li>\n<li><span style=\"font-family: 宋体\">网络游戏，比如</span>Quake<span style=\"font-family: 宋体\">和一些手机游戏（甚至基于语音和</span><span style=\"font-family: Arial\">IM</span><span style=\"font-family: 宋体\">） </span></li>\n<li><span style=\"font-family: 宋体\">基于手机的应用程序</span> </li>\n<li><span style=\"font-family: 宋体\">移动电子商务</span> </li>\n\n\n\n\n</ul>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　基本上，如果是两个端点之间进行通信，</span>SIP<span style=\"font-family: 宋体\">就能完成。 </span><br><span style=\"font-family: 宋体\">但是，关于活动的</span>Web<span style=\"font-family: 宋体\">技术支持代理的想法又如何呢？现在我们能否使用</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">来实现它？我们能否使用</span><span style=\"font-family: Arial\">Java</span><span style=\"font-family: 宋体\">来实现它？干脆点说，可以。</span></p>\n<h3><strong>Java<span style=\"font-family: 宋体\">中的</span><span style=\"font-family: Arial\">SIP</span></strong></h3>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　我经常使用</span>SIP<span style=\"font-family: 宋体\">。我可以负责任地说，</span><span style=\"font-family: Arial\">Java</span><span style=\"font-family: 宋体\">为</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">提供了绝佳的支持。</span><span style=\"font-family: Arial\">Java</span><span style=\"font-family: 宋体\">技术的一个分支把与开发</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">应用程序相关的许多细节抽象出来，这对于</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">开发人员大有帮助。下面这些技术大部分位于</span><span style=\"font-family: Arial\">JAIN (Java APIs for Integrated Networks)</span><span style=\"font-family: 宋体\">工作组中。</span></p>\n<ul>\n<li>JAIN SIP API (<a href=\"http://www.jcp.org/en/jsr/detail?id=32\">JSR 32</a>) </li>\n<li>SIP Servlet API (<a href=\"http://www.jcp.org/en/jsr/detail?id=116\">JSR 116</a>) </li>\n<li>JAIN SIP Lite (<a href=\"http://www.jcp.org/en/jsr/detail?id=125\">JSR 125</a>) </li>\n<li>SIP API for J2ME (<a href=\"http://www.jcp.org/en/jsr/detail?id=180\">JSR 180</a>) </li>\n<li>JAIN SIMPLE Presence (<a href=\"http://www.jcp.org/en/jsr/detail?id=164\">JSR 164</a>) </li>\n<li>JAIN SIMPLE Instant Messaging (<a href=\"http://www.jcp.org/en/jsr/detail?id=165\">JSR 165</a>) </li>\n<li>JAIN SDP (<a href=\"http://www.jcp.org/en/jsr/detail?id=141\">JSR 141</a>) </li>\n<li>Java Media Framework for RTP (J2SE<span style=\"font-family: 宋体\">可选包，并非</span><span style=\"font-family: Arial\">JAIN</span><span style=\"font-family: 宋体\">的</span><span style=\"font-family: Arial\">) </span></li>\n\n\n\n\n</ul>\n<h3><strong><span style=\"font-family: 宋体\">其他相关技术有：</span></strong></h3>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　如果您希望开发一个客户端应用程序，就需要一个客户端</span>SIP<span style=\"font-family: 宋体\">引擎或者</span><span style=\"font-family: Arial\">“</span><span style=\"font-family: 宋体\">堆栈</span><span style=\"font-family: Arial\">”</span><span style=\"font-family: 宋体\">。</span><a href=\"http://jain-sip.dev.java.net/\"><span style=\"font-family: 宋体\">在这里</span></a><span style=\"font-family: 宋体\">可以找到一个优秀的开源</span>Java SIP<span style=\"font-family: 宋体\">堆栈。它还支持</span><span style=\"font-family: Arial\">SDP</span><span style=\"font-family: 宋体\">。如果不想自己开发</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">电话，您可以使用</span><a href=\"https://sip-communicator.dev.java.net/\"><span style=\"font-family: 宋体\">这个</span></a><span style=\"font-family: 宋体\">。</span></p>\n<h3><strong><span style=\"font-family: 宋体\">结束语</span></strong></h3>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　本文简要介绍了</span>SIP<span style=\"font-family: 宋体\">、它的使用场景，以及一些</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">语法。我们还了解了各种与</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">相关的</span><span style=\"font-family: Arial\">Java</span><span style=\"font-family: 宋体\">技术。尽管本文不够详尽，我还是希望它能够激发您的兴趣，并促使您开始使用它。</span><span style=\"font-family: Arial\">SIP</span><span style=\"font-family: 宋体\">的时代已经到来，现在使用它可以实现很多很酷的想法。 </span><br><span style=\"font-family: 宋体\">在本系列文章的第</span>2<span style=\"font-family: 宋体\">部分中，我将说明如何使用</span><span style=\"font-family: Arial\">SIP Servlet API</span><span style=\"font-family: 宋体\">编写一个聊天室应用程序。</span></p>\n<h3><strong><span style=\"font-family: 宋体\">参考资料</span></strong></h3>\n<ul>\n<li><a href=\"http://www.sipforum.com/\">SIP Forum</a>——SIP<span style=\"font-family: 宋体\">工作组的社区站点 </span></li>\n<li><a href=\"http://www.sipcentre.com/\">SIP Center</a>——<span style=\"font-family: 宋体\">另一个广受欢迎的社区站点 </span></li>\n<li><a href=\"http://www.ietf.org/rfc/rfc3261.txt\">RFC 3261</a>——SIP<span style=\"font-family: 宋体\">规范 </span></li>\n<li><a href=\"http://www.cs.columbia.edu/sip/drafts.html\">SIP<span style=\"font-family: 宋体\">的相关</span><span style=\"font-family: Arial\">RFC</span><span style=\"font-family: 宋体\">和草案</span></a> </li>\n<li><a href=\"http://jain-sip.dev.java.net/\"><span style=\"font-family: 宋体\">开源</span>JAIN SIP<span style=\"font-family: 宋体\">堆栈</span></a> </li>\n<li><a href=\"https://sip-communicator.dev.java.net/\"><span style=\"font-family: 宋体\">开源</span>SIP<span style=\"font-family: 宋体\">软件电话</span></a> </li>\n\n\n\n\n</ul>\n<p class=\"p\"><span style=\"font-family: 宋体\">　　</span><strong><span style=\"font-family: 宋体\">原文出处</span>:</strong><a href=\"http://dev2dev.bea.com/pub/a/2005/09/introduction-sip-part-1.html\">http://dev2dev.bea.com/pub/a/2005/09/introduction-sip-part-1.html</a></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 10:15</span> <a href=\"http://www.cnblogs.com/space-place/\">Splace</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7770931\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7770931);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=264187,cb_entryId=7770931,cb_blogApp=currentBlogApp,cb_blogUserGuid='fcbdd0c6-b6be-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/2 10:15:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 83, "image_url": ["https:"], "date_pub": "2017-11-02", "article_common": 1}
{"title": "chromium源码阅读--进程间通信（IPC）", "url": "http://www.cnblogs.com/danxi/p/7766147.html", "author": "丹西", "article_desc": "\r\n    第一篇就有提到Chromium是目前默认是采用多进程架构，当然，chromium有singe-process的版本。 多进程与多线程的区别，确实有很多可以讲的，我的另一篇博客也讲了一些 （Linux 进程，线程），这里是从浏览器的角度来说，如果是多线程，如果一个线程崩溃，影响了整个浏览器的使用，因为 ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/danxi/p/7766147.html\">chromium源码阅读--进程间通信（IPC）</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>     第一篇就有提到Chromium是目前默认是采用多进程架构，当然，chromium有singe-process的版本。</p>\n<p>     多进程与多线程的区别，确实有很多可以讲的，我的另一篇博客也讲了一些 （<a href=\"http://www.cnblogs.com/danxi/p/6617625.html\" target=\"_blank\">Linux 进程，线程</a>），这里是从浏览器的角度来说，如果是多线程，如果一个线程崩溃，影响了整个浏览器的使用，因为在现在的网页标准更新了很多个版本，会有不同标准的页面在网络上，极大可能出现解析，渲染，插件等问题，那么对于用户来说，体验就会差很多了，浏览一个页面出问题，就要重启浏览器。而多进程则可以避免此问题，render进程崩溃只会影响当前的tab。</p>\n<p>    嗯，上面说了那么多，就是为了说，多进程之间就需要进程通信来协作，而chromium的进程间通信是非常繁杂的，如何处理这个是我们需要了解的关键。</p>\n<p>   那么本质的问题就是：</p>\n<p>         1、发那些消息（Message Type）</p>\n<p>         2、消息通道是怎么建立的 (Message Channel)</p>\n<p>         3、发送者和接收者（Sender，Listener）</p>\n<p>OK，咱一个个来。</p>\n<p> </p>\n<p>一、 Message Type </p>\n<p>     主要分为2类：“routed” 和 “control”。</p>\n<p>     1、routed消息</p>\n<p>         主要是用来给某个RenderViewHost对象发送消息的。不过，任何类都可以通过GetNextRoutingID 和 AddRoute 注册，就能接收routed消息。</p>\n<p>     2、control消息</p>\n<p>          control消息有创建pipe的类处理，当然这些类也可以接收routed消息。比如，请求资源或修改剪贴板不是特定于视图的，所以是控制消息。</p>\n<p>     3、消息的声明</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> IPC_MESSAGE_ROUTED2(FrameHostMsg_MyMessage, GURL, <span style=\"color: #0000ff\">int</span>)</pre>\n</div>\n<p>      这个宏用来声明routed消息，这里声明了一个从render进程发送到browser进程的消息，并有一个GURL参数，一个int参数</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> IPC_MESSAGE_CONTROL0(FrameMsg_MyMessage)</pre>\n</div>\n<p>     这个宏用来声明control消息，这里声明了一个从browser进程发送到render进程的消息，没有参数。</p>\n<p>     这里还有几个默认的约定：</p>\n<p>          （1）这些宏后面的数字表明有几个参数，最多5个参数，即： IPC_MESSAGE_ROUTED0~IPC_MESSAGE_ROUTED5 或者 IPC_MESSAGE_CONTROL0~IPC_MESSAGE_CONTROL5</p>\n<p>          （2）消息名称表明消息的接受者，FrameHostMsg，带Host后缀的类，表示在browser进程接收处理的消息，FrameMsg，则表示在render进程处理的消息，如果是Plugin进程，也会带有Plugin字样。</p>\n<p> </p>\n<p>二、Message Channel</p>\n<p>    chromium的使用mojo IPC，并且在官网提供了性能对比 （<span style=\"font-size: 11pt; font-family: Arial; color: #000000; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">Times in microseconds</span>）</p>\n<div style=\"margin-left: 0pt\" dir=\"ltr\">\n<table style=\"border: none; border-collapse: collapse\"><colgroup><col width=\"235\"><col width=\"96\"><col width=\"94\"><col width=\"166\"></colgroup>\n<tbody>\n<tr style=\"height: 15pt\">\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\"> </td>\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">Windows Z840</span></p>\n</td>\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">Linux Z620</span></p>\n</td>\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">MacBook Pro 15\" 2016</span></p>\n</td>\n</tr>\n<tr style=\"height: 15pt\">\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">IPC</span></p>\n</td>\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt; text-align: right\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">36.9</span></p>\n</td>\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt; text-align: right\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">69.5</span></p>\n</td>\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt; text-align: right\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">52.5</span></p>\n</td>\n</tr>\n<tr style=\"height: 15pt\">\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">Mojo cross-process</span></p>\n</td>\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt; text-align: right\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">28.2</span></p>\n</td>\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt; text-align: right\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">48</span></p>\n</td>\n<td style=\"vertical-align: bottom; padding: 2pt 2pt 2pt 2pt; border: solid #cccccc 0.75pt\">\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt; text-align: right\" dir=\"ltr\"><span style=\"font-size: 10pt; font-family: Arial; color: #000000; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">34.9</span></p>\n</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt\" dir=\"ltr\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\">  </span></p>\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt\" dir=\"ltr\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; font-weight: 400; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\"> 这里是官网关于mojo的一些介绍，<a href=\"https://chromium.googlesource.com/chromium/src/+/master/mojo/README.md#System-Overview\" target=\"_blank\">https://chromium.googlesource.com/chromium/src/+/master/mojo/README.md#System-Overview</a></span></p>\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt\" dir=\"ltr\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; font-weight: 400; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap\"> 从unittest看channel的创建：</span></p>\n<p style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt\" dir=\"ltr\"> </p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #0000ff\">void</span> IPCChannelMojoTestBase::CreateChannel(IPC::Listener*<span style=\"color: #000000\"> listener) {\n</span><span style=\"color: #008080\">2</span>   channel_ =\n<span style=\"color: #008080\">3</span> <span style=\"color: #000000\">      IPC::ChannelMojo::Create(TakeHandle(), IPC::Channel::MODE_SERVER,\n</span><span style=\"color: #008080\">4</span>                                listener, <span style=\"color: #0000ff\">base</span><span style=\"color: #000000\">::ThreadTaskRunnerHandle::Get());\n</span><span style=\"color: #008080\">5</span> }</pre>\n</div>\n<p> 在<span style=\"color: #000000\">IPC::ChannelMojo::Create</span>里看到需要 <span style=\"color: #000000\">IPC::ChannelMojo的构造，</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #000000\">ChannelMojo::ChannelMojo(\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #000000\">    mojo::ScopedMessagePipeHandle handle,\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #000000\">    Mode mode,\n</span><span style=\"color: #008080\"> 4</span>     Listener*<span style=\"color: #000000\"> listener,\n</span><span style=\"color: #008080\"> 5</span>     <span style=\"color: #0000ff\">const</span> scoped_refptr&lt;<span style=\"color: #0000ff\">base</span>::SingleThreadTaskRunner&gt;&amp;<span style=\"color: #000000\"> ipc_task_runner)\n</span><span style=\"color: #008080\"> 6</span> <span style=\"color: #000000\">    : task_runner_(ipc_task_runner),\n</span><span style=\"color: #008080\"> 7</span>       pipe_(handle.<span style=\"color: #0000ff\">get</span><span style=\"color: #000000\">()),\n</span><span style=\"color: #008080\"> 8</span> <span style=\"color: #000000\">      listener_(listener),\n</span><span style=\"color: #008080\"> 9</span>       weak_factory_(<span style=\"color: #0000ff\">this</span><span style=\"color: #000000\">) {\n</span><span style=\"color: #008080\">10</span>   weak_ptr_ =<span style=\"color: #000000\"> weak_factory_.GetWeakPtr();\n</span><span style=\"color: #008080\">11</span>   bootstrap_ =<span style=\"color: #000000\"> MojoBootstrap::Create(std::move(handle), mode, ipc_task_runner);\n</span><span style=\"color: #008080\">12</span> }</pre>\n</div>\n<p> 在MojoBootstrapImpl里完成sender和listener的绑定：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">class</span> MojoBootstrapImpl : <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> MojoBootstrap {\n</span><span style=\"color: #008080\"> 2</span>  <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #000000\">  MojoBootstrapImpl(\n</span><span style=\"color: #008080\"> 4</span> <span style=\"color: #000000\">      mojo::ScopedMessagePipeHandle handle,\n</span><span style=\"color: #008080\"> 5</span>       <span style=\"color: #0000ff\">const</span> scoped_refptr&lt;ChannelAssociatedGroupController&gt;<span style=\"color: #000000\"> controller)\n</span><span style=\"color: #008080\"> 6</span> <span style=\"color: #000000\">      : controller_(controller),\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #000000\">        associated_group_(controller),\n</span><span style=\"color: #008080\"> 8</span> <span style=\"color: #000000\">        handle_(std::move(handle)) {}\n</span><span style=\"color: #008080\"> 9</span> \n<span style=\"color: #008080\">10</span>   ~MojoBootstrapImpl() <span style=\"color: #0000ff\">override</span><span style=\"color: #000000\"> {\n</span><span style=\"color: #008080\">11</span>     controller_-&gt;<span style=\"color: #000000\">ShutDown();\n</span><span style=\"color: #008080\">12</span> <span style=\"color: #000000\">  }\n</span><span style=\"color: #008080\">13</span> \n<span style=\"color: #008080\">14</span>  <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\">15</span>   <span style=\"color: #0000ff\">void</span> Connect(mojom::ChannelAssociatedPtr*<span style=\"color: #000000\"> sender,\n</span><span style=\"color: #008080\">16</span>                mojom::ChannelAssociatedRequest* receiver) <span style=\"color: #0000ff\">override</span><span style=\"color: #000000\"> {\n</span><span style=\"color: #008080\">17</span>     controller_-&gt;<span style=\"color: #000000\">Bind(std::move(handle_));\n</span><span style=\"color: #008080\">18</span>     controller_-&gt;<span style=\"color: #000000\">CreateChannelEndpoints(sender, receiver);\n</span><span style=\"color: #008080\">19</span> <span style=\"color: #000000\">  }\n</span><span style=\"color: #008080\">20</span> \n<span style=\"color: #008080\">21</span> <span style=\"color: #000000\"> 。。。\n</span><span style=\"color: #008080\">22</span> }</pre>\n</div>\n<p> 上面的mojo  Channel的创建过程，linux提供的IPC比如：pipe，unix socket，share memory都不是线程安全的，mojo封装了底层IPC细节并提供了线程安全保障，并且看上面的性能对比，mojo性能更好，这也是chromium逐渐转用mojo的主要因素吧。</p>\n<p> OK，上面介绍了mojo，接下来我们会发现，在进程里都是使用IPC::ChannelProxy这个类来代理完成Channel的各种工作。</p>\n<p> 这里我们只需看一个例子就能理解了，比如在browser进程的<a class=\"f-b\" href=\"https://cs.chromium.org/chromium/src/content/public/browser/render_process_host.h?l=65&amp;gs=cpp%253Acontent%253A%253Aclass-RenderProcessHost%2540chromium%252F..%252F..%252Fcontent%252Fpublic%252Fbrowser%252Frender_process_host.h%257Cdef&amp;gsn=RenderProcessHost&amp;ct=xref_usages\">RenderProcessHost</a>类里声明了GetChannel接口：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> IPC::ChannelProxy* GetChannel() = <span style=\"color: #800080\">0</span>;</pre>\n</div>\n<p>根据chromium的套路，你大致就能想到，有一个RenderProcessHostImpl类会来实现这个接口，嗯，果不其然：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> CONTENT_EXPORT RenderProcessHostImpl\n</span><span style=\"color: #008080\"> 2</span>     : <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> RenderProcessHost,\n</span><span style=\"color: #008080\"> 3</span>       <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> ChildProcessLauncher::Client,\n</span><span style=\"color: #008080\"> 4</span>       <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> ui::GpuSwitchingObserver,\n</span><span style=\"color: #008080\"> 5</span>       <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> mojom::RouteProvider,\n</span><span style=\"color: #008080\"> 6</span>       <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> mojom::AssociatedInterfaceProvider,\n</span><span style=\"color: #008080\"> 7</span>       <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> mojom::RendererHost {\n</span><span style=\"color: #008080\"> 8</span> <span style=\"color: #000000\">      ...\n</span><span style=\"color: #008080\"> 9</span>       IPC::ChannelProxy* GetChannel() <span style=\"color: #0000ff\">override</span><span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #000000\">      ...\n</span><span style=\"color: #008080\">11</span> }</pre>\n</div>\n<p>我们可以看到这里会提供一个IPC::ChannelProxy的指针，那么顺着这个，ChannelProxy的创建和初始化就不远了。</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">bool</span><span style=\"color: #000000\"> RenderProcessHostImpl::Init() {\n   ...\n   </span><span style=\"color: #0000ff\">if</span> (!<span style=\"color: #000000\">channel_)\n    InitializeChannelProxy();\n  \n   ...\n   CreateMessageFilters();\n  RegisterMojoInterfaces();\n  ...\n\n}</span></pre>\n</div>\n<p>可以看到，上面初始化了Channel并给当前实例创建了MessageFilter和在mojo里注册了消息发送的mojo interface。</p>\n<p>mojo会负责将channel两端连通，之后的消息发送就可使用IPC::ChannelProxy来完成了。</p>\n<p> </p>\n<p>三、发送者和接收者</p>\n<p>    1、发送者</p>\n<p>    chromium里定义了IPC::Sender的接口：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Message;\n</span><span style=\"color: #008080\"> 2</span> \n<span style=\"color: #008080\"> 3</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> IPC_EXPORT Sender {\n</span><span style=\"color: #008080\"> 4</span>  <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\"> 5</span>   <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> Sends the given IPC message.  The implementor takes ownership of the\n</span><span style=\"color: #008080\"> 6</span>   <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> given Message regardless of whether or not this method succeeds.  This\n</span><span style=\"color: #008080\"> 7</span>   <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> is done to make this method easier to use.  Returns true on success and\n</span><span style=\"color: #008080\"> 8</span>   <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> false otherwise.</span>\n<span style=\"color: #008080\"> 9</span>   <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">bool</span> Send(Message* msg) = <span style=\"color: #800080\">0</span><span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">10</span> \n<span style=\"color: #008080\">11</span>  <span style=\"color: #0000ff\">protected</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\">12</span>   <span style=\"color: #0000ff\">virtual</span> ~<span style=\"color: #000000\">Sender() {}\n</span><span style=\"color: #008080\">13</span> };</pre>\n</div>\n<p>    上面的使用例子，我们可以看到 IPC::ChannelProxy 是消息的发送者，看类的声明：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #0000ff\">class</span> IPC_EXPORT ChannelProxy : <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Sender {\n</span><span style=\"color: #008080\">2</span> \n<span style=\"color: #008080\">3</span> }</pre>\n</div>\n<p>2、接收者</p>\n<p>    同样chromium也定义Listener。</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Message;\n\n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> Implemented by consumers of a Channel to receive messages.</span>\n<span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> IPC_EXPORT Listener {\n </span><span style=\"color: #0000ff\">public</span><span style=\"color: #000000\">:\n  </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> Called when a message is received.  Returns true iff the message was\n  </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> handled.</span>\n  <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">bool</span> OnMessageReceived(<span style=\"color: #0000ff\">const</span> Message&amp; message) = <span style=\"color: #800080\">0</span><span style=\"color: #000000\">;\n\n  ...\n};</span></pre>\n</div>\n<p>我们在前面提到的router，是消息接收者，也是消息发送者:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #0000ff\">class</span> IPC_EXPORT MessageRouter : <span style=\"color: #0000ff\">public</span> Listener, <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Sender { \n</span><span style=\"color: #008080\">2</span> <span style=\"color: #000000\">    ...\n</span><span style=\"color: #008080\">3</span> }</pre>\n</div>\n<p>还有子线程实例也是Listener：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> CONTENT_EXPORT ChildThreadImpl\n</span><span style=\"color: #008080\">2</span>     : <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> IPC::Listener,\n</span><span style=\"color: #008080\">3</span>       <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> ChildThread,\n</span><span style=\"color: #008080\">4</span>       <span style=\"color: #0000ff\">private</span> <span style=\"color: #0000ff\">base</span><span style=\"color: #000000\">::FieldTrialList::Observer,\n</span><span style=\"color: #008080\">5</span>       <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> mojom::RouteProvider,\n</span><span style=\"color: #008080\">6</span>       <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> mojom::AssociatedInterfaceProvider,\n</span><span style=\"color: #008080\">7</span>       <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> mojom::ChildControl {\n</span><span style=\"color: #008080\">8</span> <span style=\"color: #000000\">    ...\n</span><span style=\"color: #008080\">9</span>  }</pre>\n</div>\n<p>好了，更多例子我也不举了，chromium IPC还有更多的内容，在代码待我们学习，这里暂时总结到这里，后续再补充。</p>\n<p> </p>\n<p>   </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 10:21</span> <a href=\"http://www.cnblogs.com/danxi/\">丹西</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766147\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766147);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=280174,cb_entryId=7766147,cb_blogApp=currentBlogApp,cb_blogUserGuid='218a41e9-a103-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/2 10:21:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 136, "image_url": ["https:"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "压缩感知重构算法之子空间追踪(SP)", "url": "http://www.cnblogs.com/wwf828/p/7686937.html", "author": "闪电gogogo", "article_desc": "\r\n    SP的提出时间比CoSaMP提出时间稍晚一些，但和压缩采样匹配追踪(CoSaMP)的方法几乎是一样的。SP与CoSaMP主要区别在于“In each iteration, in the SP algorithm, only K new candidates are added, while theC ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/wwf828/p/7686937.html\">压缩感知重构算法之子空间追踪(SP)</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><div><span style=\"font-size: 16px;\">SP的提出时间比CoSaMP提出时间稍晚一些，但和压缩采样匹配追踪(CoSaMP)的方法几乎是一样的。SP与CoSaMP主要区别在于“In each iteration, in the SP algorithm, only K new candidates are added, while theCoSAMP algorithm adds 2K vectors.”，即SP每次选择K个原子，而CoSaMP则选择2K个原子；这样带来的好处是“This makes the SP algorithm computationally moreefficient,”。</span></div>\r\n<p><span style=\"font-size: 16px;\"><!--5f39ae17-8c62-4a45-bc43-b32064c9388a:W3siYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImxpbmUtaGVpZ2h0IjoxLjUsInRleHQtaW5kZW50IjoxLCJhbGlnbiI6ImxlZnQiLCJpbmRlbnQiOjB9LCJibG9ja0lkIjoiOTl0cHZyMTQ5MjQzNzE0ODE4MyIsInJpY2hUZXh0Ijp7ImlzUmljaFRleHQiOnRydWUsImtlZXBMaW5lQnJlYWsiOnRydWUsImRhdGEiOlt7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaPkCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWHuiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaXtiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumXtCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuavlCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IkMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaPkCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWHuiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaXtiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumXtCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueojSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaZmiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4gCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS6myIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS9hiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWSjCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWOiyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iue8qSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHhyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuagtyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWMuSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumFjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui/vSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui4qiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IigiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJDIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pa5Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5rOVIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YegIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LmOIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pivIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LiAIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5qC3Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi44CCIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuI4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJDIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuLsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLopoEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLljLoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliKsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlnKgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuo4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLigJwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJJIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJoIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiaSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJsIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiaSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJoIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJsIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoieSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJLIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJjIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJkIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiaSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiQyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiQSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJsIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiaSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJoIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJLIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiciIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi4oCdIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Y2zIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmr48iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmrKEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLpgIkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmi6kiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJLIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LiqIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Y6fIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5a2QIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6ICMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiQyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YiZIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6YCJIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5oupIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IksiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuKoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLljp8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlrZAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvJsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLov5kiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmoLciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLluKYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnaUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlpb0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlpIQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmmK8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLigJwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJUIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiaCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiayIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJoIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiciIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiaCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJtIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoicCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ5Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiciIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIsIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi4oCdIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi44CCIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX1dfX1d--></span></p>\r\n<div><span style=\"font-size: 16px;\">在看代码之前，先看了SP的论文[1]，在摘要部分提到SP算法具有两个主要特点：一是较低的计算复杂度，特别是针对比较稀疏的信号的重构时，相比OMP算法，SP算法具有更低的计算复杂度；二是具有和线性规划优化（LP）方法相近的重构精度。在待重构信号具有比较小的稀疏度的情况下，SP的计算复杂度明显比LP方法的小，但是重构质量比LP的差。</span></div>\r\n<div><span style=\"font-size: 16px;\">在论文中还提到这么一段与OMP方法的比较，并提供了图形加以理解。SP方法和OMP方法最大的区别就是针对所选择的原子有无回溯（反向跟踪）。</span></div>\r\n<p><span style=\"font-size: 16px;\"><!--5f39ae17-8c62-4a45-bc43-b32064c9388a:W3siYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImxpbmUtaGVpZ2h0IjoxLjUsInRleHQtaW5kZW50IjoxLCJhbGlnbiI6ImxlZnQiLCJpbmRlbnQiOjB9LCJibG9ja0lkIjoiODdhemVnMTQ5MjQzNjMyOTIxMSIsInJpY2hUZXh0Ijp7ImlzUmljaFRleHQiOnRydWUsImtlZXBMaW5lQnJlYWsiOnRydWUsImRhdGEiOlt7ImNoYXIiOiLlnKgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnnIsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLku6MiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnoIEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuYsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliY0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvIwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlhYgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnnIsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuoYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuiuuiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaWhyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIxIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiXSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWcqCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaRmCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuimgSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumDqCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWIhiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaPkCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWIsCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi566XIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5rOVIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YW3Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pyJIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LikIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LiqIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Li7Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6KaBIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi54m5Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi54K5Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yaIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LiAIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pivIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6L6DIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5L2OIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6K6hIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi566XIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5aSNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5p2CIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5bqmIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi54m5Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YirIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pivIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6ZKIIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5a+5Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5q+UIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6L6DIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi56iAIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55aPIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5L+hIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Y+3Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6YeNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5p6EIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pe2Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55u4Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5q+UIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi566XIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5rOVIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnrpciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLms5UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlhbciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnIkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmm7QiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkvY4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLorqEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnrpciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlpI0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnYIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLluqYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvJsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuowiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmmK8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlhbciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnIkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlkowiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnur8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmgKciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLop4QiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliJIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkvJgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLljJYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvIgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8iSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaWuSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuazlSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuebuCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui/kSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaehCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueyviIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuW6piIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuOAgiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWcqCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuW+hSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaehCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS/oSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWPtyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWFtyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaciSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuavlCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui+gyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWwjyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueogCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueWjyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuW6piIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaDhSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWGtSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4iyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6K6hIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi566XIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5aSNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5p2CIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5bqmIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5piOIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pi+Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5q+UIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmlrkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLms5UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlsI8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvIwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkvYYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmmK8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLph40iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLotKgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLph48iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmr5QiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuW3riIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuOAgiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19XX19LHsiYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImxpbmUtaGVpZ2h0IjoxLjUsInRleHQtaW5kZW50IjoxLCJhbGlnbiI6ImxlZnQiLCJpbmRlbnQiOjB9LCJibG9ja0lkIjoiMjh4eWFjMTQ5MjQzNjc1NTI3MSIsInJpY2hUZXh0Ijp7ImlzUmljaFRleHQiOnRydWUsImtlZXBMaW5lQnJlYWsiOnRydWUsImRhdGEiOlt7ImNoYXIiOiLlnKgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLorroiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmlociLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuK0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLov5giLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmj5AiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliLAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLov5kiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuYgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuIAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmrrUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuI4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJPIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmlrkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLms5UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmr5QiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLovoMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvIwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlubYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmj5AiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkvpsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuoYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlm74iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlvaIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliqAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLku6UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnkIYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLop6MiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLjgIIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaWuSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuazlSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWSjCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaWuSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuazlSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuacgCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWkpyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWMuiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWIqyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWwsSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaYryIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumSiCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWvuSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaJgCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumAiSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaLqSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWOnyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWtkCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaciSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaXoCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWbniIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iua6ryIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8iCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWPjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWQkSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui3nyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui4qiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8iSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuOAgiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19XX19XQ==--></span></p>\r\n<div><span style=\"font-size: 16px;\"><img style=\"margin-right: auto; margin-left: auto; display: block;\" src=\"http://images2017.cnblogs.com/blog/1212449/201710/1212449-20171018152741427-1261514351.jpg\" alt=\"\"></span>\r\n<p><span style=\"font-size: 16px;\"><img style=\"margin-right: auto; margin-left: auto; display: block;\" src=\"http://images2017.cnblogs.com/blog/1212449/201710/1212449-20171018152756459-1872119823.jpg\" alt=\"\"></span></p>\r\n<div><span style=\"font-size: 16px;\">参考文献[2]中对SP算法进行了解释，如下所示：</span></div>\r\n<p style=\"text-align: center;\"><span style=\"font-size: 16px;\"><!--5f39ae17-8c62-4a45-bc43-b32064c9388a:W3siYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImxpbmUtaGVpZ2h0IjoxLjUsInRleHQtaW5kZW50IjoxLCJhbGlnbiI6ImxlZnQiLCJpbmRlbnQiOjB9LCJibG9ja0lkIjoiMzhwZHdyMTQ5MjQzODQ2MTMyMyIsInJpY2hUZXh0Ijp7ImlzUmljaFRleHQiOnRydWUsImtlZXBMaW5lQnJlYWsiOnRydWUsImRhdGEiOlt7ImNoYXIiOiLlj4IiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLogIMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmlociLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnjK4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJbIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Il0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuK0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlr7kiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueulyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuazlSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui/myIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuihjCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS6hiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuinoyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHiiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWmgiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4iyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaJgCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuekuiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8miIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19XX19XQ==--><img src=\"http://images2017.cnblogs.com/blog/1212449/201710/1212449-20171018152814474-992601465.jpg\" alt=\"\"></span></p>\r\n<div><span style=\"font-size: 16px;\">在论文中还提到这么一段与OMP方法的比较，并提供了图形加以理解。SP方法和OMP方法最大的区别就是针对所选择的原子有无回溯（反向跟踪）。</span></div>\r\n<div><span style=\"font-size: 16px;\">以下是文献[1]中的给出的SP算法流程：</span></div>\r\n<p style=\"text-align: center;\"><span style=\"font-size: 16px;\"><!--5f39ae17-8c62-4a45-bc43-b32064c9388a:W3siYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImxpbmUtaGVpZ2h0IjoxLjUsInRleHQtaW5kZW50IjoxLCJhbGlnbiI6ImxlZnQiLCJpbmRlbnQiOjB9LCJibG9ja0lkIjoiNDR1eXVxMTQ5MjQzODQ3NjAxNCIsInJpY2hUZXh0Ijp7ImlzUmljaFRleHQiOnRydWUsImtlZXBMaW5lQnJlYWsiOnRydWUsImRhdGEiOlt7ImNoYXIiOiLlnKgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLorroiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmlociLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuK0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLov5giLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmj5AiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliLAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLov5kiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuYgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuIAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmrrUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuI4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJPIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmlrkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLms5UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmr5QiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLovoMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvIwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlubYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmj5AiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkvpsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuoYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlm74iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlvaIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliqAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLku6UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnkIYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLop6MiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLjgIIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaWuSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuazlSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWSjCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaWuSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuazlSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuacgCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWkpyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWMuiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWIqyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWwsSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaYryIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumSiCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWvuSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaJgCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumAiSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaLqSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWOnyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWtkCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaciSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaXoCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWbniIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iua6ryIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8iCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWPjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWQkSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui3nyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui4qiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8iSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuOAgiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19XX19LHsiYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImxpbmUtaGVpZ2h0IjoxLjUsInRleHQtaW5kZW50IjoxLCJhbGlnbiI6ImxlZnQiLCJpbmRlbnQiOjB9LCJibG9ja0lkIjoiNTZldnJvMTQ5MjQzODY2OTcwNyIsInJpY2hUZXh0Ijp7ImlzUmljaFRleHQiOnRydWUsImtlZXBMaW5lQnJlYWsiOnRydWUsImRhdGEiOlt7ImNoYXIiOiLCoCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS7pSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4iyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaYryIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaWhyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueMriIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIxIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiXSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4rSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iue7mSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWHuiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi566XIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5rOVIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5rWBIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi56iLIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yaIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX1dfX1d--><img src=\"http://images2017.cnblogs.com/blog/1212449/201710/1212449-20171018152857834-1792971196.png\" alt=\"\"></span></p>\r\n<div><span style=\"font-size: 16px;\">这个算法流程的初始化(Initialization)其实就是类似于CoSaMP的第1次迭代，注意第(1)步中选择了K个原子：“K indices corresponding to the largest magnitude entries”，在CoSaMP里这里要选择2K个最大的原子，后面的其它流程都一样。这里第(5)步增加了一个停止迭代的条件：当残差经过迭代后却变大了的时候就停止迭代。</span></div>\r\n<div><span style=\"font-size: 16px;\">鉴于SP与CoSaMP如此相似，这里不就再单独给出SP的步骤了，参考《<a href=\"http://blog.csdn.net/jbb0523/article/details/45441361\">压缩感知重构算法之压缩采样匹配追踪(CoSaMP)</a>》，只需将第(2)步中的2K改为K即可。</span></div>\r\n<div>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:matlab;gutter:true;\"><span style=\"font-size: 16px;\">function [ theta ] = CS_SP( y,A,K )\r\n%CS_SP Summary of this function goes here \r\n%Version: 1.0 written by jbb0523 @2015-05-01 \r\n%   Detailed explanation goes here \r\n%   y = Phi * x \r\n%   x = Psi * theta \r\n%   y = Phi*Psi * theta \r\n%   令 A = Phi*Psi, 则y=A*theta \r\n%   K is the sparsity level \r\n%   现在已知y和A，求theta \r\n%   Reference:Dai W，Milenkovic O．Subspace pursuit for compressive sensing \r\n%   signal reconstruction[J]．IEEE Transactions on Information Theory， \r\n%   2009，55(5)：2230-2249. \r\n    [y_rows,y_columns] = size(y); \r\n    if y_rows&lt;y_columns \r\n        y = y';%y should be a column vector \r\n    end \r\n    [M,N] = size(A);%传感矩阵A为M*N矩阵 \r\n    theta = zeros(N,1);%用来存储恢复的theta(列向量) \r\n    Pos_theta = [];%用来迭代过程中存储A被选择的列序号 \r\n    r_n = y;%初始化残差(residual)为y \r\n    for kk=1:K%最多迭代K次 \r\n        %(1) Identification \r\n        product = A'*r_n;%传感矩阵A各列与残差的内积 \r\n        [val,pos]=sort(abs(product),'descend'); \r\n        Js = pos(1:K);%选出内积值最大的K列 \r\n        %(2) Support Merger \r\n        Is = union(Pos_theta,Js);%Pos_theta与Js并集 \r\n        %(3) Estimation \r\n        %At的行数要大于列数，此为最小二乘的基础(列线性无关) \r\n        if length(Is)&lt;=M \r\n            At = A(:,Is);%将A的这几列组成矩阵At \r\n        else%At的列数大于行数，列必为线性相关的,At'*At将不可逆 \r\n            break;%跳出for循环 \r\n        end \r\n        %y=At*theta，以下求theta的最小二乘解(Least Square) \r\n        theta_ls = (At'*At)^(-1)*At'*y;%最小二乘解 \r\n        %(4) Pruning \r\n        [val,pos]=sort(abs(theta_ls),'descend'); \r\n        %(5) Sample Update \r\n        Pos_theta = Is(pos(1:K)); \r\n        theta_ls = theta_ls(pos(1:K)); \r\n        %At(:,pos(1:K))*theta_ls是y在At(:,pos(1:K))列空间上的正交投影 \r\n        r_n = y - At(:,pos(1:K))*theta_ls;%更新残差  \r\n        if norm(r_n)&lt;1e-6%Repeat the steps until r=0 \r\n            break;%跳出for循环 \r\n        end \r\n    end \r\n    theta(Pos_theta)=theta_ls;%恢复出的theta \r\nend \r\n</span></pre>\r\n</div>\r\n<div><span style=\"font-size: 16px;\">鉴于SP与CoSaMP的极其相似性，这里就不再给出单次重构和测量数M与重构成功概率关系曲线绘制例程代码了，只需将CoSaMP中调用CS_CoSaMP函数的部分改为调用CS_SP即可，无须任何其它改动。这里给出对比两种重构算法所绘制的测量数M与重构成功概率关系曲线的例程代码，只有这样才可以看出两种算法的重构性能优劣，以下是在分别运行完SP与CoSaMP的测量数M与重构成功概率关系曲线绘制例程代码的基础上，即已经存储了数据CoSaMPMtoPercentage1000.mat和SPMtoPercentage1000.mat：</span>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:matlab;gutter:true;\"><span style=\"font-size: 16px;\">clear all;close all;clc; \r\nload CoSaMPMtoPercentage1000; \r\nPercentageCoSaMP = Percentage; \r\nload SPMtoPercentage1000; \r\nPercentageSP = Percentage; \r\nS1 = ['-ks';'-ko';'-kd';'-kv';'-k*']; \r\nS2 = ['-rs';'-ro';'-rd';'-rv';'-r*']; \r\nfigure; \r\nfor kk = 1:length(K_set) \r\n    K = K_set(kk); \r\n    M_set = 2*K:5:N; \r\n    L_Mset = length(M_set); \r\n    plot(M_set,PercentageCoSaMP(kk,1:L_Mset),S1(kk,:));%绘出x的恢复信号 \r\n    hold on;     \r\n    plot(M_set,PercentageSP(kk,1:L_Mset),S2(kk,:));%绘出x的恢复信号 \r\nend \r\nhold off; \r\nxlim([0 256]); \r\nlegend('CoSaK=4','SPK=4','CoSaK=12','SPK=12','CoSaK=20',... \r\n    'SPK=20','CoSaK=28','SPK=28','CoSaK=36','SPK=36'); \r\nxlabel('Number of measurements(M)'); \r\nylabel('Percentage recovered'); \r\ntitle('Percentage of input signals recovered correctly(N=256)(Gaussian)'); \r\n</span></pre>\r\n</div>\r\n<div><span style=\"font-size: 16px;\">运行结果如下：</span></div>\r\n</div>\r\n<p><span style=\"font-size: 16px;\"><!--5f39ae17-8c62-4a45-bc43-b32064c9388a:W3siYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7InRleHQtaW5kZW50IjoxLCJhbGlnbiI6ImxlZnQiLCJpbmRlbnQiOjAsImxpbmUtaGVpZ2h0IjoxLjc1fSwiYmxvY2tJZCI6Ijl6YW1lMTQ5MjQzOTEyMDc2NCIsInJpY2hUZXh0Ijp7ImlzUmljaFRleHQiOnRydWUsImtlZXBMaW5lQnJlYWsiOnRydWUsImRhdGEiOlt7ImNoYXIiOiLpibQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuo4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4jiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IkMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaegSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWFtiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuebuCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS8vCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaApyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui/mSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWwsSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4jSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWGjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iue7mSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWHuiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWNlSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuasoSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaehCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWSjCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iua1iyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaVsCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuI4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLph40iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmiJAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlip8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmpoIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnjociLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlhbMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLns7siLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmm7IiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnur8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnu5giLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliLYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkvosiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnqIsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLku6MiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnoIEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuoYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvIwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlj6oiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLpnIAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlsIYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJDIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuK0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLosIMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnlKgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJDIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Il8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJDIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlh70iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmlbAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLpg6giLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliIYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmlLkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuLoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLosIMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnlKgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJDIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Il8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWNsyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWPryIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaXoCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumhuyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS7uyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS9lSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWFtiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWugyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaUuSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWKqCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuOAgiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui/mSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iue7mSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWHuiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWvuSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuavlCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4pCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuenjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaehCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueulyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuazlSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaJgCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iue7mCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWItiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iua1iyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaVsCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuI4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLph40iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmiJAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlip8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmpoIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnjociLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlhbMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLns7siLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmm7IiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnur8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkvosiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnqIsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLku6MiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnoIEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvIwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlj6oiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnIkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLov5kiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmoLciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmiY0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlj68iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLku6UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnnIsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlh7oiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuKQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnp40iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnrpciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLms5UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLph40iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmgKciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLog70iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkvJgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliqMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvIwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLku6UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuIsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmmK8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlnKgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliIYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliKsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLov5AiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLooYwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlrowiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4jiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IkMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iua1iyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaVsCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuI4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLph40iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmiJAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlip8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmpoIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnjociLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlhbMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLns7siLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmm7IiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnur8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnu5giLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliLYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkvosiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnqIsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLku6MiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnoIEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLln7oiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnoYAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuIoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvIwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLljbMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlt7IiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnu48iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlrZgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlgqgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuoYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmlbAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmja4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJDIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJjIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIwIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ii4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJtIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlkowiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiciIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIxIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIwIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiLiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8miIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19XX19XQ==--></span></p>\r\n</div>\r\n<p><span style=\"font-size: 16px;\"><!--5f39ae17-8c62-4a45-bc43-b32064c9388a:W3siYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImFsaWduIjoibGVmdCIsImluZGVudCI6MCwidGV4dC1pbmRlbnQiOjEsImxpbmUtaGVpZ2h0IjoxLjV9LCJibG9ja0lkIjoiOTJmbW5nMTQ5MjQzODY3MDAyOCIsInJpY2hUZXh0Ijp7ImlzUmljaFRleHQiOnRydWUsImtlZXBMaW5lQnJlYWsiOnRydWUsImRhdGEiOlt7ImNoYXIiOiLov5kiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuKoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnrpciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLms5UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmtYEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnqIsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLliJ0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlp4siLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLljJYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIoIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiSSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ6Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YW2Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5a6eIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5bCxIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pivIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi57G7Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Ly8Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LqOIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiQyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi56ysIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuasoSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui/rSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS7oyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuazqCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaEjyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuesrCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IigiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIxIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiKSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuatpSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4rSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumAiSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaLqSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS6hiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IksiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuKoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLljp8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlrZAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvJoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLigJwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJLIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJjIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiciIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoicCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiaCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJtIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiaSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ1Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiciIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoicyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuKAnSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWcqCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IkMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui/mSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuimgSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumAiSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaLqSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJLIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LiqIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pyAIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5aSnIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Y6fIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5a2QIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5ZCOIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6Z2iIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YW2Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5a6DIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5rWBIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi56iLIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6YO9Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LiAIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5qC3Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi44CCIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6L+ZIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6YeMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi56ysIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiKCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5q2lIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5aKeIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YqgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LqGIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LiAIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LiqIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YGcIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5q2iIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6L+tIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LujIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5p2hIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Lu2Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yaIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5b2TIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5q6LIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5beuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi57uPIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6L+HIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6L+tIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LujIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5ZCOIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Y20Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Y+YIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5aSnIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LqGIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55qEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pe2Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YCZIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5bCxIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YGcIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5q2iIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6L+tIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LujIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi44CCIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX1dfX0seyJibG9ja1R5cGUiOiJwYXJhZ3JhcGgiLCJzdHlsZXMiOnsiYWxpZ24iOiJsZWZ0IiwiaW5kZW50IjowLCJ0ZXh0LWluZGVudCI6MSwibGluZS1oZWlnaHQiOjEuNX0sImJsb2NrSWQiOiIxMGdxYmQxNDkyNDM4OTY1MjIzIiwicmljaFRleHQiOnsiaXNSaWNoVGV4dCI6dHJ1ZSwia2VlcExpbmVCcmVhayI6dHJ1ZSwiZGF0YSI6W3siY2hhciI6IumJtCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS6jiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LiOIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiQyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5aaCIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5q2kIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55u4Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Ly8Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6L+ZIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6YeMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LiNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5bCxIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5YaNIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Y2VIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi54usIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi57uZIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Ye6Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiUyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmraUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLpqqQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkuoYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvIwiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlj4IiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLogIMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLjgIoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLljosiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLnvKkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLmhJ8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLnn6UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLph40iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLmnoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLnrpciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLms5UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLkuYsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLljosiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLnvKkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLph4ciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLmoLciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLljLkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLphY0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLov70iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiLouKoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiIoIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDEzNjEifX0seyJjaGFyIjoiQyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxMzYxIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDEzNjEifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxMzYxIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTM2MSJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDEzNjEifX0seyJjaGFyIjoiKSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxMzYxIn19LHsiY2hhciI6IuOAiyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWPqiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumcgCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWwhiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuesrCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IigiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiKSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuatpSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4rSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IueahCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJLIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5pS5Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Li6Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiSyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWNsyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWPryIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuOAgiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19XX19XQ==--></span></p>\r\n<p><span style=\"font-size: 16px;\"> <img style=\"margin-right: auto; margin-left: auto; display: block;\" src=\"http://images2017.cnblogs.com/blog/1212449/201710/1212449-20171018153049052-1612335343.gif\" alt=\"\"></span></p>\r\n<div><span style=\"font-size: 16px;\">可以发现在M较小时SP略好于CoSaMP，当M变大时二者重构性能几乎一样。</span></div>\r\n<div><span style=\"font-size: 16px;\"> </span></div>\r\n<div><span style=\"font-size: 14px;\">参考文献：</span></div>\r\n<div><span style=\"font-size: 14px;\">[1] Dai W，Milenkovic O．Subspacepursuit for compressive sensing signal reconstruction[J]．IEEETransactions on Information Theory，2009，55(5)：2230-2249.</span></div>\r\n<div><span style=\"font-size: 14px;\">[2] 杨真真，杨震，孙林慧.信号压缩重构的正交匹配追踪类算法综述[J]. 信号处理，2013，29(4)：486-496.</span></div>\r\n<div><span style=\"font-size: 14px;\">[3] 彬彬有礼.<a href=\"http://blog.csdn.net/jbb0523/article/details/45441459\">压缩感知重构算法之子空间追踪(SP).http://blog.csdn.net/jbb0523/article/details/45441459</a></span></div>\r\n<p><span style=\"font-size: 16px;\"><!--5f39ae17-8c62-4a45-bc43-b32064c9388a:W3siYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImFsaWduIjoibGVmdCIsImluZGVudCI6MCwidGV4dC1pbmRlbnQiOjEsImxpbmUtaGVpZ2h0IjoxLjc1fSwiYmxvY2tJZCI6IjI0dGV3bDE0OTI0MzkxODkyNDEiLCJyaWNoVGV4dCI6eyJpc1JpY2hUZXh0Ijp0cnVlLCJrZWVwTGluZUJyZWFrIjp0cnVlLCJkYXRhIjpbeyJjaGFyIjoi5Y+vIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LulIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Y+RIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi546wIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5ZyoIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iui+gyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWwjyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaXtiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi55WlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5aW9Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LqOIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiQyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ik0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJUaW1lcyBOZXcgUm9tYW4iLCJmb250LXNpemUiOjE2LCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJQIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5b2TIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiVGltZXMgTmV3IFJvbWFuIiwiZm9udC1zaXplIjoxNiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWPmCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWkpyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaXtiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS6jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuiAhSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaehCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaApyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuiDvSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWHoCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS5jiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuS4gCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuagtyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuOAgiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IlRpbWVzIE5ldyBSb21hbiIsImZvbnQtc2l6ZSI6MTYsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19XX19LHsiYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImFsaWduIjoibGVmdCIsImluZGVudCI6MCwidGV4dC1pbmRlbnQiOjEsImxpbmUtaGVpZ2h0IjoxLjc1fSwiYmxvY2tJZCI6IjBra2ZtMTQ5MjQzOTIyMjkwMiIsInJpY2hUZXh0Ijp7ImlzUmljaFRleHQiOnRydWUsImtlZXBMaW5lQnJlYWsiOnRydWUsImRhdGEiOltdfX0seyJibG9ja1R5cGUiOiJwYXJhZ3JhcGgiLCJzdHlsZXMiOnsiYWxpZ24iOiJsZWZ0IiwiaW5kZW50IjowLCJ0ZXh0LWluZGVudCI6MCwibGluZS1oZWlnaHQiOjEuNzV9LCJibG9ja0lkIjoiNzZpdGNoMTQ5MjQzOTIyMzgxNyIsInJpY2hUZXh0Ijp7ImlzUmljaFRleHQiOnRydWUsImtlZXBMaW5lQnJlYWsiOnRydWUsImRhdGEiOlt7ImNoYXIiOiLlj4IiLCJzdHlsZXMiOnsiYm9sZCI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuiAgyIsInN0eWxlcyI6eyJib2xkIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5paHIiwic3R5bGVzIjp7ImJvbGQiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnjK4iLCJzdHlsZXMiOnsiYm9sZCI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8miIsInN0eWxlcyI6eyJib2xkIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX1dfX0seyJibG9ja1R5cGUiOiJwYXJhZ3JhcGgiLCJzdHlsZXMiOnsiYWxpZ24iOiJsZWZ0IiwiaW5kZW50IjowLCJ0ZXh0LWluZGVudCI6MCwibGluZS1oZWlnaHQiOjEuNzV9LCJibG9ja0lkIjoiOGx5aHExNDkyNDM5MjI0Nzg5IiwicmljaFRleHQiOnsiaXNSaWNoVGV4dCI6dHJ1ZSwia2VlcExpbmVCcmVhayI6dHJ1ZSwiZGF0YSI6W3siY2hhciI6IlsiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Il0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IkQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlciLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiaSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiZSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiayIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoibyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoidiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiaSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiYyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiTyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yOIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJTIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ1Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJiIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJwIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJjIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJwIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ1Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ1Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJmIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJjIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJtIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJwIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ2Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJnIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJnIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJsIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJjIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJzIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ1Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJjIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJvIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJbIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJKIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJdIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvI4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IkkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IkUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IkUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IkUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IkkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImEiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IiAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IlQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6InkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiOSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiI1Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiI1Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIoIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiI1Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvJoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ii0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjIiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ii4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19XX19LHsiYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImFsaWduIjoibGVmdCIsImluZGVudCI6MCwidGV4dC1pbmRlbnQiOjAsImxpbmUtaGVpZ2h0IjoxLjc1fSwiYmxvY2tJZCI6IjQxaGJuZjE0OTI0MzkyMzI5ODciLCJyaWNoVGV4dCI6eyJpc1JpY2hUZXh0Ijp0cnVlLCJrZWVwTGluZUJyZWFrIjp0cnVlLCJkYXRhIjpbeyJjaGFyIjoiWyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiXSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiICIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5p2oIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnnJ8iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuecnyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnagiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumchyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLlrZkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuaelyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5oWnIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkv6EiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWPtyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Y6LIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnvKkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumHjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5p6EIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnmoQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuatoyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5LqkIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLljLkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IumFjSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6L+9Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLouKoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuexuyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi566XIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLms5UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iue7vCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi6L+wIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJbIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJKIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiJdIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIuIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIgIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLkv6EiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuWPtyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5aSEIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLnkIYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Iu+8jCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi77yMIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIyIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiI5Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIoIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiI0Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiIpIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLvvJoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjgiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ii0iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjQiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IjYiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6Ii4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19XX19LHsiYmxvY2tUeXBlIjoicGFyYWdyYXBoIiwic3R5bGVzIjp7ImFsaWduIjoibGVmdCIsImluZGVudCI6MCwidGV4dC1pbmRlbnQiOjAsImxpbmUtaGVpZ2h0IjoxLjc1fSwiYmxvY2tJZCI6IjE5dHpkaTE0OTI0MzkyNTA4NzkiLCJyaWNoVGV4dCI6eyJpc1JpY2hUZXh0Ijp0cnVlLCJrZWVwTGluZUJyZWFrIjp0cnVlLCJkYXRhIjpbeyJjaGFyIjoiWyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiMyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiXSIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiwqAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuW9rCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5b2sIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiJ9fSx7ImNoYXIiOiLmnIkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIn19LHsiY2hhciI6IuekvCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoiLiIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYifX0seyJjaGFyIjoi5Y6LIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiLnvKkiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IuaEnyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoi55+lIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiLph40iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IuaehCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoi566XIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiLms5UiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IuS5iyIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoi5a2QIiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiLnqboiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IumXtCIsInN0eWxlcyI6eyJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMzMzMzMzIiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoi6L+9Iiwic3R5bGVzIjp7ImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMzMzMzMzMiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiLouKoiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IigiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IlMiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IlAiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IikiLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6Ii4iLCJzdHlsZXMiOnsiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzMzMzMzMyIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6ImgiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiJ0Iiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6InAiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiOiIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiIvIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6Ii8iLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiYiIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiJsIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6Im8iLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiZyIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiIuIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6ImMiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoicyIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiJkIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6Im4iLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiLiIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiJuIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6ImUiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiIvIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6ImoiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiYiIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiJiIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IjAiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiNSIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiIyIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IjMiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiLyIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiJhIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6InIiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoidCIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6ImMiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoibCIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6Ii8iLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiZCIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiJlIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6InQiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiYSIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiJpIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6ImwiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoicyIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiIvIiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IjQiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiNSIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiI0Iiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IjQiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiMSIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fSx7ImNoYXIiOiI0Iiwic3R5bGVzIjp7InVuZGVybGluZSI6dHJ1ZSwiZm9udC1mYW1pbHkiOiJBcmlhbCIsImNvbG9yIjoiIzAwMzg4NCIsImJhY2stY29sb3IiOiIjZmZmZmZmIiwiaHJlZiI6Imh0dHA6Ly9ibG9nLmNzZG4ubmV0L2piYjA1MjMvYXJ0aWNsZS9kZXRhaWxzLzQ1NDQxNDU5In19LHsiY2hhciI6IjUiLCJzdHlsZXMiOnsidW5kZXJsaW5lIjp0cnVlLCJmb250LWZhbWlseSI6IkFyaWFsIiwiY29sb3IiOiIjMDAzODg0IiwiYmFjay1jb2xvciI6IiNmZmZmZmYiLCJocmVmIjoiaHR0cDovL2Jsb2cuY3Nkbi5uZXQvamJiMDUyMy9hcnRpY2xlL2RldGFpbHMvNDU0NDE0NTkifX0seyJjaGFyIjoiOSIsInN0eWxlcyI6eyJ1bmRlcmxpbmUiOnRydWUsImZvbnQtZmFtaWx5IjoiQXJpYWwiLCJjb2xvciI6IiMwMDM4ODQiLCJiYWNrLWNvbG9yIjoiI2ZmZmZmZiIsImhyZWYiOiJodHRwOi8vYmxvZy5jc2RuLm5ldC9qYmIwNTIzL2FydGljbGUvZGV0YWlscy80NTQ0MTQ1OSJ9fV19fV0=--></span></p>\r\n<p><span style=\"font-size: 16px;\"> </span></p>\r\n<span style=\"font-size: 16px;\"><img src=\"file:///D:/Program%2520Files%2520%2528x86%2529/youdaoyun/Ynote/qq62B8CB8B9DB7E86B77B06F836EE1FF2E/77a98964d0dc49d09b697d525c70b865/3c86801d3dac454b9e018390a8f44f7c.jpg\" alt=\"\" data-attr-org-src-id=\"27EFC9230F21479697C90DCD68D52548\" data-media-type=\"image\"></span></div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 09:29</span> <a href=\"http://www.cnblogs.com/wwf828/\">闪电gogogo</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7686937\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7686937);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=371309,cb_entryId=7686937,cb_blogApp=currentBlogApp,cb_blogUserGuid='4789acf5-0e3d-4677-570b-08d49c352df3',cb_entryCreatedDate='2017/11/2 9:29:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 99, "image_url": ["https:"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "[Bayesian] “我是bayesian我怕谁”系列 - Variational Inference", "url": "http://www.cnblogs.com/jesse123/p/7764672.html", "author": "郝一二三", "article_desc": "涉及的领域可能有些生僻，骗不了大家点赞。但毕竟是人工智能的主流技术，在园子却成了非主流。 不可否认的是：乃值钱的技术，提高身价的技术，改变世界观的技术。 关于变分，通常的课本思路是： GMM --> EM --> VI --> Variational Bayesian Gaussian Mixtur ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/jesse123/p/7764672.html\">[Bayesian] “我是bayesian我怕谁”系列 - Variational Inference</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>涉及的领域可能有些生僻，骗不了大家点赞。但毕竟是人工智能的主流技术，在园子却成了非主流。</p>\r\n<p>不可否认的是：乃值钱的技术，提高身价的技术，改变世界观的技术。</p>\r\n<p> </p>\r\n<p>关于变分，通常的课本思路是：</p>\r\n<p>GMM --&gt; EM --&gt; VI --&gt; <a id=\"CategoryEntryList1_EntryStoryList_ctl00_Entries_TitleUrl_5\" class=\"entrylistItemTitle\" href=\"http://www.cnblogs.com/jesse123/p/7501743.html\">Variational Bayesian Gaussian Mixture</a></p>\r\n<p>GMM是个好东西，实用的模型，也是讲解收敛算法的一个好载体。</p>\r\n<p>关于这部分内容，如果你懂中文，推荐一个人，<a title=\"教材链接\" href=\"http://www-staff.it.uts.edu.au/~ydxu/ml_course/\" target=\"_blank\">徐亦达老师</a>。中文教学，亲手推算公式给读者的视频，是需要珍惜和珍藏的。</p>\r\n<p>因为提供了ppt，也有配套的视频，于是上半年将链接中的内容都走了一遍，感觉棒棒哒～</p>\r\n<p>基本上涵盖了该领域主流技术七成的基础内容，同时也节省了我大量的时间，学完后内力通常都能提高一两成的样子。</p>\r\n<p>再次道一句：“<span style=\"font-family: 'Microsoft YaHei';\">好人一生平安</span>“</p>\r\n<p> </p>\r\n<p> </p>\r\n<p><span style=\"font-size: 18pt;\"><strong><span style=\"font-family: 'courier new', courier; color: #333399;\">GMM --&gt; EM</span></strong></span></p>\r\n<hr>\r\n<p>From: <a href=\"http://www-staff.it.uts.edu.au/~ydxu/ml_course/em.pdf\" target=\"_blank\">http://www-staff.it.uts.edu.au/~ydxu/ml_course/em.pdf</a></p>\r\n<p>解决的问题也很简单，一堆点，你通过平移或是缩放，用几个高斯去拟合数据。到底用几个高斯，这是个问题，而且是个高级问题。能提出这个问题，说明你是一只有潜力变成凤凰的菜鸡。</p>\r\n<p>我们目前先考虑采用固定个数的高斯去”尽量地”拟合。</p>\r\n<p><img style=\"border: 1px solid black; display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171101070121170-128032784.png\" alt=\"\" width=\"391\" height=\"340\"></p>\r\n<p style=\"text-align: center;\">Figure, fitting with three Gaussian distribution</p>\r\n<p>注意，这里的高斯是多维高斯；</p>\r\n<p>总有人说数学基础很重要，确实如此，问问自己两个最最基本的问题：</p>\r\n<ol>\r\n<li>多维高斯的表达形式是？</li>\r\n<li>有一个满足多维高斯的变量<em><strong>x</strong></em>，那么<em><strong>x</strong></em><sup>2</sup>满足的分布以及参数是？</li>\r\n</ol>\r\n<p>暂时不会也没关系，毕竟不是每个人都想当牛人拿高薪求创业。怕得就是不愿懂但还是想当牛人拿高薪求创业的孩子们。</p>\r\n<p>如何懂？可以拿一本《多元变量分析》or《矩阵论》打基础。</p>\r\n<p> </p>\r\n<p>说到底，就是个如何估参的问题。</p>\r\n<p><img style=\"border: 1px solid black; display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171101074256670-1902562256.png\" alt=\"\"></p>\r\n<p style=\"text-align: center;\"><strong>公式1</strong></p>\r\n<p> </p>\r\n<p>图中的每个点，你可以说属于任何一个高斯，只是概率不同罢了。</p>\r\n<p>自然而然地，需要加上一个隐变量z来表示这个意思： <span style=\"color: #ff0000;\"><strong>p(Z|X, Θ)</strong></span> 　<span style=\"color: #008080;\">＃某个点Ｘ属于哪一个高斯的概率</span></p>\r\n<p> </p>\r\n<p><img style=\"border: 1px solid black; display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171101075833404-241598374.png\" alt=\"\"></p>\r\n<p style=\"text-align: center;\"><strong>公式2</strong>：更新θ</p>\r\n<p>关于这个更新theta的公式，其实这么想会容易理解一些：</p>\r\n<p style=\"margin-left: 30px;\">Ａ君：我觉得目前的Θ<sup>(g)</sup>已经是最优了。</p>\r\n<p style=\"margin-left: 30px;\">Ｂ君：真得？如果你说的没错，那么argmax后对p(Z,X|Θ)中Θ的求解结果就应该是你说的这个最优Θ<sup>(g)</sup>，你确定？赌一把？</p>\r\n<p style=\"margin-left: 30px;\">Ａ君：这个嘛，你说的没错，如果得出的结论Θ<sup>(g+1)</sup>不等于我这个最优Θ<sup>(g)</sup>，那么我就说错了，得修正Θ<sup>(g)</sup> = Θ<sup>(g+1)</sup>。</p>\r\n<p style=\"margin-left: 30px;\">Ｂ君：问题来了，我也不知道如此更新下去，收敛的目的地是否是最优的Θ。<sup><br></sup></p>\r\n<p style=\"margin-left: 30px;\">Ａ君：恩，需要去证明。</p>\r\n<p style=\"margin-left: 30px;\">Ｂ君：是的。</p>\r\n<p> </p>\r\n<p style=\"text-align: center;\"><img style=\"border: 2px solid black;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171101082851341-23818354.jpg\" alt=\"\" width=\"577\" height=\"176\"></p>\r\n<p style=\"text-align: center;\">3涨是目的；更新Θ后，若1涨，2跌就能达到目的</p>\r\n<p>先证明了：只要θ在变，【2】就会跌；【详见原视频讲解，有用到<span style=\"color: #00ff00;\"><strong>Jensen's inequality</strong></span>】</p>\r\n<p>所以，【1】涨【3】肯定也涨。</p>\r\n<p>那么，如何让【1】涨呢？这不就是【公式2】的意思么（argmax）！</p>\r\n<p>注意数学基础，【公式2】就是【1】部分，只是表达方式不同，一个是期望的形式，一个是积分的形式。</p>\r\n<p> </p>\r\n<p>【公式2】中明显有两个概率，把每个概率展开，写出具体的形式：</p>\r\n<p style=\"text-align: center;\"><strong><img style=\"border: 1px solid black;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171101090045763-1861233222.png\" alt=\"\" width=\"599\" height=\"308\"></strong></p>\r\n<p> </p>\r\n<p>把这个具体的形式带入【公式2】，然后……&lt;看视频中计算过程&gt;……，【公式2】变为了：</p>\r\n<p style=\"text-align: center;\"><img style=\"border: 1px solid black;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171101090326935-282540138.png\" alt=\"\"></p>\r\n<p> </p>\r\n<p>这就是EM方法中的likelihood，使其最大化即可；同时也是更新θ的公式。</p>\r\n<p>通常，有了likelihood也就有了一切，之后求导便是。</p>\r\n<p>对谁求导？你想优化谁就对谁求导！</p>\r\n<p>要优化谁？当然是θ这个向量代表的各个具体的参数咯！</p>\r\n<p>Θ = {α<sub>1</sub>, . . . α<sub>k</sub> , µ<sub>1</sub>, . . . µ<sub>k</sub> , Σ<sub>1</sub>, . . . Σ<sub>k</sub> }</p>\r\n<p> </p>\r\n<p>既然是EM，那么，</p>\r\n<p>Iterate:<br>1. [E-step] Infer <span style=\"color: #3366ff;\">missing values <span style=\"color: #339966;\">{latent variables}</span></span><span style=\"color: #0000ff;\"> </span>given current parameters　--&gt; 根据公式求p(Z|X,θ)，其实有点高斯采样的感觉，得到了下图中每个采样点的<span style=\"font-family: 'courier new', courier;\">p(<em>l</em>|X<sub>i</sub>,θ<sup>(g)</sup>)</span><br>2. [M-step] Optimize <span style=\"color: #3366ff;\">parameters</span> <span style=\"color: #339966;\">{θ}</span> given the “filled-in” data　--&gt;  套入下面公式即可；公式通过求导的结果而来，具体会用到<span style=\"color: #00ff00;\"><strong>“拉格朗日乘子法+KKT条件”</strong></span></p>\r\n<p><img style=\"border: 1px solid black; display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171101093255826-1913434595.png\" alt=\"\"></p>\r\n<p> </p>\r\n<p>就是这么一回事，感觉也没什么可说。 但细细想来有一个问题，上述过程中涉及到大量的贝叶斯定理，也就会有求后验分布这样的过程，如果涉及的分布不是高斯这样的友好分布，导致求后验分布困难，那上述的这段流程岂不是走不下来了么？</p>\r\n<p> </p>\r\n<div style=\"margin-left: 30px;\">From: <a href=\"https://www.zhihu.com/question/41765860\" target=\"_blank\">https://www.zhihu.com/question/41765860</a></div>\r\n<div>\r\n<div>\r\n<p style=\"margin-left: 30px;\">简单易懂的理解变分其实就是一句话：用简单的分布q去近似复杂的分布p。<br>首先，<span style=\"color: #ff6600;\">为什么要选择用变分推断？</span><br>因为，<span style=\"color: #008080;\">大多数情况下后验分布很难求</span>啊。如果后验概率好求解的话我们直接EM就搞出来了。</p>\r\n<p style=\"margin-left: 30px;\">当后验分布难于求解的时候我们就希望选择一些简单的分布来近似这些复杂的后验分布，至于这种简单的分布怎么选，有很多方法比如：Bethe自由能，平均场定理。<span style=\"color: #ff6600;\">而应用最广泛的要数平均场定理。为什么？</span><br>因为它假设各个变量之间相互独立砍断了所有变量之间的依赖关系。<span style=\"color: #ff6600;\">这又有什么好处呢？</span></p>\r\n<p style=\"margin-left: 30px;\">我们拿一个不太恰当的例子来形象的说明一下：用古代十字军东征来作为例子说明一下mean field。十字军组成以骑兵为主步兵为辅，开战之前骑兵手持重标枪首先冲击敌阵步兵手持刀斧跟随，一旦接战就成了单对单的决斗。那么在每个人的战斗力基本相似的情况下某个人的战斗力可以由其他人的均值代替这是平均场的思想。这样在整个军队没有什么战术配合的情况下军队的战斗力可以由这些单兵的战斗力来近似这是变分的思想。<br>当求解Inference问题的时候相当于积分掉无关变量求边际分布，如果变量维度过高，积分就会变得非常困难，而且你积分的分布p又可能非常复杂因此就彻底将这条路堵死了。采用平均场就是将这种复杂的多元积分变成简单的多个一元积分，而且我们选择的q是指数族内的分布，更易于积分求解。<span style=\"color: #ff6600;\">如果变量间的依赖关系很强怎么办？</span></p>\r\n<p style=\"margin-left: 30px;\">那就是structured mean field解决的问题了。</p>\r\n<p style=\"margin-left: 30px;\">说到这里我们就知道了为什么要用变分，<span style=\"color: #ff6600;\">那么怎么用？</span></p>\r\n<p style=\"margin-left: 30px;\">过程很简单，推导很复杂。<br>整个过程只需要：<br>1、根据图模型写出联合分布<br>2、写出mean filed 的形式（给出变分参数及其生成隐变量的分布）<br>3、写出ELBO（为什么是ELBO？优化它跟优化KL divergence等价，KL divergence因为含有后验分布不好优化）<br>4、求偏导进行变分参数学习</p>\r\n<p> </p>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</div>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</div>\r\n<p>  </p>\r\n<p><span style=\"font-family: 'courier new', courier; color: #333399;\"><strong><span style=\"font-size: 18pt;\">EM --&gt; VI</span></strong></span></p>\r\n<hr>\r\n<p>From: <a href=\"http://www-staff.it.uts.edu.au/~ydxu/ml_course/variational.pdf\" target=\"_blank\">http://www-staff.it.uts.edu.au/~ydxu/ml_course/variational.pdf</a></p>\r\n<p>该页表述很清晰，p是未知的真实分布，如何找一个q分布来尽可能地近似p，以下就是理论依据。</p>\r\n<p style=\"text-align: center;\"><img style=\"border: 1px solid black;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171101164041654-422788207.png\" alt=\"\"></p>\r\n<p style=\"text-align: center;\">ln (p(X)) = Evidence Lower Bound (ELOB) + KL divergence</p>\r\n<p>做一个iid假设来近似真实分布p：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171101165435357-220367782.png\" alt=\"\"></p>\r\n<p> </p>\r\n<p>之后，将L(q)替换为iid假设后，成为如下形式。</p>\r\n<p style=\"text-align: center;\"><img style=\"border: 1px solid black;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171101165241748-1936672727.png\" alt=\"\"></p>\r\n<p style=\"text-align: center;\">Figure, Evidence Lower Bound (ELOB) </p>\r\n<p>到此，菜鸡可能会有点迷惑，这么做到底为了什么？不用怕，其实当初我也迷惑，：）</p>\r\n<p>但到此，我们至少知道<span style=\"color: #ff00ff;\">做了一个iid的假设<span style=\"color: #000000;\">，</span>这个很重要</span>，记住这一步。</p>\r\n<p>那么，为了理解这个假设，趁热先直接上个例子如何：<a id=\"cb_post_title_url\" class=\"postTitle2\" title=\"手算推导Bayesian GMM\" href=\"http://www.cnblogs.com/jesse123/p/6927714.html\">[Bayes] Variational Inference for Bayesian GMMs</a></p>\r\n<p><strong>链接中的目的：</strong></p>\r\n<ul>\r\n<li>推导出近似各个变量的公式。</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<p><strong>为什么不能用EM？</strong></p>\r\n<ul>\r\n<li>例子中涉及的分布除了高斯还有好多，情况太复杂，一看就是后验不好求。</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<p><strong>为什么要折腾这个复杂的东东？</strong></p>\r\n<ul>\r\n<li>示意图很明了，与普通GMM相比，模型加了dirichlet，就跟突然有了大脑。</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<p style=\"margin-left: 30px;\"> <img style=\"border: 1px solid black;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171102070008998-1532627493.png\" alt=\"\" width=\"347\" height=\"260\"></p>\r\n<p> </p>\r\n<p>看来，模型加了先验（变得复杂），对performance确实有莫大的好处。</p>\r\n<p>模型复杂就不好估参，其中后验计算复杂也是原因之一。</p>\r\n<p>看上去，变分推断的必要性成了显而易见的常识。</p>\r\n<p>写到这里，希望菜鸡对变分有了更深的认识，本文的初衷不是教材，更多的是充当tutor，帮助大家理清思路，加深认识，建立知识体系。</p>\r\n<p>“学习”这种东西，最终还是自己的事儿，但“引导”确实需要他人来给予。</p>\r\n<p> </p>\r\n<p>书归正传，这个结论就是使用变分的核心：</p>\r\n<p><img style=\"border: 1px solid black; display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171102070359185-1208498694.png\" alt=\"\" width=\"815\" height=\"103\"></p>\r\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171102070647466-1372848100.png\" alt=\"\"></p>\r\n<p style=\"text-align: center;\"><img src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171102070805873-542408914.png\" alt=\"\"></p>\r\n<p style=\"text-align: center;\">迭代过程：注意一一对应的关系，变量命名有区别，注意分辨</p>\r\n<p> </p>\r\n<p>求近似公式的方法用起来很方便啊，如何得到的呢？</p>\r\n<p>这就要回头到 <span style=\"color: #008000;\"><strong>Figure, Evidence Lower Bound (ELOB) </strong><span style=\"color: #000000;\">，继续我们的思路。</span></span></p>\r\n<p>“<span style=\"color: #ff00ff;\">做了一个iid的假设<span style=\"color: #000000;\">，</span>这个很重要</span>”，实例中也就是：</p>\r\n<p> <img style=\"border: 1px solid black;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171102071201638-1675468520.png\" alt=\"\"></p>\r\n<p>为什么一定要做这个假设？</p>\r\n<p>因为变分中迭代过程两部分变量的关系：第一部分迭代结果给第二部分；第二部分迭代结果给第一部分；</p>\r\n<p>当然，这两部分变量要假设为iid咯。</p>\r\n<p>突然，就这么好理解了……</p>\r\n<p>至于具体的原理推导过程，在此不添加“网络信息冗余”，建议看原视频讲解。</p>\r\n<p> </p>\r\n<p> </p>\r\n<p><strong><span style=\"font-size: 18pt; color: #333399;\">VI --&gt; <span style=\"color: #333399;\"><a id=\"CategoryEntryList1_EntryStoryList_ctl00_Entries_TitleUrl_5\" class=\"entrylistItemTitle\" href=\"http://www.cnblogs.com/jesse123/p/7501743.html\">Variational Bayesian GMM</a></span></span><br></strong></p>\r\n<hr>\r\n<p>From: <a href=\"http://www.cnblogs.com/jesse123/p/7501743.html\" target=\"_blank\">http://www.cnblogs.com/jesse123/p/7501743.html</a></p>\r\n<p>这部分内容得请高人，为什么会自动调整拟合混合分布，涉及到Dirichlet process的研究，读者姑且把Dirichlet看做是每个高斯的权重调整，就相当于图像中的透明属性。</p>\r\n<p>不太清楚目前研究的进展如何，理论基础可能还未完备，但实践效果往往挺好。</p>\r\n<p> </p>\r\n<p>不管是GMM还是Variational Bayesian GMM，都是一种聚类方法，聚类方法除了贝叶斯统计派，还有其他很多种，如下：</p>\r\n<p style=\"text-align: center;\"><img style=\"border: 1px solid black;\" src=\"http://images2017.cnblogs.com/blog/310015/201711/310015-20171102081225638-305735088.png\" alt=\"\" width=\"912\" height=\"543\"></p>\r\n<p style=\"text-align: center;\"><a href=\"http://scikit-learn.org/stable/auto_examples/cluster/plot_cluster_comparison.html#sphx-glr-auto-examples-cluster-plot-cluster-comparison-py\" target=\"_blank\">Comparing different clustering algorithms on toy datasets</a></p>\r\n<p> </p>\r\n<p>本篇就到这里，关于变分的使用，未来还会有涉及，慢慢体会。</p>\r\n<p>愿菜鸡们建立起人工智能的知识体系，与硅谷接轨，而非被路人忽悠。</p>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 07:27</span> <a href=\"http://www.cnblogs.com/jesse123/\">郝一二三</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7764672\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7764672);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=91377,cb_entryId=7764672,cb_blogApp=currentBlogApp,cb_blogUserGuid='e2944e26-7d9c-e011-a53f-842b2b196315',cb_entryCreatedDate='2017/11/2 7:27:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 90, "image_url": ["https://pic.cnblogs.com/face/u310015.jpg?id=23163453"], "date_pub": "2017-11-02", "article_common": 0}
{"title": "JAVA提高十一：LinkedList深入分析", "url": "http://www.cnblogs.com/pony1223/p/7768779.html", "author": "pony1223", "article_desc": "上一节，我们学习了ArrayList 类，本节我们来学习一下LinkedList，LinkedList相对ArrayList而言其使用频率并不是很高，因为其访问元素的性能相对于ArrayList而言比较慢，至于原因我们下面讲开始讲解，本节重点是了解其内部的结构，会简单实现一个简单的LinkedLis ...", "content": "<div id=\"post_detail\">\r\n\t<div class=\"post\">\r\n\t\t<h2>\r\n\t\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/pony1223/p/7768779.html\">JAVA提高十一：LinkedList深入分析</a>\r\n\t\t</h2>\r\n\t\t<div class=\"postbody\">\r\n\t\t<div id=\"cnblogs_post_body\"><p><span style=\"font-size: 16px;\">上一节，我们学习了ArrayList 类，本节我们来学习一下LinkedList，LinkedList相对ArrayList而言其使用频率并不是很高，因为其访问元素的性能相对于ArrayList而言比较慢，至于原因我们下面讲开始讲解，本节重点是了解其内部的结构，会简单实现一个简单的LinkedList 即可。</span></p>\r\n<p><strong><span style=\"font-size: 18px;\">一、LinkedList的简单使用</span></strong></p>\r\n<p><span style=\"font-size: 16px;\">任何代码在深入分析前，首先需要会使用，因此我们先看下基本的使用列子:</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">package</span><span style=\"color: #000000;\"> study.collection;\r\n\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> java.util.LinkedList;\r\n\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> TestLinkedList {\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> main(String[] args)\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 测试LinkedList的API</span>\r\n<span style=\"color: #000000;\">        testLinkedListAPIs() ;\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 将LinkedList当作 LIFO(后进先出)的堆栈</span>\r\n<span style=\"color: #000000;\">        useLinkedListAsLIFO();\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 将LinkedList当作 FIFO(先进先出)的队列</span>\r\n<span style=\"color: #000000;\">        useLinkedListAsFIFO();\r\n    }\r\n    \r\n    </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">\r\n     * 测试LinkedList中部分API\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> testLinkedListAPIs() {\r\n        String val </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">LinkedList llist;\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">llist.offer(\"10\");\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 新建一个LinkedList</span>\r\n        LinkedList llist = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> LinkedList();\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">---- 添加操作 ----\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 依次添加1,2,3</span>\r\n        llist.add(\"1\"<span style=\"color: #000000;\">);\r\n        llist.add(</span>\"2\"<span style=\"color: #000000;\">);\r\n        llist.add(</span>\"3\"<span style=\"color: #000000;\">);\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 将“4”添加到第一个位置</span>\r\n        llist.add(1, \"4\"<span style=\"color: #000000;\">);\r\n        \r\n\r\n        System.out.println(</span>\"\\nTest \\\"addFirst(), removeFirst(), getFirst()\\\"\"<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (01) 将“10”添加到第一个位置。  失败的话，抛出异常！</span>\r\n        llist.addFirst(\"10\"<span style=\"color: #000000;\">);\r\n        System.out.println(</span>\"llist:\"+<span style=\"color: #000000;\">llist);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (02) 将第一个元素删除。        失败的话，抛出异常！</span>\r\n        System.out.println(\"llist.removeFirst():\"+<span style=\"color: #000000;\">llist.removeFirst());\r\n        System.out.println(</span>\"llist:\"+<span style=\"color: #000000;\">llist);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (03) 获取第一个元素。          失败的话，抛出异常！</span>\r\n        System.out.println(\"llist.getFirst():\"+<span style=\"color: #000000;\">llist.getFirst());\r\n\r\n\r\n        System.out.println(</span>\"\\nTest \\\"offerFirst(), pollFirst(), peekFirst()\\\"\"<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (01) 将“10”添加到第一个位置。  返回true。</span>\r\n        llist.offerFirst(\"10\"<span style=\"color: #000000;\">);\r\n        System.out.println(</span>\"llist:\"+<span style=\"color: #000000;\">llist);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (02) 将第一个元素删除。        失败的话，返回null。</span>\r\n        System.out.println(\"llist.pollFirst():\"+<span style=\"color: #000000;\">llist.pollFirst());\r\n        System.out.println(</span>\"llist:\"+<span style=\"color: #000000;\">llist);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (03) 获取第一个元素。          失败的话，返回null。</span>\r\n        System.out.println(\"llist.peekFirst():\"+<span style=\"color: #000000;\">llist.peekFirst());\r\n    \r\n\r\n        System.out.println(</span>\"\\nTest \\\"addLast(), removeLast(), getLast()\\\"\"<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (01) 将“20”添加到最后一个位置。  失败的话，抛出异常！</span>\r\n        llist.addLast(\"20\"<span style=\"color: #000000;\">);\r\n        System.out.println(</span>\"llist:\"+<span style=\"color: #000000;\">llist);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (02) 将最后一个元素删除。        失败的话，抛出异常！</span>\r\n        System.out.println(\"llist.removeLast():\"+<span style=\"color: #000000;\">llist.removeLast());\r\n        System.out.println(</span>\"llist:\"+<span style=\"color: #000000;\">llist);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (03) 获取最后一个元素。          失败的话，抛出异常！</span>\r\n        System.out.println(\"llist.getLast():\"+<span style=\"color: #000000;\">llist.getLast());\r\n\r\n\r\n        System.out.println(</span>\"\\nTest \\\"offerLast(), pollLast(), peekLast()\\\"\"<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (01) 将“20”添加到第一个位置。  返回true。</span>\r\n        llist.offerLast(\"20\"<span style=\"color: #000000;\">);\r\n        System.out.println(</span>\"llist:\"+<span style=\"color: #000000;\">llist);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (02) 将第一个元素删除。        失败的话，返回null。</span>\r\n        System.out.println(\"llist.pollLast():\"+<span style=\"color: #000000;\">llist.pollLast());\r\n        System.out.println(</span>\"llist:\"+<span style=\"color: #000000;\">llist);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> (03) 获取第一个元素。          失败的话，返回null。</span>\r\n        System.out.println(\"llist.peekLast():\"+<span style=\"color: #000000;\">llist.peekLast());\r\n\r\n         \r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 将第3个元素设置300。不建议在LinkedList中使用此操作，因为效率低！</span>\r\n        llist.set(2, \"300\"<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 获取第3个元素。不建议在LinkedList中使用此操作，因为效率低！</span>\r\n        System.out.println(\"\\nget(3):\"+llist.get(2<span style=\"color: #000000;\">));\r\n\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> ---- toArray(T[] a) ----\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 将LinkedList转行为数组</span>\r\n        String[] arr = (String[])llist.toArray(<span style=\"color: #0000ff;\">new</span> String[0<span style=\"color: #000000;\">]);\r\n        </span><span style=\"color: #0000ff;\">for</span><span style=\"color: #000000;\"> (String str:arr) \r\n            System.out.println(</span>\"str:\"+<span style=\"color: #000000;\">str);\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 输出大小</span>\r\n        System.out.println(\"size:\"+<span style=\"color: #000000;\">llist.size());\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 清空LinkedList</span>\r\n<span style=\"color: #000000;\">        llist.clear();\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 判断LinkedList是否为空</span>\r\n        System.out.println(\"isEmpty():\"+llist.isEmpty()+\"\\n\"<span style=\"color: #000000;\">);\r\n\r\n    }\r\n\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * 将LinkedList当作 LIFO(后进先出)的堆栈\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> useLinkedListAsLIFO() {\r\n        System.out.println(</span>\"\\nuseLinkedListAsLIFO\"<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 新建一个LinkedList</span>\r\n        LinkedList stack = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> LinkedList();\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 将1,2,3,4添加到堆栈中</span>\r\n        stack.push(\"1\"<span style=\"color: #000000;\">);\r\n        stack.push(</span>\"2\"<span style=\"color: #000000;\">);\r\n        stack.push(</span>\"3\"<span style=\"color: #000000;\">);\r\n        stack.push(</span>\"4\"<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 打印“栈”</span>\r\n        System.out.println(\"stack:\"+<span style=\"color: #000000;\">stack);\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 删除“栈顶元素”</span>\r\n        System.out.println(\"stack.pop():\"+<span style=\"color: #000000;\">stack.pop());\r\n        \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 取出“栈顶元素”</span>\r\n        System.out.println(\"stack.peek():\"+<span style=\"color: #000000;\">stack.peek());\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 打印“栈”</span>\r\n        System.out.println(\"stack:\"+<span style=\"color: #000000;\">stack);\r\n    }\r\n\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * 将LinkedList当作 FIFO(先进先出)的队列\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> useLinkedListAsFIFO() {\r\n        System.out.println(</span>\"\\nuseLinkedListAsFIFO\"<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 新建一个LinkedList</span>\r\n        LinkedList queue = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> LinkedList();\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 将10,20,30,40添加到队列。每次都是插入到末尾</span>\r\n        queue.add(\"10\"<span style=\"color: #000000;\">);\r\n        queue.add(</span>\"20\"<span style=\"color: #000000;\">);\r\n        queue.add(</span>\"30\"<span style=\"color: #000000;\">);\r\n        queue.add(</span>\"40\"<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 打印“队列”</span>\r\n        System.out.println(\"queue:\"+<span style=\"color: #000000;\">queue);\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 删除(队列的第一个元素)</span>\r\n        System.out.println(\"queue.remove():\"+<span style=\"color: #000000;\">queue.remove());\r\n    \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 读取(队列的第一个元素)</span>\r\n        System.out.println(\"queue.element():\"+<span style=\"color: #000000;\">queue.element());\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 打印“队列”</span>\r\n        System.out.println(\"queue:\"+<span style=\"color: #000000;\">queue);\r\n    }\r\n}</span></pre>\r\n</div>\r\n<p> <span style=\"font-size: 16px;\">从上面的代码可以看出，LinkedList的功能非常多，既可以用于存放元素的集合功能，还具备了堆栈的功能，还拥有队列的功能。这均源于其不仅仅实现了List接口还是实现了Queue接口。</span></p>\r\n<p><span style=\"font-size: 16px;\">但在介绍LinkedList接口前，从名字可以看出LinkedList 即底层采用的是链表的结构，那什么是链表，需要提前有一个认识：顾名思义，链表就和链子一样，每一环都要连接着后边的一环和前边的一环，这样，当我们需要找这根链子的某一环的时候，只要我们能找到链子的任意一环，都可以找到我们需要的那一环。我们看一个图，就能很好的理解了。</span></p>\r\n<p><span style=\"font-size: 16px;\"><img src=\"http://images2017.cnblogs.com/blog/401339/201711/401339-20171101215845076-1468163548.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-size: 16px;\">在LinkedList中，我们把链子的“环”叫做“节点”，每个节点都是同样的结构。节点与节点之间相连，构成了我们LinkedList的基本数据结构，也是LinkedList的核心。</span><span style=\"font-size: 16px;\">链表又分为单向链表和双向链表，而单向/双向链表又可以分为循环链表和非循环链表，下面简单就这四种链表进行图解说明。</span></p>\r\n<div><strong> 1.1.单向链表</strong></div>\r\n<div>          单向链表就是通过每个结点的指针指向下一个结点从而链接起来的结构，最后一个节点的next指向null。</div>\r\n<p> <img src=\"http://images2017.cnblogs.com/blog/401339/201711/401339-20171101220224341-1334091097.png\" alt=\"\"></p>\r\n<p><strong>1. 2.单向循环链表</strong></p>\r\n<p>　　单向循环链表和单向列表的不同是，最后一个节点的next不是指向null，而是指向head节点，形成一个“环”。</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/401339/201711/401339-20171101220259513-264189636.png\" alt=\"\"></p>\r\n<p><strong> 1. 3.双向链表</strong></p>\r\n<p>　　从名字就可以看出，双向链表是包含两个指针的，pre指向前一个节点，next指向后一个节点，但是第一个节点head的pre指向null，最后一个节点的tail指向null。</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/401339/201711/401339-20171101220417263-1881705280.png\" alt=\"\"></p>\r\n<div><strong>1. 4.双向循环链表</strong></div>\r\n<div><strong>         </strong> 双向循环链表和双向链表的不同在于，第一个节点的pre指向最后一个节点，最后一个节点的next指向第一个节点，也形成一个“环”。<strong>而LinkedList就是基于双向循环链表设计的。</strong></div>\r\n<div><strong><strong><img src=\"http://images2017.cnblogs.com/blog/401339/201711/401339-20171101220440216-1517727898.png\" alt=\"\"></strong></strong></div>\r\n<div>\r\n<p>更形象的解释下就是：双向循环链表就像一群小孩手牵手围成一个圈，第一个小孩的右手拉着第二个小孩的左手，第二个小孩的左手拉着第一个小孩的右手。。。最后一个小孩的右手拉着第一个小孩的左手。【接下来我们进入源代码的分析，说明linkedlist 我们采用的JDK1.8进行分析，只所以不用1.6是因为，在1.6  1.7 的时候进行过变动将1.6中的环形结构优化为了直线型了链表结构，然后回到了1.8又有部分的变动，因为从上面可以看出链表的由4种不向ArrayList单一演进，所以这里直接选择用1.8来分析】</p>\r\n<p><strong><span style=\"font-size: 18px;\"> 二、LinkedList的概述</span></strong></p>\r\n</div>\r\n<p><span style=\"font-size: 16px;\">LinkedList是List和Deque接口的双向链表的实现。实现了所有可选列表操作，并允许包括null值。</span></p>\r\n<p><span style=\"font-size: 16px;\">LinkedList既然是通过双向链表去实现的，那么它可以被当作堆栈、队列或双端队列进行操作。并且其顺序访问非常高效，而随机访问效率比较低。</span></p>\r\n<p><span style=\"font-size: 16px;\">注意，此实现不是同步的。 如果多个线程同时访问一个LinkedList实例，而其中至少一个线程从结构上修改了列表，那么它必须保持外部同步。这通常是通过同步那些用来封装列表的 对象来实现的。但如果没有这样的对象存在，则该列表需要运用{@link Collections#synchronizedList Collections.synchronizedList}来进行“包装”，该方法最好是在创建列表对象时完成，为了避免对列表进行突发的非同步操作。</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre>List list = Collections.synchronizedList(<span style=\"color: #0000ff;\">new</span> LinkedList(...));</pre>\r\n</div>\r\n<p><span style=\"font-size: 16px;\">类中的iterator()方法和listIterator()方法返回的iterators迭代器是<strong>fail-fast</strong>的：当某一个线程A通过iterator去遍历某集合的过程中，若该集合的内容被其他线程所改变了；那么线程A访问集合时，就会抛出ConcurrentModificationException异常，产生fail-fast事件。</span></p>\r\n<p><strong><span style=\"font-size: 16px;\">1.Node节点</span></strong></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">class</span> Node&lt;E&gt;<span style=\"color: #000000;\"> {\r\n        E item;    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 当前节点所包含的值</span>\r\n        Node&lt;E&gt; next;   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">下一个节点</span>\r\n        Node&lt;E&gt; prev;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">上一个节点</span>\r\n<span style=\"color: #000000;\">\r\n        Node(Node</span>&lt;E&gt; prev, E element, Node&lt;E&gt;<span style=\"color: #000000;\"> next) {\r\n            </span><span style=\"color: #0000ff;\">this</span>.item =<span style=\"color: #000000;\"> element;\r\n            </span><span style=\"color: #0000ff;\">this</span>.next =<span style=\"color: #000000;\"> next;\r\n            </span><span style=\"color: #0000ff;\">this</span>.prev =<span style=\"color: #000000;\"> prev;\r\n        }\r\n    }</span></pre>\r\n</div>\r\n<p><strong><span style=\"font-size: 16px;\">2.LinkedList类结构</span></strong></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">通过LinkedList实现的接口可知，其支持队列操作，双向列表操作，能被克隆，支持序列化</span>\r\n<span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span> LinkedList&lt;E&gt;\r\n    <span style=\"color: #0000ff;\">extends</span> AbstractSequentialList&lt;E&gt;\r\n    <span style=\"color: #0000ff;\">implements</span> List&lt;E&gt;, Deque&lt;E&gt;<span style=\"color: #000000;\">, Cloneable, java.io.Serializable\r\n{\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> LinkedList的大小（指其所含的元素个数）</span>\r\n    <span style=\"color: #0000ff;\">transient</span> <span style=\"color: #0000ff;\">int</span> size = 0<span style=\"color: #000000;\">;\r\n\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * 指向第一个节点\r\n     * 不变的: (first == null &amp;&amp; last == null) ||\r\n     *            (first.prev == null &amp;&amp; first.item != null)\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">transient</span> Node&lt;E&gt;<span style=\"color: #000000;\"> first;\r\n\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * 指向最后一个节点\r\n     * 不变的: (first == null &amp;&amp; last == null) ||\r\n     *            (last.next == null &amp;&amp; last.item != null)\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">transient</span> Node&lt;E&gt;<span style=\"color: #000000;\"> last;\r\n\r\n    ......\r\n}</span></pre>\r\n</div>\r\n<p> </p>\r\n<p><strong>LinkedList包含了三个重要的对象</strong><strong>：</strong><strong>first、last 和 size。</strong></p>\r\n<p>(1) <strong><strong>first</strong></strong> 是双向链表的表头，它是双向链表节点所对应的类Node的实例</p>\r\n<p>(2) <strong><strong>last</strong></strong> 是双向链表的最后一个元素，它是双向链表节点所对应的类Node的实例</p>\r\n<p>(3) <strong>size</strong> 是双向链表中节点的个数。</p>\r\n<p><strong><span style=\"font-size: 16px;\">3.构造函数</span></strong></p>\r\n<p><span style=\"font-size: 16px;\">LinkedList提供了两种种方式的构造器，构造一个空列表、以及构造一个包含指定collection的元素的列表，这些元素按照该collection的迭代器返回的顺序排列的。</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">构建一个空列表</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> LinkedList() {\r\n    }\r\n\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * 构造一个包含指定collection的元素的列表，这些元素按照该collection的迭代器返回的顺序排列的\r\n     * </span><span style=\"color: #808080;\">@param</span><span style=\"color: #008000;\">  c 包含用于去构造LinkedList的元素的collection\r\n     * </span><span style=\"color: #808080;\">@throws</span><span style=\"color: #008000;\"> NullPointerException 如果指定的collection为空\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">构建一个包含指定集合c的列表</span>\r\n    <span style=\"color: #0000ff;\">public</span> LinkedList(Collection&lt;? <span style=\"color: #0000ff;\">extends</span> E&gt;<span style=\"color: #000000;\"> c) {\r\n        </span><span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">();\r\n        addAll(c);\r\n    }</span></pre>\r\n</div>\r\n<p><strong><span style=\"font-size: 18px;\">三、LinkedList 方法功能源码分析</span></strong></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n * LinkedList底层使用双向链表，实现了List和deque。实现所有的可选List操作，并可以只有所有元素（包括空值）\r\n * 其大小理论上仅受内存大小的限制\r\n *\r\n * 所有的操作都可以作为一个双联列表来执行（及对双向链表操作）。\r\n * 把对链表的操作封装起来，并对外提供看起来是对普通列表操作的方法。\r\n * 遍历从起点、终点、或指定位置开始\r\n * 内部方法，注释会描述为节点的操作(如删除第一个节点)，公开的方法会描述为元素的操作(如删除第一个元素)\r\n *\r\n * LinkedList不是线程安全的，如果在多线程中使用（修改），需要在外部作同步处理。\r\n * \r\n * 需要弄清元素（节点）的索引和位置的区别，不然有几个地方不好理解，具体在碰到的地方会解释。\r\n * \r\n * 迭代器可以快速报错\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span> LinkedList&lt;E&gt; <span style=\"color: #0000ff;\">extends</span> AbstractSequentialList&lt;E&gt; <span style=\"color: #0000ff;\">implements</span> List&lt;E&gt;, Deque&lt;E&gt;<span style=\"color: #000000;\">, Cloneable, java.io.Serializable\r\n{\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">容量</span>\r\n    <span style=\"color: #0000ff;\">transient</span> <span style=\"color: #0000ff;\">int</span> size = 0<span style=\"color: #000000;\">;\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">首节点</span>\r\n    <span style=\"color: #0000ff;\">transient</span> Node&lt;E&gt;<span style=\"color: #000000;\"> first;\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">尾节点</span>\r\n    <span style=\"color: #0000ff;\">transient</span> Node&lt;E&gt;<span style=\"color: #000000;\"> last;\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">默认构造函数</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> LinkedList() {\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">通过一个集合初始化LinkedList，元素顺序有这个集合的迭代器返回顺序决定</span>\r\n    <span style=\"color: #0000ff;\">public</span> LinkedList(Collection&lt;? <span style=\"color: #0000ff;\">extends</span> E&gt;<span style=\"color: #000000;\"> c) {\r\n        </span><span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">();\r\n        addAll(c);\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">使用对应参数作为第一个节点，内部使用</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> linkFirst(E e) {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; f = first;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到首节点</span>\r\n        <span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; newNode = <span style=\"color: #0000ff;\">new</span> Node&lt;&gt;(<span style=\"color: #0000ff;\">null</span>, e, f);<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">创建一个节点</span>\r\n        first = newNode;        <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">设置首节点</span>\r\n        <span style=\"color: #0000ff;\">if</span> (f == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            last </span>= newNode;     <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果之前首节点为空(size==0)，那么尾节点就是首节点</span>\r\n        <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n            f.prev </span>= newNode;   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果之前首节点不为空，之前的首节点的前一个节点为当前首节点</span>\r\n        size++;                 <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">长度+1</span>\r\n        modCount++;             <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">修改次数+1</span>\r\n<span style=\"color: #000000;\">    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">使用对应参数作为尾节点</span>\r\n    <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> linkLast(E e) {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; l = last; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到尾节点</span>\r\n        <span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; newNode = <span style=\"color: #0000ff;\">new</span> Node&lt;&gt;(l, e, <span style=\"color: #0000ff;\">null</span>);<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">使用参数创建一个节点</span>\r\n        last = newNode;         <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">设置尾节点</span>\r\n        <span style=\"color: #0000ff;\">if</span> (l == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            first </span>= newNode;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果之前尾节点为空(size==0)，首节点即尾节点</span>\r\n        <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n            l.next </span>= newNode;   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果之前尾节点不为空，之前的尾节点的后一个就是当前的尾节点</span>\r\n        size++<span style=\"color: #000000;\">;\r\n        modCount</span>++<span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">在指定节点前插入节点，节点succ不能为空</span>\r\n    <span style=\"color: #0000ff;\">void</span> linkBefore(E e, Node&lt;E&gt;<span style=\"color: #000000;\"> succ) {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; pred = succ.prev;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取前一个节点</span>\r\n        <span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; newNode = <span style=\"color: #0000ff;\">new</span> Node&lt;&gt;(pred, e, succ);<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">使用参数创建新的节点，向前指向前一个节点，向后指向当前节点</span>\r\n        succ.prev = newNode;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">当前节点指向新的节点</span>\r\n        <span style=\"color: #0000ff;\">if</span> (pred == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            first </span>= newNode;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果前一个节点为null，新的节点就是首节点</span>\r\n        <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n            pred.next </span>= newNode;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果存在前节点，那么前节点的向后指向新节点</span>\r\n        size++<span style=\"color: #000000;\">;\r\n        modCount</span>++<span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">删除首节点并返回删除前首节点的值，内部使用</span>\r\n    <span style=\"color: #0000ff;\">private</span> E unlinkFirst(Node&lt;E&gt;<span style=\"color: #000000;\"> f) {\r\n        </span><span style=\"color: #0000ff;\">final</span> E element = f.item;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取首节点的值</span>\r\n        <span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; next = f.next;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到下一个节点</span>\r\n        f.item = <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n        f.next </span>= <span style=\"color: #0000ff;\">null</span>;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">便于垃圾回收期清理</span>\r\n        first = next;       <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">首节点的下一个节点成为新的首节点</span>\r\n        <span style=\"color: #0000ff;\">if</span> (next == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            last </span>= <span style=\"color: #0000ff;\">null</span>;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果不存在下一个节点，则首尾都为null(空表)</span>\r\n        <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n            next.prev </span>= <span style=\"color: #0000ff;\">null</span>;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果存在下一个节点，那它向前指向null</span>\r\n        size--<span style=\"color: #000000;\">;\r\n        modCount</span>++<span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> element;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">删除尾节点并返回删除前尾节点的值，内部使用</span>\r\n    <span style=\"color: #0000ff;\">private</span> E unlinkLast(Node&lt;E&gt;<span style=\"color: #000000;\"> l) {\r\n        </span><span style=\"color: #0000ff;\">final</span> E element = l.item;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取值</span>\r\n        <span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; prev = l.prev;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取尾节点前一个节点</span>\r\n        l.item = <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n        l.prev </span>= <span style=\"color: #0000ff;\">null</span>;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">便于垃圾回收期清理</span>\r\n        last = prev;        <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">前一个节点成为新的尾节点</span>\r\n        <span style=\"color: #0000ff;\">if</span> (prev == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            first </span>= <span style=\"color: #0000ff;\">null</span>;   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果前一个节点不存在，则首尾都为null(空表)</span>\r\n        <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n            prev.next </span>= <span style=\"color: #0000ff;\">null</span>;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果前一个节点存在，先后指向null</span>\r\n        size--<span style=\"color: #000000;\">;\r\n        modCount</span>++<span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> element;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">删除指定节点并返回被删除的元素值</span>\r\n    E unlink(Node&lt;E&gt;<span style=\"color: #000000;\"> x) {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取当前值和前后节点</span>\r\n        <span style=\"color: #0000ff;\">final</span> E element =<span style=\"color: #000000;\"> x.item;\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; next =<span style=\"color: #000000;\"> x.next;\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; prev =<span style=\"color: #000000;\"> x.prev;\r\n        </span><span style=\"color: #0000ff;\">if</span> (prev == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n            first </span>= next;   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果前一个节点为空(如当前节点为首节点)，后一个节点成为新的首节点</span>\r\n        } <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            prev.next </span>= next;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果前一个节点不为空，那么他先后指向当前的下一个节点</span>\r\n            x.prev = <span style=\"color: #0000ff;\">null</span>;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">方便gc回收</span>\r\n<span style=\"color: #000000;\">        }\r\n        </span><span style=\"color: #0000ff;\">if</span> (next == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n            last </span>= prev;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果后一个节点为空(如当前节点为尾节点)，当前节点前一个成为新的尾节点</span>\r\n        } <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            next.prev </span>= prev;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果后一个节点不为空，后一个节点向前指向当前的前一个节点</span>\r\n            x.next = <span style=\"color: #0000ff;\">null</span>;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">方便gc回收</span>\r\n<span style=\"color: #000000;\">        }\r\n        x.item </span>= <span style=\"color: #0000ff;\">null</span>;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">方便gc回收</span>\r\n        size--<span style=\"color: #000000;\">;\r\n        modCount</span>++<span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> element;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取第一个元素</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E getFirst() {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; f = first;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到首节点</span>\r\n        <span style=\"color: #0000ff;\">if</span> (f == <span style=\"color: #0000ff;\">null</span>)          <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果为空，抛出异常</span>\r\n            <span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> NoSuchElementException();\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> f.item;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取最后一个元素</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E getLast() {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; l = last;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到尾节点</span>\r\n        <span style=\"color: #0000ff;\">if</span> (l == <span style=\"color: #0000ff;\">null</span>)          <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果为空，抛出异常</span>\r\n            <span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> NoSuchElementException();\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> l.item;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">删除第一个元素并返回删除的元素</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E removeFirst() {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; f = first;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到第一个节点</span>\r\n        <span style=\"color: #0000ff;\">if</span> (f == <span style=\"color: #0000ff;\">null</span>)          <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果为空，抛出异常</span>\r\n            <span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> NoSuchElementException();\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> unlinkFirst(f);\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">删除最后一个元素并返回删除的值</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E removeLast() {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; l = last;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到最后一个节点</span>\r\n        <span style=\"color: #0000ff;\">if</span> (l == <span style=\"color: #0000ff;\">null</span>)          <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果为空，抛出异常</span>\r\n            <span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> NoSuchElementException();\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> unlinkLast(l);\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">添加元素作为第一个元素</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> addFirst(E e) {\r\n        linkFirst(e);\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">店家元素作为最后一个元素</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> addLast(E e) {\r\n        linkLast(e);\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">检查是否包含某个元素，返回bool</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> contains(Object o) {\r\n        </span><span style=\"color: #0000ff;\">return</span> indexOf(o) != -1;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">返回指定元素的索引位置，不存在就返回-1，然后比较返回bool值</span>\r\n<span style=\"color: #000000;\">    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">返回列表长度</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> size() {\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> size;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">添加一个元素，默认添加到末尾作为最后一个元素</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> add(E e) {\r\n        linkLast(e);\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">删除指定元素，默认从first节点开始，删除第一次出现的那个元素</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> remove(Object o) {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">会根据是否为null分开处理。若值不是null，会用到对象的equals()方法</span>\r\n        <span style=\"color: #0000ff;\">if</span> (o == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n            </span><span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = first; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.next) {\r\n                </span><span style=\"color: #0000ff;\">if</span> (x.item == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n                    unlink(x);\r\n                    </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n                }\r\n            }\r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            </span><span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = first; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.next) {\r\n                </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (o.equals(x.item)) {\r\n                    unlink(x);\r\n                    </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n                }\r\n            }\r\n        }\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">添加指定集合的元素到列表，默认从最后开始添加</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span> addAll(Collection&lt;? <span style=\"color: #0000ff;\">extends</span> E&gt;<span style=\"color: #000000;\"> c) {\r\n        </span><span style=\"color: #0000ff;\">return</span> addAll(size, c);<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">size表示最后一个位置，可以理解为元素的位置分别为1~size</span>\r\n<span style=\"color: #000000;\">    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">从指定位置（而不是下标！下标即索引从0开始，位置可以看做从1开始，其实也是0）后面添加指定集合的元素到列表中，只要有至少一次添加就会返回true\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">index换成position应该会更好理解，所以也就是从索引为index(position)的元素的前面索引为index-1的后面添加！\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">当然位置可以为0啊，为0的时候就是从位置0(虽然它不存在)后面开始添加嘛，所以理所当前就是添加到第一个位置（位置1的前面）的前面了啊！\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">比如列表：0 1 2 3，如果此处index=4(实际索引为3)，就是在元素3后面添加；如果index=3(实际索引为2)，就在元素2后面添加。\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">原谅我的表达水平，我已经尽力解释了...</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span> addAll(<span style=\"color: #0000ff;\">int</span> index, Collection&lt;? <span style=\"color: #0000ff;\">extends</span> E&gt;<span style=\"color: #000000;\"> c) {\r\n        checkPositionIndex(index);  </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">检查索引是否正确（0&lt;=index&lt;=size）</span>\r\n        Object[] a = c.toArray();   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到元素数组</span>\r\n        <span style=\"color: #0000ff;\">int</span> numNew = a.length;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到元素个数</span>\r\n        <span style=\"color: #0000ff;\">if</span> (numNew == 0)            <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">若没有元素要添加，直接返回false</span>\r\n            <span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n        Node</span>&lt;E&gt;<span style=\"color: #000000;\"> pred, succ;\r\n        </span><span style=\"color: #0000ff;\">if</span> (index == size) {    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果是在末尾开始添加，当前节点后一个节点初始化为null，前一个节点为尾节点</span>\r\n            succ = <span style=\"color: #0000ff;\">null</span>;        <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">这里可以看做node(index)，不过index=size了（index最大只能是size-1），所以这里的succ只能=null，也方便后面判断</span>\r\n            pred = last;        <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">这里看做noede(index-1)，当然实现是不能这么写的，看做这样只是为了好理解，所以就是在node(index-1的后面开始添加元素)</span>\r\n        } <span style=\"color: #0000ff;\">else</span> {                <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果不是从末尾开始添加，当前位置的节点为指定位置的节点，前一个节点为要添加的节点的前一个节点</span>\r\n            succ = node(index); <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">添加好元素后(整个新加的)的后一个节点</span>\r\n            pred = succ.prev;   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">这里依然是node(index-1)</span>\r\n<span style=\"color: #000000;\">        }\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">遍历数组并添加到列表中</span>\r\n        <span style=\"color: #0000ff;\">for</span><span style=\"color: #000000;\"> (Object o : a) {\r\n            @SuppressWarnings(</span>\"unchecked\"<span style=\"color: #000000;\">)\r\n            E e </span>=<span style=\"color: #000000;\"> (E) o;\r\n            Node</span>&lt;E&gt; newNode = <span style=\"color: #0000ff;\">new</span> Node&lt;&gt;(pred, e, <span style=\"color: #0000ff;\">null</span>);<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">创建一个节点，向前指向上面得到的前节点</span>\r\n            <span style=\"color: #0000ff;\">if</span> (pred == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n                first </span>= newNode;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">若果前节点为null，则新加的节点为首节点</span>\r\n            <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n                pred.next </span>= newNode;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果存在前节点，前节点会向后指向新加的节点</span>\r\n            pred = newNode;         <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">新加的节点成为前一个节点</span>\r\n<span style=\"color: #000000;\">        }\r\n        </span><span style=\"color: #0000ff;\">if</span> (succ == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">pred.next = null  </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">加上这句也可以更好的理解</span>\r\n            last = pred;        <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果是从最后开始添加的，则最后添加的节点成为尾节点</span>\r\n        } <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            pred.next </span>= succ;   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果不是从最后开始添加的，则最后添加的节点向后指向之前得到的后续第一个节点</span>\r\n            succ.prev = pred;   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">当前，后续的第一个节点也应改为向前指向最后一个添加的节点</span>\r\n<span style=\"color: #000000;\">        }\r\n        size </span>+=<span style=\"color: #000000;\"> numNew;\r\n        modCount</span>++<span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">清空表</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> clear() {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">方便gc回收垃圾</span>\r\n        <span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = first; x != <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">; ) {\r\n            Node</span>&lt;E&gt; next =<span style=\"color: #000000;\"> x.next;\r\n            x.item </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n            x.next </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n            x.prev </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n            x </span>=<span style=\"color: #000000;\"> next;\r\n        }\r\n        first </span>= last = <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n        size </span>= 0<span style=\"color: #000000;\">;\r\n        modCount</span>++<span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取指定索引的节点的值</span>\r\n    <span style=\"color: #0000ff;\">public</span> E get(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index) {\r\n        checkElementIndex(index);\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> node(index).item;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">修改指定索引的值并返回之前的值</span>\r\n    <span style=\"color: #0000ff;\">public</span> E set(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index, E element) {\r\n        checkElementIndex(index);\r\n        Node</span>&lt;E&gt; x =<span style=\"color: #000000;\"> node(index);\r\n        E oldVal </span>=<span style=\"color: #000000;\"> x.item;\r\n        x.item </span>=<span style=\"color: #000000;\"> element;\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> oldVal;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">指定位置后面（即索引为这个值的元素的前面）添加元素</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span> add(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index, E element) {\r\n        checkPositionIndex(index);\r\n        </span><span style=\"color: #0000ff;\">if</span> (index ==<span style=\"color: #000000;\"> size)\r\n            linkLast(element);  </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果指定位置为最后，则添加到链表最后</span>\r\n        <span style=\"color: #0000ff;\">else</span>                    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果指定位置不是最后，则添加到指定位置前</span>\r\n<span style=\"color: #000000;\">            linkBefore(element, node(index));\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">删除指定位置的元素，</span>\r\n    <span style=\"color: #0000ff;\">public</span> E remove(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index) {\r\n        checkElementIndex(index);\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> unlink(node(index));\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">检查索引是否超出范围，因为元素索引是0~size-1的，所以index必须满足0&lt;=index&lt;size</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">boolean</span> isElementIndex(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index) {\r\n        </span><span style=\"color: #0000ff;\">return</span> index &gt;= 0 &amp;&amp; index &lt;<span style=\"color: #000000;\"> size;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">检查位置是否超出范围，index必须在index~size之间（含），如果超出，返回false</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">boolean</span> isPositionIndex(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index) {\r\n        </span><span style=\"color: #0000ff;\">return</span> index &gt;= 0 &amp;&amp; index &lt;=<span style=\"color: #000000;\"> size;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">异常详情</span>\r\n    <span style=\"color: #0000ff;\">private</span> String outOfBoundsMsg(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index) {\r\n        </span><span style=\"color: #0000ff;\">return</span> \"Index: \"+index+\", Size: \"+<span style=\"color: #000000;\">size;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">检查元素索引是否超出范围，若已超出，就抛出异常</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">void</span> checkElementIndex(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index) {\r\n        </span><span style=\"color: #0000ff;\">if</span> (!<span style=\"color: #000000;\">isElementIndex(index))\r\n            </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> IndexOutOfBoundsException(outOfBoundsMsg(index));\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">检查位置是否超出范围，若已超出，就抛出异常</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">void</span> checkPositionIndex(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index) {\r\n        </span><span style=\"color: #0000ff;\">if</span> (!<span style=\"color: #000000;\">isPositionIndex(index))\r\n            </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> IndexOutOfBoundsException(outOfBoundsMsg(index));\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取指定位置的节点</span>\r\n    Node&lt;E&gt; node(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index) {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果位置索引小于列表长度的一半(或一半减一)，从前面开始遍历；否则，从后面开始遍历</span>\r\n        <span style=\"color: #0000ff;\">if</span> (index &lt; (size &gt;&gt; 1<span style=\"color: #000000;\">)) {\r\n            Node</span>&lt;E&gt; x = first;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">index==0时不会循环，直接返回first</span>\r\n            <span style=\"color: #0000ff;\">for</span> (<span style=\"color: #0000ff;\">int</span> i = 0; i &lt; index; i++<span style=\"color: #000000;\">)\r\n                x </span>=<span style=\"color: #000000;\"> x.next;\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> x;\r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            Node</span>&lt;E&gt; x =<span style=\"color: #000000;\"> last;\r\n            </span><span style=\"color: #0000ff;\">for</span> (<span style=\"color: #0000ff;\">int</span> i = size - 1; i &gt; index; i--<span style=\"color: #000000;\">)\r\n                x </span>=<span style=\"color: #000000;\"> x.prev;\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> x;\r\n        }\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取指定元素从first开始的索引位置，不存在就返回-1\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">不能按条件双向找了，所以通常根据索引获得元素的速度比通过元素获得索引的速度快</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> indexOf(Object o) {\r\n        </span><span style=\"color: #0000ff;\">int</span> index = 0<span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #0000ff;\">if</span> (o == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n            </span><span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = first; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.next) {\r\n                </span><span style=\"color: #0000ff;\">if</span> (x.item == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n                    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> index;\r\n                index</span>++<span style=\"color: #000000;\">;\r\n            }\r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            </span><span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = first; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.next) {\r\n                </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (o.equals(x.item))\r\n                    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> index;\r\n                index</span>++<span style=\"color: #000000;\">;\r\n            }\r\n        }\r\n        </span><span style=\"color: #0000ff;\">return</span> -1<span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取指定元素从first开始最后出现的索引，不存在就返回-1\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">但实际查找是从last开始的</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> lastIndexOf(Object o) {\r\n        </span><span style=\"color: #0000ff;\">int</span> index =<span style=\"color: #000000;\"> size;\r\n        </span><span style=\"color: #0000ff;\">if</span> (o == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n            </span><span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = last; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.prev) {\r\n                index</span>--<span style=\"color: #000000;\">;\r\n                </span><span style=\"color: #0000ff;\">if</span> (x.item == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n                    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> index;\r\n            }\r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            </span><span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = last; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.prev) {\r\n                index</span>--<span style=\"color: #000000;\">;\r\n                </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (o.equals(x.item))\r\n                    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> index;\r\n            }\r\n        }\r\n        </span><span style=\"color: #0000ff;\">return</span> -1<span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">提供普通队列和双向队列的功能，当然，也可以实现栈，FIFO，FILO\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">出队（从前端），获得第一个元素，不存在会返回null，不会删除元素（节点）</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E peek() {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; f =<span style=\"color: #000000;\"> first;\r\n        </span><span style=\"color: #0000ff;\">return</span> (f == <span style=\"color: #0000ff;\">null</span>) ? <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\"> : f.item;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">出队（从前端），不删除元素，若为null会抛出异常而不是返回null</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E element() {\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> getFirst();\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">出队（从前端），如果不存在会返回null，存在的话会返回值并移除这个元素（节点）</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E poll() {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; f =<span style=\"color: #000000;\"> first;\r\n        </span><span style=\"color: #0000ff;\">return</span> (f == <span style=\"color: #0000ff;\">null</span>) ? <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\"> : unlinkFirst(f);\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">出队（从前端），如果不存在会抛出异常而不是返回null，存在的话会返回值并移除这个元素（节点）</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E remove() {\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> removeFirst();\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">入队（从后端），始终返回true</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> offer(E e) {\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> add(e);\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">入队（从前端），始终返回true</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> offerFirst(E e) {\r\n        addFirst(e);\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">入队（从后端），始终返回true</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> offerLast(E e) {\r\n        addLast(e);</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">linkLast(e)</span>\r\n        <span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">出队（从前端），获得第一个元素，不存在会返回null，不会删除元素（节点）</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E peekFirst() {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; f =<span style=\"color: #000000;\"> first;\r\n        </span><span style=\"color: #0000ff;\">return</span> (f == <span style=\"color: #0000ff;\">null</span>) ? <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\"> : f.item;\r\n     }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">出队（从后端），获得最后一个元素，不存在会返回null，不会删除元素（节点）</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E peekLast() {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; l =<span style=\"color: #000000;\"> last;\r\n        </span><span style=\"color: #0000ff;\">return</span> (l == <span style=\"color: #0000ff;\">null</span>) ? <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\"> : l.item;\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">出队（从前端），获得第一个元素，不存在会返回null，会删除元素（节点）</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E pollFirst() {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; f =<span style=\"color: #000000;\"> first;\r\n        </span><span style=\"color: #0000ff;\">return</span> (f == <span style=\"color: #0000ff;\">null</span>) ? <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\"> : unlinkFirst(f);\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">出队（从后端），获得最后一个元素，不存在会返回null，会删除元素（节点）</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E pollLast() {\r\n        </span><span style=\"color: #0000ff;\">final</span> Node&lt;E&gt; l =<span style=\"color: #000000;\"> last;\r\n        </span><span style=\"color: #0000ff;\">return</span> (l == <span style=\"color: #0000ff;\">null</span>) ? <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\"> : unlinkLast(l);\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">入栈，从前面添加</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> push(E e) {\r\n        addFirst(e);\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">出栈，返回栈顶元素，从前面移除（会删除）</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E pop() {\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> removeFirst();\r\n    }\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * Removes the first occurrence of the specified element in this\r\n     * list (when traversing the list from head to tail).  If the list\r\n     * does not contain the element, it is unchanged.\r\n     *\r\n     * </span><span style=\"color: #808080;\">@param</span><span style=\"color: #008000;\"> o element to be removed from this list, if present\r\n     * </span><span style=\"color: #808080;\">@return</span><span style=\"color: #008000;\"> {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> true} if the list contained the specified element\r\n     * </span><span style=\"color: #808080;\">@since</span><span style=\"color: #008000;\"> 1.6\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> removeFirstOccurrence(Object o) {\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> remove(o);\r\n    }\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * Removes the last occurrence of the specified element in this\r\n     * list (when traversing the list from head to tail).  If the list\r\n     * does not contain the element, it is unchanged.\r\n     *\r\n     * </span><span style=\"color: #808080;\">@param</span><span style=\"color: #008000;\"> o element to be removed from this list, if present\r\n     * </span><span style=\"color: #808080;\">@return</span><span style=\"color: #008000;\"> {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> true} if the list contained the specified element\r\n     * </span><span style=\"color: #808080;\">@since</span><span style=\"color: #008000;\"> 1.6\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> removeLastOccurrence(Object o) {\r\n        </span><span style=\"color: #0000ff;\">if</span> (o == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n            </span><span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = last; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.prev) {\r\n                </span><span style=\"color: #0000ff;\">if</span> (x.item == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n                    unlink(x);\r\n                    </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n                }\r\n            }\r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n            </span><span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = last; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.prev) {\r\n                </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (o.equals(x.item)) {\r\n                    unlink(x);\r\n                    </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n                }\r\n            }\r\n        }\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n    }\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * Returns a list-iterator of the elements in this list (in proper\r\n     * sequence), starting at the specified position in the list.\r\n     * Obeys the general contract of {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> List.listIterator(int)}.&lt;p&gt;\r\n     *\r\n     * The list-iterator is &lt;i&gt;fail-fast&lt;/i&gt;: if the list is structurally\r\n     * modified at any time after the Iterator is created, in any way except\r\n     * through the list-iterator's own {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> remove} or {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> add}\r\n     * methods, the list-iterator will throw a\r\n     * {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> ConcurrentModificationException}.  Thus, in the face of\r\n     * concurrent modification, the iterator fails quickly and cleanly, rather\r\n     * than risking arbitrary, non-deterministic behavior at an undetermined\r\n     * time in the future.\r\n     *\r\n     * </span><span style=\"color: #808080;\">@param</span><span style=\"color: #008000;\"> index index of the first element to be returned from the\r\n     *              list-iterator (by a call to {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> next})\r\n     * </span><span style=\"color: #808080;\">@return</span><span style=\"color: #008000;\"> a ListIterator of the elements in this list (in proper\r\n     *         sequence), starting at the specified position in the list\r\n     * </span><span style=\"color: #808080;\">@throws</span><span style=\"color: #008000;\"> IndexOutOfBoundsException {</span><span style=\"color: #808080;\">@inheritDoc</span><span style=\"color: #008000;\">}\r\n     * </span><span style=\"color: #808080;\">@see</span><span style=\"color: #008000;\"> List#listIterator(int)\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">public</span> ListIterator&lt;E&gt; listIterator(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index) {\r\n        checkPositionIndex(index);\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> ListItr(index);\r\n    }\r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">class</span> ListItr <span style=\"color: #0000ff;\">implements</span> ListIterator&lt;E&gt;<span style=\"color: #000000;\"> {\r\n        </span><span style=\"color: #0000ff;\">private</span> Node&lt;E&gt;<span style=\"color: #000000;\"> lastReturned;\r\n        </span><span style=\"color: #0000ff;\">private</span> Node&lt;E&gt;<span style=\"color: #000000;\"> next;\r\n        </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> nextIndex;\r\n        </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">int</span> expectedModCount =<span style=\"color: #000000;\"> modCount;\r\n        ListItr(</span><span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index) {\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> assert isPositionIndex(index);</span>\r\n            next = (index == size) ? <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\"> : node(index);\r\n            nextIndex </span>=<span style=\"color: #000000;\"> index;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> hasNext() {\r\n            </span><span style=\"color: #0000ff;\">return</span> nextIndex &lt;<span style=\"color: #000000;\"> size;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E next() {\r\n            checkForComodification();\r\n            </span><span style=\"color: #0000ff;\">if</span> (!<span style=\"color: #000000;\">hasNext())\r\n                </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> NoSuchElementException();\r\n            lastReturned </span>=<span style=\"color: #000000;\"> next;\r\n            next </span>=<span style=\"color: #000000;\"> next.next;\r\n            nextIndex</span>++<span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> lastReturned.item;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> hasPrevious() {\r\n            </span><span style=\"color: #0000ff;\">return</span> nextIndex &gt; 0<span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E previous() {\r\n            checkForComodification();\r\n            </span><span style=\"color: #0000ff;\">if</span> (!<span style=\"color: #000000;\">hasPrevious())\r\n                </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> NoSuchElementException();\r\n            lastReturned </span>= next = (next == <span style=\"color: #0000ff;\">null</span>) ?<span style=\"color: #000000;\"> last : next.prev;\r\n            nextIndex</span>--<span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> lastReturned.item;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> nextIndex() {\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> nextIndex;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> previousIndex() {\r\n            </span><span style=\"color: #0000ff;\">return</span> nextIndex - 1<span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> remove() {\r\n            checkForComodification();\r\n            </span><span style=\"color: #0000ff;\">if</span> (lastReturned == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n                </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> IllegalStateException();\r\n            Node</span>&lt;E&gt; lastNext =<span style=\"color: #000000;\"> lastReturned.next;\r\n            unlink(lastReturned);\r\n            </span><span style=\"color: #0000ff;\">if</span> (next ==<span style=\"color: #000000;\"> lastReturned)\r\n                next </span>=<span style=\"color: #000000;\"> lastNext;\r\n            </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n                nextIndex</span>--<span style=\"color: #000000;\">;\r\n            lastReturned </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n            expectedModCount</span>++<span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> set(E e) {\r\n            </span><span style=\"color: #0000ff;\">if</span> (lastReturned == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n                </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> IllegalStateException();\r\n            checkForComodification();\r\n            lastReturned.item </span>=<span style=\"color: #000000;\"> e;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> add(E e) {\r\n            checkForComodification();\r\n            lastReturned </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #0000ff;\">if</span> (next == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n                linkLast(e);\r\n            </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n                linkBefore(e, next);\r\n            nextIndex</span>++<span style=\"color: #000000;\">;\r\n            expectedModCount</span>++<span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span> forEachRemaining(Consumer&lt;? <span style=\"color: #0000ff;\">super</span> E&gt;<span style=\"color: #000000;\"> action) {\r\n            Objects.requireNonNull(action);\r\n            </span><span style=\"color: #0000ff;\">while</span> (modCount == expectedModCount &amp;&amp; nextIndex &lt;<span style=\"color: #000000;\"> size) {\r\n                action.accept(next.item);\r\n                lastReturned </span>=<span style=\"color: #000000;\"> next;\r\n                next </span>=<span style=\"color: #000000;\"> next.next;\r\n                nextIndex</span>++<span style=\"color: #000000;\">;\r\n            }\r\n            checkForComodification();\r\n        }\r\n        </span><span style=\"color: #0000ff;\">final</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> checkForComodification() {\r\n            </span><span style=\"color: #0000ff;\">if</span> (modCount !=<span style=\"color: #000000;\"> expectedModCount)\r\n                </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> ConcurrentModificationException();\r\n        }\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">节点的数据结构，包含前后节点的引用和当前节点</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">class</span> Node&lt;E&gt;<span style=\"color: #000000;\"> {\r\n        E item;\r\n        Node</span>&lt;E&gt;<span style=\"color: #000000;\"> next;\r\n        Node</span>&lt;E&gt;<span style=\"color: #000000;\"> prev;\r\n        Node(Node</span>&lt;E&gt; prev, E element, Node&lt;E&gt;<span style=\"color: #000000;\"> next) {\r\n            </span><span style=\"color: #0000ff;\">this</span>.item =<span style=\"color: #000000;\"> element;\r\n            </span><span style=\"color: #0000ff;\">this</span>.next =<span style=\"color: #000000;\"> next;\r\n            </span><span style=\"color: #0000ff;\">this</span>.prev =<span style=\"color: #000000;\"> prev;\r\n        }\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">返回迭代器</span>\r\n    <span style=\"color: #0000ff;\">public</span> Iterator&lt;E&gt;<span style=\"color: #000000;\"> descendingIterator() {\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> DescendingIterator();\r\n    }\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">因为采用链表实现，所以迭代器很简单</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">class</span> DescendingIterator <span style=\"color: #0000ff;\">implements</span> Iterator&lt;E&gt;<span style=\"color: #000000;\"> {\r\n        </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">final</span> ListItr itr = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> ListItr(size());\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span><span style=\"color: #000000;\"> hasNext() {\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> itr.hasPrevious();\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> E next() {\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> itr.previous();\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> remove() {\r\n            itr.remove();\r\n        }\r\n    }\r\n    @SuppressWarnings(</span>\"unchecked\"<span style=\"color: #000000;\">)\r\n    </span><span style=\"color: #0000ff;\">private</span> LinkedList&lt;E&gt;<span style=\"color: #000000;\"> superClone() {\r\n        </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n            </span><span style=\"color: #0000ff;\">return</span> (LinkedList&lt;E&gt;) <span style=\"color: #0000ff;\">super</span><span style=\"color: #000000;\">.clone();\r\n        } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (CloneNotSupportedException e) {\r\n            </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> InternalError(e);\r\n        }\r\n    }\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * Returns a shallow copy of this {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> LinkedList}. (The elements\r\n     * themselves are not cloned.)\r\n     *\r\n     * </span><span style=\"color: #808080;\">@return</span><span style=\"color: #008000;\"> a shallow copy of this {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> LinkedList} instance\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> Object clone() {\r\n        LinkedList</span>&lt;E&gt; clone =<span style=\"color: #000000;\"> superClone();\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Put clone into \"virgin\" state</span>\r\n        clone.first = clone.last = <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n        clone.size </span>= 0<span style=\"color: #000000;\">;\r\n        clone.modCount </span>= 0<span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Initialize clone with our elements</span>\r\n        <span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = first; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.next)\r\n            clone.add(x.item);\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> clone;\r\n    }\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * Returns an array containing all of the elements in this list\r\n     * in proper sequence (from first to last element).\r\n     *\r\n     * &lt;p&gt;The returned array will be \"safe\" in that no references to it are\r\n     * maintained by this list.  (In other words, this method must allocate\r\n     * a new array).  The caller is thus free to modify the returned array.\r\n     *\r\n     * &lt;p&gt;This method acts as bridge between array-based and collection-based\r\n     * APIs.\r\n     *\r\n     * </span><span style=\"color: #808080;\">@return</span><span style=\"color: #008000;\"> an array containing all of the elements in this list\r\n     *         in proper sequence\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> Object[] toArray() {\r\n        Object[] result </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Object[size];\r\n        </span><span style=\"color: #0000ff;\">int</span> i = 0<span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = first; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.next)\r\n            result[i</span>++] =<span style=\"color: #000000;\"> x.item;\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> result;\r\n    }\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * Returns an array containing all of the elements in this list in\r\n     * proper sequence (from first to last element); the runtime type of\r\n     * the returned array is that of the specified array.  If the list fits\r\n     * in the specified array, it is returned therein.  Otherwise, a new\r\n     * array is allocated with the runtime type of the specified array and\r\n     * the size of this list.\r\n     *\r\n     * &lt;p&gt;If the list fits in the specified array with room to spare (i.e.,\r\n     * the array has more elements than the list), the element in the array\r\n     * immediately following the end of the list is set to {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> null}.\r\n     * (This is useful in determining the length of the list &lt;i&gt;only&lt;/i&gt; if\r\n     * the caller knows that the list does not contain any null elements.)\r\n     *\r\n     * &lt;p&gt;Like the {</span><span style=\"color: #808080;\">@link</span><span style=\"color: #008000;\"> #toArray()} method, this method acts as bridge between\r\n     * array-based and collection-based APIs.  Further, this method allows\r\n     * precise control over the runtime type of the output array, and may,\r\n     * under certain circumstances, be used to save allocation costs.\r\n     *\r\n     * &lt;p&gt;Suppose {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> x} is a list known to contain only strings.\r\n     * The following code can be used to dump the list into a newly\r\n     * allocated array of {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> String}:\r\n     *\r\n     * &lt;pre&gt;\r\n     *     String[] y = x.toArray(new String[0]);&lt;/pre&gt;\r\n     *\r\n     * Note that {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> toArray(new Object[0])} is identical in function to\r\n     * {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> toArray()}.\r\n     *\r\n     * </span><span style=\"color: #808080;\">@param</span><span style=\"color: #008000;\"> a the array into which the elements of the list are to\r\n     *          be stored, if it is big enough; otherwise, a new array of the\r\n     *          same runtime type is allocated for this purpose.\r\n     * </span><span style=\"color: #808080;\">@return</span><span style=\"color: #008000;\"> an array containing the elements of the list\r\n     * </span><span style=\"color: #808080;\">@throws</span><span style=\"color: #008000;\"> ArrayStoreException if the runtime type of the specified array\r\n     *         is not a supertype of the runtime type of every element in\r\n     *         this list\r\n     * </span><span style=\"color: #808080;\">@throws</span><span style=\"color: #008000;\"> NullPointerException if the specified array is null\r\n     </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    @SuppressWarnings(</span>\"unchecked\"<span style=\"color: #000000;\">)\r\n    </span><span style=\"color: #0000ff;\">public</span> &lt;T&gt;<span style=\"color: #000000;\"> T[] toArray(T[] a) {\r\n        </span><span style=\"color: #0000ff;\">if</span> (a.length &lt;<span style=\"color: #000000;\"> size)\r\n            a </span>=<span style=\"color: #000000;\"> (T[])java.lang.reflect.Array.newInstance(a.getClass().getComponentType(), size);\r\n        </span><span style=\"color: #0000ff;\">int</span> i = 0<span style=\"color: #000000;\">;\r\n        Object[] result </span>=<span style=\"color: #000000;\"> a;\r\n        </span><span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = first; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.next)\r\n            result[i</span>++] =<span style=\"color: #000000;\"> x.item;\r\n        </span><span style=\"color: #0000ff;\">if</span> (a.length &gt;<span style=\"color: #000000;\"> size)\r\n            a[size] </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> a;\r\n    }\r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">final</span> <span style=\"color: #0000ff;\">long</span> serialVersionUID = 876323262645176354L<span style=\"color: #000000;\">;\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * Saves the state of this {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> LinkedList} instance to a stream\r\n     * (that is, serializes it).\r\n     *\r\n     * </span><span style=\"color: #808080;\">@serialData</span><span style=\"color: #008000;\"> The size of the list (the number of elements it\r\n     *             contains) is emitted (int), followed by all of its\r\n     *             elements (each an Object) in the proper order.\r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> writeObject(java.io.ObjectOutputStream s)\r\n        </span><span style=\"color: #0000ff;\">throws</span><span style=\"color: #000000;\"> java.io.IOException {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Write out any hidden serialization magic</span>\r\n<span style=\"color: #000000;\">        s.defaultWriteObject();\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Write out size</span>\r\n<span style=\"color: #000000;\">        s.writeInt(size);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Write out all elements in the proper order.</span>\r\n        <span style=\"color: #0000ff;\">for</span> (Node&lt;E&gt; x = first; x != <span style=\"color: #0000ff;\">null</span>; x =<span style=\"color: #000000;\"> x.next)\r\n            s.writeObject(x.item);\r\n    }\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * Reconstitutes this {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> LinkedList} instance from a stream\r\n     * (that is, deserializes it).\r\n     </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    @SuppressWarnings(</span>\"unchecked\"<span style=\"color: #000000;\">)\r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> readObject(java.io.ObjectInputStream s)\r\n        </span><span style=\"color: #0000ff;\">throws</span><span style=\"color: #000000;\"> java.io.IOException, ClassNotFoundException {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Read in any hidden serialization magic</span>\r\n<span style=\"color: #000000;\">        s.defaultReadObject();\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Read in size</span>\r\n        <span style=\"color: #0000ff;\">int</span> size =<span style=\"color: #000000;\"> s.readInt();\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> Read in all elements in the proper order.</span>\r\n        <span style=\"color: #0000ff;\">for</span> (<span style=\"color: #0000ff;\">int</span> i = 0; i &lt; size; i++<span style=\"color: #000000;\">)\r\n            linkLast((E)s.readObject());\r\n    }\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * Creates a &lt;em&gt;&lt;a href=\"Spliterator.html#binding\"&gt;late-binding&lt;/a&gt;&lt;/em&gt;\r\n     * and &lt;em&gt;fail-fast&lt;/em&gt; {</span><span style=\"color: #808080;\">@link</span><span style=\"color: #008000;\"> Spliterator} over the elements in this\r\n     * list.\r\n     *\r\n     * &lt;p&gt;The {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> Spliterator} reports {</span><span style=\"color: #808080;\">@link</span><span style=\"color: #008000;\"> Spliterator#SIZED} and\r\n     * {</span><span style=\"color: #808080;\">@link</span><span style=\"color: #008000;\"> Spliterator#ORDERED}.  Overriding implementations should document\r\n     * the reporting of additional characteristic values.\r\n     *\r\n     * @implNote\r\n     * The {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> Spliterator} additionally reports {</span><span style=\"color: #808080;\">@link</span><span style=\"color: #008000;\"> Spliterator#SUBSIZED}\r\n     * and implements {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> trySplit} to permit limited parallelism..\r\n     *\r\n     * </span><span style=\"color: #808080;\">@return</span><span style=\"color: #008000;\"> a {</span><span style=\"color: #808080;\">@code</span><span style=\"color: #008000;\"> Spliterator} over the elements in this list\r\n     * </span><span style=\"color: #808080;\">@since</span><span style=\"color: #008000;\"> 1.8\r\n     </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    @Override\r\n    </span><span style=\"color: #0000ff;\">public</span> Spliterator&lt;E&gt;<span style=\"color: #000000;\"> spliterator() {\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">new</span> LLSpliterator&lt;E&gt;(<span style=\"color: #0000ff;\">this</span>, -1, 0<span style=\"color: #000000;\">);\r\n    }\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\"> A customized variant of Spliterators.IteratorSpliterator </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">final</span> <span style=\"color: #0000ff;\">class</span> LLSpliterator&lt;E&gt; <span style=\"color: #0000ff;\">implements</span> Spliterator&lt;E&gt;<span style=\"color: #000000;\"> {\r\n        </span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">final</span> <span style=\"color: #0000ff;\">int</span> BATCH_UNIT = 1 &lt;&lt; 10;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> batch array size increment</span>\r\n        <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">final</span> <span style=\"color: #0000ff;\">int</span> MAX_BATCH = 1 &lt;&lt; 25;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> max batch array size;</span>\r\n        <span style=\"color: #0000ff;\">final</span> LinkedList&lt;E&gt; list; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> null OK unless traversed</span>\r\n        Node&lt;E&gt; current;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> current node; null until initialized</span>\r\n        <span style=\"color: #0000ff;\">int</span> est;              <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> size estimate; -1 until first needed</span>\r\n        <span style=\"color: #0000ff;\">int</span> expectedModCount; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> initialized when est set</span>\r\n        <span style=\"color: #0000ff;\">int</span> batch;            <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> batch size for splits</span>\r\n        LLSpliterator(LinkedList&lt;E&gt; list, <span style=\"color: #0000ff;\">int</span> est, <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> expectedModCount) {\r\n            </span><span style=\"color: #0000ff;\">this</span>.list =<span style=\"color: #000000;\"> list;\r\n            </span><span style=\"color: #0000ff;\">this</span>.est =<span style=\"color: #000000;\"> est;\r\n            </span><span style=\"color: #0000ff;\">this</span>.expectedModCount =<span style=\"color: #000000;\"> expectedModCount;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">final</span> <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> getEst() {\r\n            </span><span style=\"color: #0000ff;\">int</span> s; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> force initialization</span>\r\n            <span style=\"color: #0000ff;\">final</span> LinkedList&lt;E&gt;<span style=\"color: #000000;\"> lst;\r\n            </span><span style=\"color: #0000ff;\">if</span> ((s = est) &lt; 0<span style=\"color: #000000;\">) {\r\n                </span><span style=\"color: #0000ff;\">if</span> ((lst = list) == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n                    s </span>= est = 0<span style=\"color: #000000;\">;\r\n                </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n                    expectedModCount </span>=<span style=\"color: #000000;\"> lst.modCount;\r\n                    current </span>=<span style=\"color: #000000;\"> lst.first;\r\n                    s </span>= est =<span style=\"color: #000000;\"> lst.size;\r\n                }\r\n            }\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> s;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">long</span> estimateSize() { <span style=\"color: #0000ff;\">return</span> (<span style=\"color: #0000ff;\">long</span><span style=\"color: #000000;\">) getEst(); }\r\n        </span><span style=\"color: #0000ff;\">public</span> Spliterator&lt;E&gt;<span style=\"color: #000000;\"> trySplit() {\r\n            Node</span>&lt;E&gt;<span style=\"color: #000000;\"> p;\r\n            </span><span style=\"color: #0000ff;\">int</span> s =<span style=\"color: #000000;\"> getEst();\r\n            </span><span style=\"color: #0000ff;\">if</span> (s &gt; 1 &amp;&amp; (p = current) != <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n                </span><span style=\"color: #0000ff;\">int</span> n = batch +<span style=\"color: #000000;\"> BATCH_UNIT;\r\n                </span><span style=\"color: #0000ff;\">if</span> (n &gt;<span style=\"color: #000000;\"> s)\r\n                    n </span>=<span style=\"color: #000000;\"> s;\r\n                </span><span style=\"color: #0000ff;\">if</span> (n &gt;<span style=\"color: #000000;\"> MAX_BATCH)\r\n                    n </span>=<span style=\"color: #000000;\"> MAX_BATCH;\r\n                Object[] a </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Object[n];\r\n                </span><span style=\"color: #0000ff;\">int</span> j = 0<span style=\"color: #000000;\">;\r\n                </span><span style=\"color: #0000ff;\">do</span> { a[j++] = p.item; } <span style=\"color: #0000ff;\">while</span> ((p = p.next) != <span style=\"color: #0000ff;\">null</span> &amp;&amp; j &lt;<span style=\"color: #000000;\"> n);\r\n                current </span>=<span style=\"color: #000000;\"> p;\r\n                batch </span>=<span style=\"color: #000000;\"> j;\r\n                est </span>= s -<span style=\"color: #000000;\"> j;\r\n                </span><span style=\"color: #0000ff;\">return</span> Spliterators.spliterator(a, 0<span style=\"color: #000000;\">, j, Spliterator.ORDERED);\r\n            }\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span> forEachRemaining(Consumer&lt;? <span style=\"color: #0000ff;\">super</span> E&gt;<span style=\"color: #000000;\"> action) {\r\n            Node</span>&lt;E&gt; p; <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> n;\r\n            </span><span style=\"color: #0000ff;\">if</span> (action == <span style=\"color: #0000ff;\">null</span>) <span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> NullPointerException();\r\n            </span><span style=\"color: #0000ff;\">if</span> ((n = getEst()) &gt; 0 &amp;&amp; (p = current) != <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n                current </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n                est </span>= 0<span style=\"color: #000000;\">;\r\n                </span><span style=\"color: #0000ff;\">do</span><span style=\"color: #000000;\"> {\r\n                    E e </span>=<span style=\"color: #000000;\"> p.item;\r\n                    p </span>=<span style=\"color: #000000;\"> p.next;\r\n                    action.accept(e);\r\n                } </span><span style=\"color: #0000ff;\">while</span> (p != <span style=\"color: #0000ff;\">null</span> &amp;&amp; --n &gt; 0<span style=\"color: #000000;\">);\r\n            }\r\n            </span><span style=\"color: #0000ff;\">if</span> (list.modCount !=<span style=\"color: #000000;\"> expectedModCount)\r\n                </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> ConcurrentModificationException();\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">boolean</span> tryAdvance(Consumer&lt;? <span style=\"color: #0000ff;\">super</span> E&gt;<span style=\"color: #000000;\"> action) {\r\n            Node</span>&lt;E&gt;<span style=\"color: #000000;\"> p;\r\n            </span><span style=\"color: #0000ff;\">if</span> (action == <span style=\"color: #0000ff;\">null</span>) <span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> NullPointerException();\r\n            </span><span style=\"color: #0000ff;\">if</span> (getEst() &gt; 0 &amp;&amp; (p = current) != <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {\r\n                </span>--<span style=\"color: #000000;\">est;\r\n                E e </span>=<span style=\"color: #000000;\"> p.item;\r\n                current </span>=<span style=\"color: #000000;\"> p.next;\r\n                action.accept(e);\r\n                </span><span style=\"color: #0000ff;\">if</span> (list.modCount !=<span style=\"color: #000000;\"> expectedModCount)\r\n                    </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> ConcurrentModificationException();\r\n                </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n            }\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> characteristics() {\r\n            </span><span style=\"color: #0000ff;\">return</span> Spliterator.ORDERED | Spliterator.SIZED |<span style=\"color: #000000;\"> Spliterator.SUBSIZED;\r\n        }\r\n    }\r\n}</span></pre>\r\n</div>\r\n<p>上面的代码解释参考自：http://blog.csdn.net/anxpp/article/details/51203591，感谢anxpp 的分享。</p>\r\n<p><strong>LinkedList和ArrayList的对比：</strong></p>\r\n<p>1、顺序插入速度ArrayList会比较快，因为ArrayList是基于数组实现的，数组是事先new好的，只要往指定位置塞一个数据就好了；LinkedList则不同，每次顺序插入的时候LinkedList将new一个对象出来，如果对象比较大，那么new的时间势必会长一点，再加上一些引用赋值的操作，所以顺序插入LinkedList必然慢于ArrayList</p>\r\n<p>2、基于上一点，因为LinkedList里面不仅维护了待插入的元素，还维护了Entry的前置Entry和后继Entry，如果一个LinkedList中的Entry非常多，那么LinkedList将比ArrayList更耗费一些内存</p>\r\n<p>3、数据遍历的速度，看最后一部分，这里就不细讲了，结论是：<strong>使用各自遍历效率最高的方式，ArrayList的遍历效率会比LinkedList的遍历效率高一些</strong></p>\r\n<p>4、有些说法认为LinkedList做插入和删除更快，这种说法其实是不准确的：</p>\r\n<p>（1）LinkedList做插入、删除的时候，慢在寻址，快在只需要改变前后Entry的引用地址</p>\r\n<p>（2）ArrayList做插入、删除的时候，慢在数组元素的批量copy，快在寻址</p>\r\n<p><strong>所以，如果待插入、删除的元素是在数据结构的前半段尤其是非常靠前的位置的时候，LinkedList的效率将大大快过ArrayList，因为ArrayList将批量copy大量的元素；越往后，对于LinkedList来说，因为它是双向链表，所以在第2个元素后面插入一个数据和在倒数第2个元素后面插入一个元素在效率上基本没有差别，但是ArrayList由于要批量copy的元素越来越少，操作速度必然追上乃至超过LinkedList</strong>。</p>\r\n<p>从这个分析看出，如果你十分确定你插入、删除的元素是在前半段，那么就使用LinkedList；如果你十分确定你删除、删除的元素在比较靠后的位置，那么可以考虑使用ArrayList。如果你不能确定你要做的插入、删除是在哪儿呢？那还是建议你使用LinkedList吧，因为一来LinkedList整体插入、删除的执行效率比较稳定，没有ArrayList这种越往后越快的情况；二来插入元素的时候，弄得不好ArrayList就要进行一次扩容，记住，<strong>ArrayList底层数组扩容是一个既消耗时间又消耗空间的操作。</strong></p>\r\n<p><strong><span style=\"font-size: 18px;\">四、自己实现一个简单的LinkedList</span></strong></p>\r\n<p><span style=\"font-size: 16px;\">上面学习了那么多，感觉还是自己来实现一个比较容易理解，并且面试的时候如果考到了，自己写一个简单的即可，理解原理才是最重要的。</span></p>\r\n<p><span style=\"font-size: 16px;\">1.定义一个Node节点</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">package</span><span style=\"color: #000000;\"> study.collection;\r\n\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">用来表示一个节点</span>\r\n<span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Node {\r\n     Node previous;   </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">上一个节点</span>\r\n<span style=\"color: #000000;\">     Object obj;\r\n     Node next;        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">下一个节点</span>\r\n    \r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> Node() {\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> Node(Node previous, Object obj, Node next) {\r\n        </span><span style=\"color: #0000ff;\">super</span><span style=\"color: #000000;\">();\r\n        </span><span style=\"color: #0000ff;\">this</span>.previous =<span style=\"color: #000000;\"> previous;\r\n        </span><span style=\"color: #0000ff;\">this</span>.obj =<span style=\"color: #000000;\"> obj;\r\n        </span><span style=\"color: #0000ff;\">this</span>.next =<span style=\"color: #000000;\"> next;\r\n    }\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> Node getPrevious() {\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> previous;\r\n    }\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> setPrevious(Node previous) {\r\n        </span><span style=\"color: #0000ff;\">this</span>.previous =<span style=\"color: #000000;\"> previous;\r\n    }\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> Object getObj() {\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> obj;\r\n    }\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> setObj(Object obj) {\r\n        </span><span style=\"color: #0000ff;\">this</span>.obj =<span style=\"color: #000000;\"> obj;\r\n    }\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> Node getNext() {\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> next;\r\n    }\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> setNext(Node next) {\r\n        </span><span style=\"color: #0000ff;\">this</span>.next =<span style=\"color: #000000;\"> next;\r\n    }\r\n    \r\n    \r\n    \r\n}</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 16px;\">2.定义链表实现</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">package</span><span style=\"color: #000000;\"> study.collection;\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span> MyLinkedList <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">implements List</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n{\r\n    </span><span style=\"color: #0000ff;\">private</span> Node first; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">首节点</span>\r\n    <span style=\"color: #0000ff;\">private</span> Node last;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">尾节点</span>\r\n    \r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">int</span> size; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">个数</span>\r\n    \r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> add(Object obj){\r\n        Node n </span>= <span style=\"color: #0000ff;\">new</span> Node(); <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">建立一个新的节点</span>\r\n        <span style=\"color: #0000ff;\">if</span>(first==<span style=\"color: #0000ff;\">null</span>) <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果首节点为空</span>\r\n<span style=\"color: #000000;\">        {\r\n            n.setPrevious(</span><span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">);\r\n            n.setObj(obj);\r\n            n.setNext(</span><span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">);\r\n            first </span>= n;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">则这个时候此进入的为第一个元素，那么首节点和尾节点均为新加入的这个节点</span>\r\n            last =<span style=\"color: #000000;\"> n;\r\n        }</span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">{\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">直接往last节点后增加新的节点</span>\r\n            n.setPrevious(last); <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">因为这个时候只有一个,那么这个时候往后面添加元素,所以这个时候新加的节点的前节点为last</span>\r\n<span style=\"color: #000000;\">            n.setObj(obj);\r\n            n.setNext(</span><span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">);\r\n            \r\n            last.setNext(n); </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">原来last的next 节点就是它了</span>\r\n<span style=\"color: #000000;\">            \r\n            last </span>= n; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">n 变成了last </span>\r\n<span style=\"color: #000000;\">        }\r\n        size</span>++<span style=\"color: #000000;\">;\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> size(){\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> size;\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">void</span> rangeCheck(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index){\r\n        </span><span style=\"color: #0000ff;\">if</span>(index&lt;0||index&gt;=<span style=\"color: #000000;\">size){\r\n            </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n                </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Exception();\r\n            } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception e) {\r\n                e.printStackTrace();\r\n            }\r\n        }\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> Object get(<span style=\"color: #0000ff;\">int</span> index){   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">2</span>\r\n<span style=\"color: #000000;\">        rangeCheck(index);\r\n        \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 0 1 2 3 4</span>\r\n        Node temp =<span style=\"color: #000000;\"> node(index);\r\n        </span><span style=\"color: #0000ff;\">if</span>(temp!=<span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">){\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> temp.obj;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n    }\r\n    \r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * 这个是关键的步骤，根据索引找到对应的节点，这个时候只要遍历即可,而且遍历的&lt;index 就可以了,因为最后就是它了。\r\n     * </span><span style=\"color: #808080;\">@param</span><span style=\"color: #008000;\"> index\r\n     * </span><span style=\"color: #808080;\">@return</span>\r\n     <span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">public</span> Node node(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index){\r\n        Node temp </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #0000ff;\">if</span>(first!=<span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">if</span> (index &lt; (size &gt;&gt; 1<span style=\"color: #000000;\">)) \r\n            {\r\n                temp </span>=<span style=\"color: #000000;\"> first;\r\n                </span><span style=\"color: #0000ff;\">for</span>(<span style=\"color: #0000ff;\">int</span> i=0;i&lt;index;i++<span style=\"color: #000000;\">)\r\n                {\r\n                    temp </span>=<span style=\"color: #000000;\"> temp.next;\r\n                }\r\n            }\r\n            </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n            {\r\n                temp </span>=<span style=\"color: #000000;\"> last;\r\n                </span><span style=\"color: #0000ff;\">for</span> (<span style=\"color: #0000ff;\">int</span> i = size - 1; i &gt; index; i--<span style=\"color: #000000;\">){\r\n                    temp </span>=<span style=\"color: #000000;\"> temp.previous;\r\n                }\r\n            }\r\n            \r\n        }\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">        LinkedList l;</span>\r\n        <span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> temp;\r\n    }\r\n    \r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span> remove(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index){\r\n        Node temp </span>=<span style=\"color: #000000;\"> node(index);\r\n        \r\n        </span><span style=\"color: #0000ff;\">if</span>(temp!=<span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">){\r\n            Node up </span>=<span style=\"color: #000000;\"> temp.previous;\r\n            Node down </span>=<span style=\"color: #000000;\"> temp.next;\r\n            up.next </span>=<span style=\"color: #000000;\"> down;\r\n            down.previous </span>=<span style=\"color: #000000;\"> up;\r\n            size</span>--<span style=\"color: #000000;\">;\r\n        }\r\n        \r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span> add(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> index,Object obj){\r\n        Node temp </span>=<span style=\"color: #000000;\"> node(index);\r\n        \r\n        Node newNode </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Node();\r\n        newNode.obj </span>=<span style=\"color: #000000;\"> obj;\r\n        \r\n        </span><span style=\"color: #0000ff;\">if</span>(temp!=<span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">){\r\n            Node up </span>=<span style=\"color: #000000;\"> temp.previous;\r\n            up.next </span>=<span style=\"color: #000000;\"> newNode;\r\n            newNode.previous </span>=<span style=\"color: #000000;\"> up;\r\n            \r\n            newNode.next </span>=<span style=\"color: #000000;\"> temp;\r\n            temp.previous </span>=<span style=\"color: #000000;\"> newNode;\r\n            \r\n            size</span>++<span style=\"color: #000000;\">;\r\n        }\r\n    }\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> main(String[] args) {\r\n        MyLinkedList list </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> MyLinkedList();\r\n        list.add(</span>\"aaa\"<span style=\"color: #000000;\">);\r\n        list.add(</span>\"bbb\"<span style=\"color: #000000;\">);\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">        list.add(1,\"BBBB\");</span>\r\n        list.add(\"ccc\"<span style=\"color: #000000;\">);\r\n        list.add(</span>\"ddd\"<span style=\"color: #000000;\">);\r\n        list.add(</span>\"eee\"<span style=\"color: #000000;\">);\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">        list.remove(1);</span>\r\n        System.out.println(list.get(3<span style=\"color: #000000;\">)); \r\n    }\r\n    \r\n\r\n}</span></pre>\r\n</div>\r\n<p> </p>\r\n<p>参考资料：</p>\r\n<p>http://www.cnblogs.com/CherishFX/p/4734490.html<br>http://www.cnblogs.com/tstd/p/5046819.html<br>http://blog.csdn.net/zw0283/article/details/51132161<br>http://blog.csdn.net/anxpp/article/details/51203591</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<p class=\"postfoot\">\r\n\t\t\tposted on <span id=\"post-date\">2017-11-02 07:34</span> <a href=\"http://www.cnblogs.com/pony1223/\">pony1223</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7768779\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7768779);return false;\">收藏</a>\r\n\t\t</p>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=115583,cb_entryId=7768779,cb_blogApp=currentBlogApp,cb_blogUserGuid='6f4e35bd-a58b-e111-aa3f-842b2b196315',cb_entryCreatedDate='2017/11/2 7:34:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n\t</div>", "article_view": 234, "image_url": ["https://pic.cnblogs.com/face/u401339.gif?id=22115014"], "date_pub": "2017-11-02", "article_common": 1}
{"title": "基于HTML5 Canvas的3D动态Chart图表", "url": "http://www.cnblogs.com/xhload3d/p/7768021.html", "author": "xhload3d", "article_desc": "发现现在工业SCADA上或者电信网管方面用图表的特别多，虽然绝大部分人在图表制作方面用的是echarts，他确实好用，但是有些时候我们不能调用别的插件，这个时候就得自己写这些美丽的图表了，然而图表轻易做不成美丽的。。。看到有一个网站上在卖的图表，感觉挺好看的，就用 HT for Web 3D 实现了... ...", "content": "<div id=\"post_detail\">\r\n<div class=\"post\">\r\n\t<div class=\"postTitle\">\r\n\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/xhload3d/p/7768021.html\">基于HTML5 Canvas的3D动态Chart图表</a>\r\n\t</div>\r\n\t\r\n\t<div class=\"postText\">\r\n\t\t<div id=\"cnblogs_post_body\"><p>发现现在工业SCADA上或者电信网管方面用图表的特别多，虽然绝大部分人在图表制作方面用的是echarts，他确实好用，但是有些时候我们不能调用别的插件，这个时候就得自己写这些美丽的图表了，然而图表轻易做不成美丽的。。。看到有一个网站上在卖的图表，感觉挺好看的，就用 HT for Web 3D 做了一个小例子，挺简单的，也挺好看的，哈哈~</p>\n<p>Demo 地址： <a href=\"http://www.hightopo.com/demo/WireframeAnim/index.html\" target=\"_blank\">http://www.hightopo.com/demo/WireframeAnim/index.html</a></p>\n<p>动态效果图如下：</p>\n<p><img src=\"http://img.blog.csdn.net/20171101182139997?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGhsb2FkM2Q=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center\" alt=\"\"></p>\n<p>这个例子用 HT 实现真的很容易，首先创建一个 HT 中最基础的 dm 数据模型，然后将数据模型添加进 g3d 3d 组件中，再设置 3d 中的视角并把 3d 组件添加进 body 元素中：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> dm = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> ht.DataModel();\n</span><span style=\"color: #008080\">2</span> g3d = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> ht.graph3d.Graph3dView(dm);\n</span><span style=\"color: #008080\">3</span> g3d.setEye(0, 185, 300<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">4</span> <span style=\"color: #000000\">g3d.addToDOM();\n</span><span style=\"color: #008080\">5</span> g3d.getView().style.background = '#000';</pre>\n</div>\n<p>接着就是造这五个chart图表条了，我的思路是这样的，里层有一个节点，外层一个透明的节点，底部一个 3d 的文字显示当前的百分比。</p>\n<p>里层的节点非常容易，我直接用的 HT 封装的 ht.Node 创建了一个新的节点对象，然后通过 node.s 方法来设置 node 节点的样式：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">var</span> node = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> ht.Node();\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #000000\">node.s({\n</span><span style=\"color: #008080\"> 3</span>     'shape3d'<span style=\"color: #000000\">: cylinderModel,\n</span><span style=\"color: #008080\"> 4</span>     'shape3d.color'<span style=\"color: #000000\">: color,\n</span><span style=\"color: #008080\"> 5</span>     '3d.movable': <span style=\"color: #0000ff\">false</span>\n<span style=\"color: #008080\"> 6</span> <span style=\"color: #000000\">});\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #000000\">node.a({\n</span><span style=\"color: #008080\"> 8</span>     'myHeight': s3[1<span style=\"color: #000000\">],\n</span><span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">});\n</span><span style=\"color: #008080\">10</span> node.p3([p3[0], s3[1]/2, p3[2]]);\n<span style=\"color: #008080\">11</span> <span style=\"color: #000000\">node.s3(s3);\n</span><span style=\"color: #008080\">12</span> dm.add(node);</pre>\n</div>\n<p>其中要说明的是，'shape3d':cylinderModel 这个样式的设置，首先，shape3d 属性指定显示为 3d 模型的图标效果，cylinderModel 是用 HT 自定义的一个 3d 模型，可参考 <a href=\"http://hightopo.com/guide/guide/plugin/modeling/ht-modeling-guide.html#ref_createCylinderModel\">HT for Web 建模手册</a>：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> cylinderModel = ht.Default.createCylinderModel(1000, 0, 1000, <span style=\"color: #0000ff\">false</span>, <span style=\"color: #0000ff\">false</span>, <span style=\"color: #0000ff\">true</span>, <span style=\"color: #0000ff\">true</span>);</pre>\n</div>\n<p>然后设置了一个动态变化的属性 myHeight，在 HT 中，node.a 方法是预留给用户存储业务数据的，我们可以在这边添加任意多个属性。</p>\n<p>接下来我们要创建的是外部的透明节点，这个节点的构造方式基本上与内部节点相同，就是多了一点“透明”的样式设置：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">var</span> cNode = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> ht.Node();\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #000000\">cNode.s({\n</span><span style=\"color: #008080\"> 3</span>     'shape3d'<span style=\"color: #000000\">: cylinderModel,\n</span><span style=\"color: #008080\"> 4</span>     'shape3d.transparent': <span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 5</span>     'shape3d.opacity': 0.2<span style=\"color: #000000\">,    \n</span><span style=\"color: #008080\"> 6</span>     'label.color': '#fff'<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 7</span>     '3d.movable': <span style=\"color: #0000ff\">false</span>\n<span style=\"color: #008080\"> 8</span> <span style=\"color: #000000\">});\n</span><span style=\"color: #008080\"> 9</span> cNode.p3([p3[0], 50, p3[2<span style=\"color: #000000\">]]);\n</span><span style=\"color: #008080\">10</span> cNode.s3(20, 100, 20<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">11</span> dm.add(cNode);</pre>\n</div>\n<p>要先设置 ‘shape3d.transparent’ 为true，再设置 ‘shape3d.opacity’ 透明度。</p>\n<p>最后是 3d 文字，呈现 3d 文字需要一个 json 格式的 typeface 字体，然后通过 ht.Default.loadFontFace 来加载 json 格式的字体到内存中，详情请参考 <a href=\"http://hightopo.com/guide/guide/core/3d/ht-3d-guide.html#ref_text\">HT for Web 3D 手册</a>：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> ht.Default.loadFontFace('./wenquanyi.json', <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(){\n</span><span style=\"color: #008080\"> 2</span>     <span style=\"color: #008000\">//</span><span style=\"color: #008000\">......</span>\n<span style=\"color: #008080\"> 3</span>     <span style=\"color: #0000ff\">var</span> text = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> ht.Node();\n</span><span style=\"color: #008080\"> 4</span>     text.s3([5, 5, 5<span style=\"color: #000000\">]);\n</span><span style=\"color: #008080\"> 5</span>     text.p3(cNode.p3()[0]-5, -10, 0<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 6</span> <span style=\"color: #000000\">    dm.add(text);\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #000000\">    text.s({\n</span><span style=\"color: #008080\"> 8</span>         'shape3d' : 'text'<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 9</span>     'shape3d.text': node.a('myHeight')+'%'<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">10</span>     'shape3d.text.curveSegments': 1<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">11</span>     '3d.movable': <span style=\"color: #0000ff\">false</span>\n<span style=\"color: #008080\">12</span> <span style=\"color: #000000\">    });\n</span><span style=\"color: #008080\">13</span> });</pre>\n</div>\n<p>因为我们用的 typeface 字体的绘制方式是无数个三角形构成的一个字，会占用很大的内存，所以我把图形的曲线的精细度调得较低，但是还是很清晰，如果你们能找到性能更好的字体，可以使用并且告知我一下，我们目前没找到占用内存小的字体。</p>\n<p>最后，要动态的变化 chart 图表中的柱形图，我们得设置动画，并且将 3d 字体也同步更新数值：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> setInterval(<span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(){\n</span><span style=\"color: #008080\"> 2</span>     <span style=\"color: #0000ff\">if</span>(node.a('myHeight') &lt; 100<span style=\"color: #000000\">){\n</span><span style=\"color: #008080\"> 3</span>         node.a('myHeight', (node.getAttr('myHeight')+1<span style=\"color: #000000\">));\n</span><span style=\"color: #008080\"> 4</span>     node.s3(20, node.a('myHeight'), 20<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 5</span>     node.p3(p3[0], node.a('myHeight')/2, p3[2]);\n<span style=\"color: #008080\"> 6</span>     }<span style=\"color: #0000ff\">else</span><span style=\"color: #000000\">{\n</span><span style=\"color: #008080\"> 7</span>         node.a('myHeight', 0<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 8</span>     node.s3([20, 0, 20<span style=\"color: #000000\">]);\n</span><span style=\"color: #008080\"> 9</span>     node.p3([p3[0], 0, p3[2<span style=\"color: #000000\">]]);\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">11</span>     <span style=\"color: #0000ff\">if</span> (text) text.s('shape3d.text', node.a('myHeight')+'%'<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">12</span> }, 100);</pre>\n</div>\n<p>这里，我自定义的属性 “myHeight” 就起到了决定性的作用，我用这个属性来存储变量，而且可以任意更改变量的值，这样就能实现动态绑定的效果了。</p>\n<p>还有不懂的可以留言，或者直接去我们官网上查看手册 <a href=\"http://hightopo.com/\">HT for Web</a>，有更多你想不到的效果能快速实现哦~ </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t</div>\r\n\t\r\n\t<div class=\"postfoot\">\r\n\t\tposted on <span id=\"post-date\">2017-11-02 08:01</span> <a href=\"http://www.cnblogs.com/xhload3d/\">xhload3d</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7768021\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7768021);return false;\">收藏</a>\r\n\t</div>\r\n</div>\r\n<script type=\"text/javascript\">var allowComments=true,cb_blogId=171723,cb_entryId=7768021,cb_blogApp=currentBlogApp,cb_blogUserGuid='99a30dc7-3165-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/11/2 8:01:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\r\n</div>", "article_view": 461, "image_url": ["https://pic.cnblogs.com/face/591709/20140223000109.png"], "date_pub": "2017-11-02", "article_common": 4}
{"title": "[译]ASP.NET Core 2.0 路由引擎之网址生成", "url": "http://www.cnblogs.com/sanshi/p/7746089.html", "author": "三生石上(FineUI控件)", "article_desc": "问题 如何在ASP.NET Core 2.0中由路由引擎来生成网址？ 答案 新建一个空项目，修改Startup.cs文件，添加MVC服务和中间件： 添加一个MobileController控制器类： 讨论 我们可以使用MVC的路由机制来生成网址，而无需在应用程序中硬编码网址。MVC有这么做的所有信息 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/sanshi/p/7746089.html\">[译]ASP.NET Core 2.0 路由引擎之网址生成</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h2>问题</h2>\r\n<p>如何在ASP.NET Core 2.0中由路由引擎来生成网址？</p>\r\n<h2>答案</h2>\r\n<p>新建一个空项目，修改Startup.cs文件，添加MVC服务和中间件：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public void ConfigureServices(IServiceCollection services)\r\n{\r\n\tservices.AddMvc();\r\n}\r\n\r\npublic void Configure(IApplicationBuilder app, IHostingEnvironment env)\r\n{\r\n\tif (env.IsDevelopment())\r\n\t{\r\n\t\tapp.UseDeveloperExceptionPage();\r\n\t}\r\n\r\n\tapp.UseMvc(routes =&gt;\r\n\t{\r\n\t\troutes.MapRoute(\r\n\t\t\tname: \"goto_one\",\r\n\t\t\ttemplate: \"one\",\r\n\t\t\tdefaults: new { controller = \"Home\", action = \"PageOne\" });\r\n\r\n\t\troutes.MapRoute(\r\n\t\t\tname: \"goto_two\",\r\n\t\t\ttemplate: \"two/{id?}\",\r\n\t\t\tdefaults: new { controller = \"Home\", action = \"PageTwo\" });\r\n\r\n\t\troutes.MapRoute(\r\n\t\t\tname: \"default\",\r\n\t\t\ttemplate: \"{controller=Home}/{action=Index}/{id?}\");\r\n\t});\r\n}\r\n</pre>\r\n</div>\r\n<p>　　</p>\r\n<p>添加一个MobileController控制器类：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public class MobileController : Controller\r\n{\r\n\tpublic IActionResult Index()\r\n\t{\r\n\t\tvar url = Url.Action(\"Index\"); // /mobile\r\n\t\treturn Content($\"Mobile/Index (Url: {url})\");\r\n\t}\r\n\r\n\tpublic IActionResult PageOne()\r\n\t{\r\n\t\tvar url = Url.Action(\"PageOne\"); // /mobile/PageOne\r\n\t\treturn Content($\"Mobile/One (Url: {url})\");\r\n\t}\r\n\r\n\t[HttpGet]\r\n\tpublic IActionResult PageTwo()\r\n\t{\r\n\t\tvar url = Url.Action(\"PageTwo\"); // /mobile/PageTwo OR /mobile/PageTwo/1?\r\n\t\treturn Content($\"(GET) Mobile/Two (Url: {url})\");\r\n\t}\r\n\r\n\t[HttpPost]\r\n\tpublic IActionResult PageTwo(int id)\r\n\t{\r\n\t\tvar url = Url.Action(\"PageTwo\"); // /mobile/PageTwo/1\r\n\t\treturn Content($\"(POST) Mobile/Two: {id} (Url: {url})\");\r\n\t}\r\n\r\n\tpublic IActionResult PageThree()\r\n\t{\r\n\t\tvar url = Url.RouteUrl(\"goto_two\", new { id = 5 }); // /two/5\r\n\t\treturn Content($\"Mobile/Three (Url: {url})\");\r\n\t}\r\n\r\n\tpublic IActionResult PageFour()\r\n\t{\r\n\t\tvar url = Url.RouteUrl(\"goto_two\", new { q = 5 }); // /two?q=5\r\n\t\treturn Content($\"Mobile/Four (Url: {url})\");\r\n\t}\r\n\r\n\tpublic IActionResult PageFive()\r\n\t{\r\n\t\treturn RedirectToAction(\"PageSix\");\r\n\t}\r\n\r\n\tpublic IActionResult PageSix()\r\n\t{\r\n\t\treturn Content(\"Mobile/Six (Mobile/Five will also come here)\");\r\n\t}\r\n}</pre>\r\n</div>\r\n<h2>讨论</h2>\r\n<p>我们可以使用MVC的路由机制来生成网址，而无需在应用程序中硬编码网址。MVC有这么做的所有信息，来自于我们设置路由映射所提供的模板。</p>\r\n<p>MVC提供了IUrlHelper接口来提供生成网址的功能。这是通过在控制器基类，视图和试图组件公开Url属性来实现的。</p>\r\n<p>IUrlHelper接口提供两个关键的方法来生成网址：</p>\r\n<ol>\r\n<li>Action：通过提供控制器，方法和路由参数值来生成网址。</li>\r\n<li>RouteUrl： 通过提供路由映射名称和路由参数来生成网址。</li>\r\n</ol>\r\n<p>如果调用上述方法时未提供控制器和路由参数，那么MVC会从当前请求或者方法参数中获取（即是从当前上下文的环境变量中获取）。下面的方法存在于MobileController控制器中：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public IActionResult PageTwo(int id)\r\n{\r\n\tvar url = Url.Action(\"PageTwo\"); // /mobile/PageTwo/1\r\n\treturn Content($\"(POST) Mobile/Two: {id} (Url: {url})\");\r\n}　　</pre>\r\n</div>\r\n<p>路由参数可以作为匿名对象来提供：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public IActionResult PageThree()\r\n{\r\n\tvar url = Url.RouteUrl(\"goto_two\", new { id = 5 }); // /two/5\r\n\treturn Content($\"Mobile/Three (Url: {url})\");\r\n}\r\n</pre>\r\n</div>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/48817/201710/48817-20171028133506351-1133356940.png\" alt=\"\"></p>\r\n<p>如果MVC无法将这些值映射到地址标记，那么这些参数会作为网址的查询字符串拼接起来：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public IActionResult PageFour()\r\n{\r\n\tvar url = Url.RouteUrl(\"goto_two\", new { id=5, key1 = \"value1\" }); // /two/5?key1=value1\r\n\treturn Content($\"Mobile/Four (Url: {url})\");\r\n}\r\n</pre>\r\n</div>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/48817/201710/48817-20171028133804664-2100625643.png\" alt=\"\"></p>\r\n<p>ControlBase类上有一个很方便的方法RedirectToAction，用来将用户请求重定向到某个控制器方法中，这一过程是在客户端完成的：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public IActionResult PageFive()\r\n{\r\n\treturn RedirectToAction(\"PageSix\");\r\n}\r\n\r\npublic IActionResult PageSix()\r\n{\r\n\treturn Content(\"Mobile/Six (Mobile/Five will also come here)\");\r\n}\r\n</pre>\r\n</div>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/48817/201710/48817-20171028134049976-113480826.png\" alt=\"\">　　</p>\r\n<p>为了将IUrlHeper作为依赖项注入需要的类中，我们需要首先在ConfigureServices中配置相应的服务：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public void ConfigureServices(IServiceCollection services)\r\n{\r\n\tservices.AddSingleton&lt;IActionContextAccessor, ActionContextAccessor&gt;();\r\n\tservices.AddScoped&lt;IUrlHelper&gt;(factory =&gt;\r\n\t{\r\n\t\tvar actionContext = factory.GetService&lt;IActionContextAccessor&gt;().ActionContext;\r\n\t\treturn new UrlHelper(actionContext);\r\n\t});\r\n\r\n\tservices.AddMvc();\r\n}　　</pre>\r\n</div>\r\n<p>注：大部分情况下我们无需通过注入来使用IUrlHelper，因为控制器，视图中都已经公开了Url属性供我们使用。</p>\r\n<p> </p>\r\n<h2><a href=\"https://files.cnblogs.com/files/sanshi/RoutingUrlGeneration.zip\" target=\"_blank\">源代码下载</a></h2>\r\n<p> </p>\r\n<p>原文：<a href=\"https://tahirnaushad.com/2017/08/20/asp-net-core-mvc-routing/\" target=\"_blank\">https://tahirnaushad.com/2017/08/20/asp-net-core-mvc-routing/</a></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 08:43</span> <a href=\"http://www.cnblogs.com/sanshi/\">三生石上(FineUI控件)</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7746089\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7746089);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=52411,cb_entryId=7746089,cb_blogApp=currentBlogApp,cb_blogUserGuid='289f0a2c-88f9-dd11-9e4d-001cf0cd104b',cb_entryCreatedDate='2017/11/2 8:43:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 291, "image_url": ["https://pic.cnblogs.com/face/48817/20151109122200.png"], "date_pub": "2017-11-02", "article_common": 2}
{"title": "java基础解析系列(十)---ArrayList和LinkedList源码及使用分析", "url": "http://www.cnblogs.com/-new/p/7768407.html", "author": "jiajun_geek", "article_desc": "java基础解析系列(十) ArrayList和LinkedList源码及使用分析 目录 \"java基础解析系列(一) String、StringBuffer、StringBuilder\" \"java基础解析系列(二) Integer缓存及装箱拆箱\" \"java基础解析系列(三) HashMap原理 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/-new/p/7768407.html\">java基础解析系列(十)---ArrayList和LinkedList源码及使用分析</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"java基础解析系列十---arraylist和linkedlist源码及使用分析\">java基础解析系列(十)---ArrayList和LinkedList源码及使用分析</h1>\n<h2 id=\"目录\">目录</h2>\n<ul>\n<li><a href=\"http://www.cnblogs.com/-new/p/7417915.html\">java基础解析系列(一)---String、StringBuffer、StringBuilder</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7469763.html\">java基础解析系列(二)---Integer缓存及装箱拆箱</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7472455.html\">java基础解析系列(三)---HashMap原理</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7484680.html\">java基础解析系列(四)---LinkedHashMap的原理及LRU算法的实现</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7496323.html\">java基础解析系列(五)---HashMap并发下的问题以及HashTable和CurrentHashMap的区别</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7588250.html\">java基础解析系列(六)---注解原理及使用</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7604420.html\">java基础解析系列(七)---ThreadLocal原理分析</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7638302.html\">java基础解析系列(八)--fail-fast机制及CopyOnWriteArrayList的原理</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7396648.html\">这是我的博客目录，欢迎阅读</a></li>\n</ul>\n<h1 id=\"arraylist\">ArrayList</h1>\n<h2 id=\"成员变量\">成员变量</h2>\n<ul>\n<li>数组元素</li>\n</ul>\n<pre><code>111     private transient Object[] elementData;</code></pre>\n<ul>\n<li>数组中元素的个数</li>\n</ul>\n<pre><code>118     private int size;</code></pre>\n<h2 id=\"构造方法\">构造方法</h2>\n<ul>\n<li>初始化容量为10</li>\n</ul>\n<pre><code>Constructs an empty list with an initial capacity of ten.\n137 \n138     public ArrayList() {\n139         this(10);\n140     }</code></pre>\n<ul>\n<li>可以设置初始容量</li>\n</ul>\n<pre><code>127     public ArrayList(int initialCapacity) {\n128         super();\n129         if (initialCapacity &lt; 0)\n130             throw new IllegalArgumentException(\"Illegal Capacity: \"+\n131                                                initialCapacity);\n132         this.elementData = new Object[initialCapacity];\n133     }</code></pre>\n<h2 id=\"ensurecapacity方法\">ensureCapacity方法</h2>\n<pre><code>178     public void ensureCapacity(int minCapacity) {\n179         modCount++;\n180         int oldCapacity = elementData.length;\n181         if (minCapacity &gt; oldCapacity) {\n182             Object oldData[] = elementData;\n183             int newCapacity = (oldCapacity * 3)/2 + 1;\n184             if (newCapacity &lt; minCapacity)\n185                 newCapacity = minCapacity;\n186             // minCapacity is usually close to size, so this is a win:\n187             elementData = Arrays.copyOf(elementData, newCapacity);\n188         }\n189     }</code></pre>\n<ul>\n<li>181行，判断minCapacoty是否大于elementData数组的长度</li>\n<li>如果181结果为true，183行设置新的容量为旧的容量*3/2+1</li>\n<li>187行进行扩容，创建一个新容量的数组，然后将旧的数组元素复制到新数组中</li>\n</ul>\n<h2 id=\"顺序add方法\">顺序add方法</h2>\n<pre><code>377     public boolean add(E e) {\n378         ensureCapacity(size + 1);  // Increments modCount!!\n379         elementData[size++] = e;\n380         return true;\n381     }</code></pre>\n<ul>\n<li>378行执行ensureCapacity方法，看插入一个元素后是否需要扩容</li>\n<li>379行，将待添加元素放置到下标size的位置,size+1</li>\n</ul>\n<h2 id=\"指定index的add方法\">指定index的add方法</h2>\n<pre><code>392     public void add(int index, E element) {\n393         rangeCheckForAdd(index);\n394 \n395         ensureCapacity(size+1);  // Increments modCount!!\n396         System.arraycopy(elementData, index, elementData, index + 1,\n397                          size - index);\n398         elementData[index] = element;\n399         size++;\n400     }</code></pre>\n<ul>\n<li>393执行rangeCheckForAdd方法</li>\n</ul>\n<pre><code>577     private void rangeCheckForAdd(int index) {\n578         if (index &gt; size || index &lt; 0)\n579             throw new IndexOutOfBoundsException(outOfBoundsMsg(index));\n580     }</code></pre>\n<ul>\n<li>rangeCheckForAdd方法判断index是否超出范围或者小于0</li>\n<li>395执行ensureCapacity方法看是否需要扩容</li>\n<li>396行将index开始的元素全部往后移动一位</li>\n<li>然后设置index位置的元素为插入元素</li>\n</ul>\n<h2 id=\"remove方法\">remove方法</h2>\n<pre><code>411     public E remove(int index) {\n412         rangeCheck(index);\n413 \n414         modCount++;\n415         E oldValue = elementData(index);\n416 \n417         int numMoved = size - index - 1;\n418         if (numMoved &gt; 0)\n419             System.arraycopy(elementData, index+1, elementData, index,\n420                              numMoved);\n421         elementData[--size] = null; // Let gc do its work\n422 \n423         return oldValue;\n424     }</code></pre>\n<ul>\n<li>412行rangeCheck看传入的index是否在范围之内</li>\n</ul>\n<pre><code>569     private void rangeCheck(int index) {\n570         if (index &gt;= size)\n571             throw new IndexOutOfBoundsException(outOfBoundsMsg(index));\n572     }</code></pre>\n<ul>\n<li>415通过下标获得该元素</li>\n<li>419行进行数组的移动，elementData数组中位置在 index+1 到 index+numMoved-1 之间的组件被分别复制到elementData数组中的 index 到 index+numMoved-1 位置。</li>\n<li>把index后面的元素向前移动一位后，将size-1的位置设置为null，方便gc</li>\n</ul>\n<h2 id=\"get方法\">get方法</h2>\n<pre><code>348     public E get(int index) {\n349         rangeCheck(index);\n350 \n351         return elementData(index);\n352     }</code></pre>\n<ul>\n<li>349行查找index是否超出范围</li>\n<li>351直接通过坐标从数组中返回</li>\n</ul>\n<h1 id=\"linkedlist\">LinkedList</h1>\n<h2 id=\"成员变量-1\">成员变量</h2>\n<pre><code>95     private transient Entry&lt;E&gt; header = new Entry&lt;E&gt;(null, null, null);\n96     private transient int size = 0;</code></pre>\n<ul>\n<li>95行head为一个头结点</li>\n<li>size为链表大小</li>\n</ul>\n<h2 id=\"构造方法-1\">构造方法</h2>\n<pre><code>101    public LinkedList() {\n102        header.next = header.previous = header;\n103    }\n</code></pre>\n<ul>\n<li>102行将header的前节点和后节点设置为header本身,从这里也可以看出这是一个双向链表</li>\n</ul>\n<h2 id=\"add方法\">add方法</h2>\n<pre><code>214    public boolean add(E e) {\n215        addBefore(e, header);\n216        return true;\n217    }</code></pre>\n<ul>\n<li>215行执行addBefore方法</li>\n</ul>\n<pre><code>794    private Entry&lt;E&gt; addBefore(E e, Entry&lt;E&gt; entry) {\n795        Entry&lt;E&gt; newEntry = new Entry&lt;E&gt;(e, entry, entry.previous);\n796        newEntry.previous.next = newEntry;\n797        newEntry.next.previous = newEntry;\n798        size++;\n799        modCount++;\n800        return newEntry;\n801    }</code></pre>\n<ul>\n<li>795行创建一个新的节点</li>\n<li>796行和797行修改节点的指针，将新节点放入链表</li>\n</ul>\n<h2 id=\"get方法-1\">get方法</h2>\n<pre><code>331    public E get(int index) {\n332        return entry(index).element;\n333    }\n</code></pre>\n<ul>\n<li>执行entry方法</li>\n</ul>\n<pre><code>380    private Entry&lt;E&gt; entry(int index) {\n381        if (index &lt; 0 || index &gt;= size)\n382            throw new IndexOutOfBoundsException(\"Index: \"+index+\n383                                                \", Size: \"+size);\n384        Entry&lt;E&gt; e = header;\n385        if (index &lt; (size &gt;&gt; 1)) {\n386            for (int i = 0; i &lt;= index; i++)\n387                e = e.next;\n388        } else {\n389            for (int i = size; i &gt; index; i--)\n390                e = e.previous;\n391        }\n392        return e;\n393    }</code></pre>\n<ul>\n<li>从这个方法可以看出并不是就是从前往后一个一个寻找，而是先将size&gt;&gt;1也就是将size除以2，看此时要查看的下标是小于还是大于这个数，如果小于这个数，说明位于链表中点的前面，用next指针寻找，正向寻找，反之用previous指针来寻找，这样可以减少遍历的次数</li>\n<li>不过不能像ArrayList通过index直接定位，还是要一个一个寻找</li>\n</ul>\n<h2 id=\"remove方法-1\">remove方法</h2>\n<pre><code>232    public boolean remove(Object o) {\n233        if (o==null) {\n234            for (Entry&lt;E&gt; e = header.next; e != header; e = e.next) {\n235                if (e.element==null) {\n236                    remove(e);\n237                    return true;\n238                }\n239            }\n240        } else {\n241            for (Entry&lt;E&gt; e = header.next; e != header; e = e.next) {\n242                if (o.equals(e.element)) {\n243                    remove(e);\n244                    return true;\n245                }\n246            }\n247        }\n248        return false;\n249    }</code></pre>\n<ul>\n<li>可以看到，从前往后遍历，找到Object o后执行remove方法</li>\n</ul>\n<pre><code>803    private E remove(Entry&lt;E&gt; e) {\n804        if (e == header)\n805            throw new NoSuchElementException();\n806\n807        E result = e.element;\n808        e.previous.next = e.next;\n809        e.next.previous = e.previous;\n810        e.next = e.previous = null;\n811        e.element = null;\n812        size--;\n813        modCount++;\n814        return result;\n815    }</code></pre>\n<ul>\n<li>删除这个节点后，重新调整链表</li>\n</ul>\n<h1 id=\"总结与对比\">总结与对比</h1>\n<ul>\n<li>效率方面，这两个集合对应数据结构中的两个线性表，一个数组一个链表，数组可以通过下标可以快速定位元素，所以自然查找和修改效率高。链表不能快速定位元素，只能一个一个找，所以自然查找效率没有数组快，而链表的优势在于他能快速插入快速删除因为只需修改一下节点的指针就可以，不需要像ArrayList移动元素。</li>\n<li>容量方面，因为数组是有容量的，所以当容量不足的时候，需要扩容，扩容后就以为者需要进行一次复制，所以如果使用ArrayList的时候，要初始化一个合适的容量，避免扩容的开销。而链表就没有大小限制，插入一个元素，只要插入一个节点就行了</li>\n<li>编程世界里面，同一个问题会有很多的方案，有优点也会一定会有缺点，只是在哪种场景下，优点大于缺点罢了</li>\n</ul>\n<h3 id=\"我觉得分享是一种精神分享是我的乐趣所在不是说我觉得我讲得一定是对的我讲得可能很多是不对的但是我希望我讲的东西是我人生的体验和思考是给很多人反思也许给你一秒钟半秒钟哪怕说一句话有点道理引发自己内心的感触这就是我最大的价值这是我喜欢的一句话也是我写博客的初衷\">我觉得分享是一种精神，分享是我的乐趣所在，不是说我觉得我讲得一定是对的，我讲得可能很多是不对的，但是我希望我讲的东西是我人生的体验和思考，是给很多人反思，也许给你一秒钟、半秒钟，哪怕说一句话有点道理，引发自己内心的感触，这就是我最大的价值。（这是我喜欢的一句话，也是我写博客的初衷）</h3>\n<blockquote>\n<p>作者：jiajun 出处： <a href=\"http://www.cnblogs.com/-new/\" class=\"uri\">http://www.cnblogs.com/-new/</a><br>\n本文版权归作者和博客园共有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。如果觉得还有帮助的话，可以点一下右下角的【推荐】，希望能够持续的为大家带来好的技术文章！想跟我一起进步么？那就【关注】我吧。</p>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 08:53</span> <a href=\"http://www.cnblogs.com/-new/\">jiajun_geek</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7768407\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7768407);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=269387,cb_entryId=7768407,cb_blogApp=currentBlogApp,cb_blogUserGuid='334d29a8-70df-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/2 8:53:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 217, "image_url": ["https://pic.cnblogs.com/face/900751/20161023114041.png"], "date_pub": "2017-11-02", "article_common": 1}
{"title": "前端设计师必收的5款免费响应式布局测试工具", "url": "http://www.cnblogs.com/zhengqiaoyin/p/7770590.html", "author": "zhengqiaoyin", "article_desc": "\r\n    我在给客户做网站的过程中，不少客户都会要求做响应式设计，响应式的网站也越来越多。但是响应式的网站在具体操作过程中，会有很多问题被忽略，所以我一般会使用一些响应式设计工具来测试这些站点是否正常显示。 上次给大家分享过我的个人收藏夹的一些工具，今天跟大家再分享我个人觉得好用的五款响应式网页测试工具，重点 ...\r\n    ", "content": "<div id=\"post_detail\">\r\n\t<div class=\"post\">\r\n\t\t<h2>\r\n\t\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/zhengqiaoyin/p/7770590.html\">前端设计师必收的5款免费响应式布局测试工具</a>\r\n\t\t</h2>\r\n\t\t<div class=\"postbody\">\r\n\t\t<div id=\"cnblogs_post_body\"><p><span style=\"color: #333333\">我在给客户做网站的过程中，不少客户都会要求做响应式设计，响应式的网站也越来越多。但是响应式的网站在具体操作过程中，会有很多问题被忽略，所以我一般会使用一些响应式设计工具来测试这些站点是否正常显示。</span><br>\n<span style=\"color: #333333\">上次给大家分享过我的个人收藏夹的一些工具，今天跟大家再分享我个人觉得好用的五款响应式网页测试工具，重点都是免费免费！</span><br>\n</p>\n<h4><span style=\"color: #333333\"><a href=\"http://responsivedesignchecker.com/#1Q2JnB5r8OuKFN\" target=\"_blank\"><span style=\"color: #003399\"><strong>Responsive Design Checker</strong></span></a></span></h4>\n<p>\n<span style=\"color: #333333\">这个网站适合自定义屏幕尺寸的响应式设计检查工具。直接在搜索栏输入你要查询的站点URL，侧边栏有很多尺寸高度可用于检测，也可以在顶部自定义屏幕尺寸来进行站点检测。</span><br>\n<span style=\"color: #333333\">在侧边栏中，您可以找到大量预定义的屏幕尺寸，例如Nexus平板电脑，Kindles等甚至像Google Pixel这样的新手机。</span><br>\n<span style=\"color: #333333\">该网站还支持大屏幕尺寸，桌面显示器  达24“宽。令人惊讶的是，即使在小型显示器上，这些大尺寸也能很好地工作，因为预览窗格根据比例而不是总像素宽度进行调整。</span><br>\n<span style=\"color: #333333\">因此，如果您在较小的MacBook屏幕上测试1920px的显示器，此工具非常值得收藏。</span><br>\n<img src=\"http://blog.cnezsoft.com/file-read-4509.jpg\" alt=\"\"><br>\n</p>\n<h4><span style=\"color: #333333\"><a href=\"https://www.responsinator.com/#1Q2JnB5r8OuKFN\" target=\"_blank\"><span style=\"color: #003399\"><strong>Responsinator</strong></span></a></span></h4>\n<p>\n<span style=\"color: #333333\">这个测试工具很酷，HTTP和HTTPS站点的切换比较自如，它会提供给设计师两者类型的预览网站效果，这个跟HTTP和HTTPS相关。它会自动匹配您预览的任何网站，以避免SSL错误。</span><br>\n<span style=\"color: #333333\">这个网站工具直接给你按照每个设备大小的屏幕给你展示测试站点的响应式效果，你可以直接在各个像素大小的设备上去预览所做的网站效果。</span><br>\n<span style=\"color: #333333\">可查看的设备包括最常见的iPhone和Android Nexus设备，包括纵向和横向预览。您还可以在纵向和横向找到iPad设备预览。总的来说比较全面的。</span><br>\n<img src=\"http://blog.cnezsoft.com/file-read-4510.jpg\" alt=\"\"><br>\n</p>\n<h4><span style=\"color: #333333\"><a href=\"https://designmodo.com/responsive-test/#1Q2JnB5r8OuKFN\" target=\"_blank\"><strong><span style=\"color: #003399\">Designmodo Responsive Test</span></strong></a></span></h4>\n<p>\n<span style=\"color: #333333\">这个工具是我个人比较喜欢的，也是个免费的测试工具。这个工具有个特点就是你可以随意的拖动预览窗口的大小，以测试各个平面尺寸下的实际效果。它也支持手动输入尺寸来预览实际的效果。</span><br>\n<span style=\"color: #333333\">同时，右上角的每个设备图标可以让您从数十种常用屏幕尺寸中进行选择，从而使此工具非常适合检查您可以想象的任何设备。</span><br>\n<img src=\"http://blog.cnezsoft.com/file-read-4511.jpg\" alt=\"\"><br>\n</p>\n<h4><span style=\"color: #333333\"><a href=\"http://mattkersley.com/responsive/#1Q2JnB5r8OuKFN\" target=\"_blank\"><strong><span style=\"color: #003399\">Matt Kersley’s Responsive Tool</span></strong></a></span></h4>\n<p>\n<span style=\"color: #333333\">这个免费的测试工具， 主要用于响应式布局。界面比较简单，也没有过多装饰，但真的是好用。</span><br>\n<span style=\"color: #333333\">这个工具设定了5个固定宽度供预览：240像素，320像素，480像素，768像素，1024像素。</span><br>\n<span style=\"color: #333333\">每个尺寸下的预览窗口都有各个像素设备下的滚动条，可以轻松移动内容。但这个有个缺点吧，就是无法单击任何链接或浏览窗格中的其他页面，因此这最适用于测试单个页面。</span><br>\n<span style=\"color: #333333\">因为使用比较简单，可操作性也比较高，所以还是值得推荐的。</span><br>\n<img src=\"http://blog.cnezsoft.com/file-read-4512.jpg\" alt=\"\"><br>\n</p>\n<h4><span style=\"color: #333333\"><a href=\"http://app.xrespond.com/#1Q2JnB5r8OuKFN\" target=\"_blank\"><span style=\"color: #003399\"><strong>XRESPOND</strong></span></a></span></h4>\n<p>\n<span style=\"color: #333333\">这个工具的实用性极高，通过这个站点，输入要测试的官网连接，便可以预览到各个设备上的网站效果。但是这个需要横向去拉滚动条才能看到后面一些大尺寸的屏幕格式。</span><br>\n<span style=\"color: #333333\">每个屏幕上方的标签会告诉您确切的大小和与之匹配的设备。也可以从下拉菜单中还可以选择各种智能手机，平板电脑和笔记本电脑来测试特定的设备。</span><br>\n<span style=\"color: #333333\">除此，还可以单独修改自定义宽度/高度的设置，来查看网站在特定尺寸显示器上的显示方式。</span><br>\n<img src=\"http://blog.cnezsoft.com/file-read-4513.jpg\" alt=\"\"><br>\n</p>\n<p><span style=\"color: #333333\">推荐这五款工具是因为操作起来比较简单，最重要的是他们支持多设备尺寸，因此我们在具体使用过程中可以清晰的看到布局在各个屏幕设备下的不同效果。</span></p>\n<p style=\"text-align: left\">以上这些内容就是本次的分享，希望对大家的学习有所帮助，工具不在数量多，但一定要多用，希望这些工具都能给到大家的实质性的帮助，而不是变成收藏夹里的一个条目。</p>\n<p><br>\n</p>\n<div><span style=\"color: #333333\"><br>\n</span></div>\n<p><img style=\"width: 1px !important; height: 1px !important; border: none !important\" src=\"http://blog.cnezsoft.com/1Q2JfB5q8OvKFN.gif\" alt=\"\"></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<p class=\"postfoot\">\r\n\t\t\tposted on <span id=\"post-date\">2017-11-02 08:56</span> <a href=\"http://www.cnblogs.com/zhengqiaoyin/\">zhengqiaoyin</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7770590\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7770590);return false;\">收藏</a>\r\n\t\t</p>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=385053,cb_entryId=7770590,cb_blogApp=currentBlogApp,cb_blogUserGuid='e8d7a79d-60de-44a6-f603-08d4ef52ecb5',cb_entryCreatedDate='2017/11/2 8:56:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n\t</div>", "article_view": 624, "image_url": ["https:"], "date_pub": "2017-11-02", "article_common": 2}
{"title": "从架构演进的角度聊聊Spring Cloud都做了些什么？", "url": "http://www.cnblogs.com/ityouknow/p/7770593.html", "author": "纯洁的微笑", "article_desc": "Spring Cloud作为一套微服务治理的框架，几乎考虑到了微服务治理的方方面面，之前也写过一些关于Spring Cloud文章，主要偏重各组件的使用，本次分享主要解答这两个问题：Spring Cloud在微服务的架构中都做了哪些事情？Spring Cloud提供的这些功能对微服务的架构提供了怎样 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/ityouknow/p/7770593.html\">从架构演进的角度聊聊Spring Cloud都做了些什么？</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>Spring Cloud作为一套微服务治理的框架，几乎考虑到了微服务治理的方方面面，之前也写过一些关于Spring Cloud文章，主要偏重各组件的使用，本次分享主要解答这两个问题：Spring Cloud在微服务的架构中都做了哪些事情？Spring Cloud提供的这些功能对微服务的架构提供了怎样的便利？</p>\n<p>这也是我写Spring Cloud三部曲的最后一篇文章，前两面篇内容如下：</p>\n<ul>\n<li><p><a href=\"http://mp.weixin.qq.com/s/bciSlKearaVFQg1QWOSn_g\">中小型互联网公司微服务实践-经验和教训</a></p></li>\n<li><p><a href=\"https://mp.weixin.qq.com/s/vnWXpH5pv-FAzLZfbgTGvg\">Spring Cloud在国内中小型公司能用起来吗？</a></p></li>\n</ul>\n<p>我们先来简单回顾一下，我们以往互联网架构的发展情况：<br>\n<br></p>\n<h2 id=\"传统架构发展史\">传统架构发展史</h2>\n<h3 id=\"单体架构\">单体架构</h3>\n<p>单体架构在小微企业比较常见，典型代表就是一个应用、一个数据库、一个web容器就可以跑起来，比如我们开发的开源软件<a href=\"https://github.com/cloudfavorites/favorites-web\">云收藏</a>，就是标准的单体架构。</p>\n<p>在两种情况下可能会选择单体架构：一是在企业发展的初期，为了保证快速上线，采用此种方案较为简单灵活；二是传统企业中垂直度较高，访问压力较小的业务。在这种模式下对技术要求较低，方便各层次开发人员接手，也能满足客户需求。</p>\n<p>下面是单体架构的架构图：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/chat/single_structure.jpg\"></p>\n<p>在单体架构中，技术选型非常灵活，优先满足快速上线的要求，也便于快速跟进市场。<br>\n<br></p>\n<h3 id=\"垂直架构\">垂直架构</h3>\n<p>在单体架构发展一段时间后，公司的业务模式得到了认可，交易量也慢慢的大起来，这时候有些企业为了应对更大的流量，就会对原有的业务进行拆分，比如说：后台系统、前端系统、交易系统等。</p>\n<p>在这一阶段往往会将系统分为不同的层级，每个层级有对应的职责，UI层负责和用户进行交互、业务逻辑层负责具体的业务功能、数据库层负责和上层进行数据交换和存储。</p>\n<p>下面是垂直架构的架构图：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/chat/vertical__structure.jpg\"></p>\n<p>在这个阶段SSH（struts+spring+hibernate）是项目的关键技术，Struts负责web层逻辑控制、Spring负责业务层管理Bean、Hibernate负责数据库操作进行封装，持久化数据。</p>\n<p><br></p>\n<h3 id=\"服务化架构\">服务化架构</h3>\n<p>如果公司进一步的做大，垂直子系统会变的越来越多，系统和系统之间的调用关系呈指数上升的趋势。在这样的背景下，很多公司都会考虑服务的SOA化。SOA代表面向服务的架构，将应用程序根据不同的职责划分为不同的模块，不同的模块直接通过特定的协议和接口进行交互。这样使整个系统切分成很多单个组件服务来完成请求，当流量过大时通过水平扩展相应的组件来支撑，所有的组件通过交互来满足整体的业务需求。</p>\n<p>SOA服务化的优点是，它可以根据需求通过网络对松散耦合的粗粒度应用组件进行分布式部署、组合和使用。服务层是SOA的基础，可以直接被应用调用，从而有效控制系统中与软件代理交互的人为依赖性。</p>\n<p>服务化架构是一套松耦合的架构，服务的拆分原则是服务内部高内聚，服务之间低耦合。</p>\n<p>下面是服务化架构图：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/chat/soa__structure.jpg\"></p>\n<p>在这个阶段可以使用WebService或者dubbo来服务治理。</p>\n<p>我们发现从单体架构到服务化架构，应用数量都在不断的增加，慢慢的下沉的就成了基础组建，上浮的就成为业务系统。从上述也可以看出架构的本质就是不断的拆分重构：分的过程是把系统拆分为各个子系统/模块/组件，拆的时候，首先要解决每个组件的定位问题，然后才能划分彼此的边界，实现合理的拆分。合就是根据最终要求，把各个分离的组件有机整合在一起。拆分的结果使开发人员能够做到业务聚焦、技能聚焦，实现开发敏捷，合的结果是系统变得柔性，可以因需而变，实现业务敏捷。<br>\n<br></p>\n<h2 id=\"soa和微服务架构\">SOA和微服务架构</h2>\n<h3 id=\"soa和微服务的区别\">SOA和微服务的区别</h3>\n<p>其实服务化架构已经可以解决大部分企业的需求了，那么我们为什么要研究微服务呢？先说说它们的区别；</p>\n<ul>\n<li>微服务架构强调业务系统需要彻底的组件化和服务化，一个组件就是一个产品，可以独立对外提供服务<br>\n</li>\n<li>微服务不再强调传统SOA架构里面比较重的ESB企业服务总线<br>\n</li>\n<li>微服务强调每个微服务都有自己独立的运行空间，包括数据库资源。<br>\n</li>\n<li>微服务架构本身来源于互联网的思路，因此组件对外发布的服务强调了采用HTTP Rest API的方式来进行<br>\n</li>\n<li>微服务的切分粒度会更小</li>\n</ul>\n<blockquote>\n<p>总结:微服务架构是 SOA 架构思想的一种扩展，更加强调服务个体的独立性、拆分粒度更小。</p>\n</blockquote>\n<p><br></p>\n<h3 id=\"为什么考虑spring-cloud\">为什么考虑Spring Cloud</h3>\n<ul>\n<li>Spring Cloud来源于Spring，质量、稳定性、持续性都可以得到保证<br>\n</li>\n<li>Spirng Cloud天然支持Spring Boot，更加便于业务落地。<br>\n</li>\n<li>Spring Cloud发展非常的快，从16年开始接触的时候相关组件版本为1.x，到现在将要发布2.x系列<br>\n</li>\n<li>Spring Cloud是Java领域最适合做微服务的框架。<br>\n</li>\n<li>相比于其它框架,Spring Cloud对微服务周边环境的支持力度最大。<br>\n</li>\n<li>对于中小企业来讲，使用门槛较低。</li>\n</ul>\n<blockquote>\n<p>Spring Cloud　是微服务架构的最佳落地方案<br>\n<br></p>\n</blockquote>\n<h3 id=\"它的特性\">它的特性</h3>\n<p>以下为Spring Cloud的核心特性：</p>\n<ul>\n<li>分布式/版本化配置</li>\n<li>服务注册和发现</li>\n<li>路由</li>\n<li>服务和服务之间的调用</li>\n<li>负载均衡</li>\n<li>断路器</li>\n<li>分布式消息传递</li>\n</ul>\n<p>这些特性都是由不同的组件来完成，在架构的演进过程中扮演着重要的角色，接下来我们一起看看。<br>\n<br><br></p>\n<h2 id=\"微服务架构\">微服务架构</h2>\n<p>Spring Cloud解决的第一个问题就是：服务与服务之间的解耦。很多公司在业务高速发展的时候，服务组件也会相应的不断增加。服务和服务之间有着复杂的相互调用关系，经常有服务A调用服务B，服务B调用服务C和服务D ...，随着服务化组件的不断增多，服务之间的调用关系成指数级别的增长，极端情况下就如下图所示：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/architecture/calling_relation.png\"></p>\n<p>这样最容易导致的情况就是牵一发而动全身。经常出现由于某个服务更新而没有通知到其它服务，导致上线后惨案频发。这时候就应该进行服务治理，将服务之间的直接依赖转化为服务对服务中心的依赖。Spring Cloud 核心组件Eureka就是解决这类问题。<br>\n<br></p>\n<h3 id=\"eureka\">Eureka</h3>\n<p>Eureka是Netflix开源的一款提供服务注册和发现的产品，它提供了完整的Service Registry和Service Discovery实现。也是Spring Cloud体系中最重要最核心的组件之一。</p>\n<p>用大白话讲，Eureka就是一个服务中心，将所有的可以提供的服务都注册到它这里来管理，其它各调用者需要的时候去注册中心获取，然后再进行调用，避免了服务之间的直接调用，方便后续的水平扩展、故障转移等。如下图：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/architecture/eureka.jpg\"></p>\n<p>当然服务中心这么重要的组件一但挂掉将会影响全部服务，因此需要搭建Eureka集群来保持高可用性，生产中建议最少两台。随着系统的流量不断增加，需要根据情况来扩展某个服务，Eureka内部已经提供均衡负载的功能，只需要增加相应的服务端实例既可。那么在系统的运行期间某个实例挂了怎么办？Eureka内容有一个心跳检测机制，如果某个实例在规定的时间内没有进行通讯则会自动被剔除掉，避免了某个实例挂掉而影响服务。</p>\n<p>因此使用了Eureka就自动具有了注册中心、负载均衡、故障转移的功能。如果想对Eureka进一步了解可以参考这篇文章：<a href=\"http://www.ityouknow.com/springcloud/2017/05/10/springcloud-eureka.html\">注册中心Eureka</a><br>\n<br></p>\n<h3 id=\"hystrix\">Hystrix</h3>\n<p>在微服务架构中通常会有多个服务层调用，基础服务的故障可能会导致级联故障，进而造成整个系统不可用的情况，这种现象被称为服务雪崩效应。服务雪崩效应是一种因“服务提供者”的不可用导致“服务消费者”的不可用,并将不可用逐渐放大的过程。</p>\n<p>如下图所示：A作为服务提供者，B为A的服务消费者，C和D是B的服务消费者。A不可用引起了B的不可用，并将不可用像滚雪球一样放大到C和D时，雪崩效应就形成了。</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/springcloud/hystrix-1.png\"></p>\n<p>在这种情况下就需要整个服务机构具有故障隔离的功能，避免某一个服务挂掉影响全局。在Spring Cloud 中Hystrix组件就扮演这个角色。</p>\n<p>Hystrix会在某个服务连续调用N次不响应的情况下，立即通知调用端调用失败，避免调用端持续等待而影响了整体服务。Hystrix间隔时间会再次检查此服务，如果服务恢复将继续提供服务。</p>\n<p>继续了解Hystrix可以参考：<a href=\"http://www.ityouknow.com/springcloud/2017/05/10/springcloud-eureka.html\">熔断器Hystrix</a><br>\n<br></p>\n<h3 id=\"hystrix-dashboard和turbine\">Hystrix Dashboard和Turbine</h3>\n<p>当熔断发生的时候需要迅速的响应来解决问题，避免故障进一步扩散，那么对熔断的监控就变得非常重要。熔断的监控现在有两款工具：Hystrix-dashboard和Turbine</p>\n<p>Hystrix-dashboard是一款针对Hystrix进行实时监控的工具，通过Hystrix Dashboard我们可以直观地看到各Hystrix Command的请求响应时间, 请求成功率等数据。但是只使用Hystrix Dashboard的话, 你只能看到单个应用内的服务信息, 这明显不够. 我们需要一个工具能让我们汇总系统内多个服务的数据并显示到Hystrix Dashboard上, 这个工具就是Turbine.<br>\n监控的效果图如下：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/springcloud/turbine-02.jpg\"></p>\n<p>想了解具体都监控了哪些指标，以及如何监控可以参考这篇文章：<a href=\"http://www.ityouknow.com/springcloud/2017/05/18/hystrix-dashboard-turbine.html\">熔断监控Hystrix Dashboard和Turbine</a><br>\n<br></p>\n<h3 id=\"配置中心\">配置中心</h3>\n<p>随着微服务不断的增多，每个微服务都有自己对应的配置文件。在研发过程中有测试环境、UAT环境、生产环境，因此每个微服务又对应至少三个不同环境的配置文件。这么多的配置文件，如果需要修改某个公共服务的配置信息，如：缓存、数据库等，难免会产生混乱，这个时候就需要引入Spring Cloud另外一个组件：Spring Cloud Config。<br>\n<br></p>\n<h4 id=\"spring-cloud-config\">Spring Cloud Config</h4>\n<p>Spring Cloud Config是一个解决分布式系统的配置管理方案。它包含了Client和Server两个部分，Server提供配置文件的存储、以接口的形式将配置文件的内容提供出去，Client通过接口获取数据、并依据此数据初始化自己的应用。</p>\n<p>其实就是Server端将所有的配置文件服务化，需要配置文件的服务实例去Config Server获取对应的数据。将所有的配置文件统一整理，避免了配置文件碎片化。配置中心git实例参考：<a href=\"http://www.ityouknow.com/springcloud/2017/05/22/springcloud-config-git.html\">配置中心git示例</a>；</p>\n<p>如果服务运行期间改变配置文件，服务是不会得到最新的配置信息，需要解决这个问题就需要引入Refresh。可以在服务的运行期间重新加载配置文件，具体可以参考这篇文章：<a href=\"http://www.ityouknow.com/springcloud/2017/05/23/springcloud-config-svn-refresh.html\">配置中心svn示例和refresh</a></p>\n<p>当所有的配置文件都存储在配置中心的时候，配置中心就成为了一个非常重要的组件。如果配置中心出现问题将会导致灾难性的后果，因此在生产中建议对配置中心做集群，来支持配置中心高可用性。具体参考：<a href=\"http://www.ityouknow.com/springcloud/2017/05/25/springcloud-config-eureka.html\">配置中心服务化和高可用</a><br>\n<br></p>\n<h4 id=\"spring-cloud-bus\">Spring Cloud Bus</h4>\n<p>上面的Refresh方案虽然可以解决单个微服务运行期间重载配置信息的问题，但是在真正的实践生产中，可能会有N多的服务需要更新配置，如果每次依靠手动Refresh将是一个巨大的工作量，这时候Spring Cloud提出了另外一个解决方案：Spring Cloud Bus</p>\n<p>Spring Cloud Bus通过轻量消息代理连接各个分布的节点。这会用在广播状态的变化（例如配置变化）或者其它的消息指令中。Spring Cloud Bus的一个核心思想是通过分布式的启动器对Spring Boot应用进行扩展，也可以用来建立一个或多个应用之间的通信频道。目前唯一实现的方式是用AMQP消息代理作为通道。</p>\n<p>Spring Cloud Bus是轻量级的通讯组件，也可以用在其它类似的场景中。有了Spring Cloud Bus之后，当我们改变配置文件提交到版本库中时，会自动的触发对应实例的Refresh，具体的工作流程如下：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/springcloud/configbus2.jpg\"></p>\n<p>也可以参考这篇文章来了解：<a href=\"http://www.ityouknow.com/springcloud/2017/05/26/springcloud-config-eureka-bus.html\">配置中心和消息总线</a><br>\n<br></p>\n<h3 id=\"服务网关\">服务网关</h3>\n<p>在微服务架构模式下，后端服务的实例数一般是动态的，对于客户端而言很难发现动态改变的服务实例的访问地址信息。因此在基于微服务的项目中为了简化前端的调用逻辑，通常会引入API Gateway作为轻量级网关，同时API Gateway中也会实现相关的认证逻辑从而简化内部服务之间相互调用的复杂度。</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/springcloud/api_gateway.png\"></p>\n<p>Spring Cloud体系中支持API Gateway落地的技术就是Zuul。Spring Cloud Zuul路由是微服务架构中不可或缺的一部分，提供动态路由，监控，弹性，安全等的边缘服务。Zuul是Netflix出品的一个基于JVM路由和服务端的负载均衡器。</p>\n<p>它的具体作用就是服务转发，接收并转发所有内外部的客户端调用。使用Zuul可以作为资源的统一访问入口，同时也可以在网关做一些权限校验等类似的功能。</p>\n<p>具体使用参考这篇文章：<a href=\"http://www.ityouknow.com/springcloud/2017/06/01/gateway-service-zuul.html\">服务网关zuul</a><br>\n<br></p>\n<h3 id=\"链路跟踪\">链路跟踪</h3>\n<p>随着服务的越来越多，对调用链的分析会越来越复杂，如服务之间的调用关系、某个请求对应的调用链、调用之间消费的时间等，对这些信息进行监控就成为一个问题。在实际的使用中我们需要监控服务和服务之间通讯的各项指标，这些数据将是我们改进系统架构的主要依据。因此分布式的链路跟踪就变的非常重要，Spring Cloud也给出了具体的解决方案：Spring Cloud Sleuth和Zipkin</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/architecture/dyl.png\"></p>\n<p>Spring Cloud Sleuth为服务之间调用提供链路追踪。通过Sleuth可以很清楚的了解到一个服务请求经过了哪些服务，每个服务处理花费了多长时间。从而让我们可以很方便的理清各微服务间的调用关系。</p>\n<p>Zipkin是Twitter的一个开源项目，允许开发者收集 Twitter 各个服务上的监控数据，并提供查询接口</p>\n<p>分布式链路跟踪需要Sleuth+Zipkin结合来实现，具体操作参考这篇文章：<a href=\"http://www.jianshu.com/p/c3d191663279\">分布式链路跟踪(Sleuth)</a></p>\n<p><br></p>\n<h3 id=\"总结\">总结</h3>\n<p>我们从整体上来看一下Spring Cloud各个组件如何来配套使用：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/chat/spring_cloud_structure.png\"></p>\n<p>从上图可以看出Spring Cloud各个组件相互配合，合作支持了一套完整的微服务架构。</p>\n<ul>\n<li>其中Eureka负责服务的注册与发现，很好将各服务连接起来</li>\n<li>Hystrix 负责监控服务之间的调用情况，连续多次失败进行熔断保护。</li>\n<li>Hystrix dashboard,Turbine 负责监控 Hystrix的熔断情况，并给予图形化的展示<br>\n</li>\n<li>Spring Cloud Config 提供了统一的配置中心服务<br>\n</li>\n<li>当配置文件发生变化的时候，Spring Cloud Bus 负责通知各服务去获取最新的配置信息<br>\n</li>\n<li>所有对外的请求和服务，我们都通过Zuul来进行转发，起到API网关的作用<br>\n</li>\n<li>最后我们使用Sleuth+Zipkin将所有的请求数据记录下来，方便我们进行后续分析</li>\n</ul>\n<p><br><br>\nSpring Cloud从设计之初就考虑了绝大多数互联网公司架构演化所需的功能，如服务发现注册、配置中心、消息总线、负载均衡、断路器、数据监控等。这些功能都是以插拔的形式提供出来，方便我们系统架构演进的过程中，可以合理的选择需要的组件进行集成，从而在架构演进的过程中会更加平滑、顺利。</p>\n<p>微服务架构是一种趋势，Spring Cloud提供了标准化的、全站式的技术方案，意义可能会堪比当前Servlet规范的诞生，有效推进服务端软件系统技术水平的进步。</p>\n<p><strong>这是我在GitChat的分享<a href=\"http://gitbook.cn/gitchat/author/5949f1f19bc6b9498d120a0d\">从架构演进的角度聊聊 Spring Cloud 都做了些什么？</a></strong></p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-02 08:58</span> <a href=\"http://www.cnblogs.com/ityouknow/\">纯洁的微笑</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7770593\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7770593);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=96952,cb_entryId=7770593,cb_blogApp=currentBlogApp,cb_blogUserGuid='44ce118c-0edc-e011-8ee0-842b2b196315',cb_entryCreatedDate='2017/11/2 8:58:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 523, "image_url": ["https://pic.cnblogs.com/face/331425/20130328094900.png"], "date_pub": "2017-11-02", "article_common": 4}
{"title": "“购物狂欢节”如何应对“羊毛党”", "url": "http://www.cnblogs.com/qcloud1001/p/7767525.html", "author": "腾讯云技术社区", "article_desc": "最近几年，电商行业飞速发展，各种创业公司犹如雨后春笋大量涌现，商家通过各种活动形式的补贴来获取用户、培养用户的消费习惯，即将到来的“ 购物狂欢节”尤其明显。但任何一件事情都具有两面性，高额的补贴、优惠同时了也催生了“羊毛党”。“羊毛党”的行为距离欺诈只有一步之遥，他们的存在严重破环了活动的目的，侵占... ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/qcloud1001/p/7767525.html\">“购物狂欢节”如何应对“羊毛党”</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><div class=\"J-article-detail article-detail\">\n<p>欢迎大家前往<a href=\"https://cloud.tencent.com/community\">腾讯云社区</a>，获取更多腾讯海量技术实践干货哦~</p>\n<div class=\"J-article-detail article-detail\">\n<h2 id=\"-\">基于用户画像大数据的电商防刷架构</h2>\n<blockquote>\n<p>作者：颜国平<br>摘要：最近几年，电商行业飞速发展，各种创业公司犹如雨后春笋大量涌现，商家通过各种活动形式的补贴来获取用户、培养用户的消费习惯，即将到来的“ 购物狂欢节”尤其明显。但任何一件事情都具有两面性，高额的补贴、优惠同时了也催生了“羊毛党”。“羊毛党”的行为距离欺诈只有一步之遥，他们的存在严重破环了活动的目的，侵占了活动的资源，使得正常的用户享受不到活动的直接好处。这篇文章主要分享下腾讯自己是如何通过大数据、用户画像、建模来防止被刷、恶意撞库的。</p>\n\n</blockquote>\n<h2 id=\"-\">黑产“羊毛党”现状介绍</h2>\n<p>“羊毛党”一般先利用自动机注册大量的目标网站账号，当目标网站搞促销、优惠等活动的时候，利用这些账号参与活动刷取较多的优惠，最后通过某宝等电商平台转卖获益。</p>\n<h3 id=\"-\">一.“羊毛党”分工</h3>\n<p>据初步估计，全国“羊毛党”在20万人左右，他们往往有着明确的分工，已形成了几大团伙：</p>\n<p>1.软件制作团伙：专门制作各种自动、半自动的黑产工具，比如注册自动机、刷单自动机等；他们主要靠出售各种黑产工具、提供升级服务等形式来获利。<br>2.短信代接平台：实现手机短信的自动收发。这其中，有一些短信平台是亦正亦邪，不但提供给正常的商家使用，一些黑产也会购买相关的服务。<br>3.账号出售团伙：他们主要是大量注册各种账号，通过转卖账号来获利；该团伙与刷单团伙往往属于同一团伙。<br>4.刷单团伙：到各种电商平台刷单，获取优惠，并且通过第三方的电商平台出售优惠，实现套现。</p>\n<p>也就是说，这些“羊毛党“在电商促销或优惠活动中，已逐步形成了相对完善的刷单及变现工作流程（见图1：电商刷单团伙工作流程）:<br><img src=\"https://blog-10039692.file.myqcloud.com/1509501258853_3782_1509501200197.png\" alt=\"\"><br>图1：电商刷单团队的工作流程</p>\n<h3 id=\"-\">二.“羊毛党”从业特点</h3>\n<p>从“羊毛党“的分工与工作流程看，他们具有以下从业特点：<br>1.专业化：有专业团队、人员、机器来做。<br>2.团伙化：已经形成一定规模的团伙，而且分工明确；从刷单软件制作、短信代收发平台、电商刷单到变卖套现等环节，已经形成完整的刷单团伙。<br>3.地域化：刷单黑产团伙基本分布在沿海的一些经济发达城市，比如，北京、上海、广东等城市，这或许跟发达城市更加容易接触到新事物、新观念有关。<br>下图2显示了我们TOP5的黑产刷单团伙分别位于：北京、上海、广州、江苏、浙江这些沿海较发达的经济区域。<br><img src=\"https://blog-10039692.file.myqcloud.com/1509501288060_2591_1509501229395.png\" alt=\"\"><br>图2 TOP5黑产刷单团伙的地域分布</p>\n<h3 id=\"-\">三.对抗刷单的思路</h3>\n<p>面对黑产刷单，我们有什么对抗思路呢？一般来讲，对抗刷单主要从注册、登陆、活动三个环节入手：<br>1.注册环节：识别虚假注册、减少“羊毛党”能够使用的账号量。在注册环节识别虚假注册的账号，并进行拦截和打击。<br>2.登录场景：提高虚假账号登录门槛，从而减少能够到达活动环节的虚假账号量。比如，登录环节通过验证码、短信验证码等手段来降低自动机的登录效率，从而达到减少虚假账号登录量、减轻活动现场安全压力的目的。<br>3.活动环节：这个是防刷单对抗的主战场，也是减少“羊毛党”获利的直接战场；这里的对抗措施，一般有两个方面： 1）通过验证码（短信、语音）降低黑产刷单的效率。 2）大幅度降低异常账号的优惠力度。</p>\n<h2 id=\"-\">电商防刷架构</h2>\n<h3 id=\"-\">一. 腾讯防刷总体架构</h3>\n<p>面对疯狂的黑产刷单，按照对抗刷单的思路，基于腾讯的多维度大数据，腾讯专门设计并构建了电商防刷技术体系。总体防刷架构见下图3：<br><img src=\"https://blog-10039692.file.myqcloud.com/1509501333340_5540_1509501274709.png\" alt=\"\"><br>图3：腾讯防刷单技术架构<br>从上面的总体架构我们可以看到，整个系统分三层：接入层、实时计算层、存储&amp;挖掘层。整个系统充分利用了腾讯海量业务生态中的多维度大数据，以及全方位的风控经验与能力。接下来我们详细介绍其中的一些核心模块。</p>\n<h3 id=\"-\">二.防刷单技术架构核心模块与框架介绍</h3>\n<h4 id=\"1-\">1.风险学习引擎</h4>\n<p>对于风险学习引擎而言，效率问题非常关键。该模块线上采用的都是C++实现的DBScan等针对大数据的快速聚类算法，性能卓越；而且主要的工作都是线下进行，所以线上系统也不存在学习的效率问题。<br>风险学习引擎采用了黑/白双分类器风险判定机制，可以很好地减少对正常用户的误伤。例如，某个IP是恶意的IP，那么该IP上可能会有一些正常的用户，比如大网关IP。再比如，黑产通过ADSL拨号上网，那么就会造成恶意与正常用户共用一个IP的情况。<br>其中，黑分类器风险判定是根据特征、机器学习算法、规则/经验模型，来判断本次请求异常的概率。而白分类器风险判定则是判断属于正常请求的概率。见下图4示意：</p>\n<p><img src=\"https://blog-10039692.file.myqcloud.com/1509501378269_652_1509501319559.png\" alt=\"\"><br>图4 风险引擎的宏观构成</p>\n<h4 id=\"2-\">2.分类器逻辑框架</h4>\n<p>如何实现风险评估的判定呢？我们以黑分类器为例，来详细剖析下分类器的逻辑框架。</p>\n<p>系统总体是采用一种矩阵式的逻辑框架。</p>\n<p>黑分类器最初设计是整体检测判定，即按需随意地建立一个个针对黑产的检测规则、模型。但这种设计出来的结果，发现不是这个逻辑漏过了，而是那个逻辑误伤量大，要对某一类的账号加强安全打击力度，改动起来也非常麻烦。</p>\n<p>因此，我们最终设计出一套矩阵式的框架（见下图5），较好地解决上述问题。<br><img src=\"https://blog-10039692.file.myqcloud.com/1509501419072_6205_1509501360496.png\" alt=\"\"><br>图5 黑分类器的矩阵逻辑框架<br>矩阵的横向采用了Adaboost方法，该方法是一种迭代算法，其核心思想是针对同一个训练集训练不同的弱分类器，然后把这些分类器集合起来，构成一个最终的分类器。而我们这里每一个弱分类器都只能解决一种帐号类型的安全风险判断，集中起来才能解决所有账户的风险检测。<br>这个矩阵逻辑的横向方法，在工程实现上也带来三个好处：<br>1.便于实现轻重分离。比如某平台虚假账号集中在邮箱账号，策略就可以加大对邮箱账号的打击力度，影响范围也局限在邮箱帐号，而不是该平台所有的账号。<br>2.减少模型训练的难度。模型训练最大的难度在于样本的均衡性问题，拆分成子问题，就不需要考虑不同账号类型之间的数据配比、均衡性问题，大大降低了模型训练时正负样本比率的问题。<br>3.逻辑的健壮性。某一个分类器的训练出现了问题，受影响的范围不至于扩展到全局。</p>\n<p>矩阵纵向则采用了Bagging方法，该方法是一种用来提高学习算法准确度的方法。它在同一个训练集合上构造预测函数系列，然后设法将他们组合成一个预测函数，从而来提高预测结果的准确性。</p>\n<h2 id=\"-\">腾讯大数据处理平台－魔方</h2>\n<p>毫无疑问，对抗黑产刷单离不开大数据。大数据一直在安全对抗领域发挥着重要的作用，从我们的对抗经验来看，大数据不仅仅是数据规模很大，而且还包括两个方面：<br>1.数据广度：要有丰富的数据类型。比如，不仅仅要有社交领域的数据、还要有游戏、支付、自媒体等领域的数据，这样就提供了一个广阔的视野让我们来看待黑产的行为特点。<br>2.数据深度：黑产的对抗，我们一直强调纵深防御。不仅仅要有注册数据，还要有登录，以及账号的使用的数据，这样我们才能更好的识别恶意。<br>所以想要做风控和大数据的团队，一定要注意在自己的产品上多埋点，拿到足够多的数据，先沉淀下来。<br>腾讯安全团队研发了一个叫魔方的大数据处理和分析的平台，底层集成了MySQL、MongoDB，Spark、Hadoop等技术，在用户层面我们只需要写一些简单的SQL语句、完成一些配置就可以实现例行分析。<br>这里我们收集了社交、电商、支付、游戏等场景的数据，针对这些数据我们建立一些模型，发现哪些是恶意的数据，并且将数据沉淀下来。<br>沉淀下来的对安全有意义的数据，一方面就存储在魔方平台上，供线下审计做模型使用；另一方面会做成实时的服务，提供给线上的系统查询使用。</p>\n<h3 id=\"-\">一.腾讯用户画像沉淀方法</h3>\n<p>用户画像，本质上就是给账号、设备等打标签。但我们这里主要从安全的角度出发来打标签，比如IP画像，我们会标注IP是不是代理IP，这些对我们做策略是有帮助的。<br>我们看看腾讯的IP画像，目前沉淀的逻辑如下图6：<br><img src=\"https://blog-10039692.file.myqcloud.com/1509501489829_8594_1509501431294.png\" alt=\"\"><br>图6 IP画像系统构成<br>一般的业务都有针对IP的频率、次数限制的策略，那么黑产为了对抗，必然会大量采用代理IP来绕过限制。既然代理IP的识别如此重要，那我们就以代理IP为例来谈下腾讯识别代理IP的过程。<br>识别一个IP是不是代理IP，技术不外乎就是如下四种：<br>1.反向探测技术：扫描IP是不是开通了80,8080等代理服务器经常开通的端口，显然一个普通的用户IP不太可能开通如上的端口。<br>2.HTTP头部的X_Forwarded_For：开通了HTTP代理的IP可以通过此法来识别是不是代理IP；如果带有XFF信息，该IP是代理IP无疑。<br>3.Keep-alive报文：如果带有Proxy-Connection的Keep-alive报文，该IP毫无疑问是代理IP。<br>4.查看IP上端口：如果一个IP有的端口大于10000，那么该IP大多也存在问题，普通的家庭IP开这么大的端口几乎是不可能的。<br>以上代理IP检测的方法几乎都是公开的，但是盲目去扫描全网的IP，被拦截不说，效率也是一个很大的问题。<br>因此，我们的除了利用网络爬虫爬取代理IP外，还利用如下办法来加快代理IP的收集：通过业务建模，收集恶意IP（黑产使用代理IP的可能性比较大）然后再通过协议扫描的方式来判断这些IP是不是代理IP。每天腾讯都能发现千万级别的恶意IP，其中大部分还是代理IP。</p>\n<h3 id=\"-\">二.腾讯用户画像类别概览</h3>\n<p>腾讯用户画像的维度与类别很多，这里仅举部分用户画像数据来说明。比如用户画像其中有手机画像和QQ画像这两个重要类别。涉及画像的标签见下图7：<br><img src=\"https://blog-10039692.file.myqcloud.com/1509501520940_4395_1509501462339.png\" alt=\"\"><br>以QQ的画像为例，比如，一个QQ只登录IM、不登录其他腾讯的业务、不聊天、频繁的加好友、被好友删除、QQ空间要么没开通、要么开通了QQ空间但是评论多但回复少，这种号码我们一般会标注QQ养号（色情、营销），类似的我们也会给QQ打上其他标签。<br>标签的类别和明细，需要做风控的人自己去设定，比如：地理位置，按省份标记。性别，按男女标记。其他细致规则以此规律自己去设定。</p>\n<h3 id=\"-\">三. 风险判定的基础逻辑</h3>\n<p>有了用户画像的基础数据，我们就可以进行风险判定了。腾讯风险判定的系统现已开放为腾讯云的能力，即天御系统。我们来看一下风险判定的基础逻辑，见下图8：<br><img src=\"https://blog-10039692.file.myqcloud.com/1509501567314_8022_1509501508766.png\" alt=\"\"><br>图8 腾讯云天御系统防御逻辑示意图</p>\n<p>实时防御系统使用C/C++开发实现，所有的数据通过共享内存的方式进行存储，相比其他的系统，安全系统更有他自己特殊的情况，因此这里我们可以使用“有损”的思路来实现，大大降低了开发成本和难度。</p>\n<p>但这里在安全策略方面，可能会面临一个挑战：多台机器，使用共享内存，如何保障数据一致性？其实，安全策略不需要做到强数据一致性。</p>\n<p>从安全本身的角度看，风险本身就是一个概率值，不确定，所以有一点数据不一致，不影响全局。但是安全系统也有自己的特点，安全系统一般突发流量比较大，我们这里就需要设置各种应急开关，而且需要微信号、短信等方式方便快速切换，避免将影响扩散到后端系统。</p>\n<h2 id=\"-\">电商企业接入天御系统，启用带防刷能力的业务架构</h2>\n<p>通过剖析腾讯对抗“羊毛党”刷单的防刷系统技术架构与原理，我们了解到了天御系统可以帮助咱们电商企业在促销、优惠活动时，有效打击黑产刷单团伙。特别是马上到来的双十一“购物狂欢节”，该系统将让广大电商企业更好地服务用户，真正为用户带来贴心的实惠与好处。</p>\n<p>天御系统可适应的场景包括但不限于：</p>\n<ul>\n<li>电商o2o刷单、刷券、刷红包</li>\n<li>防止虚假账号注册</li>\n<li>防止用户名、密码被撞库</li>\n<li>防止恶意登录</li>\n\n</ul>\n<p>那么如何接入并使用天御系统呢？其实，电商企业接入天御系统仅需要四步，见下图9：<br>其中：第一步离线数据分析与第二步搭建实时模型为前期的准备工作，第三步正式接入其实并不耗费多少时间，不过第四步上线后，还需要持续的优化，以进一步提高对抗的能力。<br><img src=\"https://blog-10039692.file.myqcloud.com/1509501608087_4514_1509501549574.png\" alt=\"\"></p>\n<p>图9 企业接入天御系统步骤<br>业务接入天御系统后的架构图，见下图10：<br><img src=\"https://blog-10039692.file.myqcloud.com/1509501625234_6997_1509501566595.png\" alt=\"\"><br>图10 业务接入天御防刷后的架构图<br>从上图可以看到，接入天御防刷是旁路接入，不需要调整现有业务任何核心逻辑、关键流程，可以快速上线。另外，运行过程中，即使天御防刷有任何异常也不会影响业务主逻辑。<br><strong>Q&amp;A</strong><br><strong>Q：风险学习引擎是自研的，还是使用的开源库？</strong><br>风险学习引擎包括两个部分，线上和线下两部分：<br>线上：自己利用c/c++来实现。<br>线下：涉及利用python开源库来做的，主要是一些通用算法的训练和调优。<br><strong>Q：请问魔方平台中用到的MongDB是不是经过改造？因为MongDB一直不被看好，出现问题也比较多。</strong><br>我们做了部分改造，主要是DB的引擎方面。<br><strong>Q：请问黑分类器和白分类器有什么区别？</strong><br>白分类器主要用来识别正常用户，黑分类器识别虚假用户。<br><strong>Q：风险概率的权重指标是如何考虑的？</strong><br>先通过正负样本进行训练，并且做参数显著性检查；然后，人工会抽查一些参数的权重，看看跟经验是否相符。<br><strong>Q：安全跟风控职责如何区分呢？</strong><br>相比安全，风控的外延更丰富，更注重宏观全局；针对一个公司来讲，风控是包括安全、法务、公关、媒体、客服等在内一整套应急处理预案。<br><strong>Q：如果识别错了，误伤了正常用户会造成什么后果么？比如影响单次操作还是会一直失败。</strong><br>如果识别错了正常用户不会被误伤，但是会导致体验多加了一个环节，如弹出验证码、或者人工客服核对等。</p>\n<blockquote>\n<p>作者：颜国平，原腾讯云－天御系统研发负责人。一直负责腾讯自有验证码、业务安全、防刷、账号安全等研发工作。内部支持的产品（游戏、电商、腾讯投资的O2O企业）非常广泛。在业务安全领域项目经验丰富，并且具备深度学习、大数据架构搭建等实战经验。</p>\n\n</blockquote>\n\n</div>\n<div class=\"article-event\"> </div>\n<div class=\"blog-share\"> </div>\n</div>\n<div class=\"article-event\">\n<div id=\"cnblogs_post_body\">\n<div class=\"J-article-detail article-detail\">\n<h3>相关阅读</h3>\n<p><a title=\"免费试用活动防刷服务\" href=\"https://cloud.tencent.com/product/aa?idx=1&amp;fromSource=gwzcw.593628.593628.593628\" target=\"_blank\">免费试用活动防刷服务</a></p>\n</div>\n<div class=\"article-event\">\n<p class=\"title\"><a href=\"https://cloud.tencent.com/act/double11?fromSource=gwzcw.541526.541526.541526\">一站式满足电商节云计算需求的秘诀</a></p>\n<p class=\"title\"><a href=\"https://cloud.tencent.com/community/article/125131\" target=\"_blank\">代码自动生成在重构中的一次探索</a></p>\n</div>\n<div class=\"blog-share\"> <hr>\n<div>\n<div>此文已由作者授权腾讯云技术社区发布，转载请注明<a href=\"https://cloud.tencent.com/community/article/852012\">文章出处</a></div>\n</div>\n<div>\n<div>原文链接：https://cloud.tencent.com/community/article/852012</div>\n</div>\n</div>\n</div>\n<div id=\"MySignature\">海量技术实践经验，尽在腾讯云社区！ https://cloud.tencent.com/community</div>\n</div>\n<div class=\"blog-share\"> </div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 17:27</span> <a href=\"http://www.cnblogs.com/qcloud1001/\">腾讯云技术社区</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7767525\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7767525);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=335046,cb_entryId=7767525,cb_blogApp=currentBlogApp,cb_blogUserGuid='ba94c61b-3dfa-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/1 17:27:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 713, "image_url": ["https://pic.cnblogs.com/face/1112679/20170307164131.png"], "date_pub": "2017-11-01", "article_common": 2}
{"title": "「编程之外」青春是如此美好，又怎忍平凡度过", "url": "http://www.cnblogs.com/okaychen/p/7765852.html", "author": "OkayChen", "article_desc": "写在前面 读了博友吕大豹前辈的博文《假如大学可以重来》，我决定走心写下这篇文章： 不像考卷一样所有的问题都能得到一个答案，真正的人生有些事情永远没有答案， 青春是如此美好，我们又怎忍心平凡度过. 小小心事，大大感动 ~~已经大二了，我总是相信，做喜欢的事，总是值得的和最快乐的，虽然不善言谈，但是我发 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/okaychen/p/7765852.html\">「编程之外」青春是如此美好，又怎忍平凡度过</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h1>写在前面</h1>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1140602/201711/1140602-20171101130631545-1261006104.png\" alt=\"\"></p>\r\n<p>　　 <span style=\"font-size: 16px;\">读了博友吕大豹前辈的博文<a href=\"http://www.cnblogs.com/lvdabao/p/5273249.html\" target=\"_blank\">《假如大学可以重来》</a>，我决定走心写下这篇文章：</span></p>\r\n<p><span style=\"font-size: 16px;\">　　不像考卷一样所有的问题都能得到一个答案，真正的人生有些事情永远没有答案，</span></p>\r\n<p><span style=\"font-size: 16px;\">　　青春是如此美好，我们又怎忍心平凡度过.</span></p>\r\n<h1>小小心事，大大感动</h1>\r\n<p>　　<span style=\"font-size: 16px;\">~~已经大二了，我总是相信，做喜欢的事，总是值得的和最快乐的，虽然不善言谈，但是我发现已经把<span style=\"color: #3366ff; font-size: 14px;\"><strong>编程</strong></span>和<span style=\"color: #3366ff; font-size: 14px;\"><strong>写文章</strong></span>当做自己的一种生活常态或是一种习惯，</span></p>\r\n<p><span style=\"font-size: 16px;\">　　在同学看来每天如此或许很累很空虚吧，但是他们不知道其实<span style=\"font-size: 14px;\"><strong><span style=\"color: #3366ff;\">我的内心是有多么的充实和快乐</span></strong></span>~~</span></p>\r\n<p><span style=\"font-size: 16px;\">　　我相信我们的坚持总是有收获：<span style=\"color: #ff6600;\"><span style=\"color: #000000;\">上个月</span>爱范儿<span style=\"color: #000000;\">的一个编辑作者联系我</span>，<span style=\"color: #000000;\">邀请我加入了他们的<span style=\"color: #ff9900;\">vip群</span>，就这样我的文章发表在了<span style=\"color: #ff9900;\"><span style=\"color: #000000;\">知名媒体</span>爱范儿 和 爱范儿知晓程序</span> 等相关平台</span></span></span></p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1140602/201711/1140602-20171101130356216-1978858794.png\" alt=\"\" width=\"1025\" height=\"228\"></p>\r\n<p>   <span style=\"font-size: 16px;\">    对于一个大学生小作者来说，最大的快乐就是读者和媒体的欣赏，这无疑给了我莫大的动力~ 谢谢你</span></p>\r\n<h1>岁言心语，且听我说</h1>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1140602/201711/1140602-20171101183721435-1938345742.png\" alt=\"\" width=\"626\" height=\"354\"></p>\r\n<p>　　 <span style=\"font-size: 16px;\">高中的时候我们不清楚自己想要什么，模糊的说我们知道我们是为了一所'大学'，或者说为了'明天'， 为了奔一个好的'前途'。</span></p>\r\n<p><span style=\"font-size: 16px;\">　　直到幸福悄然来到，我们来到大学，觉得从小灌输的'到了大学就轻松了'的观念，脱离了家长和老师的包围圈，恨不得玩到天昏地暗。</span></p>\r\n<p><span style=\"font-size: 16px;\">　　有同学跟我说：'你大一的时候好安静~'，其实不然，我只是换一种方式发出自己的声音，我是一个疯狂的人，看似安静的背后，是滚烫的热血。</span></p>\r\n<p><span style=\"font-size: 16px;\">　　可以说我并不是一个优等生，但是我一旦为一件事情痴迷，就愿意疯狂为之付出，</span></p>\r\n<p><span style=\"font-size: 16px;\">　　记得小时候父亲在广州安置的还不错，家境条件不算差，我的玩具是伙伴中最多的，小时候喜欢用很多很多的玩具摆出两军对峙的情形，然后用自己的想象力去描绘他们的战争，总是偏心的，最喜欢的玩具总是胜利的一方；</span></p>\r\n<p><span style=\"font-size: 16px;\">　　接触电脑也比较早，初中就开始接触电脑，但是我却是以一种错误的方式开始使用它，那一段的疯狂岁月我不会忘记，</span></p>\r\n<p><span style=\"font-size: 16px;\">　　直到那一晚我爸妈让我幡然醒悟，结束了我那一段荒诞又不舍的青春和叛逆年华，</span></p>\r\n<p><span style=\"font-size: 16px;\">　　我感谢那一段错误的青春，让现在的我不怕挫折和艰苦，以一种坚定的姿态行走，因为我们已经走错过，不要让爱你的人寒了心；</span></p>\r\n<hr>\r\n<p><span style=\"font-size: 16px;\">　　记得刚步入大学校园，在琳琅满目的大学生社团中，我基于自己的优势，会<span style=\"font-size: 14px;\"><strong><span style=\"color: #3366ff;\">画画</span></strong></span>和<span style=\"font-size: 14px;\"><strong><span style=\"color: #3366ff;\">Dreamweaver</span></strong></span>，选择了大学生网络工作室设计组，好像这一切貌似都是注定，</span></p>\r\n<p><span style=\"font-size: 16px;\">　　我那时候不知道Dreamweaver是前端开发的一个工具，但是因为接触较早我却已经熟练的使用它，它也是我的前端启蒙软件，就这样我顺顺利利的进入了工作室，从设计到前端，开始了我的前端之路。</span></p>\r\n<p><span style=\"font-size: 16px;\">　　记不清从什么时候开始，自己喜欢上买书和读书，在当当买书经常有活动，每次总是拿出自己做外包的钱毫不吝啬，它们是属于我一生的财富，不知道爱写作的我将来有没有能力去写书或者译书~期待ing</span></p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1140602/201711/1140602-20171101183447795-856421915.jpg\" alt=\"\" width=\"150\" height=\"201\"> <img src=\"http://images2017.cnblogs.com/blog/1140602/201711/1140602-20171101183509185-1114723520.jpg\" alt=\"\" width=\"271\" height=\"203\"> ...&lt;此处省略hah做参考喽&gt;</p>\r\n<p><span style=\"font-size: 16px;\">　　从基础的笔记分块来记录，到现在笔记分块分天来记录，</span></p>\r\n<p>　<span style=\"font-size: 16px;\">　据称<span style=\"color: #ff9900;\">雷军叔叔</span>的整个大学都是在图书馆度过的，</span><span style=\"font-size: 16px;\">这又让我想起了《异类》中的<span style=\"color: #ff9900;\">比尔乔伊</span>，那时候的他都每天都待在计算机中心，直到清晨7点才离开，</span></p>\r\n<p><span style=\"font-size: 16px;\">　　<span style=\"color: #3366ff;\">曾经的我错误的这么疯狂过，现在我想以一种正确的方式在去疯狂一次</span><br></span></p>\r\n<p><span style=\"font-size: 16px;\">　　外包项目一点一点的做，（郑州百格教育的官网，江苏南通集团的APP，微信狗的一起团小程序，深圳政府党建网的修改工作我都有负责）业务代码写了不少，</span></p>\r\n<p><span style=\"font-size: 16px;\">　　<img src=\"http://images2017.cnblogs.com/blog/1140602/201711/1140602-20171101184305966-1372145517.png\" alt=\"\" width=\"452\" height=\"245\"> <img src=\"http://images2017.cnblogs.com/blog/1140602/201711/1140602-20171101184423232-2079524613.png\" alt=\"\" width=\"454\" height=\"248\"></span></p>\r\n<p><span style=\"font-size: 16px;\">　　开始觉得自己需要去补充知识，继续了大一上持续学习的状态，</span></p>\r\n<p><span style=\"font-size: 16px;\">　　还记得之前看过一篇文章，业务代码都写不好是一个很大的问题，但是只会写业务代码必然是不可取的，解决问题的思路都不同，眼界和见识都有很大的差别。</span></p>\r\n<h1>写在后面</h1>\r\n<p><span style=\"font-size: 16px;\">　　小时候不明白坚持的是什么，长大后不明白坚持的对不对，做自己坚持的人很累，很辛苦；做随波逐流的人，很无趣。</span></p>\r\n<p><span style=\"font-size: 16px;\">　　青春是如此的美好，我们又怎么忍心平凡度过，这几天读东野圭吾的《我的晃荡青春》--他的自传，我眼前浮现了我的那段荒诞的青春，心中满是感激v</span></p>\r\n<p><span style=\"font-size: 16px;\">　　这世界上最幸福的事莫过于：幡然醒悟后，岁月安好，只愿你们还不老，曾经爱我的人，今后交给我来守护。</span></p>\r\n<p>　　</p>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 19:16</span> <a href=\"http://www.cnblogs.com/okaychen/\">OkayChen</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7765852\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7765852);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=346174,cb_entryId=7765852,cb_blogApp=currentBlogApp,cb_blogUserGuid='6bd1495b-fa19-e711-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/1 19:16:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 600, "image_url": ["https://pic.cnblogs.com/face/1140602/20171031141101.png"], "date_pub": "2017-11-01", "article_common": 17}
{"title": "不借助vue-cli，自行构建一个vue项目", "url": "http://www.cnblogs.com/xingyazhao/p/7767602.html", "author": "zhaoxingya", "article_desc": "对于刚刚接触vue的同学来说，直接用官方的构建工具vue-cli来生成一个项目结构会存在一些疑惑，比如:   .vue组件 为什么可以写成三段式（tempalte、script、style）? 整个项目是怎样组织运行起来的，main.vue - App.vue - 各个组件 之间是怎么相互引用的？为... ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/xingyazhao/p/7767602.html\">不借助vue-cli，自行构建一个vue项目</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><strong>前言：</strong></p>\n<p>　　对于刚刚接触vue的同学来说，直接用官方的构建工具vue-cli来生成一个项目结构会存在一些疑惑，比如:   <em>.vue</em>组件 为什么可以写成三段式（tempalte、script、style）? 整个项目是怎样组织运行起来的，main.js - App.vue - 各个组件 之间是怎么相互引用的？</p>\n<p>　　为了让更多同学理解，我们不借助官方构建工具，自行构建一个类似于官方的项目结构，去体会它的运作机制。</p>\n<p>　　在自行构建的项目中，我们的组件并不使用.vue文件方式，因为这种文件是经过了vue-loader做了相应的处理，意思可以理解为将组件&lt;template&gt;&lt;/template&gt;中的模板编译到了组件对象中。而我们既然选择原生的方式，那么我们就应该将模板写在组件选项'template'中（虽然这种方式没有语法高亮，但要记得我们这样做的目的），而我们的组件后缀是.js。</p>\n<p> </p>\n<p><strong>开始：</strong></p>\n<p>　　1. 进入自己的项目根目录，初始化npm</p>\n<p>　　npm init</p>\n<p>　　2. 安装vue包到项目</p>\n<p>　　npm install --save-dev vue</p>\n<p>　　3. 创建index.html/src目录/dist目录</p>\n<p>　　touch index.html　　mkdir src　　mkdir dist </p>\n<p> </p>\n<p><strong>文件功能：</strong></p>\n<p>　　到目前，我们的项目结构：</p>\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1036165/201711/1036165-20171101162056326-1637164839.png\" alt=\"\"></p>\n<p>　　接下来我们在src路径下创建，js入口文件main.js，项目根组件App.js，和组件目录components，并且我们象征性的创建两个组件cp1.js、cp2.js ：</p>\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1036165/201711/1036165-20171101162540982-1363667174.png\" alt=\"\"></p>\n<p>　　main.js 是所有js的入口，（那么我们在index.html文件中只需要引入这个文件就够了？ -- 并不是），该文件将会声明与其他组件的依赖关系（而其他组件又会声明和别的组件的关系），我们在写完项目的时候需要使用webpack打包整个项目的js代码，而这个main.js就是打包寻找依赖的入口。</p>\n<p>　　我们得知通过Vuejs构建的项目，是组件化的，项目可以说是由一个个组件构成的，在一个组件中可以使用其他的组件作为自己的子组件，那么必然会存在一个根组件，它就是App.js。</p>\n<p> </p>\n<p><strong>组件：</strong></p>\n<p>　　components文件夹下存放的是项目中的除根组件外的其他组件，我们在写这些组件的时候应该遵循的一个原则就是：<strong>与外界隔绝，不做任何与外界耦合的假设</strong>。那么我们就来我们就开始编写组件cp1.js吧：</p>\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1036165/201711/1036165-20171101164105123-790502783.png\" alt=\"\"></p>\n<p>　　请注意它和.vue组件写法的区别，我们的组件模板是写在template选项中的。并且提供给外界一个props参数接口msg。</p>\n<p> </p>\n<p>　　接下来我们需要在根组件中引用这个组件，根组件的写法遵循同样的原则：</p>\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1036165/201711/1036165-20171101164733529-1476699533.png\" alt=\"\"></p>\n<p>　　要使用cp1组件，首先要将其import导入，因为cp1.js中导出的写法是export default，所以我们在这可以给cp1组件对象随意命名（import后紧随的'cp1'就是我们的命名），这是ES6的语法规则。</p>\n<p>　　记住：每个组件对象我们都需要使用export default进行导出，因为这样外界才可以调用它，并且将 给此组件的命名权 递交给使用者。</p>\n<p>　　我们看到，在根组件中我们有components选项，用来注册将使用的组件（局部注册）。此选项对象中的key将作为模板中标签，value为其他组件对象。</p>\n<p>　　在模板中我们使用了cp1标签，并且给其props属性msg赋值为'Message from parent ~'。</p>\n<p> </p>\n<p><strong>入口：</strong></p>\n<p>　　组件都写好了，那如何将其挂载到html页面中呢，这个时候我们需要一个桥梁，就是main.js：</p>\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1036165/201711/1036165-20171101170250560-2092362344.png\" alt=\"\"></p>\n<p>　　这次我们终于用到Vue了！（记得先导入），并且导入App根组件，将其注册为Vue实例的组件，并且在模板中使用它（template:'&lt;app&gt;&lt;/app&gt;'），然后将这个Vue实例挂载到index.html中id为app的元素中。</p>\n<p> </p>\n<p><strong>打包：</strong></p>\n<p>　　在打包之前我们需要先修改vue npm包的package.json文件，将默认导出的‘只包含运行时’改为‘完整版’，即将如下两项的'runtime'去掉（运行时不包含编译器 | 编译器作用：用来将模板字符串编译成为 JavaScript 渲染函数的代码&gt;，因此组件对象不支持 template 选项）：</p>\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1036165/201711/1036165-20171101172207138-1270820955.png\" alt=\"\"></p>\n<p>　　在项目根路径执行打包（全局安装过webpack）</p>\n<p>　　webpack ./src/main.js ./dist/main.bundle.js</p>\n<p> </p>\n<p><strong>index.html：</strong></p>\n<p><strong>　　</strong>将打包后的文件引入到页面：</p>\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1036165/201711/1036165-20171101173326013-1703716730.png\" alt=\"\"></p>\n<p>　　接下来去浏览器访问它吧～</p>\n<p> </p>\n<p> </p>\n<p>　　效果：</p>\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1036165/201711/1036165-20171101173440779-220905955.png\" alt=\"\"></p>\n<p> </p>\n<p> </p>\n<p>　　</p>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 17:37</span> <a href=\"http://www.cnblogs.com/xingyazhao/\">zhaoxingya</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7767602\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7767602);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=309194,cb_entryId=7767602,cb_blogApp=currentBlogApp,cb_blogUserGuid='772bddd0-fd87-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/1 17:37:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 503, "image_url": ["https://pic.cnblogs.com/face/1036165/20170927223530.png"], "date_pub": "2017-11-01", "article_common": 5}
{"title": "数据库的使用你可能忽略了这些", "url": "http://www.cnblogs.com/joylee/p/7768457.html", "author": "IT米粉", "article_desc": "数据库的管理是一个非常专业的事情，对数据库的调优、监控一般是由数据库工程师完成，但是开发人员也经常与数据库打交道，即使是简单的增删改查也是有很多窍门，这里，一起来聊聊数据库中很容易忽略的问题。 字段长度省着点用 先说说我们常用的类型的存储长度： 列类型 | 存储长度 | tinyint | 1字节  ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/joylee/p/7768457.html\">数据库的使用你可能忽略了这些</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><blockquote>\n<p>数据库的管理是一个非常专业的事情，对数据库的调优、监控一般是由数据库工程师完成，但是开发人员也经常与数据库打交道，即使是简单的增删改查也是有很多窍门，这里，一起来聊聊数据库中很容易忽略的问题。</p>\n</blockquote>\n<h2 id=\"字段长度省着点用\">字段长度省着点用</h2>\n<p>先说说我们常用的类型的存储长度：</p>\n<table>\n<thead>\n<tr class=\"header\">\n<th>列类型</th>\n<th>存储长度</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>tinyint</td>\n<td>1字节</td>\n</tr>\n<tr class=\"even\">\n<td>smallint</td>\n<td>2字节</td>\n</tr>\n<tr class=\"odd\">\n<td>int</td>\n<td>4字节</td>\n</tr>\n<tr class=\"even\">\n<td>bigint</td>\n<td>8字节</td>\n</tr>\n<tr class=\"odd\">\n<td>float</td>\n<td>4字节</td>\n</tr>\n<tr class=\"even\">\n<td>decimal(m,d)</td>\n<td>0-4字节</td>\n</tr>\n<tr class=\"odd\">\n<td>datetime</td>\n<td>8字节</td>\n</tr>\n<tr class=\"even\">\n<td>timestamp</td>\n<td>4字节</td>\n</tr>\n<tr class=\"odd\">\n<td>char(m)</td>\n<td>m个字节</td>\n</tr>\n<tr class=\"even\">\n<td>varchar(m)</td>\n<td>可变长度</td>\n</tr>\n<tr class=\"odd\">\n<td>text</td>\n<td>可变长度</td>\n</tr>\n</tbody>\n</table>\n<p>很明显，不同的类型存储的长度有很大区别的，对查询的效率有影响，字段长度对索引的影响是很大的。</p>\n<ul>\n<li>字符串字段长度都差不多的，可以预估长度的，用char</li>\n<li>字符串长度差异大，用varchar,限制长度，不要浪费空间</li>\n<li>整型根据大小，选择合适的类型</li>\n<li>时间建议用timestamp</li>\n<li>建议使用decimal，不建议使用float,如果是价格，可以考虑用int或bigint，如1元，存储的就是100</li>\n</ul>\n<h2 id=\"放弃uuidguid的使用\">放弃uuid(guid)的使用</h2>\n<p>不管是uuid，还是guid，使用的时候都是为了避免同时生成重复的ID，但是建议考虑其他方案，原因如下：</p>\n<ul>\n<li>uuid没有顺序</li>\n<li>uuid太长</li>\n<li>uuid规则完全不可控</li>\n</ul>\n<p>推荐的方案用bigint（首选），或者char来存储，生成方式参考snowflake的算法，有顺序、长度固定、比uuid更短，当然，也几乎不会重复。</p>\n<h2 id=\"大表减少联表最好是单表查询\">大表减少联表，最好是单表查询</h2>\n<p>单表查询的优势很多，查询效率极高，便于分表分库扩展，但是很多时候大家都觉得真正实现起来不太现实，完全失去了关系数据库的意义，但是单表的性能优势太明显，一般总会有办法解决的:</p>\n<ul>\n<li>合理的冗余字段<br>\n</li>\n<li>配合内存数据库（redis\\mongodb）使用</li>\n<li>联表变多次查询（下文会有说明）</li>\n</ul>\n<p>如果考虑都后期数据量大，需要分表分库，就应该尽早实时单表查询，现在的数据库分表分库的中间件基本都无法支持联表查询。即使如mycat最多支持两个表的联表查询，但是也有很明显的性能损耗。</p>\n<h2 id=\"索引的正确处理方式\">索引的正确处理方式</h2>\n<p>索引的优势这里就不多说了，索引使用不当会有反效果：</p>\n<ul>\n<li>数据量很小的表，不需要索引</li>\n<li>一个表的索引不宜过多，建议最多就5个，索引不可能满足所有的场景，但是了个满足绝大部分的场景</li>\n<li>mysql 和 sqlserver的索引差别还挺大的，需要注意。例如：<br>\nmysql索引字段的顺序对性能有很大影响，sqlserver优化过，影响很小</li>\n</ul>\n<h2 id=\"多查几次比联表可能要好\">多查几次比联表可能要好</h2>\n<p>提出这个方案相信会得到很多人的反对，但是我相信这个结论还是非常适合数据量大的场景。多查几次数据库有这么几个弊端：</p>\n<ul>\n<li>增加了网络消耗</li>\n<li>增加了数据库的连接数</li>\n</ul>\n<p>其实，这两个问题在现在基本都可以忽略的，数据库和应用的连接基本都是内网，这个网络连接的效率还是很高的。数据库对连接池的优化已经比较成熟了，连接数只要不是太多，影响也不会太严重，但是多查几次的优势却很多：</p>\n<ul>\n<li>单表效率更高</li>\n<li>便于后期扩展分表分库库</li>\n<li>有效利用数据库本身的结果缓存</li>\n<li>减少锁表，联表会锁多个表</li>\n</ul>\n<p>当然，多查几次这个度一定要把握。千万不要在一个循环里面查询数据库。我们也应该尽量减少查询数据库的次数。我们可以接受1次查询变2次查询，如果你变成10次查询，那就要放弃了。<br>\n举个例子：<br>\n查询商品的时候，需要显示分类表的分类名</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sql\"><code class=\"sourceCode sql\"><span class=\"kw\">select</span> category.name,product.name <span class=\"kw\">from</span> product  <span class=\"kw\">inner</span> <span class=\"kw\">join</span> <span class=\"kw\">category</span> <span class=\"kw\">on</span> p.categoryid=category.id</code></pre></div>\n<p>建议的方式：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sql\"><code class=\"sourceCode sql\"><span class=\"kw\">select</span> categoryid,name  <span class=\"kw\">from</span> product \n<span class=\"kw\">select</span> categoryname <span class=\"kw\">from</span> <span class=\"kw\">category</span> <span class=\"kw\">where</span> categoryid <span class=\"kw\">in</span> (<span class=\"st\">''</span>,<span class=\"st\">''</span>,<span class=\"st\">''</span>,<span class=\"st\">''</span>)</code></pre></div>\n<p>当然，你可以再优化一下，查询分类名之前，对product的categoryid排序一下，这样速度更快。因为我们前面已经用snowflake生成了有顺序的主键了。<br>\n补充一下，in的效率并不是你想象的那么慢，如果保持在100个节点（很多书籍介绍1000个节点，我们保守一点），性能还是很高的。</p>\n<h2 id=\"尽量使用简单的数据库脚本\">尽量使用简单的数据库脚本</h2>\n<p>很多用过 .net Entity Framework 的人都说这个框架太慢，其实慢主要是两点：错误的使用延迟加载（外键关联）、生成SQL编译太慢。Entity Framework生成的SQL脚本有太多没用的东西，导致编译太慢。<br>\n数据库脚本尽量使用简单的，不要用太长的一个SQL脚本，会导致初次执行的时候，编译SQL脚本花费太多的时间。</p>\n<h2 id=\"尽量去避免聚合操作\">尽量去避免聚合操作</h2>\n<p>聚合操作如count,group等，是数据库性能的大杀手，经常会出现大面积的表扫描和索表的情况，所以大家能看到很多平台都把数量的计算给隐藏了，商品查询不去实时显示count的结果。如淘宝，就不显示查询结果的数量，只是显示前100页。<br>\n避免聚合操作的方法就是将实时的count计算结果用字段去存储，去累加这个结果。当然，也可以考虑用spark等实时计算框架去处理，这种高深的技术，不在此次讨论范围内。（PS:主要是我也不懂）</p>\n<h2 id=\"总结\">总结</h2>\n<p>程序的优化很多时候都是一些细节的问题，更应该注意平时的积累，阿里SQL的规范有很多可以吸取的地方，以上也是自己工作中的一些总结，欢迎大家补充。<br>\n（完）</p>\n<hr>\n<p>欢迎大家关注我的公众号交流、学习、第一时间获取最新的文章。<br>\n微信号：itmifen</p>\n<p><img src=\"https://ws2.sinaimg.cn/large/006tNc79gy1fjqwqm6v25j30760760t7.jpg\"></p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 21:03</span> <a href=\"http://www.cnblogs.com/joylee/\">IT米粉</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7768457\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7768457);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=45612,cb_entryId=7768457,cb_blogApp=currentBlogApp,cb_blogUserGuid='fdf8460b-63cf-dd11-9e4d-001cf0cd104b',cb_entryCreatedDate='2017/11/1 21:03:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 535, "image_url": ["https://pic.cnblogs.com/face/42030/20171003230725.png"], "date_pub": "2017-11-01", "article_common": 5}
{"title": "话说LightningChart是最快最美的图表控件，到底先进在哪里？", "url": "http://www.cnblogs.com/lightningchart/p/7768617.html", "author": "LightningChart", "article_desc": "LightningChart Ultimate v.8.2 最新版本新特征告诉你它先进在哪里！ 1. Headless 模式 headless模式允许在没有GUI的情况下使用LC。例如，在Windows Service和控制台应用程序中。以下示例是为报告或网页生成的图表。 在headless模式下， ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/lightningchart/p/7768617.html\">话说LightningChart是最快最美的图表控件，到底先进在哪里？</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>LightningChart Ultimate v.8.2 最新版本新特征告诉你它先进在哪里！</p>\n<p> </p>\n<p>1. Headless 模式</p>\n<p>headless模式允许在没有GUI的情况下使用LC。例如，在Windows Service和控制台应用程序中。以下示例是为报告或网页生成的图表。 </p>\n<p>在headless模式下，图表框被捕获为图像。可以通过利用以下方法来获取位图，例如 </p>\n<p>• OutputStream 属性</p>\n<p>• SaveToStream 方法</p>\n<p>• CopyToClipboard 方法</p>\n<p>• CaptureToByArray 方法</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1124004/201711/1124004-20171101212418248-240862411.png\" alt=\"\"></p>\n<p>该服务可以设置为在本地网络服务器运行或在云端的Windows Server运行。 </p>\n<p>在Windows Application和Windows Service之间的进程间通信中，例如，可以使用Named管道或Socket I / O通信。</p>\n<p>SDK中包含一个新的Headless模式演示解决方案。它在本地计算机上使用Windows服务器。WPF应用程序使用Named Pipes连接到它，并显示服务器发送的图像流。</p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/1124004/201711/1124004-20171101212713076-59816817.png\" alt=\"\"></p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1124004/201711/1124004-20171101212722810-839902624.png\" alt=\"\"></p>\n<p>解释了带有命名管道和后台线程的 Headless演示解决方案的内部操作消。 </p>\n<p> </p>\n<p> </p>\n<p>2. ViewXY BarSeries中的BaseLevel</p>\n<p>BarSeries中添加的BaseLevel属性是所有系列值的一个系列最小值，并指示条的起始位置。在堆叠视图中，它将增加（如果为正）或减小（如果为负）条的大小。如果是StackedToSum，则条尺寸是相对的，并且像Stacked一样计算。</p>\n<p>BaseLevel设置为100。条值为10,20,35,50,65,45,30,25,20,5。</p>\n<p>在之前的LightningChart版本中，像BaseLevel一样的条形图设置为0。 </p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1124004/201711/1124004-20171101212755076-1749013849.png\" alt=\"\"></p>\n<p>BaseLevel设置为100。条值为10,20,35,50,65,45,30,25,20,5。</p>\n<p>在之前的LightningChart版本中，像BaseLevel一样的条形图设置为0。 </p>\n<p> </p>\n<p> </p>\n<p>3. MeshModel程序化构建</p>\n<p>MeshModel支持以编程方式构建MeshModel几何。它允许可视化由于计算而产生的对象和形状。</p>\n<p>以下创建方法可用 </p>\n<p>•创建（位置、颜色、索引）</p>\n<p>•创建（位置、颜色、法线、索引）</p>\n<p>•创建（位置、纹理坐标、位图、textureWrapMode、索引）</p>\n<p>•创建（位置、法线、纹理坐标、位图、textureWrapMode、索引） </p>\n<p>索引数组（索引）参数对于所有方法都是可选的。如果提供它们将定义从给定的阵列使用哪些顶点、颜色、光线法线和纹理坐标。当多个三角形之间共享相同的顶点时，使用索引会节省资源。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1124004/201711/1124004-20171101212844357-312835581.png\" alt=\"\"></p>\n<p>由代码构造的MeshModels。 </p>\n<p>旋转、缩放和定位属性等以及事件也适用于从顶点以编程方式创建的MeshModel，它们的工作方式类似于从顶点以编程方式加载，与处理加载对象方式相同。</p>\n<p> </p>\n<p> </p>\n<p>4. 3D中单维缩放</p>\n<p>只能使用鼠标拖动来缩放一个维度。</p>\n<p>ZoomPanOptions下添加了用于控制单维缩放的新选项。</p>\n<p>LeftMouseButtonAction，RightMouseButtonAction和MiddleMouseButtonAction属性现在有ZoomX，ZoomY和ZoomZ的新选项。 </p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1124004/201711/1124004-20171101212939732-537607756.png\" alt=\"\"></p>\n<p> </p>\n<p> </p>\n<p>5. ViewXY中的图例框，对齐</p>\n<p>AlignmentInVerticalMargin属性添加了左/右/中心选项，到ViewXY的LegendBox。该属性控制图例框的水平定位设置为相同的垂直边距。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1124004/201711/1124004-20171101213037701-981382862.png\" alt=\"\"></p>\n<p>AlignmentInVerticalMargin控制水平定位</p>\n<p> </p>\n<p> </p>\n<p>6.控制图例框中的“强度”和“表面”系列调色板的可视性。</p>\n<p>通过设置LegendBox.IntensityScales.Visible可以隐藏调色板比例为“False”（in ViewXY）和LegendBox.SurfaceScales.Visible为“False”（在View3D中）。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1124004/201711/1124004-20171101213100310-150089026.png\" alt=\"\"></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 21:35</span> <a href=\"http://www.cnblogs.com/lightningchart/\">LightningChart</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7768617\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7768617);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=344487,cb_entryId=7768617,cb_blogApp=currentBlogApp,cb_blogUserGuid='26e92f53-ff06-e711-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/1 21:35:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 544, "image_url": ["https://pic.cnblogs.com/face/1124004/20170404205141.png"], "date_pub": "2017-11-01", "article_common": 2}
{"title": "平台框架-101", "url": "http://www.cnblogs.com/kid551/p/7768720.html", "author": "kid551", "article_desc": "原文首发于我的微信公众号：GeekArtT . 将源代码编译，加载进入内存，相应的构建于程序员脑海中的程序便在计算机上跑(run)起来了。这看似简单的步骤背后，却是一个从无到有的施展魔法的过程。 初学programming的时候，不太能够分清楚手写的源代码和在内存中运行的机器代码（运行时代码）的区别 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/kid551/p/7768720.html\">平台框架-101</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><img src=\"http://images2017.cnblogs.com/blog/672506/201711/672506-20171101215043529-31373015.jpg\" alt=\"\" width=\"859\" height=\"644\"></p>\n<blockquote>\n<p>原文首发于我的微信公众号：GeekArtT .</p>\n</blockquote>\n<p>将源代码编译，加载进入内存，相应的构建于程序员脑海中的程序便在计算机上跑(run)起来了。这看似简单的步骤背后，却是一个从无到有的施展魔法的过程。</p>\n<p>初学programming的时候，不太能够分清楚手写的源代码和在内存中运行的机器代码（运行时代码）的区别。一直被教育，机器代码是通过源代码的编译生成的。机器代码所做的事情，会完全依赖于源代码所表达的意图。或者可以被通俗地理解为：因为源代码是人可以识别的语言，机器代码是机器可以识别的语言，而编译，便是将两者做了一个翻译而建立起来的桥梁。</p>\n<p>如此，在我脑海中建立起来的两者关系便是，这两者就是完全等价的一回事。你想要机器做什么，那么只要在源代码里体现就好了。这一说法的直接推论便是：<strong>如果我在运行的程序中发现缺少了什么功能，那么直接在源代码里增加修改就好了</strong>。</p>\n<p>而这其实是一句表面上政治正确，却在细节上会造成完全不同理解的模糊说法。而如果你恰好在细节上将差别弄错，那么你对整个程序编写的认识、对软件工程存在的意义以及API框架设计的好坏标准，将会形成完全错误的理解（事实上，曾经的我，正是在这些方面陷入过深坑）。</p>\n<p>编译前的源代码和运行起来的机器代码，表面上是一个一一对应的关系，但实际上已经是两个不同的时空世界。虽然运行起来的代码是<strong>完全根据</strong>源代码指定的规则和意图来做事情。可一旦机器代码运行起来，源代码将对运行时的代码毫无办法，产生不了一点影响。你<strong>不能够</strong>通过<strong>临时增加一些源代码</strong>的方式，来为运行时的程序增添一些功能或者feature。你只能老老实实地利用好当前运行着的程序为你提供的现成功能。</p>\n<p>这里的trick是，运行时的代码已经不是代码了，它已经是运转起来的机器，或者说机器状态。而源代码提供的是让计算机如何运行的步骤指令，你可以把它理解为一份分步骤操作的菜谱。而处在运行时的程序，它已经是一套按照源代码的指令转动起来的机器。在这个程序中，它有且只能做之前源代码规定好的事情。如果要想让计算机产生别的行为，那就不得不让计算机停止当前的运转，然后重新塞给它一份执行步骤的说明书，然后重新开始运转。</p>\n<p>所以，通过修改源代码，你确实可以为程序增加新的功能，但你不得不把当前的程序停止掉，然后重新构建计算机运行的状态。</p>\n<p>如果用相对粗糙的比喻可以理解为：如果把程序员看作是能够施展法术，让微观的<strong>原子</strong>形成现实宏观世界的<strong>物体</strong>的魔法师（请脑补SICP的封面图案），那么这些原子便是源代码，而运行时的机器代码便是相应物理世界的物体。一旦物体形成，你便只有使用物体的能力，却没有再次更改物体性质的能力。也就是，你没有办法通过操作原子的排列方式，将手中的一把大刀，变成一杆长枪。</p>\n<p>从这个角度讲，编译前的源代码和运行时的代码，是处在两个不同时空的存在。一旦机器运行起来，你便<strong>只能够</strong>使用当前运行着的程序所提供的功能去做动态操作（也就是对运行的计算机做操作），你不能够通过增添源代码的方式为当前的程序制作新的功能。</p>\n<p>于是，程序在运行状态时所提供的这些功能，便是一切的关键。因为它们是构成你将来一切操作的原始操作（元操作）。这便是程序所提供的API了。</p>\n<p>一套程序提供API的意义，并不是它能够以多么不同的方式对计算机做影响，而是它能够对它所形成的“它的世界”做多少影响。举个例子，一款游戏程序的计算方式、调用CPU的方式、让显示器呈现图像的方式并不会有多么的独特和不同。关键在于游戏里提供的操作方式（可理解为终端用户的API），是你唯一可以运用的、拿去攻击boss并对boss产生影响的方式。你无法通过计算机上一般性的“减法操作”，来减少boss的血槽值。</p>\n<p>既然对你建造的这个MyApp的程序世界的所有影响，都要由这些基础的API来构成。那么如何设计这些API，让它们足够少、却又能够提供足够多的组合方式，去满足你对MyApp世界的各种需求，就成为了关键。</p>\n<p>一个极好的API设计案例，当然是数学领域的几何学。通过《几何原本》上描绘的几条基本定理，便将欧式几何世界的性质、操作和需求全部囊括。而仅仅是改变第五公设的论述，又形成了另一套几何世界——非欧几何。并且也是这么几条基本公理（API），便将非欧几何的需求、操作全部囊括。</p>\n<p>从这个角度来讲，某一个程序的一组精挑细选的API，便可以看作是数学领域中一个分支的公理假设集。而每一套这样的API，便构成了一个独有的世界。所以，这套精简的API便是支撑整个你创造的世界的<strong>骨架</strong>，也就是通常所说的<strong>框架</strong>了。而这套框架，事实上形成了一组构建世界的工具箱，或者是工作坊，也可以叫做工作平台（platform）。因为在这个平台上，你可以建造、加工你所处的MyApp世界。那它当然是最核心也最富有潜力、想象的基建设施平台了。</p>\n<p>那么，一套程序（产品）是否具备平台意识，其实决定了它未来的想象。例如，如果你的程序只能够做规定它做的事情，没有任何开放给开发者的API，那它就只是个固定的东西，而不是一套可以完善、成长的生态系统。例如，一款俄罗斯方块游戏，你能做的，便是按照规则去玩，不能够再添加别的新鲜想法。而反观Apple 处理自己App的方式，它不是说给你一个固定不变的App，而是给你提供一套可以建造App的工具/平台/框架，让你可以按照自己的想法去做各种不同的App，去构建你脑海中不同的世界。又或是Facebook这款社交软件，它并没有选择成为一款静态的产品，而是提供足够多的API，让作为开发者的你去完善它，去为Facebook的成长贡献一份力量。</p>\n<p>所以，对于一个特定程序之外的开发者来说，ta并不是万能的 。而这个特定程序的构建者，才是那个上帝。如果这款程序的构建者，不提供对外开放的API，那么外来者便没有办法去对这个特定的程序世界做修改。另一方面，如果一款产品不提供对外的API，也就是不具备平台思维，那么它也将失去世界上其他程序员为它带来的生长养分。</p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p><strong>近期回顾</strong></p>\n<p>《<a href=\"http://mp.weixin.qq.com/s?__biz=MzI5MDMyMTEwNw==&amp;mid=2247484021&amp;idx=1&amp;sn=61327099a99e1a0ffa2361bc9a25e723&amp;chksm=ec20e5c9db576cdf4b4c06b50dd52de580cdf79bde5389e66af1a3334a7b37d4fe0554565cd0&amp;scene=21#wechat_redirect\" target=\"_blank\">新入手MacBook Pro环境搭建</a>》<br>《<a href=\"http://mp.weixin.qq.com/s?__biz=MzI5MDMyMTEwNw==&amp;mid=2247484008&amp;idx=1&amp;sn=8d1e6de98b5ac438a8923283ead216c4&amp;chksm=ec20e5d4db576cc2a4366966dc105d7ec237e98538ea6fee6c9b7cc688e3bf6884ac619b6fa7&amp;scene=21#wechat_redirect\" target=\"_blank\">做一名「技术掮客」去变现自己的技术</a>》<br>《<a href=\"http://mp.weixin.qq.com/s?__biz=MzI5MDMyMTEwNw==&amp;mid=2247483998&amp;idx=1&amp;sn=acb416bb9f336d7cea1e66c7ba86d260&amp;chksm=ec20e5e2db576cf4ddf72e51c295e562a1a0d62389c1ce157a60d093828fb32255a58a80cc0b&amp;scene=21#wechat_redirect\" target=\"_blank\">「极客时间」带来的社区价值思考</a>》</p>\n<h2> </h2>\n<p><strong>如果你喜欢我的文章或分享，请长按下面的二维码关注我的微信公众号，谢谢！</strong></p>\n<p><img src=\"http://mmbiz.qpic.cn/mmbiz_jpg/VJsh0SqOtxPlOTGK4uYCNPSK7ADI9xNIfB1ic7Cpmen9fZvzt1ZoBdoiapSQV0fHAHvahBiaO6R2k0OH1Jyx2bHuA/640?wx_fmt=jpeg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1\" alt=\"\" width=\"auto\" data-ratio=\"0.5\" data-s=\"300,640\" data-src=\"http://mmbiz.qpic.cn/mmbiz_jpg/VJsh0SqOtxPlOTGK4uYCNPSK7ADI9xNIfB1ic7Cpmen9fZvzt1ZoBdoiapSQV0fHAHvahBiaO6R2k0OH1Jyx2bHuA/0?wx_fmt=jpeg\" data-type=\"jpeg\" data-w=\"1240\" data-fail=\"0\"></p>\n<p> </p>\n<p><strong>VIP赞赏专区</strong></p>\n<p><img src=\"http://mmbiz.qpic.cn/mmbiz_jpg/VJsh0SqOtxPlOTGK4uYCNPSK7ADI9xNI0nibuKnVBZ8XYPvYggVcaRMJuRwiaiaR1ZAhTcYic1gia9ibgJywZG2NxrJg/640?wx_fmt=jpeg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1\" alt=\"\" width=\"252\" height=\"252\" data-copyright=\"0\" data-ratio=\"1\" data-s=\"300,640\" data-src=\"http://mmbiz.qpic.cn/mmbiz_jpg/VJsh0SqOtxPlOTGK4uYCNPSK7ADI9xNI0nibuKnVBZ8XYPvYggVcaRMJuRwiaiaR1ZAhTcYic1gia9ibgJywZG2NxrJg/0?wx_fmt=jpeg\" data-type=\"jpeg\" data-w=\"1152\" data-fail=\"0\"></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 21:52</span> <a href=\"http://www.cnblogs.com/kid551/\">kid551</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7768720\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7768720);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=204991,cb_entryId=7768720,cb_blogApp=currentBlogApp,cb_blogUserGuid='ea7b0735-223c-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/11/1 21:52:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 279, "image_url": ["https://pic.cnblogs.com/face/672506/20140914231736.png"], "date_pub": "2017-11-01", "article_common": 1}
{"title": "[译]你真的了解外边距折叠吗", "url": "http://www.cnblogs.com/Ghunter/p/7766003.html", "author": "闲鱼~", "article_desc": "译自： \"Collapsing Margins\" 外边距折叠是CSS布局中很小的一个知识点，但是却能够对我们的页面布局产生很大的影响。这篇文章详细介绍了外边距折叠的情况及如何避免，希望能够帮助大家加深理解。水平有限，翻译不当还请指正。 ~文章内容略显啰嗦，可以重点关注代码部分~ 让我们来探究一下外边 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/Ghunter/p/7766003.html\">[译]你真的了解外边距折叠吗</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><blockquote>\n<p>译自：<a href=\"https://www.sitepoint.com/collapsing-margins/\" title=\"https://www.sitepoint.com/collapsing-margins/\">Collapsing Margins</a></p>\n</blockquote>\n<p>外边距折叠是CSS布局中很小的一个知识点，但是却能够对我们的页面布局产生很大的影响。这篇文章详细介绍了外边距折叠的情况及如何避免，希望能够帮助大家加深理解。水平有限，翻译不当还请指正。<br>\n~文章内容略显啰嗦，可以重点关注代码部分~</p>\n<hr>\n<p>让我们来探究一下外边距折叠的结果是什么，它将怎样影响页面上的元素。</p>\n<p><a href=\"http://www.w3.org/TR/CSS21/box.html#collapsing-margins\">W3C规范</a>是这样定义外边距折叠的：</p>\n<blockquote>\n<p>In this specification, the expression collapsing margins means that adjoining margins (no non-empty content, padding, or border areas, or clearance separate them) of two or more boxes (which may be next to one another or nested) combine to form a single margin.</p>\n</blockquote>\n<p>简单说，这个定义表明当垂直方向两个元素的外边距（<em>译</em>：即<code>margin</code>）相接触时，只有<code>margin</code>值较大的会被选用，而<code>margin</code>较小的元素的外边距会被折叠为0。在其中一个元素的<code>margin</code>为负值的情况下，两元素的外边距是两者求和。如果两个元素的外边距都是负值，那么取较小的负值作为最终外边距（如-3px,-5px,取-5px）。这个定义适用于相邻或嵌套的元素上。<br>\n在一些情况下元素的外边距不会折叠：</p>\n<ul>\n<li>浮动元素</li>\n<li>绝对定位元素</li>\n<li>行内块元素</li>\n<li>设置了<code>overflow</code>不为<code>visible</code>的元素（不会与其子元素发生外边距折叠）</li>\n<li><code>cleared</code>元素（上外边距不会与其父块的下外边距折叠。<em>译</em>：此处不太理解，原文是They do not collapse their top margins with their parent block’s bottom margin.）</li>\n<li>根元素</li>\n</ul>\n<p>这是一个很难理解的概念，让我们来看一些例子。</p>\n<h2 id=\"相邻元素间的外边界折叠\">相邻元素间的外边界折叠</h2>\n<p>相邻元素的外边距折叠。简言之，就是文档流（<em>译</em>：normal document flow，国内常译为文档流）中垂直方向相邻的块级元素，只有<code>margin</code>值最大的元素的外边距会被采用，而<code>margin</code>较小的元素的外边距会被折叠为0。例如，如果一个元素的<code>margin-bottom</code>为<code>25px</code>，在其下方相邻的元素的<code>margin-top</code>为<code>20px</code>，那么只有<code>25px</code>的下外边距会被应用，即两元素间的距离为<code>25px</code>，而不是<code>45px</code>（25+20）。<br>\n这个行为最好通过一个简短的例子说明，请看下面的代码：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode css\"><code class=\"sourceCode css\">h1 <span class=\"kw\">{</span>  \n  <span class=\"kw\">margin:</span> <span class=\"dt\">0</span> <span class=\"dt\">0</span> <span class=\"dt\">25px</span> <span class=\"dt\">0</span><span class=\"kw\">;</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#cfc</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\np <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">20px</span> <span class=\"dt\">0</span> <span class=\"dt\">0</span> <span class=\"dt\">0</span><span class=\"kw\">;</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#cf9</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span></code></pre></div>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/Ghunter/1107122/o_1398314844css-box-model_collapsing-margins.png\" alt=\"相邻元素间的外边距折叠\"></p>\n<p>如图1所示，两个元素间的间隙只有<code>25px</code>，较小的外边距被折叠为0。如果上述例子中元素的外边距相等（如，都是20像素），那么两元素间的距离就只是<code>20px</code>。<br>\n有一种情况下会发生轻微的偏差：如果其中一个元素的上或下外边距为负数，那么最终的元素间距为正数与负数的和。下面这个示例展示了这一点：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode css\"><code class=\"sourceCode css\">h1 <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">0</span> <span class=\"dt\">0</span> <span class=\"dt\">25px</span> <span class=\"dt\">0</span><span class=\"kw\">;</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#cfc</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\np <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">-20px</span> <span class=\"dt\">0</span> <span class=\"dt\">0</span> <span class=\"dt\">0</span><span class=\"kw\">;</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#cf9</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span></code></pre></div>\n<p><code>h1</code>元素的下外边距是一个正数（<code>25px</code>），<code>p</code>元素的上外边距是一个负数（<code>-20px</code>），在这种情况下，这两个值将进行求和计算得到最终的间距：<code>25px</code> + (<code>-20px</code>) = <code>5px</code>。<br>\n如果计算的结果是一个负数，将会导致一个元素覆盖另外一个元素。你可能会说负的外边距使元素在相反的方向上生成正的外边距，关于负的外边距的更多信息请查阅外边距。（<em>译</em>：这句话翻译起来实在别扭，自行理解吧，也欢迎你在评论里给出自己的见解）</p>\n<h2 id=\"父子元素间的外边距折叠\">父子元素间的外边距折叠</h2>\n<p>目前为止，我们只讨论了相邻元素间的外边距折叠，但同样的情况适用于外边界接触的父子元素间。这里的接触是指在相邻的<code>margin</code>之间没有<code>padding</code>，<code>border</code>和<code>content</code>。在下面的例子中，一个父元素包含了一个被设置了上外边距的子元素：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode css\"><code class=\"sourceCode css\">h1 <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">0</span><span class=\"kw\">;</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#cff</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\ndiv <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">40px</span> <span class=\"dt\">0</span> <span class=\"dt\">25px</span> <span class=\"dt\">0</span><span class=\"kw\">;</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#cfc</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\np <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">20px</span> <span class=\"dt\">0</span> <span class=\"dt\">0</span> <span class=\"dt\">0</span><span class=\"kw\">;</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#cf9</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span></code></pre></div>\n<p>在上边的样式表中，为<code>p</code>元素声明了一个上外边距，在下边的代码中可以看到<code>p</code>元素是<code>div</code>元素的子元素。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode html\"><code class=\"sourceCode html\"><span class=\"kw\">&lt;h1&gt;</span>Heading Content<span class=\"kw\">&lt;/h1&gt;</span>\n<span class=\"kw\">&lt;div&gt;</span>\n  <span class=\"kw\">&lt;p&gt;</span>Paragraph content<span class=\"kw\">&lt;/p&gt;</span>\n<span class=\"kw\">&lt;/div&gt;</span></code></pre></div>\n<p>图2中可以看到这段代码的结果：<br>\n<img src=\"http://images.cnblogs.com/cnblogs_com/Ghunter/1107122/t_1398314904css-box-model_collapsing-margins2.png\" alt=\"父子元素间的外边距折叠\"></p>\n<p>你可能会认为<code>p</code>元素和<code>h1</code>元素的间距为<code>60px</code>，因为<code>div</code>元素的<code>margin-top</code>是<code>40px</code>，并且<code>p</code>元素的<code>margin-top</code>为<code>20px</code>。你或许也会认为在<code>p</code>元素的上方会有<code>20px</code>的范围展示<code>div</code>元素的背景色。但是如图所示，并非如此，因为发生了外边距折叠，导致只有最大的外边距被应用（和相邻块一样）。<br>\n事实上如果<code>div</code>元素没有上外边距（<em>译</em>：即<code>margin-top</code>为0）并且<code>p</code>元素的<code>margin-top</code>为<code>40px</code>我们会得到相同的结果。<code>p</code>元素的<code>40px</code>上外边距转化成<code>div</code>元素的上外边距，将<code>div</code>元素下移<code>40px</code>，并使<code>p</code>元素紧贴<code>div</code>顶部。在<code>div</code>元素内<code>p</code>元素的上方不会有背景色展示。<br>\n为了使两个元素的外边距都展示，并且使<code>div</code>的背景色展示在<code>p</code>元素的上方，这里需要设置一个<code>border</code>或者<code>padding</code>去阻止外边距折叠。我们简单的为<code>div</code>元素添加一个上边框，就可以得到最初期待的效果：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode css\"><code class=\"sourceCode css\">h1 <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">0</span><span class=\"kw\">;</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#cff</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\ndiv <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">40px</span> <span class=\"dt\">0</span> <span class=\"dt\">25px</span> <span class=\"dt\">0</span><span class=\"kw\">;</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#cfc</span><span class=\"kw\">;</span>\n  <span class=\"kw\">border-top:</span> <span class=\"dt\">1px</span> <span class=\"dt\">solid</span> <span class=\"dt\">#000</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\np <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">20px</span> <span class=\"dt\">0</span> <span class=\"dt\">0</span> <span class=\"dt\">0</span><span class=\"kw\">;</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#cf9</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span></code></pre></div>\n<p>在图3中，我们可以看到<code>div</code>元素与<code>h1</code>元素的距离依旧是<code>40px</code>，但是<code>p</code>元素被下移了<code>20px</code>的距离，因此显示了<code>20px</code>范围的<code>div</code>背景色（通过设置外边框）。<br>\n<img src=\"http://images.cnblogs.com/cnblogs_com/Ghunter/1107122/t_1398314949css-box-model_collapsing-margins3.png\" alt=\"设置border消除外边界折叠\"></p>\n<p>如果我们不希望在设计上展示可见的上边框，<code>1px</code>的上内边距会产生同样的效果。记住<code>border</code>和<code>padding</code>应该应用在父<code>div</code>上，在<code>p</code>元素上不会阻止外边距折叠，因为<code>p</code>元素的<code>margin</code>在<code>border</code>的外面。<br>\n上述示例只讨论了单个父元素和单个子元素外边距接触的情况，同样的处理方式也适用于多重子孙元素（即，嵌套的元素。<em>译</em>：原文是several children，字面意思是多个子元素，但实际指多重嵌套的子孙元素）均含有垂直相邻外边距的情况：即所有的外边距会折叠为一个单独的外边距。虽然上面的示例只提到了上外边距，但同样的效果作用于下外边距，下文会看到。<br>\n在下面的示例中，我们嵌套了四层<code>div</code>元素，每一个都设置了<code>10px</code>的外边距。每个<code>div</code>都设置了不同的背景色，所以我们可以清楚的看到外边距折叠的效果：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode css\"><code class=\"sourceCode css\"><span class=\"fl\">.box</span> <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">10px</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\n<span class=\"fl\">.a</span> <span class=\"kw\">{</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#777</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\n<span class=\"fl\">.b</span> <span class=\"kw\">{</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#999</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\n<span class=\"fl\">.c</span> <span class=\"kw\">{</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#bbb</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\n<span class=\"fl\">.d</span> <span class=\"kw\">{</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#ddd</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span>\n<span class=\"fl\">.e</span> <span class=\"kw\">{</span>\n  <span class=\"kw\">background:</span> <span class=\"dt\">#fff</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span></code></pre></div>\n<p>图4展示了上述 CSS 的结果。<br>\n<img src=\"http://images.cnblogs.com/cnblogs_com/Ghunter/1107122/t_1398314988css-box-model_collapsing-margins4.png\" alt=\"多层嵌套外边距折叠\"></p>\n<p>正如这个例子所示，这段CSS的效果是引人注目的：所有的垂直方向外边距折叠为一个单独的，<code>10px</code>的外边距。不同于水平方向所示的每个外边距都可见，虽然我们为每个元素设置了不同的背景色，但垂直方向并没有展示类似的颜色。整个块将会被放置在距文档流中其他元素<code>10px</code>的位置上，所有嵌套的块的外边距将会折叠成一个。<br>\n如上所述，阻止外边界折叠最简单的方法是为每个元素添加内边距或边框。如果我们希望每个元素间的外边距是<code>10px</code>，可以通过简单的设置一个<code>9px</code>的<code>margin</code>和<code>1px</code>的<code>padding</code>来实现：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode css\"><code class=\"sourceCode css\"><span class=\"fl\">.box</span> <span class=\"kw\">{</span>\n  <span class=\"kw\">margin:</span> <span class=\"dt\">9px</span><span class=\"kw\">;</span>\n  <span class=\"kw\">padding:</span> <span class=\"dt\">1px</span><span class=\"kw\">;</span>\n<span class=\"kw\">}</span></code></pre></div>\n<p>微小的改动会阻止垂直方向上的外边距折叠，效果图5所示。<br>\n<img src=\"http://images.cnblogs.com/cnblogs_com/Ghunter/1107122/t_1398315046css-box-model_collapsing-margins5.png\" alt=\"阻止外边距折叠\"></p>\n<p>当然，考虑IE的兼容性是很重要的。第一个例子（图4）中的元素在IE中会直接展示位图5的效果。另外值得一提的是在IE之外的其他浏览器中，设置<code>overflow</code>为不等于<code>visible</code>的其他值时会产生同样的效果。</p>\n<h2 id=\"总结\">总结</h2>\n<p>尽管外边距折叠给人的第一印象不够直观，但它确实使得多层元素嵌套的情况更加简单，也更令人满意。如果有需要你也可以使用上述简单方式阻止外边距折叠。</p>\n<hr>\n<p>那么，现在你真的读懂外边距折叠了吗？不如我们来做个小小的测试吧。对A,B,C三个块级元素分别设置<code>margin</code>如下图所示，请问：</p>\n<ol>\n<li>把B和C同时放到A中，BC间距是多少？<br>\n</li>\n<li>基于问题1，把B的<code>margin</code>改为<code>-30px</code>呢？<br>\n</li>\n<li>基于问题1，把BC的<code>margin</code>均取负数呢？<br>\n</li>\n<li>把B放入A内，C放入B内时，ABC的位置是怎样的？<br>\n</li>\n<li>基于问题4，B的<code>margin</code>为<code>-30px</code>呢？</li>\n</ol>\n<p><img src=\"http://images.cnblogs.com/cnblogs_com/Ghunter/1107122/o_QQ%E6%88%AA%E5%9B%BE20171101224413.png\"></p>\n<p>实践出真知，不确定答案的同学还是亲自动手试试吧:)</p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 23:09</span> <a href=\"http://www.cnblogs.com/Ghunter/\">闲鱼~</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766003\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766003);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=193454,cb_entryId=7766003,cb_blogApp=currentBlogApp,cb_blogUserGuid='2764e31c-b618-e411-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/11/1 23:09:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 179, "image_url": ["https://pic.cnblogs.com/face/658296/20140731213526.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "FastDFS 集群 安装 配置", "url": "http://www.cnblogs.com/ityouknow/p/7769142.html", "author": "纯洁的微笑", "article_desc": "这篇文章介绍如何搭建FastDFS 集群 FastDFS是一个开源的轻量级分布式文件系统，它对文件进行管理，功能包括：文件存储、文件同步、文件访问（文件上传、文件下载）等，解决了大容量存储和负载均衡的问题。特别适合以文件为载体的在线服务，如相册网站、视频网站等等。 FastDFS为互联网量身定制，充 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/ityouknow/p/7769142.html\">FastDFS 集群 安装 配置</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>这篇文章介绍如何搭建FastDFS 集群</p>\n<p>FastDFS是一个开源的轻量级分布式文件系统，它对文件进行管理，功能包括：文件存储、文件同步、文件访问（文件上传、文件下载）等，解决了大容量存储和负载均衡的问题。特别适合以文件为载体的在线服务，如相册网站、视频网站等等。</p>\n<p>FastDFS为互联网量身定制，充分考虑了冗余备份、负载均衡、线性扩容等机制，并注重高可用、高性能等指标，使用FastDFS很容易搭建一套高性能的文件服务器集群提供文件上传、下载等服务。<br>\n<br></p>\n<h2 id=\"环境准备\">环境准备</h2>\n<p>系统系统 centos6.5<br>\n六台服务器：192.168.53.85/86/90<br>\n192.168.54.73/74/75<br>\n安装包：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">fastdfs-5.05.tar.gz</span>\n<span class=\"kw\">libfastcommon-1.0.36.zip</span>\n<span class=\"kw\">nginx-1.7.9.tar.gz</span></code></pre></div>\n<p>服务器规划</p>\n<p>tracker服务器：192.168.53.85/86<br>\nstorage服务器：192.168.53.90<br>\n192.168.54.73/74/75<br>\n<br><br>\n<br></p>\n<h2 id=\"安装fastdfs全部\">安装Fastdfs(全部)</h2>\n<p>安装依赖包</p>\n<blockquote>\n<p>注意：FastDFS 5.x 取消了对 libevent 的依赖，添加了对 libfastcommon 的依赖。</p>\n</blockquote>\n<ul>\n<li>在安装FastDFS和Nginx之前，需确保gcc、gcc-c++、 libstdc++-devel、make等依赖库和工具已经安装</li>\n</ul>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"co\">#安装依赖软件</span>\n<span class=\"kw\">yum</span> -y install gcc gcc-c++ libstdc++-devel pcre-devel zlib-devel wget make\n<span class=\"kw\">yum</span> -y groupinstall <span class=\"st\">'Development Tools'</span> </code></pre></div>\n<p>安装libfastcommon类库</p>\n<p>安装FastDFS必须先安装libfastcommon类库，否则会导致报错，安装直接根据如下几个步骤即可~</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">unzip</span> libfastcommon-1.0.36.zip  -d /usr/local\n\n<span class=\"kw\">cd</span> /usr/local/libfastcommon-1.0.36\n<span class=\"kw\">./make.sh</span>\n<span class=\"kw\">./make.sh</span> install</code></pre></div>\n<p>安装FastDFS</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">tar</span> -xvzf fastdfs-5.05.tar.gz -C /usr/local\n\n<span class=\"kw\">cd</span> /usr/local/fastdfs-5.05\n<span class=\"kw\">./make.sh</span>\n<span class=\"kw\">./make.sh</span> install</code></pre></div>\n<p>安装好之后，在/usr/bin目录下，可以看fdfs开头的命令工具</p>\n<blockquote>\n<p>FastDFS安装完成之后，所有配置文件在/etc/fdfs目录下，tracker需要tracker.conf配置文件，storage需要storage.conf配置文件。</p>\n</blockquote>\n<p><br></p>\n<h2 id=\"安装tracker8586\">安装tracker（85/86）</h2>\n<p>将tracker.conf.sample文件重命名为tracker.conf，然后修改配置文件/etc/fdfs/tracker.conf</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"co\"># 存储日志和数据的根目录</span>\n<span class=\"kw\">mkdir</span> /root/fastdfs\n\n<span class=\"kw\">cd</span> /etc/fdfs\n<span class=\"kw\">cp</span> tracker.conf.sample tracker.conf</code></pre></div>\n<p>只需要修改 base_pash路径（文件存储路径）</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">vi</span> tracker.conf\n<span class=\"ot\">base_path=</span>/root/fastdfs</code></pre></div>\n<p>配置文件中有这几个参数需要注意：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"co\">#启用配置文件</span>\n<span class=\"ot\">disabled=</span>false\n<span class=\"co\">#设置tracker的端口号</span>\n<span class=\"ot\">port=</span>22122\n<span class=\"co\">#设置tracker的数据文件和日志目录（需手动创建）</span>\n<span class=\"ot\">base_path=</span>/root/fastdfs\n<span class=\"co\">#设置http端口号</span>\n<span class=\"kw\">http.server_port</span>=9090</code></pre></div>\n<p>使用<code>/usr/bin/fdfs_trackerd /etc/fdfs/tracker.conf start</code>尝试启动tracker</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">[<span class=\"kw\">root@localhost</span> ~]# fdfs_trackerd /etc/fdfs/tracker.conf restart\n[<span class=\"kw\">root@localhost</span> ~]# </code></pre></div>\n<p>没有报错，查看端口22122是否开始监听，确认启动是否成功。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">[<span class=\"kw\">root@localhost</span> ~]# ps -ef<span class=\"kw\">|grep</span> fdfs\n<span class=\"kw\">root</span>      6078     1  0 11:59 ?        00:00:00 /usr/bin/fdfs_trackerd /etc/fdfs/tracker.conf start\n<span class=\"kw\">root</span>      6101  6054  0 12:01 pts/2    00:00:00 grep fdfs\n[<span class=\"kw\">root@localhost</span> ~]# netstat -unltp <span class=\"kw\">|</span> <span class=\"kw\">grep</span> fdfs\n<span class=\"kw\">tcp</span>        0      0 0.0.0.0:22122               0.0.0.0:*                   LISTEN      6078/fdfs_trackerd  </code></pre></div>\n<p>也可以查看tracker的日志是否启动成功</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">[<span class=\"kw\">root@localhost</span> ~]# cat /root/fastdfs/logs/trackerd.log \n[<span class=\"kw\">2017-10-09</span> 11:59:12] INFO - FastDFS v5.05, base_path=/root/fastdfs, run_by ...</code></pre></div>\n<p>至此，一个简单的的tracker配置就完成了，Tracker也成功启动~， 接下来要做的就是完成Storage的配置~</p>\n<p><br></p>\n<h2 id=\"安装storage90737475\">安装storage（90/73/74/75）</h2>\n<p>将存储节点分为两个组，其中group1 （72、73）、group2 （74、75）。</p>\n<p>创建存储目录和配置文件</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">mkdir</span> /root/fastdfs\n\n<span class=\"kw\">cd</span> /etc/fdfs\n<span class=\"kw\">cp</span> storage.conf.sample storage.conf</code></pre></div>\n<p>修改配置</p>\n<p>storage主要完成base_path，store_path以及tracker的连接地址以及storage的http服务端口配置等。</p>\n<p>主要有如下几个参数：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">vi</span> /etc/fdfs/storage.conf\n<span class=\"co\"># 内容</span>\n<span class=\"ot\">group_name=</span>group1                   <span class=\"co\"># 组名（第一组为group1，第二组为group2，依次类推...）</span>\n<span class=\"ot\">base_path=</span>/root/fastdfs             <span class=\"co\"># 数据和日志文件存储根目录</span>\n<span class=\"ot\">store_path0=</span>/root/fastdfs           <span class=\"co\">#第一个存储目录，第二个存储目录起名为：store_path1=xxx，其它存储目录名依次类推...</span>\n<span class=\"ot\">store_path_count=</span>1                  <span class=\"co\"># 存储路径个数，需要和store_path个数匹配</span>\n<span class=\"ot\">tracker_server=</span>192.168.53.85:22122          <span class=\"co\"># tracker服务器IP和端口</span>\n<span class=\"ot\">tracker_server=</span>192.168.53.86:22122          <span class=\"co\"># tracker服务器IP和端口</span></code></pre></div>\n<p>启动Storage</p>\n<blockquote>\n<p>启动storage，会根据配置文件的设置自动创建多级存储目录，查看端口23000是否开始监听，确认启动是否成功。</p>\n</blockquote>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">[<span class=\"kw\">root@localhost</span> fdfs]# fdfs_storaged /etc/fdfs/storage.conf restart\n[<span class=\"kw\">root@localhost</span> fdfs]# netstat -unltp <span class=\"kw\">|</span> <span class=\"kw\">grep</span> fdfs\n<span class=\"kw\">tcp</span>        0      0 0.0.0.0:23000               0.0.0.0:*                   LISTEN      5551/fdfs_storaged  </code></pre></div>\n<p>也可以查看storage的日志是否启动成功。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">[<span class=\"kw\">root@localhost</span> logs]# cat /root/fastdfs/logs/storaged.log \n[<span class=\"kw\">2017-10-09</span> 15:39:12] INFO - FastDFS v5.05, base_path=/root/fastdfs, store_path_count=1 ...</code></pre></div>\n<p>验证storage是否登记到tracker服务器</p>\n<p>使用<code>fdfs_monitor /etc/fdfs/storage.conf</code>，运行fdfs_monitor查看storage服务器是否已经登记到tracker服务器。</p>\n<blockquote>\n<p>可以在任一存储节点上使用如下命令查看集群的状态信息</p>\n</blockquote>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">fdfs_monitor</span> /etc/fdfs/storage.conf</code></pre></div>\n<p>如果出现ip_addr = <ip> Active, 则表明storage服务器已经登记到tracker服务器，如下：</ip></p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">Storage</span> 1:\n        <span class=\"kw\">id</span> = 192.168.53.90\n        <span class=\"kw\">ip_addr</span> = 192.168.53.90 (localhost)  <span class=\"kw\">ACTIVE</span></code></pre></div>\n<p>至此，tracker、storage等配置都完成并成功启动</p>\n<p>接下来，继续完成Nginx和fastdfs-nginx-module的安装和配置</p>\n<p><br><br></p>\n<h2 id=\"在storage上安装nginx\">在storage上安装nginx</h2>\n<blockquote>\n<p>注意：fastdfs-nginx-module模块只需要安装到storage上。</p>\n</blockquote>\n<p><br></p>\n<h3 id=\"安装\">安装</h3>\n<p>解压安装包</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">tar</span> -xvzf fastdfs-nginx-module_v1.16.tar.gz -C /usr/local\n<span class=\"kw\">tar</span> -zvxf nginx-1.7.9.tar.gz  -C /usr/local</code></pre></div>\n<p>需要先配置软链接:</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">ln</span> -sv /usr/include/fastcommon /usr/local/include/fastcommon \n<span class=\"kw\">ln</span> -sv /usr/include/fastdfs /usr/local/include/fastdfs \n<span class=\"kw\">ln</span> -sv /usr/lib64/libfastcommon.so /usr/local/lib/libfastcommon.so</code></pre></div>\n<blockquote>\n<p>安装nginx的时候，添加 fastdfs-nginx-module-master模块，如：<br>\n<code>./configure --add-module=../fastdfs-nginx-module/src/</code></p>\n</blockquote>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">cd</span> /usr/local/nginx-1.7.9\n<span class=\"kw\">./configure</span> --prefix=/usr/local/nginx --add-module=/usr/local/fastdfs-nginx-module/src</code></pre></div>\n<p>configure 成功输出结果：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">checking</span> for OS\n <span class=\"kw\">+</span> Linux 2.6.32-431.el6.x86_64 x86_64\n<span class=\"kw\">checking</span> for C compiler ... found\n <span class=\"kw\">+</span> using GNU C compiler\n <span class=\"kw\">+</span> gcc version: 4.4.7 20120313 (Red Hat 4.4.7-18) <span class=\"kw\">(GCC)</span> \n<span class=\"kw\">checking</span> for gcc -pipe switch ... found\n\n<span class=\"kw\">......</span>\n\n<span class=\"kw\">nginx</span> http access log file: <span class=\"st\">\"/usr/local/nginx/logs/access.log\"</span>\n<span class=\"kw\">nginx</span> http client request body temporary files: <span class=\"st\">\"client_body_temp\"</span>\n<span class=\"kw\">nginx</span> http proxy temporary files: <span class=\"st\">\"proxy_temp\"</span>\n<span class=\"kw\">nginx</span> http fastcgi temporary files: <span class=\"st\">\"fastcgi_temp\"</span>\n<span class=\"kw\">nginx</span> http uwsgi temporary files: <span class=\"st\">\"uwsgi_temp\"</span>\n<span class=\"kw\">nginx</span> http scgi temporary files: <span class=\"st\">\"scgi_temp\"</span> </code></pre></div>\n<p>configure成功了</p>\n<p>接下来执行make和make install</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">make</span></code></pre></div>\n<p>确定编译没有出错，再进行install</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">make</span> install </code></pre></div>\n<p>安装成功，查看版本信息</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">/usr/local/nginx/sbin/nginx</span> -V</code></pre></div>\n<p><br></p>\n<h3 id=\"配置\">配置</h3>\n<p><strong>配置fastdfs-nginx-module</strong></p>\n<p>进入fastdfs-nginx-module的src目录，将md_fastdfs.conf配置文件拷贝到/etc/fdfs/目录中</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">cd</span> /usr/local/fastdfs-nginx-module/src\n<span class=\"kw\">cp</span> mod_fastdfs.conf /etc/fdfs/</code></pre></div>\n<p>配置 mod_fastdfs.conf</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">vim</span> /etc/fdfs/mod_fastdfs.conf</code></pre></div>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">一般只需改动以下几个参数即可：\n<span class=\"ot\">base_path=</span>/root/fastdfs           <span class=\"co\">#保存日志目录</span>\n<span class=\"ot\">tracker_server=</span>192.168.53.85:22122\n<span class=\"ot\">tracker_server=</span>192.168.53.86:22122 \n<span class=\"ot\">storage_server_port=</span>23000         <span class=\"co\">#storage服务器的端口号</span>\n<span class=\"ot\">group_name=</span>group1                 <span class=\"co\">#当前服务器的group名</span>\n<span class=\"kw\">url_have_group_name</span> = true        <span class=\"co\">#文件url中是否有group名</span>\n<span class=\"ot\">store_path_count=</span>1                <span class=\"co\">#存储路径个数，需要和store_path个数匹配</span>\n<span class=\"ot\">store_path0=</span>/root/fastdfs         <span class=\"co\">#存储路径</span>\n<span class=\"kw\">group_count</span> = 2                   <span class=\"co\">#设置组的个数</span></code></pre></div>\n<p>在末尾增加3个组的具体信息：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">[<span class=\"kw\">group1</span>]\n<span class=\"ot\">group_name=</span>group1\n<span class=\"ot\">storage_server_port=</span>23000\n<span class=\"ot\">store_path_count=</span>1\n<span class=\"ot\">store_path0=</span>/root/fastdfs\n\n[<span class=\"kw\">group2</span>]\n<span class=\"ot\">group_name=</span>group2\n<span class=\"ot\">storage_server_port=</span>23000\n<span class=\"ot\">store_path_count=</span>1\n<span class=\"ot\">store_path0=</span>/root/fastdfs</code></pre></div>\n<p>建立M00至存储目录的符号连接。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">ln</span> -s /root/fastdfs/data /root/fastdfs/data/M00\n<span class=\"kw\">ll</span> /root/fastdfs/data/M00</code></pre></div>\n<p><br><br>\n<strong>配置nginx</strong></p>\n<p>编辑<code>/usr/local/nginx/conf</code>配置文件目录下的nginx.conf，设置添加storage信息并保存。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">vim</span> /usr/local/nginx/conf/nginx.conf</code></pre></div>\n<p>将server段中的listen端口号改为8080，启动用户使用root。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">user</span> root\n<span class=\"kw\">listen</span>       8080<span class=\"kw\">;</span></code></pre></div>\n<p>在server段中添加：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">location</span> ~/group[1-2]/M00 {\n    <span class=\"kw\">root</span> /root/fastdfs/data<span class=\"kw\">;</span>\n    <span class=\"kw\">ngx_fastdfs_module;</span>\n}</code></pre></div>\n<p>复制fastdfs中的http.conf、mime.types文件到/etc/fdfs</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">cp</span> /usr/local/fastdfs-5.05/conf/http.conf /usr/local/fastdfs-5.05/conf/mime.types  /etc/fdfs</code></pre></div>\n<p>至此，nginx以及FastDFS插件模块设置完成。<br>\n<br></p>\n<h3 id=\"运行\">运行</h3>\n<p>运行nginx之前，先要把防火墙中对应的端口打开（本例中为8080）。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">iptables</span> -I INPUT -p tcp -m state --state NEW -m tcp --dport 8080 -j ACCEPT\n<span class=\"kw\">/etc/init.d/iptables</span> save</code></pre></div>\n<p>启动nginx，确认启动是否成功。（查看是否对应端口8080是否开始监听）</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">[<span class=\"kw\">root@localhost</span> ~]# /usr/local/nginx/sbin/nginx\n<span class=\"kw\">ngx_http_fastdfs_set</span> pid=12768\n[<span class=\"kw\">root@localhost</span> ~]# netstat -unltp <span class=\"kw\">|</span> <span class=\"kw\">grep</span> nginx\n<span class=\"kw\">tcp</span>        0      0 0.0.0.0:8080                0.0.0.0:*                   LISTEN      12769/nginx  </code></pre></div>\n<p>也可查看nginx的日志是否启动成功或是否有错误。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">cat</span> /usr/local/nginx/logs/error.log</code></pre></div>\n<p>在error.log中没有错误，既启动成功。可以打开浏览器，直接访问http://192.168.53.90:8080，查看是否弹出nginx欢迎页面。</p>\n<p>查看到欢迎页则说明，nginx运行成功。之后依次在其它storage上全部安装上nginx并确认运行正常。</p>\n<p>将nginx设置为开机启动：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">vim</span> /etc/rc.d/rc.local</code></pre></div>\n<p>将运行命令行添加进文件：<code>/usr/local/nginx/sbin/nginx</code></p>\n<p><br><br></p>\n<h2 id=\"在tracker上安装nginx\">在tracker上安装nginx</h2>\n<p>在tracker上安装的nginx主要为了提供http访问的反向代理、负载均衡以及缓存服务。<br>\n<br></p>\n<h3 id=\"安装-1\">安装</h3>\n<p>解压</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">tar</span> -zvxf nginx-1.7.9.tar.gz  -C /usr/local</code></pre></div>\n<p>运行./configure进行安装前的设置，主要设置安装路径</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">cd</span> /usr/local/nginx-1.7.9\n<span class=\"kw\">./configure</span> --prefix=/usr/local/nginx</code></pre></div>\n<p>运行make进行编译，确保编译成功。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">make</span></code></pre></div>\n<p>运行make install进行安装。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">make</span> install</code></pre></div>\n<p><br></p>\n<h3 id=\"配置-1\">配置</h3>\n<p>编辑/usr/local/nginx/conf配置文件目录下的nginx.conf，设置负载均衡</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">vim</span> /usr/local/nginx/conf/nginx.conf</code></pre></div>\n<p>配置信息</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">worker_processes</span>  4<span class=\"kw\">;</span>                  <span class=\"co\">#根据CPU核心数而定</span>\n<span class=\"kw\">events</span> {\n    <span class=\"kw\">worker_connections</span>  65535<span class=\"kw\">;</span>        <span class=\"co\">#最大链接数</span>\n    <span class=\"kw\">use</span> epoll<span class=\"kw\">;</span>                        <span class=\"co\">#新版本的Linux可使用epoll加快处理性能</span>\n}\n<span class=\"kw\">http</span> {\n    <span class=\"co\">#设置group1的服务器</span>\n    <span class=\"kw\">upstream</span> fdfs_group1 {\n        <span class=\"kw\">server</span> 192.168.53.90:8080 weight=1 max_fails=2 fail_timeout=30s<span class=\"kw\">;</span>\n        <span class=\"kw\">server</span> 192.168.54.229:8080 weight=1 max_fails=2 fail_timeout=30s<span class=\"kw\">;</span>\n    }\n    <span class=\"co\">#设置group2的服务器</span>\n    <span class=\"kw\">upstream</span> fdfs_group2 {\n        <span class=\"kw\">server</span> 192.168.54.233:8080 weight=1 max_fails=2 fail_timeout=30s<span class=\"kw\">;</span>\n        <span class=\"kw\">server</span> 192.168.54.234:8080 weight=1 max_fails=2 fail_timeout=30s<span class=\"kw\">;</span>\n    }\n\n   <span class=\"kw\">server</span> {\n       <span class=\"co\">#设置服务器端口</span>\n        <span class=\"kw\">listen</span>       8080<span class=\"kw\">;</span>\n       <span class=\"co\">#设置group1的负载均衡参数</span>\n        <span class=\"kw\">location</span> /group1/M00 {\n            <span class=\"kw\">proxy_pass</span> http://fdfs_group1<span class=\"kw\">;</span>\n        }\n        <span class=\"co\">#设置group2的负载均衡参数</span>\n        <span class=\"kw\">location</span> /group2/M00 {\n            <span class=\"kw\">proxy_pass</span> http://fdfs_group2<span class=\"kw\">;</span>\n        }\n      }\n\n    }</code></pre></div>\n<p>至此，nginx设置完成。<br>\n<br></p>\n<h3 id=\"运行-1\">运行</h3>\n<p>运行nginx之前，先要把防火墙中对应的端口打开（本例中为8080）</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">iptables</span> -I INPUT -p tcp -m state --state NEW -m tcp --dport 8080 -j ACCEPT\n<span class=\"kw\">/etc/init.d/iptables</span> save</code></pre></div>\n<p>启动nginx，确认启动是否成功。（查看是否对应端口8080是否开始监听）</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">[<span class=\"kw\">root@localhost</span> ~]# /usr/local/nginx/sbin/nginx\n<span class=\"kw\">ngx_http_fastdfs_set</span> pid=12768\n[<span class=\"kw\">root@localhost</span> ~]# netstat -unltp <span class=\"kw\">|</span> <span class=\"kw\">grep</span> nginx\n<span class=\"kw\">tcp</span>        0      0 0.0.0.0:8080                0.0.0.0:*                   LISTEN      12769/nginx  </code></pre></div>\n<p>也可查看nginx的日志是否启动成功或是否有错误。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">cat</span> /usr/local/nginx/logs/error.log</code></pre></div>\n<p>尝试上传一个文件到FastDFS，然后访问试试。先配置client.conf文件。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">cp</span> client.conf.sample  client.conf\n<span class=\"kw\">vim</span> /etc/fdfs/client.conf</code></pre></div>\n<p>修改以下参数：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"ot\">base_path=</span>/root/fastdfs                   <span class=\"co\">#日志存放路径</span>\n<span class=\"ot\">tracker_server=</span>192.168.53.85:22122         \n<span class=\"ot\">tracker_server=</span>192.168.53.86:22122 \n<span class=\"kw\">http.tracker_server_port</span>=8080</code></pre></div>\n<p>使用/usr/local/bin/fdfs_upload_file上传一个文件，程序会自动返回文件的URL。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">[<span class=\"kw\">root@localhost</span> fdfs]# fdfs_upload_file /etc/fdfs/client.conf /root/test.jpg\n<span class=\"kw\">group2/M00/00/00/wKg26VncfamAEqZ0AAu-4Kcs3QI677.jpg</span></code></pre></div>\n<p>然后使用浏览器访问:</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">http</span>://192.168.53.85:8080/group2/M00/00/00/wKg26VncfamAEqZ0AAu-4Kcs3QI677.jpg</code></pre></div>\n<p>看有查看到图片,说明集群搭建成功！</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/neo.jpg\"></p>\n<blockquote>\n<p>生产中可以将：<code>/root/fastdfs</code> 替换为：<code>/fdfs/storage</code></p>\n</blockquote>\n<p><br><br></p>\n<h2 id=\"报错\">报错</h2>\n<h3 id=\"编译nginx的时候报错\">编译nginx的时候报错</h3>\n<p>在nginx目录下，执行configure之后，进行make编译报错，报错内容如下：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">s</span> -I src/mail \\\n                -o objs/addon/src/ngx_http_fastdfs_module.o \\\n                /usr/local/fastdfs-nginx-module/src/ngx_http_fastdfs_module.c\n<span class=\"kw\">In</span> file included from /usr/local/fastdfs-nginx-module/src/ngx_http_fastdfs_module.c:6:\n<span class=\"kw\">/usr/local/fastdfs-nginx-module/src</span>/common.c:<span class=\"kw\">21</span>:25: error: fdfs_define.h: No such file or directory\n\n<span class=\"kw\">......</span>\n\n<span class=\"kw\">/usr/local/fastdfs-nginx-module/src</span>/ngx_http_fastdfs_module.c:<span class=\"kw\">933</span>: error: ‘true’ undeclared (first use in this function)\n<span class=\"kw\">make</span>[1]: *** [objs/addon/src/ngx_http_fastdfs_module.o] Error 1\n<span class=\"kw\">make</span>[1]: Leaving directory <span class=\"kw\">`/usr/local/nginx-1.7.9</span><span class=\"st\">'</span>\n<span class=\"st\">make: *** [build] Error 2</span></code></pre></div>\n<p>做以下修改</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">vim</span> /usr/local/fastdfs-nginx-module/src/config</code></pre></div>\n<p>将、</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"ot\">CORE_INCS=</span><span class=\"st\">\"</span><span class=\"ot\">$CORE_INCS</span><span class=\"st\"> /usr/local/include/fastdfs /usr/local/include/fastcommon/\"</span></code></pre></div>\n<p>修改为：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"ot\">CORE_INCS=</span><span class=\"st\">\"</span><span class=\"ot\">$CORE_INCS</span><span class=\"st\"> /usr/include/fastdfs /usr/local/include/fastcommon/\"</span></code></pre></div>\n<p>其实就是改动了fastdfs的路径，没改之前直接访问<code>cd /usr/local/include/fastdfs</code>为空目录。</p>\n<p>或者设置对应的软连接也可以。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">ln</span> -sv /usr/include/fastcommon /usr/local/include/fastcommon \n<span class=\"kw\">ln</span> -sv /usr/include/fastdfs /usr/local/include/fastdfs \n<span class=\"kw\">ln</span> -sv /usr/lib64/libfastcommon.so /usr/local/lib/libfastcommon.so</code></pre></div>\n<p>修改完成之后在nginx目录，重新configure和make就好了。</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">./configure</span> --prefix=/usr/local/nginx --add-module=/usr/local/fastdfs-nginx-module/src\n<span class=\"kw\">make</span></code></pre></div>\n<p><br></p>\n<h3 id=\"启动nginx报错\">启动nginx报错</h3>\n<p>在在storage上配置nginx相关信息后启动nginx，查看日志发现报错：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">cat</span> /usr/local/nginx/logs/error.log\n<span class=\"kw\">ngx_http_fastdfs_process_init</span> pid=12770\n[<span class=\"kw\">2017-10-10</span> 13:41:44] ERROR - file: ini_file_reader.c, line: 631, include file <span class=\"st\">\"http.conf\"</span> not exists, line: <span class=\"st\">\"#include http.conf\"</span>\n[<span class=\"kw\">2017-10-10</span> 13:41:44] ERROR - file: /usr/local/fastdfs-nginx-module/src/common.c, line: 155, load conf file <span class=\"st\">\"/etc/fdfs/mod_fastdfs.conf\"</span> fail, ret code: 2\n<span class=\"kw\">2017/10/10</span> 13:41:44 [alert] 12769#0: worker process 12770 exited with fatal code 2 and cannot be respawned</code></pre></div>\n<p>解决方案：</p>\n<p>复制fastdfs中的http.conf、mime.types文件到/etc/fdfs</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">cp</span> /usr/local/fastdfs-5.05/conf/http.conf /usr/local/fastdfs-5.05/conf/mime.types  /etc/fdfs</code></pre></div>\n<p>然后重启nginx</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">killall</span> nginx\n<span class=\"kw\">/usr/local/nginx/sbin/nginx</span></code></pre></div>\n<p>查看日志，还报错：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\">[<span class=\"kw\">root@localhost</span> logs]# cat /usr/local/nginx/logs/error.log\n<span class=\"kw\">ngx_http_fastdfs_process_init</span> pid=12813\n[<span class=\"kw\">2017-10-10</span> 14:05:33] ERROR - file: /usr/local/fastdfs-nginx-module/src/common.c, line: 180, config file: /etc/fdfs/mod_fastdfs.conf, you must set url_have_group_name to true to support multi-group!\n<span class=\"kw\">2017/10/10</span> 14:05:33 [alert] 12812#0: worker process 12813 exited with fatal code 2 and cannot be respawned</code></pre></div>\n<p>解决方案：</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">vim</span>  /etc/fdfs/mod_fastdfs.conf</code></pre></div>\n<p>将</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"ot\">url_have_group_name=</span>false</code></pre></div>\n<p>改为</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"ot\">url_have_group_name=</span>true </code></pre></div>\n<p>重启正常</p>\n<p><br></p>\n<h3 id=\"测试图片无法访问\">测试图片无法访问</h3>\n<p>搭建完成之后，访问<code>http://192.168.53.85:8080/group2/M00/00/00/wKg26VncfamAEqZ0AAu-4Kcs3QI677.jpg</code><br>\n地址图片总是报404无法找到，跟踪到storage服务器，查看nginx的error日志发现如下；</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">ERROR</span> - file: /usr/local/fastdfs-nginx-module/src/common.c, line: 877, stat file: /root/fastdfs/data/00/00/wKg1Wlnchn2AOo0kAAu-4Kcs3QI239.jpg fail, errno: 13, error info: Permission denied</code></pre></div>\n<p>原因是nginx启动的时候默认会以nobody用户来启动，这样的话就权限访问<code>/root/fastdfs/data</code>的权限</p>\n<p>修改这个问题有两个版本，第一个方案设置nginx以root身份启动，或者设置nobody用户权限可以访问<code>/root/fastdfs/data</code>地址。这里只展示第一种方案的修改</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span class=\"kw\">vim</span> /usr/local/nginx/conf/nginx.conf\n<span class=\"co\"># 修改nobody为root</span>\n<span class=\"kw\">user</span> root</code></pre></div>\n<p>重启nginx后问题解决</p>\n<p><strong>这里有一个网友整理的word版本的安装配置文档，包括缓存各方面的内容比较全面，需要的朋友在公众号回复：“fastdfs”</strong><br>\n<br><br>\n参考：</p>\n<p><a href=\"https://my.oschina.net/wangmengjun/blog/1142982\">CentOS上安装分布式文件系统FastDFS &amp; 配置和问题</a></p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 23:35</span> <a href=\"http://www.cnblogs.com/ityouknow/\">纯洁的微笑</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7769142\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7769142);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=96952,cb_entryId=7769142,cb_blogApp=currentBlogApp,cb_blogUserGuid='44ce118c-0edc-e011-8ee0-842b2b196315',cb_entryCreatedDate='2017/11/1 23:35:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 284, "image_url": ["https://pic.cnblogs.com/face/331425/20130328094900.png"], "date_pub": "2017-11-01", "article_common": 2}
{"title": "RabbitMQ使用详解", "url": "http://www.cnblogs.com/enjoyall/p/7767462.html", "author": "泥粑", "article_desc": "\r\n    刚刚用了，记录下来，以后忘了，方便能够快速想起来。 首先说明，由于RabbitMQ服务端非JAVA,C++语言，当然也就看不懂，所以本文的理解都是过于主观的。 一，RabbitMQ服务端搭建 推荐最好的安装方式：去官网，去官网，去官网，重要的事情说三遍。 我一般的操作流程是：用google右上角翻译 ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<div class=\"post\">\r\n\t<h1 class=\"postTitle\"><a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/enjoyall/p/7767462.html\">RabbitMQ使用详解</a></h1>\r\n\t<div id=\"cnblogs_post_body\"><p>刚刚用了，记录下来，以后忘了，方便能够快速想起来。</p>\n<p>首先说明，由于RabbitMQ服务端非JAVA,C++语言，当然也就看不懂，所以本文的理解都是过于主观的。</p>\n<ul>\n<li><strong>一，RabbitMQ服务端搭建</strong></li>\n</ul>\n<p>　　　　推荐最好的安装方式：去官网，去官网，去官网，重要的事情说三遍。</p>\n<p>　　　　我一般的操作流程是：用google右上角翻译网页，然后看个大概意思，然后再显示原网页，一个单词单词的看。</p>\n<p>　　　　还是总结一下Ubuntu,RabbitMQ安装步骤（依次执行下面四条命令就ok了）：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #800080\">1</span>，<span style=\"color: #0000ff\">echo</span> <span style=\"color: #800000\">'</span><span style=\"color: #800000\">deb http://www.rabbitmq.com/debian/ testing main</span><span style=\"color: #800000\">'</span> |\n     <span style=\"color: #0000ff\">sudo</span> <span style=\"color: #0000ff\">tee</span> /etc/apt/sources.list.d/<span style=\"color: #000000\">rabbitmq.list\n</span><span style=\"color: #800080\">2</span>，<span style=\"color: #0000ff\">wget</span> -O- https:<span style=\"color: #008000\">//</span><span style=\"color: #008000\">www.rabbitmq.com/rabbitmq-release-signing-key.asc |</span>\n     <span style=\"color: #0000ff\">sudo</span> apt-key add -\n<span style=\"color: #800080\">3</span>，<span style=\"color: #0000ff\">sudo</span> apt-<span style=\"color: #000000\">get update\n</span><span style=\"color: #800080\">4</span>，<span style=\"color: #0000ff\">sudo</span> apt-get <span style=\"color: #0000ff\">install</span> rabbitmq-server</pre>\n</div>\n<ul>\n<li><strong>二，服务端基本配置</strong></li>\n</ul>\n<p><strong>　　　　</strong>服务端配置，基本上不需要配置就能满足大多数需求。官网如是说，且相信他一次　　　</p>\n<p>　　　　<strong>2.1 界面管理插件的安装</strong></p>\n<p>　　　　先说一下ubuntu目录下面的日志目录，与脚本目录，一般这是我们最关心的目录：</p>\n<p>　　　　1,日志目录: /var/log/robbitmq-server 可以通过/etc/logrotate.d/rabbitmq-server进行配置<br>　　　　2,脚本目录:/usr/lib/rabbitmq/bin/</p>\n<p>　　　　然后进入到脚本目录也就是（cd /usr/lib/rabbitmq/bin/），执行如下命令</p>\n<div class=\"cnblogs_code\">\n<pre>      rabbitmq-plugins enable rabbitmq_management</pre>\n</div>\n<p>　　　　这样管理插件算是装好了。</p>\n<p>　　　　<strong>2.2 用户管理</strong></p>\n<p>　　　　通过http://localhost:15672登录会发现（默认用户guest,密码也是guest），认证失败(登录失败去日志文件查找原因)。</p>\n<p>　　　　然后自然需要授权了，给一个授权的命令demo，详情自行脑补:　　　</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">     #username就是用户名，可以随便取，pwd就是你要设置的密码\n     rabbitmqctl add_user username </span><span style=\"color: #0000ff\">pwd</span><span style=\"color: #000000\">\n     #administrator为用户的角色，与tomcat那种管理员配置有点像\n     rabbitmqctl set_user_tags username administrator\n     #授予权限  </span>/代表vhost主机根目录，后面的*<span style=\"color: #000000\">j就是读写之类的权限\n     rabbitmqctl set_permissions </span>-p / username <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">.*</span><span style=\"color: #800000\">\"</span> <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">.*</span><span style=\"color: #800000\">\"</span> <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">.*</span><span style=\"color: #800000\">\"</span></pre>\n</div>\n<p>　　　　授权之后，讲道理就能登录了，可以看到下面这样的界面：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/871695/201711/871695-20171101154025966-1039426491.png\" alt=\"\"></p>\n<ul>\n<li><strong>三，RabbitMQ的工作原理（例子稍后奉上）</strong></li>\n</ul>\n<p>　　　　先体验一下整个消息投递过程：</p>\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/871695/201711/871695-20171101165531357-471890139.png\" alt=\"\"></p>\n<p> </p>\n<p>　　　　<strong>3.1 RabbitMQ的核心：</strong></p>\n<p>　　　　核心官网有介绍，说的connecnton,channel之类的，到底怎么样，who care？　</p>\n<p>　　　　总体来看，我们关注业务实现是：1）消息怎么投递的。2）消费者怎么消费消息。3）消息是否是可靠投递。4）消息投递方式。5）消息的生命周期。6）消息队列生命周期</p>\n<p>　　　　<strong>3.2  消息是怎么投递的？（记住一点，生产者消息投递都是面向交换机的）</strong></p>\n<p><strong>　　　　R</strong>abbitMQ 是面向交换机投递消息的。交换机可能绑定有许多队列，交换机如何将消息投递给这些队列呢？</p>\n<p>　　　　首先说一下面向交换机的设计的优势：1）这明显借助了数据链路层那个交换机的设计思想。除了层级分明以外，还能从分提高链路利用率（可能有点抽像）。</p>\n<p>　　　　　　　　　　　　　　　　　　　　　2）从代码层面来看：如果没有交换机，你至少得维护一个十分庞大的路由表，然后从路由表正确投递消息，有了交互机，这里路</p>\n<p>　　　　　　　　　　　　　　　　　　　　　　由表就会被拆分到多个交换机里面，效果不必多说。</p>\n<p>　　　　　　　　　　　　　　　　　　　　   3）然后就是高度的解耦，不同的交换机可有不同的路由规则，要是没有交换机。。。。。。</p>\n<p>　　　　在RabbitMQ，交换机有4种投递方式，就是枚举类BuiltinExchangeType的4个枚举变量：</p>\n<p>　　　    DIRECT:会将所有消息先取消息的ROUTE_KEY，然后投递到与ROUTE_KEY绑定的队列里面（if(msg.routekey.equals(queue.routekey))）。</p>\n<p>　　　　FANOUT:此种模式下，根本不检查消息的ROUTE_KEY,直接投送到交换机所拥有的所有队列里面。</p>\n<p>　　　　TOPIC,HEADERS自行看一下官网怎么说的，不想码字了^_^||</p>\n<p>　　　　总结起来就一个函数就把消息发出去了:channel.basicPublish(excange_name,route_key,false,bs,\"test\".getBytes());可以去官网查一下这个API</p>\n<p>　　　　<strong>3.3 消费者怎么消费消息（记住一点，消费者消费消息是面向消息队列的，这与生成者有点不一样）</strong></p>\n<p>　　　　还不是就是TCP长连接心跳的那些事，就是这么一个API：channel.basicConsume(QUEUE_AUTODELETE, true, consumer);consumer是Consumer类的一个实例，</p>\n<p>　　　　你直接去处理回调接口就ok了</p>\n<p>　　　　<strong>3.4 消息传递是否可靠</strong></p>\n<p>　　　　很明显是可靠的，除非你将消息队列，声明成非持久模式，这事你又重启了机器。这会丢失消息的。还有就是他有应答机制，你可以通过设置消费者消费消息的模式，</p>\n<p>　　　　去手动应答。channel.basicConsume（？，autoACk,?）的autoAck参数设置</p>\n<p>　　　　<strong>3.5 消息的生命周期</strong></p>\n<p><strong>　　　　</strong>一旦受到消费者应答，标识消息已被消费，则消息被回收掉。</p>\n<p>　　　　<strong>3.6 队列生命周期</strong></p>\n<p><strong>　　　　</strong>channel.queueDeclare(QUEUE_NAME,false,false,true,null);</p>\n<p>　　　　第二个参数设置为true，会将消息持久化到磁盘，第四个参数设置为true表示没有消息并且没有连接则删除改队列，详情可以查一下API</p>\n<ul>\n<li><strong>四、一个示例</strong></li>\n</ul>\n<p><strong>　　　　</strong>4.1 生产者代码：</p>\n<p>　　　　　　自行导入相关依赖包或相关依赖</p>\n<p>　　　　　　</p>\n<div class=\"cnblogs_code\">\n<pre> 　　　　 ConnectionFactory factory = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> ConnectionFactory();\n        factory.setHost(</span>\"localhost\"<span style=\"color: #000000\">);\n        factory.setUsername(</span>\"username\"<span style=\"color: #000000\">);\n        factory.setPort(</span>5672);<span style=\"color: #008000\">//</span><span style=\"color: #008000\">注意这里的端口与管理插件的端口不一样</span>\n        factory.setPassword(\"pwd\"<span style=\"color: #000000\">);\n        Connection connection </span>=<span style=\"color: #000000\"> factory.newConnection();\n        Channel channel </span>=<span style=\"color: #000000\"> connection.createChannel();\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">声明一个dirent模式的交换机</span>\n        channel.exchangeDeclare(\"exchange_name\",BuiltinExchangeType.DIRECT,<span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">);\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">声明一个非持久化自动删除的队列</span>\n        channel.queueDeclare(\"queue_name\",<span style=\"color: #0000ff\">false</span>,<span style=\"color: #0000ff\">false</span>,<span style=\"color: #0000ff\">true</span>,<span style=\"color: #0000ff\">null</span>);<span style=\"color: #008000\">//</span><span style=\"color: #008000\">如果该队列不在被使用就删除他 zhe\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">将绑定到改交换机</span>\n        channel.queueBind(\"queue_name\",\"exchange_name\",\"route_key\"<span style=\"color: #000000\">);\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">声明一个消息头部</span>\n        Map&lt;String,Object&gt; header=<span style=\"color: #0000ff\">new</span> HashMap&lt;&gt;<span style=\"color: #000000\">();\n        AMQP.BasicProperties.Builder b</span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> AMQP.BasicProperties.Builder();\n        header.put(</span>\"charset\",\"utf-8\"<span style=\"color: #000000\">);\n        b.headers(header);\n        AMQP.BasicProperties bp</span>=<span style=\"color: #000000\">b.build();\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">将消息发出去</span>\n       channel.basicPublish(\"exchange_name\",\"route_key\",<span style=\"color: #0000ff\">false</span>,bp,\"test3\".getBytes());</pre>\n</div>\n<p>　　　　4.2 消费者代码</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:java;gutter:true;\">   　　　ConnectionFactory factory = new ConnectionFactory();\n        factory.setHost(\"localhost\");\n        factory.setUsername(\"username\");\n        factory.setPort(5672);//注意这里的端口与管理插件的端口不一样\n        factory.setPassword(\"pwd\");\n        Connection connection = factory.newConnection();\n        Channel channel = connection.createChannel();\n        //声明一个dirent模式的交换机\n        channel.exchangeDeclare(\"exchange_name\",BuiltinExchangeType.DIRECT,true);\n        //声明一个非持久化自动删除的队列\n        channel.queueDeclare(\"queue_name\",false,false,true,null);//如果该队列不在被使用就删除他 zhe\n        //将绑定到改交换机\n        channel.queueBind(\"queue_name\",\"exchange_name\",\"route_key\");\n        Consumer consumer = new DefaultConsumer(channel) {\n            @Override\n            public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties,\n                                       byte[] body) throws IOException {\n                String message = new String(body, \"UTF-8\");\n                System.out.println(\" [x] Received '\" + message + \"'\");\n            }\n        };\n        channel.basicConsume(\"queue_name\", true, consumer);\n</pre>\n</div>\n<p>　　</p>\n<p>　　　　</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t<div class=\"postDesc\">posted on <span id=\"post-date\">2017-11-01 17:17</span> <a href=\"http://www.cnblogs.com/enjoyall/\">泥粑</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7767462\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7767462);return false;\">收藏</a></div>\r\n</div>\r\n<script type=\"text/javascript\">var allowComments=true,cb_blogId=261492,cb_entryId=7767462,cb_blogApp=currentBlogApp,cb_blogUserGuid='9eea94ef-67b1-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/1 17:17:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\r\n</div>", "article_view": 510, "image_url": ["https:"], "date_pub": "2017-11-01", "article_common": 1}
{"title": "[翻译]欢迎来到 C# 7.1", "url": "http://www.cnblogs.com/Rwing/p/Welcome_to_Csharp_7_1.html", "author": "Rwing", "article_desc": "原文: [Welcome to C# 7.1](https://blogs.msdn.microsoft.com/dotnet/2017/10/31/welcome-to-c-7-1/) 在 C＃ 中，我们一直倾向于主要版本：捆绑了很多功能，并且不太频繁地发布。当我们谈到 C＃6.0时，我们甚至还经... ...", "content": "<div id=\"post_detail\">\r\n<div class=\"post\" id=\"post\">\r\n    <a name=\"top\"></a>\r\n    <h2><a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/Rwing/p/Welcome_to_Csharp_7_1.html\">[翻译]欢迎来到 C# 7.1</a></h2>\r\n    <small>2017-11-01 16:20 by Rwing, <span id=\"post_view_count\">...</span> 阅读, <span id=\"post_comment_count\">...</span> 评论, <a href=\"#\" onclick=\"AddToWz(7767059);return false;\">收藏</a>,  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7767059\" rel=\"nofollow\">编辑</a></small>\r\n    <div class=\"entry\">\r\n        <div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"翻译欢迎来到-c-7.1\">[翻译]欢迎来到 C# 7.1</h1>\n<p>原文: <a href=\"https://blogs.msdn.microsoft.com/dotnet/2017/10/31/welcome-to-c-7-1/\">Welcome to C# 7.1</a></p>\n<p>在 C＃ 中，我们一直倾向于主要版本：捆绑了很多功能，并且不太频繁地发布。当我们谈到 C＃6.0时，我们甚至还经常忽略掉后面的“.0”！</p>\n<p>在 C＃7.0 这一“波”中，我们正在尝试新的东西。像 Visual Studio 这样频繁的升级节奏，为什么 C# 不能也频繁的升级呢，这已经不存在技术原因了。所以这一次，我们正在拥抱“点发布”的概念; C＃的次要版本会以更短的间隔更新，并且提供有用且较小的语言功能。这意味着您不必等待很长时间才能获得高级特性，而且还可以更容易地将C＃版本与相关功能的发布相一致，例如.NET。</p>\n<p>当然，对于团队来说，将语言升级到新版本“一直以来”都是件麻烦事，对于个人来说还好。 Visual Studio 2017 允许您决定是否切换到最新版本，或使用主要的版本。你可以选择你的喜好。</p>\n<h2 id=\"第一个点发布\">第一个“点发布”</h2>\n<p>在2017年8月，我们发布了 C＃ 的第一个“点发布”版。它被称为 C＃7.1，其主要目的是为我们的“点发布”积累经验，并且保证没有太多的依赖以使问题复杂化。</p>\n<p>因此，C＃7.1是一个很小的版本，只有少数（但精心挑选的）新语言特性; 我们认为它们是有用的，并且一定在某些场景下有用。 Visual Studio 2017 Update 15.3 开始支持。</p>\n<p>现在我们来看一下！这是一个涵盖了三个 C＃7.1 新特性的程序，加上最近 C＃7.0 的一些特性，旨在使其有趣。</p>\n<pre><code>using System.Linq;\nusing System.Threading;\nusing System.Threading.Tasks;\n\nusing static System.Console;\n\nclass Program\n{\n    static async Task Main(string[] args)\n    {\n        var results = Enumerable.Range(1, 40)\n            .Select(input =&gt; (input, task: FibonacciAsync(input)))\n            .ToArray();\n\n        foreach (var tuple in results)\n        {\n            WriteLine($\"Fib {tuple.input} = {await tuple.task}\");\n        }\n    }\n\n    private static Task&lt;int&gt; FibonacciAsync(int n, CancellationToken token = default)\n    {\n        return Task.Run(() =&gt; Fib(n).curr, token);\n\n        (int curr, int prev) Fib(int i)\n        {\n            if (i is 0) return (1, 0);\n            var (c, p) = Fib(i - 1);\n            return (c + p, c);\n        }\n    }\n}</code></pre>\n<p>它在线程池中并行计算前40个斐波纳契数，并按顺序打印出来。</p>\n<p>我们来看看这里使用的每个新的 C＃7.1 特性。要全面的了解 C＃7.1 中新特性，请查看<a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-7-1\">文档</a>。</p>\n<h2 id=\"main-方法可以-async\">Main 方法可以 Async</h2>\n<p>现在 Main 入口点方法可以返回 Task 或 Task<int>。当它执行时，执行将等待返回的任务完成，然后关闭程序。</int></p>\n<p>当然，常用的方法就是使 Main 方法异步，你可以这样做：</p>\n<pre><code>static async Task Main(string[] args)</code></pre>\n<p>这会让你可以直接在 Main 方法里 await， 这在以前是不行的。</p>\n<pre><code>WriteLine($\"Fib {tuple.input} = {await tuple.task}\");</code></pre>\n<p>以前的话，想达到这个效果是很麻烦：首先创建一个 async 的辅助方法，MainAsync，写上所有逻辑，然后写个怪异的 Main 方法：</p>\n<pre><code>static void Main(string[] args) =&gt; MainAsync().GetAwaiter().GetResult();</code></pre>\n<p>现在你可以直接让你的 Main 方法 async，编译器会帮你重写它。</p>\n<h2 id=\"推断元组元素的名称\">推断元组元素的名称</h2>\n<p>在这个lambda表达式里面的查询：</p>\n<pre><code>input =&gt; (input, task: FibonacciAsync(input))</code></pre>\n<p>您注意到，我们创建一个元组，但只为第二个元素提供一个名称， task。然后我们可以直接这么写</p>\n<pre><code>WriteLine($\"Fib {tuple.input} = {await tuple.task}\");</code></pre>\n<p>用名称tuple.input来访问第一个元素。这是因为当您创建一个有名称的表达式元组时，如上面的lambda表达式中的输入，我们将自动给予相应的元组元素一个名称。</p>\n<h2 id=\"default-literals-默认常值\">Default literals 默认常值</h2>\n<p>如果默认表达式有预期类型，那么现在可以省略对类型的说明，就像在 FibonacciAsync 方法的签名中的 CancellationToken 一样：</p>\n<pre><code>private static Task&lt;int&gt; FibonacciAsync(int n, CancellationToken token = default)</code></pre>\n<p>这避免了繁琐的类型名称重复，或者当已经由上下文给出时，输出长的类型名称。</p>\n<h2 id=\"whats-next\">What’s next?</h2>\n<p>我们已经在开发 C＃7.2，以及下一个主要版本的特性。 如果你好奇，你可以跟随并参加C＃语言设计GitHub repo：<a href=\"https://github.com/dotnet/csharplang\">github.com/dotnet/csharplang</a></p>\n</div><div id=\"MySignature\"></div>\r\n        <div class=\"clear\"></div>\r\n        <div id=\"blog_post_info_block\">\r\n        <div id=\"blog_post_info\">\r\n        </div>\r\n        <div class=\"clear\"></div>\r\n        <div id=\"post_next_prev\"></div>\r\n    </div>\r\n</div>\r\n    <ul class=\"postmetadata\">\r\n        <li class=\"icon_cat\" id=\"BlogPostCategory\">\r\n        <li class=\"icon_bullet\" id=\"EntryTag\">\r\n    </ul>\r\n</div>\r\n<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=26999,cb_entryId=7767059,cb_blogApp=currentBlogApp,cb_blogUserGuid='96753d0b-63cf-dd11-9e4d-001cf0cd104b',cb_entryCreatedDate='2017/11/1 16:20:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n<script type=\"text/javascript\">\r\n    var m = window.__blog.postRendered;\r\n    if (m) { m(__$(\"post\")); }\r\n</script>\r\n<script type=\"text/javascript\">\r\n    var m = window.__blog.postRenderPosts;\r\n    if (m) { m(); }\r\n</script>\r\n</div>", "article_view": 755, "image_url": ["https://pic.cnblogs.com/face/23440/20161207192429.png"], "date_pub": "2017-11-01", "article_common": 3}
{"title": "设计模式之-观察者模式（发布模式-订阅模式）", "url": "http://www.cnblogs.com/IT-study/p/7767186.html", "author": "人猿亦猿", "article_desc": "1.观察者模式定义 观察者模式定义了一种一对多的依赖关系，让多个观察者对象同时监听某一个主题对象。 这个主题对象在状态上发生变化时，会通知所有观察者对象，让它们能够自动更新自己。 2.观察者模式机构图 3.观察者模式的构成 ● 抽象主题(Subject)角色：抽象主题角色把所有对观察者对象的引用保存 ...", "content": "<div id=\"post_detail\">\r\n<div class=\"post\">\r\n\t<div class=\"postTitle\">\r\n\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/IT-study/p/7767186.html\">设计模式之-观察者模式（发布模式-订阅模式）</a>\r\n\t</div>\r\n\t\r\n\t<div class=\"postText\">\r\n\t\t<div id=\"cnblogs_post_body\"><p style=\"margin-left: 30px\"><span style=\"font-size: 16px\"><strong>1.观察者模式定义</strong></span></p>\n<p style=\"margin-left: 30px\"><span style=\"font-size: 15px\"><span style=\"font-size: 15px\">观察者模式定义了一种一对多的依赖关系，让多个观察者对象同时监听某一个主题对象。</span></span></p>\n<p style=\"margin: 10px auto; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.200000762939453px\"><span style=\"font-size: 15px\">　　这个主题对象在状态上发生变化时，会通知所有观察者对象，让它们能够自动更新自己。</span></p>\n<p style=\"margin: 10px auto 10px 30px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px\"><strong><span style=\"font-size: 15px\">2.观察者模式机构图</span></strong></p>\n<p style=\"margin: 10px auto; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.200000762939453px\"><span style=\"font-size: 15px\">　　<img id=\"currentImg\" class=\"currentImg\" style=\"top: 60px; left: 130px; width: 654px; height: 263px; cursor: pointer\" title=\"点击查看源网页\" src=\"https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1509532695469&amp;di=899d864b6be36719ea37448e70365a9e&amp;imgtype=0&amp;src=http%3A%2F%2Fimages.cnblogs.com%2Fcnblogs_com%2Foec2003%2FWindowsLiveWriter%2F19_127B9%2F2010-01-24_210216_thumb.png\" alt=\"\" width=\"654\" height=\"263\"></span></p>\n<p style=\"margin: 10px auto; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.200000762939453px\"> </p>\n<p style=\"margin: 10px auto; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.200000762939453px\"><span style=\"font-size: 16px\"><strong>　　3.观察者模式的构成</strong></span></p>\n<p style=\"margin: 10px auto; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.200000762939453px\">　　●　　<strong>抽象主题(Subject)角色：</strong>抽象主题角色把所有对观察者对象的引用保存在一个聚集（比如ArrayList对象）里，每个主题都可以有任何数量的观察者。抽象主题提供一个接口，可以增加和删除观察者对象，抽象主题角色又叫做抽象被观察者(Observable)角色。</p>\n<p style='font-size: 14px; margin: 10px auto; font-family: \"ms shell dlg\"; line-height: 28px'>　　●　　<strong>具体主题(ConcreteSubject)角色：</strong>将有关状态存入具体观察者对象；在具体主题的内部状态改变时，给所有登记过的观察者发出通知。具体主题角色又叫做具体被观察者(Concrete Observable)角色。</p>\n<p style='font-size: 14px; margin: 10px auto; font-family: \"ms shell dlg\"; line-height: 28px'>　　●　　<strong>抽象观察者(Observer)角色：</strong>为所有的具体观察者定义一个接口，在得到主题的通知时更新自己，这个接口叫做更新接口。</p>\n<p style='font-size: 14px; margin: 10px auto; font-family: \"ms shell dlg\"; line-height: 28px'>　　●　　<strong>具体观察者(ConcreteObserver)角色：</strong>存储与主题的状态自恰的状态。具体观察者角色实现抽象观察者角色所要求的更新接口，以便使本身的状态与主题的状态 像协调。如果需要，具体观察者角色可以保持一个指向具体主题对象的引用。</p>\n<p style='font-size: 14px; margin: 10px auto; font-family: \"ms shell dlg\"; line-height: 28px'><a href=\"http://blog.csdn.net/qq279880252/article/details/39674163\" target=\"_blank\">深入理解观察者模式请进入该博客</a></p>\n<h3 style='font-size: 16px; border-bottom-width: 1px; border-bottom-style: dotted; border-bottom-color: #d6d6d6; font-family: \"ms shell dlg\"; line-height: 28px'><span style=\"font-size: 16px\"><strong>　　4.</strong><strong>代码实现</strong></span></h3>\n<p style=\"margin-left: 30px\"> <strong>抽象主题(Subject)角色：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1 <span style=\"color: #0000ff\">package<span style=\"color: #000000\"> main.java.pub_sub2;\n<span style=\"color: #008080\"> 2 \n<span style=\"color: #008080\"> 3 <span style=\"color: #0000ff\">import<span style=\"color: #000000\"> java.util.ArrayList;\n<span style=\"color: #008080\"> 4 <span style=\"color: #0000ff\">import<span style=\"color: #000000\"> java.util.List;\n<span style=\"color: #008080\"> 5 \n<span style=\"color: #008080\"> 6 <span style=\"color: #008000\">/**\n<span style=\"color: #008080\"> 7 <span style=\"color: #008000\">* @ClassName: Subject\n<span style=\"color: #008080\"> 8 <span style=\"color: #008000\">* @Description: 抽象主题(Subject)角色\n<span style=\"color: #008080\"> 9 <span style=\"color: #008000\">* <span style=\"color: #808080\">@author<span style=\"color: #008000\"> JinXing \n<span style=\"color: #008080\">10 <span style=\"color: #008000\">* @date 2017年11月1日 下午2:00:52\n<span style=\"color: #008080\">11 <span style=\"color: #008000\">*\n<span style=\"color: #008080\">12 <span style=\"color: #008000\">*/ \n<span style=\"color: #008080\">13 <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">abstract <span style=\"color: #0000ff\">class<span style=\"color: #000000\"> Subject {\n<span style=\"color: #008080\">14 \n<span style=\"color: #008080\">15     <span style=\"color: #0000ff\">private List&lt;Observer&gt; list=<span style=\"color: #0000ff\">new ArrayList&lt;Observer&gt;<span style=\"color: #000000\">();\n<span style=\"color: #008080\">16     \n<span style=\"color: #008080\">17     <span style=\"color: #008000\">/**\n<span style=\"color: #008080\">18 <span style=\"color: #008000\">     * 注册观察者\n<span style=\"color: #008080\">19 <span style=\"color: #008000\">     * @Title: addObserver\n<span style=\"color: #008080\">20 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@author<span style=\"color: #008000\"> JinXing \n<span style=\"color: #008080\">21 <span style=\"color: #008000\">     * @date 2017年11月1日 下午2:04:33\n<span style=\"color: #008080\">22 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@param<span style=\"color: #008000\">  obj\n<span style=\"color: #008080\">23 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@return<span style=\"color: #008000\"> void\n<span style=\"color: #008080\">24      <span style=\"color: #008000\">*/\n<span style=\"color: #008080\">25     <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">void<span style=\"color: #000000\"> addObserver(Observer obj){\n<span style=\"color: #008080\">26 <span style=\"color: #000000\">        list.add(obj);\n<span style=\"color: #008080\">27 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">28     \n<span style=\"color: #008080\">29     <span style=\"color: #008000\">/**\n<span style=\"color: #008080\">30 <span style=\"color: #008000\">     * 删除观察者\n<span style=\"color: #008080\">31 <span style=\"color: #008000\">     * @Title: delObserver\n<span style=\"color: #008080\">32 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@author<span style=\"color: #008000\"> JinXing \n<span style=\"color: #008080\">33 <span style=\"color: #008000\">     * @date 2017年11月1日 下午2:04:33\n<span style=\"color: #008080\">34 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@param<span style=\"color: #008000\">  obj\n<span style=\"color: #008080\">35 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@return<span style=\"color: #008000\"> void\n<span style=\"color: #008080\">36      <span style=\"color: #008000\">*/\n<span style=\"color: #008080\">37     <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">void<span style=\"color: #000000\"> delObserver(Observer obj){\n<span style=\"color: #008080\">38 <span style=\"color: #000000\">        list.remove(obj);\n<span style=\"color: #008080\">39 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">40     \n<span style=\"color: #008080\">41     <span style=\"color: #008000\">/**\n<span style=\"color: #008080\">42 <span style=\"color: #008000\">     * 通知所有的观察者\n<span style=\"color: #008080\">43 <span style=\"color: #008000\">     * @Title: notifyAllObserver\n<span style=\"color: #008080\">44 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@author<span style=\"color: #008000\"> JinXing \n<span style=\"color: #008080\">45 <span style=\"color: #008000\">     * @date 2017年11月1日 下午2:11:34\n<span style=\"color: #008080\">46 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@param <span style=\"color: #808080\">@param<span style=\"color: #008000\"> msg\n<span style=\"color: #008080\">47 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@return<span style=\"color: #008000\"> void\n<span style=\"color: #008080\">48      <span style=\"color: #008000\">*/\n<span style=\"color: #008080\">49     <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">void<span style=\"color: #000000\"> notifyAllObserver(){\n<span style=\"color: #008080\">50         <span style=\"color: #0000ff\">for<span style=\"color: #000000\"> (Observer observer : list) {\n<span style=\"color: #008080\">51             observer.update(<span style=\"color: #0000ff\">this<span style=\"color: #000000\">);\n<span style=\"color: #008080\">52 <span style=\"color: #000000\">        }\n<span style=\"color: #008080\">53 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">54     \n<span style=\"color: #008080\">55 }</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<p> </p>\n<p style=\"margin: 10px auto 10px 30px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px\"> <strong>具体主题(ConcreteSubject)角色：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1 <span style=\"color: #0000ff\">package<span style=\"color: #000000\"> main.java.pub_sub2;\n<span style=\"color: #008080\"> 2 \n<span style=\"color: #008080\"> 3 <span style=\"color: #008000\">/**\n<span style=\"color: #008080\"> 4 <span style=\"color: #008000\">* @ClassName: GameSubject\n<span style=\"color: #008080\"> 5 <span style=\"color: #008000\">* @Description: 游戏主题\n<span style=\"color: #008080\"> 6 <span style=\"color: #008000\">* <span style=\"color: #808080\">@author<span style=\"color: #008000\"> JinXing \n<span style=\"color: #008080\"> 7 <span style=\"color: #008000\">* @date 2017年11月1日 下午2:13:08\n<span style=\"color: #008080\"> 8 <span style=\"color: #008000\">*\n<span style=\"color: #008080\"> 9 <span style=\"color: #008000\">*/ \n<span style=\"color: #008080\">10 <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">class GameSubject <span style=\"color: #0000ff\">extends<span style=\"color: #000000\"> Subject{\n<span style=\"color: #008080\">11 \n<span style=\"color: #008080\">12     <span style=\"color: #0000ff\">private String name;<span style=\"color: #008000\">//<span style=\"color: #008000\">发布人\n<span style=\"color: #008080\">13     <span style=\"color: #0000ff\">private String content;<span style=\"color: #008000\">//<span style=\"color: #008000\">发布内容\n<span style=\"color: #008080\">14     \n<span style=\"color: #008080\">15     <span style=\"color: #0000ff\">public<span style=\"color: #000000\"> String getName() {\n<span style=\"color: #008080\">16         <span style=\"color: #0000ff\">return<span style=\"color: #000000\"> name;\n<span style=\"color: #008080\">17 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">18     <span style=\"color: #0000ff\">public<span style=\"color: #000000\"> String getContent() {\n<span style=\"color: #008080\">19         <span style=\"color: #0000ff\">return<span style=\"color: #000000\"> content;\n<span style=\"color: #008080\">20 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">21 \n<span style=\"color: #008080\">22     <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">void<span style=\"color: #000000\"> setName(String name) {\n<span style=\"color: #008080\">23         <span style=\"color: #0000ff\">this.name =<span style=\"color: #000000\"> name;\n<span style=\"color: #008080\">24 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">25     <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">void<span style=\"color: #000000\"> setContent(String content) {\n<span style=\"color: #008080\">26         <span style=\"color: #0000ff\">this.content =<span style=\"color: #000000\"> content;\n<span style=\"color: #008080\">27 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">28     <span style=\"color: #0000ff\">public<span style=\"color: #000000\"> GameSubject() {\n<span style=\"color: #008080\">29         <span style=\"color: #0000ff\">super<span style=\"color: #000000\">();\n<span style=\"color: #008080\">30 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">31     <span style=\"color: #0000ff\">public<span style=\"color: #000000\"> GameSubject(String name, String content) {\n<span style=\"color: #008080\">32         <span style=\"color: #0000ff\">super<span style=\"color: #000000\">();\n<span style=\"color: #008080\">33         <span style=\"color: #0000ff\">this.name =<span style=\"color: #000000\"> name;\n<span style=\"color: #008080\">34         <span style=\"color: #0000ff\">this.content =<span style=\"color: #000000\"> content;\n<span style=\"color: #008080\">35 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">36     \n<span style=\"color: #008080\">37 <span style=\"color: #000000\">    @Override\n<span style=\"color: #008080\">38     <span style=\"color: #0000ff\">public<span style=\"color: #000000\"> String toString() {\n<span style=\"color: #008080\">39         <span style=\"color: #0000ff\">return \"GameSubject [name=\" + name + \", content=\" + content + \"]\"<span style=\"color: #000000\">;\n<span style=\"color: #008080\">40 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">41     <span style=\"color: #008000\">/**\n<span style=\"color: #008080\">42 <span style=\"color: #008000\">     * 开始主题活动\n<span style=\"color: #008080\">43 <span style=\"color: #008000\">     * @Title: sendSubject\n<span style=\"color: #008080\">44 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@author<span style=\"color: #008000\"> JinXing \n<span style=\"color: #008080\">45 <span style=\"color: #008000\">     * @date 2017年11月1日 下午2:13:26\n<span style=\"color: #008080\">46 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@param <span style=\"color: #808080\">@param<span style=\"color: #008000\"> msg\n<span style=\"color: #008080\">47 <span style=\"color: #008000\">     * <span style=\"color: #808080\">@return<span style=\"color: #008000\"> void\n<span style=\"color: #008080\">48      <span style=\"color: #008000\">*/\n<span style=\"color: #008080\">49     <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">void<span style=\"color: #000000\"> sendSubject(GameSubject sub){\n<span style=\"color: #008080\">50 \n<span style=\"color: #008080\">51         System.out.println(\"当前主题为：\"+<span style=\"color: #000000\">sub.getContent());\n<span style=\"color: #008080\">52         <span style=\"color: #0000ff\">this<span style=\"color: #000000\">.notifyAllObserver();\n<span style=\"color: #008080\">53 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">54 }</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<p> </p>\n<p style=\"margin: 10px auto 10px 30px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px\"> <strong>抽象观察者(Observer)角色：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1 <span style=\"color: #0000ff\">package<span style=\"color: #000000\"> main.java.pub_sub2;\n<span style=\"color: #008080\"> 2 \n<span style=\"color: #008080\"> 3 <span style=\"color: #008000\">/**\n<span style=\"color: #008080\"> 4 <span style=\"color: #008000\">* @ClassName: Observer\n<span style=\"color: #008080\"> 5 <span style=\"color: #008000\">* @Description: 抽象观察者(Observer)角色\n<span style=\"color: #008080\"> 6 <span style=\"color: #008000\">* <span style=\"color: #808080\">@author<span style=\"color: #008000\"> JinXing \n<span style=\"color: #008080\"> 7 <span style=\"color: #008000\">* @date 2017年11月1日 下午2:14:52\n<span style=\"color: #008080\"> 8 <span style=\"color: #008000\">*\n<span style=\"color: #008080\"> 9 <span style=\"color: #008000\">*/ \n<span style=\"color: #008080\">10 <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">interface<span style=\"color: #000000\"> Observer {\n<span style=\"color: #008080\">11 \n<span style=\"color: #008080\">12     <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">void<span style=\"color: #000000\"> update(Subject subject);\n<span style=\"color: #008080\">13     \n<span style=\"color: #008080\">14 }</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<p> </p>\n<p style=\"margin: 10px auto 10px 30px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px\"><strong>具体观察者(ConcreteObserver)角色：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1 <span style=\"color: #0000ff\">package<span style=\"color: #000000\"> main.java.pub_sub2;\n<span style=\"color: #008080\"> 2 \n<span style=\"color: #008080\"> 3 <span style=\"color: #008000\">/**\n<span style=\"color: #008080\"> 4 <span style=\"color: #008000\">* @ClassName: PcPlayer\n<span style=\"color: #008080\"> 5 <span style=\"color: #008000\">* @Description:PC玩家 （观察者）\n<span style=\"color: #008080\"> 6 <span style=\"color: #008000\">* <span style=\"color: #808080\">@author<span style=\"color: #008000\"> JinXing \n<span style=\"color: #008080\"> 7 <span style=\"color: #008000\">* @date 2017年11月1日 下午2:18:44\n<span style=\"color: #008080\"> 8 <span style=\"color: #008000\">*\n<span style=\"color: #008080\"> 9 <span style=\"color: #008000\">*/ \n<span style=\"color: #008080\">10 <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">class PcPlayer <span style=\"color: #0000ff\">implements<span style=\"color: #000000\"> Observer{\n<span style=\"color: #008080\">11 \n<span style=\"color: #008080\">12 <span style=\"color: #000000\">    @Override\n<span style=\"color: #008080\">13     <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">void<span style=\"color: #000000\"> update(Subject sub) {\n<span style=\"color: #008080\">14         GameSubject gameSub=<span style=\"color: #000000\">(GameSubject) sub;\n<span style=\"color: #008080\">15         String msg=<span style=\"color: #000000\">gameSub.getContent();\n<span style=\"color: #008080\">16         <span style=\"color: #0000ff\">if(msg!=<span style=\"color: #0000ff\">null<span style=\"color: #000000\">){\n<span style=\"color: #008080\">17             msg=<span style=\"color: #000000\">msg.toLowerCase();\n<span style=\"color: #008080\">18 <span style=\"color: #000000\">        }\n<span style=\"color: #008080\">19         \n<span style=\"color: #008080\">20         <span style=\"color: #0000ff\">if(msg.contains(\"pc\"<span style=\"color: #000000\">)){\n<span style=\"color: #008080\">21             System.out.println(\"PC玩家：我对这个主题非常感兴趣！\"<span style=\"color: #000000\">);\n<span style=\"color: #008080\">22         }<span style=\"color: #0000ff\">else<span style=\"color: #000000\">{\n<span style=\"color: #008080\">23             System.out.println(\"PC玩家：这个主题很无聊！\"<span style=\"color: #000000\">);\n<span style=\"color: #008080\">24 <span style=\"color: #000000\">        }\n<span style=\"color: #008080\">25         \n<span style=\"color: #008080\">26         System.out.println(\"本次游戏主题发布者：\"+<span style=\"color: #000000\">gameSub.getName());\n<span style=\"color: #008080\">27         \n<span style=\"color: #008080\">28 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">29 \n<span style=\"color: #008080\">30 }</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<p> </p>\n<p style=\"margin: 10px auto 10px 30px; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 25.2px\"><strong>测试：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1 <span style=\"color: #0000ff\">package<span style=\"color: #000000\"> main.java.pub_sub2;\n<span style=\"color: #008080\"> 2 \n<span style=\"color: #008080\"> 3 <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">class<span style=\"color: #000000\"> Test {\n<span style=\"color: #008080\"> 4 \n<span style=\"color: #008080\"> 5     <span style=\"color: #0000ff\">public <span style=\"color: #0000ff\">static <span style=\"color: #0000ff\">void<span style=\"color: #000000\"> main(String[] args) {\n<span style=\"color: #008080\"> 6         \n<span style=\"color: #008080\"> 7         String name=\"jack\"<span style=\"color: #000000\">;\n<span style=\"color: #008080\"> 8         String content=\"英雄联盟手游版+PC版\"<span style=\"color: #000000\">;\n<span style=\"color: #008080\"> 9         \n<span style=\"color: #008080\">10         <span style=\"color: #008000\">//<span style=\"color: #008000\">主题对象\n<span style=\"color: #008080\">11         GameSubject sub=<span style=\"color: #0000ff\">new<span style=\"color: #000000\"> GameSubject(name,content);\n<span style=\"color: #008080\">12         <span style=\"color: #008000\">//<span style=\"color: #008000\">观察者对象\n<span style=\"color: #008080\">13         Observer obj1=<span style=\"color: #0000ff\">new<span style=\"color: #000000\"> PcPlayer();\n<span style=\"color: #008080\">14         <span style=\"color: #008000\">//<span style=\"color: #008000\">添加观察者\n<span style=\"color: #008080\">15 <span style=\"color: #000000\">        sub.addObserver(obj1);\n<span style=\"color: #008080\">16 <span style=\"color: #000000\">        sub.sendSubject(sub);\n<span style=\"color: #008080\">17         \n<span style=\"color: #008080\">18 <span style=\"color: #000000\">    }\n<span style=\"color: #008080\">19     \n<span style=\"color: #008080\">20 }</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t</div>\r\n\t\r\n\t<div class=\"postfoot\">\r\n\t\tposted on <span id=\"post-date\">2017-11-01 16:37</span> <a href=\"http://www.cnblogs.com/IT-study/\">人猿亦猿</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7767186\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7767186);return false;\">收藏</a>\r\n\t</div>\r\n</div>\r\n<script type=\"text/javascript\">var allowComments=true,cb_blogId=387886,cb_entryId=7767186,cb_blogApp=currentBlogApp,cb_blogUserGuid='767cd2a8-711e-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/1 16:37:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\r\n</div>", "article_view": 208, "image_url": ["https://pic.cnblogs.com/face/961141/20171013180936.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "Selenium Grid分布式测试入门详解", "url": "http://www.cnblogs.com/lovesoo/p/7767166.html", "author": "lovesoo", "article_desc": "Selenium Grid允许你在多台机器的多个浏览器上并行的进行测试，即分布式测试。 本文对Selenium Grid进行了完整的介绍，从环境准备到使用Selenium Grid进行一次完整的多节点分布式测试。 运行环境为Windows 10，Selenium版本为 3.5.0，Chrome版本为... ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/lovesoo/p/7767166.html\">Selenium Grid分布式测试入门详解</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><div>本文对Selenium Grid进行了完整的介绍，从环境准备到使用Selenium Grid进行一次完整的多节点分布式测试。</div>\r\n<div>运行环境为Windows 10，Selenium版本为 3.5.0，Chrome版本为62，Firefox版本为56，IE版本为11。</div>\r\n<h1>1. Selenium Grid简介</h1>\r\n<div>Selenium Grid允许你在多台机器的多个浏览器上并行的进行测试，即分布式测试。</div>\r\n<div>通常，以下两种情况会需要使用Selenium Grid：</div>\r\n<div>1) 通常多个浏览器的兼容性测试，即在不同浏览器或不同操作系统的浏览器中进行测试</div>\r\n<div>2) 测试用例较多时，可以通过分布式测试减少测试执行时间</div>\r\n<div> </div>\r\n<h1>2. Selenium Grid结构</h1>\r\n<div>Selenium Grid由一个中心hub及多个节点node组成（类似于其他分布式系统的matser-slave），其中hub用来管理各个node的注册和状态信息，并且接受远程客户端代码的请求调用，然后把请求再转发给node来执行。</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/445074/201711/445074-20171101163001498-1499185111.png\" alt=\"\">\r\n<p> </p>\r\n</div>\r\n<div> </div>\r\n<h1>3. 环境准备</h1>\r\n<div>由于Selenium Grid的hub及node启动时需要java环境，所以首先需要安装JDK。</div>\r\n<div> </div>\r\n<h2>3.1 JDK环境</h2>\r\n<div>1. 官网下载地址：<a href=\"http://www.oracle.com/technetwork/java/javase/downloads/index.html\" target=\"_blank\">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a></div>\r\n<div>2. 选择Java SE 8u151/ 8u152，点击JDK下载</div>\r\n<div>3. 安装下载的JDK</div>\r\n<div>4. 配置系统环境变量</div>\r\n<div> </div>\r\n<h2>3.2 selenium-server-standalone下载</h2>\r\n<div>1. selenium-release官网地址：<a href=\"http://selenium-release.storage.googleapis.com/index.html\">http://selenium-release.storage.googleapis.com/index.html</a></div>\r\n<div>2. 下载与本机selenium 3.5.0匹配的版本：selenium-server-standalone-3.5.0.jar</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/445074/201711/445074-20171101163011216-386368325.png\" alt=\"\"></div>\r\n<div> </div>\r\n<div>2. 拷贝selenium-server-standalone-3.5.0.jar至本地工作目录下，如D:\\grid</div>\r\n<h2>3.3 webdriver下载</h2>\r\n<h3>3.3.1 IE</h3>\r\n<div>1) 还是在刚才的页面：<a href=\"http://selenium-release.storage.googleapis.com/index.html?path=3.5/\">http://selenium-release.storage.googleapis.com/index.html?path=3.5/</a></div>\r\n<div>2) 下载与selenium版本、系统均匹配的IEDriver版本：IEDriverServer_Win32_3.5.0.zip</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/445074/201711/445074-20171101163115029-2059267680.png\" alt=\"\"></div>\r\n<h3>3.3.2 Chrome</h3>\r\n<div>1) 下载地址：<a href=\"https://sites.google.com/a/chromium.org/chromedriver/downloads\" target=\"_blank\">https://sites.google.com/a/chromium.org/chromedriver/downloads</a></div>\r\n<div>2) 下载与系统及浏览器版本匹配的driver版本：chromedriver_win32.zip</div>\r\n<h3>3.3.3 Firefox</h3>\r\n<div>1) 下载地址：<a href=\"https://github.com/mozilla/geckodriver/releases\">https://github.com/mozilla/geckodriver/releases</a></div>\r\n<div>2) 下载与系统及浏览器版本匹配的driver版本：geckodriver-v0.19.1-win64.zip</div>\r\n<div> <img src=\"http://images2017.cnblogs.com/blog/445074/201711/445074-20171101163131279-156347288.png\" alt=\"\">\r\n<p> </p>\r\n<p>driver下载完成解压后，分别拷贝IEDriverServer.exe，geckodriver.exe，chromedriver.exe至Python安装路径（如C:\\Python27\\）下即可</p>\r\n</div>\r\n<div>上述selenium-server-standalone 及webdriver，我已上传至百度网盘，下载链接: <a href=\"https://pan.baidu.com/s/1i4MBpXF\" target=\"_blank\">https://pan.baidu.com/s/1i4MBpXF</a> 密码: ygdy</div>\r\n<h1>4. Selenium Grid启动</h1>\r\n<h2>4.1 启动hub</h2>\r\n<div>hub启动命令如下：</div>\r\n<div>\r\n<div class=\"cnblogs_code\">\r\n<pre>java -jar selenium-server-standalone-<span style=\"color: #800080;\">3.5</span>.<span style=\"color: #800080;\">0</span>.jar -role hub</pre>\r\n</div>\r\n</div>\r\n<div>其中 -role指定角色为hub，通过下图可以看到：hub已使用默认4444端口启动成功，且node可以通过<a href=\"http://localhost:4444/grid/register/\">http://localhost:4444/grid/register/</a>进行注册</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/445074/201711/445074-20171101163222732-315032782.png\" alt=\"\"></div>\r\n<div> </div>\r\n<h2>4.2 启动node</h2>\r\n<div>node启动命令如下：</div>\r\n<div>\r\n<div class=\"cnblogs_code\">\r\n<pre>java -jar selenium-server-standalone-<span style=\"color: #800080;\">3.5</span>.<span style=\"color: #800080;\">0</span>.jar -role node -port <span style=\"color: #800080;\">5555</span> -hub http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">localhost:4444/grid/register</span></pre>\r\n</div>\r\n</div>\r\n<div>其中 -role指定角色为node, -port指定端口为 5555, -hub指定连接hub地址，通过下图可以看到node已成功连接hub</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/445074/201711/445074-20171101163243591-539778752.png\" alt=\"\">\r\n<p>同理我们另外启动两个 node（使用端口号分别为5556/5557）：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>java -jar selenium-server-standalone-<span style=\"color: #800080;\">3.5</span>.<span style=\"color: #800080;\">0</span>.jar -role node -port <span style=\"color: #800080;\">5556</span> -hub http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">localhost:4444/grid/register</span>\r\njava -jar selenium-server-standalone-<span style=\"color: #800080;\">3.5</span>.<span style=\"color: #800080;\">0</span>.jar -role node -port <span style=\"color: #800080;\">5557</span> -hub http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">localhost:4444/grid/register</span></pre>\r\n</div>\r\n</div>\r\n<div> </div>\r\n<div>此时打开页面<a href=\"http://localhost:4444/grid/console\">http://localhost:4444/grid/console</a>，可以看到我们启动的三个node:</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/445074/201711/445074-20171101163305951-455914393.png\" alt=\"\"></div>\r\n<h2>4.3 更好的启动方法 — bat脚本</h2>\r\n<div>1. 新建一个文件selenium_grid.bat，写入我们刚才启动hub及node的命令：</div>\r\n<div>\r\n<div class=\"cnblogs_code\">\r\n<pre>cd /<span style=\"color: #000000;\">d D:\\grid\r\nstart java </span>-jar selenium-server-standalone-<span style=\"color: #800080;\">3.5</span>.<span style=\"color: #800080;\">0</span>.jar -<span style=\"color: #000000;\">role hub\r\nstart java </span>-jar selenium-server-standalone-<span style=\"color: #800080;\">3.5</span>.<span style=\"color: #800080;\">0</span>.jar -role node -port <span style=\"color: #800080;\">5555</span> -hub http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">localhost:4444/grid/register</span>\r\nstart java -jar selenium-server-standalone-<span style=\"color: #800080;\">3.5</span>.<span style=\"color: #800080;\">0</span>.jar -role node -port <span style=\"color: #800080;\">5556</span> -hub http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">localhost:4444/grid/register</span>\r\nstart java -jar selenium-server-standalone-<span style=\"color: #800080;\">3.5</span>.<span style=\"color: #800080;\">0</span>.jar -role node -port <span style=\"color: #800080;\">5557</span> -hub http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">localhost:4444/grid/register</span></pre>\r\n</div>\r\n</div>\r\n<div>1) 第一行是进入并修改当前目录为存放 selenium-server-standalone-3.5.0.jar的目录：D:\\grid</div>\r\n<div>2) 后面三行stat java...是分别打开新的cmd窗口用以启动hub及node</div>\r\n<div> </div>\r\n<div>2. 双击selenium_grid.bat即可启动hub及node</div>\r\n<div> </div>\r\n<h2>4.4 更多选项</h2>\r\n<div>关于Selenium Grid更多命令选项，可运行--help查看：</div>\r\n<div>\r\n<div class=\"cnblogs_code\">\r\n<pre>d:\\grid&gt;java -jar selenium-server-standalone-<span style=\"color: #800080;\">3.5</span>.<span style=\"color: #800080;\">0</span>.jar --<span style=\"color: #000000;\">help\r\nUsage: </span>&lt;main class&gt;<span style=\"color: #000000;\"> [options]\r\n  Options:\r\n    </span>--version, -<span style=\"color: #000000;\">version\r\n       Displays the version and exits.\r\n       Default: </span><span style=\"color: #0000ff;\">false</span>\r\n    -<span style=\"color: #000000;\">browserTimeout\r\n       </span>&lt;Integer&gt; <span style=\"color: #0000ff;\">in</span><span style=\"color: #000000;\"> seconds : number of seconds a browser session is allowed to\r\n       hang </span><span style=\"color: #0000ff;\">while</span><span style=\"color: #000000;\"> a WebDriver command is running (example: driver.get(url)). If the\r\n       timeout is reached </span><span style=\"color: #0000ff;\">while</span><span style=\"color: #000000;\"> a WebDriver command is still processing, the session\r\n       will quit. Minimum value is </span><span style=\"color: #800080;\">60</span><span style=\"color: #000000;\">. An unspecified, zero, or negative value means\r\n       </span><span style=\"color: #0000ff;\">wait</span><span style=\"color: #000000;\"> indefinitely.\r\n       Default: </span><span style=\"color: #800080;\">0</span>\r\n    -<span style=\"color: #000000;\">debug\r\n       </span>&lt;Boolean&gt;<span style=\"color: #000000;\"> : enables LogLevel.FINE.\r\n       Default: </span><span style=\"color: #0000ff;\">false</span>\r\n    -<span style=\"color: #000000;\">enablePassThrough\r\n       </span>&lt;Boolean&gt;<span style=\"color: #000000;\">: Whether or not to use the experimental passthrough mode.\r\n       Defaults to </span><span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">.\r\n       Default: </span><span style=\"color: #0000ff;\">true</span>\r\n    -jettyThreads, -<span style=\"color: #000000;\">jettyMaxThreads\r\n       </span>&lt;Integer&gt; : max number of threads <span style=\"color: #0000ff;\">for</span><span style=\"color: #000000;\"> Jetty. An unspecified, zero, or\r\n       negative value means the Jetty default value (</span><span style=\"color: #800080;\">200</span><span style=\"color: #000000;\">) will be used.\r\n    </span>-<span style=\"color: #000000;\">log\r\n       </span>&lt;String&gt; filename : the filename to use <span style=\"color: #0000ff;\">for</span><span style=\"color: #000000;\"> logging. If omitted, will log\r\n       to STDOUT\r\n    </span>-<span style=\"color: #000000;\">port\r\n       </span>&lt;Integer&gt;<span style=\"color: #000000;\"> : the port number the server will use.\r\n       Default: </span><span style=\"color: #800080;\">4444</span>\r\n    -<span style=\"color: #000000;\">role\r\n       </span>&lt;String&gt;<span style=\"color: #000000;\"> options are [hub], [node], or [standalone].\r\n       Default: standalone\r\n    </span>-timeout, -<span style=\"color: #000000;\">sessionTimeout\r\n       </span>&lt;Integer&gt; <span style=\"color: #0000ff;\">in</span><span style=\"color: #000000;\"> seconds : Specifies the timeout before the server\r\n       automatically kills a session that hasn</span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">t had any activity in the last X seconds. The</span>\r\n       test slot will <span style=\"color: #0000ff;\">then</span> be released <span style=\"color: #0000ff;\">for</span><span style=\"color: #000000;\"> another test to use. This is typically\r\n       used to take care of client crashes. For grid hub</span>/<span style=\"color: #000000;\">node roles, cleanUpCycle\r\n       must also be set.\r\n       Default: </span><span style=\"color: #800080;\">1800</span></pre>\r\n</div>\r\n</div>\r\n<h1>5. Selenium Grid 分布式测试脚本</h1>\r\n<div>下面，我们编写一个Selenium Grid自动化测试脚本，分别在3个node上运行Chrome,Firefox及IE浏览器，执行WEB页面自动化测试。</div>\r\n<div>示例脚本如下：</div>\r\n<div>\r\n<div class=\"cnblogs_code\">\r\n<pre># coding:utf-<span style=\"color: #800080;\">8</span><span style=\"color: #000000;\">\r\n\r\n\r\nfrom selenium.webdriver import Remote\r\nimport </span><span style=\"color: #0000ff;\">time</span><span style=\"color: #000000;\">\r\n\r\n# 定义node_hub与浏览器对应关系\r\nnodes </span>=<span style=\"color: #000000;\"> {\r\n    </span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">http://127.0.0.1:5555/wd/hub</span><span style=\"color: #800000;\">'</span>: <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">chrome</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">,\r\n    </span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">http://127.0.0.1:5556/wd/hub</span><span style=\"color: #800000;\">'</span>: <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">internet explorer</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">,\r\n    </span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">http://127.0.0.1:5557/wd/hub</span><span style=\"color: #800000;\">'</span>: <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">firefox</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">\r\n}\r\n\r\n# 通过不同的浏览器执行测试脚本\r\n</span><span style=\"color: #0000ff;\">for</span> host, browser <span style=\"color: #0000ff;\">in</span><span style=\"color: #000000;\"> nodes.items():\r\n    print(host, browser)\r\n    # 调用remote方法\r\n    driver </span>= Remote(command_executor=<span style=\"color: #000000;\">host,\r\n                    desired_capabilities</span>={<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">platform</span><span style=\"color: #800000;\">'</span>: <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">ANY</span><span style=\"color: #800000;\">'</span>, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">browserName</span><span style=\"color: #800000;\">'</span>: browser, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">version</span><span style=\"color: #800000;\">'</span>: <span style=\"color: #800000;\">''</span>, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">javascriptEnabled</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">: True})\r\n\r\n    # 打开百度首页并搜索词语，最后判断搜索跳转页面标题是否含有搜索词\r\n    wd </span>= <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">lovesoo</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">\r\n    driver.get(</span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">https://www.baidu.com</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">)\r\n    driver.find_element_by_id(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">kw</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">).send_keys(wd)\r\n    driver.find_element_by_id(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">su</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">).click()\r\n    </span><span style=\"color: #0000ff;\">time</span>.<span style=\"color: #0000ff;\">sleep</span>(<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">)\r\n    assert wd </span><span style=\"color: #0000ff;\">in</span> driver.title, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">{0} not in {1}</span><span style=\"color: #800000;\">'</span>.format(wd, driver.title.encode(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">utf-8</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">))\r\n    driver.quit()</span></pre>\r\n</div>\r\n</div>\r\n<div>运行结果如下：</div>\r\n<div>\r\n<div class=\"cnblogs_code\">\r\n<pre>(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">http://127.0.0.1:5555/wd/hub</span><span style=\"color: #800000;\">'</span>, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">chrome</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">)\r\n(</span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">http://127.0.0.1:5557/wd/hub</span><span style=\"color: #800000;\">'</span>, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">firefox</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">)\r\n(</span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">http://127.0.0.1:5556/wd/hub</span><span style=\"color: #800000;\">'</span>, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">internet explorer</span><span style=\"color: #800000;\">'</span>)</pre>\r\n</div>\r\n</div>\r\n<div> </div>\r\n<h1>6. 常见问题</h1>\r\n<div>脚本运行过程中若IE浏览器报错找不到元素，而Chrome及Firefox浏览器正常，原因是IE浏览器的保护模式没有关闭：</div>\r\n<div>1) 打开IE浏览器，在浏览器的菜单栏上点击“工具”选项，然后点击“Internet选项”</div>\r\n<div>2) 在“Internet选项”中，切换到“安全”选项，取消“启用保护模式”的勾选</div>\r\n<div>3) 并且上面四个区域的保护模式都需要关闭</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/445074/201711/445074-20171101163503201-1342473814.png\" alt=\"\">\r\n<p> </p>\r\n</div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 16:46</span> <a href=\"http://www.cnblogs.com/lovesoo/\">lovesoo</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7767166\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7767166);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=127424,cb_entryId=7767166,cb_blogApp=currentBlogApp,cb_blogUserGuid='30de04d9-e9f7-e111-aa3f-842b2b196315',cb_entryCreatedDate='2017/11/1 16:46:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 139, "image_url": ["https://pic.cnblogs.com/face/445074/20171023190913.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "领域驱动开发实践之路:我们是如何从领域驱动开发当中获益的", "url": "http://www.cnblogs.com/cnblogsfans/p/7767162.html", "author": "敏捷的水", "article_desc": "有了《领域驱动设计》和《实现领域驱动设计》两大神器，也只是向美女要了个联系方式和家庭住址而已，中间还隔了一个漫长的日落和日出，没有正式的项目，我们永远是在岸上游泳，虽然我们也在项目里开始或多或少使用了领域的一些概念，但是我们应该知道基于数据驱动(Database Driven) 是很难成功应用领域驱... ...", "content": "<div id=\"post_detail\">\r\n<div class=\"post\" id=\"post\">\r\n    <a name=\"top\"></a>\r\n    <h2><a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/cnblogsfans/p/7767162.html\">领域驱动开发实践之路:我们是如何从领域驱动开发当中获益的</a></h2>\r\n    <small>2017-11-01 16:47 by 敏捷的水, <span id=\"post_view_count\">...</span> 阅读, <span id=\"post_comment_count\">...</span> 评论, <a href=\"#\" onclick=\"AddToWz(7767162);return false;\">收藏</a>,  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7767162\" rel=\"nofollow\">编辑</a></small>\r\n    <div class=\"entry\">\r\n        <div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h2 id=\"领域驱动设计遇见你之前\">领域驱动设计，遇见你之前</h2>\n<p>我们公司推行和实践敏捷已经很多年了，SCRUM已经成功应用于大部分项目，得益与业界敏捷开发大师以及国内很多优秀工程师的分享和宣传，我们使用了很多优秀的软件开发实践，比如测试驱动开发(TDD)，行为驱动开发(BDD), 持续集成(CI)等等为我们带来了很多收益。由于我们公司以做项目为主，虽然这些软件实践确实能很好的提高软件交付质量和效率，但是要想用好这些实践，涉及到的因素很多，常见的如下：</p>\n<ul>\n<li><p>Scrum里需要Product Owner, 客户方很少能有一个比较符合Scrum里提到的Product Owner来定义需求为As a role I want to do something so that I can get some benefit.</p></li>\n<li><p>行为驱动开发BDD对客户方要求更高，客户需要写Specific, Scenaro, Given...When...Then. 我做过一个项目，客户开始写BDD,而且也能写出比较高质量的BDD, 但是客户后来就不写了，觉得写的麻烦。</p></li>\n<li><p>我们主要使用.NET，虽然大家都熟悉面向对象，熟悉类，接口，继承，封装等等，但是面对一个项目的时候，如何对业务就行合适的抽象，正确使用面向对象依然是非常大的挑战。</p></li>\n<li><p>由于使用敏捷，不再像之前传统开发过程中有详细的需求说明书（假定那个需求说明书及时更新，且描述准确易于理解), 强调的是可工作的软件，但是很多业务逻辑很难通过界面来体现，虽然有User story, 但是就像第一步PO很难写出符合SMART原则的用户故事，常出现的情况，就是PO说一个需求的大意，程序员就“秒懂”了，最后也确实开发出了经过验收测试的软件，但是因为有测试和Feedback的修复，这一类的需求就“丢失”了。</p></li>\n<li><p>人员变动，软件行业成员变动是很正常的现象，但是很多小团队一个萝卜一个坑，如果没有好的方法，项目的相关context就丢失了，且不说有的人走的时候没有心思做交接，就算想好好做交接，也只能是最大程度减少项目相关内容不能很好传递。</p></li>\n</ul>\n<p>几年前，当我开始做分公司的时候，刚开始我一直在致力于敏捷的推行，好的软件开发实践的实践，很多同事的软件技能大幅提升，比如熟悉了很多Clean Code的东西，单元测试的重要性和好处，持续集成，Gitflow等的好处。但是有几个问题一直是我在考虑的问题</p>\n<ol>\n<li>如何减少客户反馈的bug, 虽然敏捷强调客户频繁互动和反馈来让错误无限靠近开发的时间，但是能把事情一次做对而不是多次改对依然能大幅提高项目提交速度，也就节省了客户的成本，提高了开发程序员的效率。</li>\n<li>人员变更时候的知识传递，虽然清晰的软件架构，整洁的代码，高的单元测试覆盖率能大幅加快新的人员理解项目的速度，但是看用户故事，单元测试以及散落在很多类中的代码（单一职责的时候，我们会有大量类，注意：这里不是说不要单一职责）对中途加入项目的人依然是需要较长时间熟悉项目和代码。</li>\n<li>提高开发人员软件技能，提高开发效率从而提高对客户的产出，然后开发人员的薪水自然能有对应的提升是做为一个分公司负责人的第一责任，员工第一嘛！另一个方面，我认为相对简单的项目，比如一些CRUD项目，一些前端项目比如Angular/React的项目报价越来越低。主要是研究前端以及学习这些框架的毕业生越来越多（注：这里并没有任何贬低前端的意思，现在前端要想做好也需要很多技能和设计思想), 我们必须去接一些\"不好做\"的项目，也就是业务复杂，需求复杂类的，这类项目才能提升程序员的能力而且报价相对较高。</li>\n</ol>\n<p>追求软件卓越，原来，我一直强调质量和效率的重要性，但是大家很难理解和应用，突然有一天，我想到（也许从别的地方看到的），软件最重要的是要解决两个问题：</p>\n<ol>\n<li><p><strong>做正确的事情 (Do Right Thing)</strong></p></li>\n<li><p><strong>把事情做正确 (Do Thing Right)</strong></p></li>\n</ol>\n<h2 id=\"初遇领域驱动设计\">初遇领域驱动设计</h2>\n<p><strong>做正确的事情 (Do Right Thing)</strong></p>\n<p><strong>把事情做正确 (Do Thing Right)</strong></p>\n<p>一直在我脑海里，然后简单的CRUD项目越来越没竞争力，程序员的报价难以提高，自然薪水就会有瓶颈，而我也想解决这样的问题，突然有一天我看到了另一句话：<strong>我选择做这件事，不是因为他简单，而是因为他难</strong>，这句话对我触动很大。我的脑海里就一直萦绕着“简单”，“复杂”，“麻烦”， 于是我要做的事情就是下面三个:</p>\n<p><strong>做正确的事情 (Do Right Thing)</strong></p>\n<p><strong>把事情做正确 (Do Thing Right)</strong></p>\n<p><strong>做难的事情 (Do Hard Thing)</strong></p>\n<p>我就在网上搜索Complex, Software 等，一本叫做Domain Driven Design的这本书出现在我面前，Domain Driven Design这个词语早就听说过，但是更吸引我的是副标题 \"Tackling complexity in the heart of software\", 我就大概看了一下书，里面的战略设计正好提供了解决复杂业务的方法，统一语言，Bounded Context, 界限上下文，设计就是代码，代码就是设计等等。 我相信这正是解决 <strong>做难的事情</strong>，<strong>做正确的事情</strong> 但是对战略有些了解，怎么去实现呢？一直没有一个好的例子来帮助大家如何使用领域驱动设计，直到一本《实现领域驱动设计》这本书的出现，才真的让我们有了打通任督二脉的机会。</p>\n<p><img class=\"img-responsive\" src=\"http://images.cnblogs.com/cnblogs_com/cnblogsfans/172349/o_DDDBook.jpg\"><br>\n<img class=\"img-responsive\" src=\"http://images.cnblogs.com/cnblogs_com/cnblogsfans/172349/o_implementingDDD.jpg\"></p>\n<h2 id=\"实践领域驱动设计\">实践领域驱动设计</h2>\n<p>有了《领域驱动设计》和《实现领域驱动设计》两大神器，也只是向美女要了个联系方式和家庭住址而已，中间还隔了一个漫长的日落和日出，没有正式的项目，我们永远是在岸上游泳，虽然我们也在项目里开始或多或少使用了领域的一些概念，但是我们应该知道基于数据驱动(Database Driven) 是很难成功应用领域驱动设计的。正好这个时候公司来了一个项目（客户是Fortune Global 500), 他们的架构师指定要求使用领域驱动设计，这让我非常兴奋，让我们有机会对复杂业务进行领域驱动开发的实践。</p>\n<p>就像实现领域驱动力说的一样，领域驱动主要有两大块儿战略设计和战术设计。</p>\n<h3 id=\"战略设计-do-right-things\">战略设计 (Do Right Things)</h3>\n<h3 id=\"ubiquitous-language\">Ubiquitous language</h3>\n<p>领域驱动开发让业务专家(Domain Expert)和开发人员一起来梳理业务，而双方有效沟通的方式是使用通用语言，在这个项目里，一开始我们就定义了很多<strong>词汇表</strong>, 就是我们自己的通用语言。</p>\n<h3 id=\"bounded-context-和-domain\">Bounded Context 和 Domain</h3>\n<p>有了通用语言，<strong>词汇表</strong> 每一个词汇一定是有边界的，不同的边界内是不一样，比如你爱人在你家这个Bounded Context是你的Wife, 但是如果她是一个老师，那么在学校这个边界里就是一个Teacher. 我们经过多次讨论，采取的方法是拆成多个子系统（Bounded Context,是不是很像现在的微服务？)，每个子系统进行自治。</p>\n<p>随后我们把一个个业务抽象为领域对象(Domain Model), 每一个Domain对领域进行自治。而模型里的属性和行为表达为业务专家都可以理解的代码，用比如Job.Publish(). 虽然这里面最终产生了聚合根、实体、值对象等，但是我们和业务专家沟通的时候尽量不要说这些词汇，比如我们可以说， 在招聘这块儿，职位是不是必须经过公司进行管理，那样我们就知道 Job是属于公司这个聚合根。 对领域进行“通用”（类名，方法名等都用自然语言表达）建模，业务人员可以直接读懂我们的代码，从而可以知道是否表达了业务需求。</p>\n<h3 id=\"战术设计-do-things-right\">战术设计 (Do Things Right)</h3>\n<p>在战术设计方面，由于业务行为和规则都在领域里，而且系统被拆分成多个子系统，这对技术实现上带来了非常大的挑战，尤其是大部分人都是有牢固的基于数据驱动开发的思想。 技术上有不同实现方式，但是一开始我们选择了“最佳实践”(实现领域驱动设计)，也就是使用了Event Source和CQRS, 但是这条路是陡峭的。</p>\n<h4 id=\"event-sourcing\">Event Sourcing</h4>\n<p>Event Sourcing 就是我们不记录数据的最终状态，我们记录对数据的每一次改变(Event)，而读取的时候我们把这些改变从头再来一遍来取得数据状态，比如你有100块钱，现在剩下10块了，我们记录的不是money.total=10, 而是记录你每一次取钱的记录，然后从100块开始一步步重放你取钱的过程，来得到10.</p>\n<p>一开始，我们写的过程中，时常回想起数据驱动的好，（每次开始一个新东西的时候，是不是很熟悉的感觉？)，觉得用Event Sourcing各种麻烦，直到后来随着系统的复杂性不断增加，我们才感觉到带来了非常大的好处, 这个随后单独来说。</p>\n<h4 id=\"cqrs\">CQRS</h4>\n<p>由于使用了EventSourcing, 对数据查询，尤其是跨业务(aggregate)的查询非常麻烦，很难像关系数据那样有查询优势，CQRS是解决这一问题非常好的方法，CQRS让查询和写入分开，把界面需要查询的数据进行原样写入，原样的意思就是界面显示什么样的，就提前保存成什么样的，类似于原来的缓存，没有任何join操作，这样查询是非常高效的。</p>\n<h2 id=\"实践领域驱动过程中面临的技术挑战\">实践领域驱动过程中面临的技术挑战</h2>\n<p><strong>最大的挑战当然是战略设计部分</strong> 就是正确的划分Bounded Context和领域建模，这个部分这里难以几句话说清楚，只能多实践，多向大师学习，比如试试Event Storming的方式。</p>\n<p>然后，如果团队没有任何领域驱动开发的经验，千万不要低估技术部分的挑战，并不是很多人说的技术部分不重要，如果实现不好，领域驱动很难落地。我们遇到一些典型问题，当然后来都很好的解决。</p>\n<ol>\n<li><p>开发人员认为EventSourcing不重要，比如，原来你要发布一个Job, 你可能只需要改一个属性Job.Status=\"Published\", 但是现在你需要定义一个JobPublishedEvent的事件，很多时候一次改变需要定义很多事件，比如CompanyNameChangedEvent, CompanyEmployeeAddeedEvent. 最重要的是事件的粒度如何定义？</p></li>\n<li><p>由于根据Bounded Context拆分成一个个子系统，系统之间的交互比较麻烦。原来在一个Controller里直接调用不同的Repository来改变数据的方式就很不适用了。</p></li>\n<li><p>由于使用CQRS,查询必须要单独保存QueryModel, 这相对传统的数据库驱动的开发方法，写和读都是同一个数据库更加麻烦。</p></li>\n<li><p>事件的版本管理，比如事件改名，删除和增加都需要考虑重放事件重建领域对象的影响。</p></li>\n<li><p>CQRS如何保证数据的及时性和一致性，比如我在一个公司详细页面修改了一个公司名字，然后点击保存按钮导航到公司列表页面，这个时候QueryModel可能还没有更新过来，这些如何解决一致性的问题。</p></li>\n</ol>\n<h2 id=\"领域驱动开发如何让我们和客户共同获益的\">领域驱动开发如何让我们和客户共同获益的</h2>\n<ol>\n<li><p>做正确的事情(Do Right Things): 领域专家高效的和团队沟通，确保建立了正确的反映业务规则的模型，而开发人员有了直接可以使用的代码，而且可以因为Domain有了数据和行为，非常方便的进行<strong>单元测试</strong>，因为Domain不依赖第三方的数据存储等，可以确保实现了业务。</p></li>\n<li><p>大大提高了沟通的效率，我们知道一图胜千言，而对开发人员来说，少废话，Show me the code! 不但代码对程序员更容易读，而且Code（领域对象)就是最新的需求. 可以跑起来的需求。</p></li>\n<li><p>大大提高新成员进入项目的速度，最主要的是看领域模型以及对领域模型的测试，几乎就知道了系统的所有的业务规则。</p></li>\n<li><p>领域驱动的技术部分给系统增加功能或扩展带来了极大的遍历，举几个例子：</p>\n<p>a. 由于使用了事件溯源，我们很容易查询历史数据。我们只需要指定一个时间点，我们重放事件的时候重放到这个时间点就可以了。</p>\n<p>b. 操作日志，原来如果我们想记录操作日志我们代码里遍布都是Log, 而现在我们只需要重发事件，想看什么日志就看什么日志，而这些就只需要我们回放数据库存储的事件流就可以了。</p>\n<p>c. 系统之间的通信，我们只需要发布事件就可以了，其它系统订阅我们的事件就可以，我们和其它系统之间没有直接依赖。</p>\n<p>d. 大大提高了系统增加新功能的方便性，很多时候增加新功能就是订阅事件就可以了。</p>\n<p>f. CQRS, Query model极大的提高了系统的查询性能，而且当我需要新的界面的时候，我不需要对写入端代码进行任何修改，包括类文件都不用修改，是不是符合对修改关闭，对扩展开放(OCP)？ 我们只需要建一个类似新的EventHandler，然后重放对应的事件就可以了。</p>\n<p>e. 因为使用了事件溯源，系统之间通过事件集成，比如通过消息队列发布和订阅事件，这可以大大增加系统的<strong>抗压能力</strong>，我们可以把事件放入队列，后续处理系统即使不能及时处理也不会让前端系统崩溃。</p>\n<p>f. 系统性能大福提高，在写入端只有插入操作，没有修改操作，在读取端只有Read操作，那么何须锁表，何须开启事务？由此一来，输出存储和读取的瓶颈可以大大缓解。</p></li>\n<li><p>开发人员可以更集中的处理业务，由于一切都是事件，实现玩基础库后，开发人员可以忽略数据存储，大部分时间都是在写业务代码，不关心数据怎么存储，数据存储部分就俩操作 AggregateRoot.Get(id), AggregateRoot.Save(), EventPublish.Pubish(CompanyNameChangedEvent), 而事件订阅端只需要增加一个EventHandler就可以了。</p></li>\n<li><p>系统很好进行了解耦，业务逻辑集中在领域中，不会像之前的开发里面业务逻辑充斥在很多地方，修改一些功能的时候，不得不如履薄冰，生怕哪里给破坏了，或者哪里没考虑全。</p></li>\n<li><p>不用过于担心开发人员，尤其初级开发人员不正确的代码遍布系统多个部分，对其它功能的影响可以大大减低，Review代码其实主要Review业务实现的单独的类，不用担心很多技术实现部分不正确，因为基础库写好了，这样可以适当均衡团队成员组成来降低项目开发成本。</p></li>\n</ol>\n<p>最后，<strong>系统更加容易修改和增加新功能，不正好支持了敏捷开发的“拥抱变化”吗？</strong></p>\n<h2 id=\"总结\">总结</h2>\n<p>领域驱动开发好处多多，概念比较多，门槛相对较高，对人员要求较高，团队里至少需要有领路人，不然代价会比较大。 尤其慎用Event Sourcing, 而领域驱动尤其适合业务相对复杂的项目。 对那些很小的项目，CRUD仍然是好的选择。</p>\n<p>最后，如果你对领域驱动比较感兴趣，欢迎与我联系探讨 <a href=\"mailto:wangdeshui@outlook.com\">wangdeshui@outlook.com</a></p>\n</div><div id=\"MySignature\"></div>\r\n        <div class=\"clear\"></div>\r\n        <div id=\"blog_post_info_block\">\r\n        <div id=\"blog_post_info\">\r\n        </div>\r\n        <div class=\"clear\"></div>\r\n        <div id=\"post_next_prev\"></div>\r\n    </div>\r\n</div>\r\n    <ul class=\"postmetadata\">\r\n        <li class=\"icon_cat\" id=\"BlogPostCategory\">\r\n        <li class=\"icon_bullet\" id=\"EntryTag\">\r\n    </ul>\r\n</div>\r\n<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=30341,cb_entryId=7767162,cb_blogApp=currentBlogApp,cb_blogUserGuid='8e823d0b-63cf-dd11-9e4d-001cf0cd104b',cb_entryCreatedDate='2017/11/1 16:47:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n<script type=\"text/javascript\">\r\n    var m = window.__blog.postRendered;\r\n    if (m) { m(__$(\"post\")); }\r\n</script>\r\n<script type=\"text/javascript\">\r\n    var m = window.__blog.postRenderPosts;\r\n    if (m) { m(); }\r\n</script>\r\n</div>", "article_view": 431, "image_url": ["https://pic.cnblogs.com/face/26781/20140308114159.png"], "date_pub": "2017-11-01", "article_common": 5}
{"title": "多线程编程学习笔记——线程同步（二）", "url": "http://www.cnblogs.com/chillsrc/p/7766589.html", "author": "DotNet菜园", "article_desc": "\r\n    程序中，我们定义了两个AutoResetEvent实例。其中一个是从子线程往主线程发信号 ，另一个是主线程往子线程发信号。我们在构造AutoResetEvent时，传入了false，定义了这两个实例的初始状态unsignaled。这个状态下，任何线程调用这两个实例的WaitOne方法将会被阻塞，直到... ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/chillsrc/p/7766589.html\">多线程编程学习笔记——线程同步（二）</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h1> <span style=\"font-size: 16px;\">接上文 <span style=\"color: #0000ff;\"><a id=\"homepage1_HomePageDays_DaysList_ctl01_DayList_TitleUrl_0\" class=\"postTitle2\" href=\"http://www.cnblogs.com/chillsrc/p/7743930.html\"><span style=\"color: #0000ff;\">多线程编程学习笔记——线程同步（一）</span></a></span></span></h1>\r\n<h1><span style=\"font-size: 16px;\">四、使用AutoResetEvent</span></h1>\r\n<p><span style=\"font-size: 16px;\">1. 使用AutoResetEvent类来实现从一个线程向另一个线程发出通知。</span></p>\r\n<p><span style=\"font-size: 16px;\">2.代码如下</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Collections.Generic;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Linq;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Text;\r\n</span><span style=\"color: #0000ff;\">using</span> System.Threading; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">引入线程</span>\r\n<span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Diagnostics;\r\n\r\n</span><span style=\"color: #0000ff;\">namespace</span><span style=\"color: #000000;\"> ThreadSynchronousDemo\r\n{\r\n    </span><span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Program\r\n    {\r\n\r\n        </span><span style=\"color: #0000ff;\">static</span> AutoResetEvent autoResetWork = <span style=\"color: #0000ff;\">new</span> AutoResetEvent(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #0000ff;\">static</span> AutoResetEvent autoResetMain = <span style=\"color: #0000ff;\">new</span> AutoResetEvent(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> Main(<span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\">[] args)\r\n        {\r\n\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">开始，AutoResetEvent 同步</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);       \r\n\r\n                </span><span style=\"color: #0000ff;\">string</span> threadName = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">线程 1</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;         \r\n                </span><span style=\"color: #0000ff;\">var</span> t = <span style=\"color: #0000ff;\">new</span> Thread((() =&gt; working(threadName, <span style=\"color: #800080;\">10</span><span style=\"color: #000000;\">)));\r\n\r\n                t.Start();\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">开始，第一次工作</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n \r\n\r\n            autoResetWork.WaitOne();</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">万事俱备只欠东风，事情卡在这里了，</span>\r\n<span style=\"color: #000000;\">\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">第一次工作完成</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">主线程操作，准备发信号</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            Thread.Sleep(TimeSpan.FromSeconds(</span><span style=\"color: #800080;\">5</span><span style=\"color: #000000;\">));\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">发信号，说明值已经被写进去了。这里的意思是说Set是一个发信号的方法。</span>\r\n<span style=\"color: #000000;\">\r\n            autoResetMain.Set();\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">现在运行第二次工作。</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            autoResetWork.WaitOne();\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">第二次工作完成</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            Console.Read();\r\n        } \r\n\r\n        </span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> working(<span style=\"color: #0000ff;\">string</span> name,<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> seconds)\r\n        {\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">{0} 开始运行工作</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, name);\r\n            Thread.Sleep(TimeSpan.FromSeconds(seconds));\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">{0}  正在工作。。。。。。</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n              name);\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">发信号，说明值已经被写进去了。这里的意思是说Set是一个发信号的方法。</span>\r\n<span style=\"color: #000000;\">\r\n            autoResetWork.Set();\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">等待主线程完成工作，并发出信号</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            autoResetMain.WaitOne();\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">主线程发来信号，开始第二次工作</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            Thread.Sleep(TimeSpan.FromSeconds(seconds));\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">{0} 第二次工作正在进行中。。。。。</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, name);\r\n            autoResetWork.Set();\r\n        }\r\n    }\r\n}\r\n </span></pre>\r\n</div>\r\n<p><span style=\"font-size: 16px;\">3.程序运行结果，如下图。</span></p>\r\n<p><span style=\"font-size: 16px;\"> <img src=\"http://images2017.cnblogs.com/blog/10343/201711/10343-20171101150418279-1847875723.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-size: 16px;\">         以上程序中，我们定义了两个AutoResetEvent实例。其中一个是从子线程往主线程发信号 ，另一个是主线程往子线程发信号。我们在构造AutoResetEvent时，传入了false，定义了这两个实例的初始状态unsignaled。这个状态下，任何线程调用这两个实例的WaitOne方法将会被阻塞，直到我们调用了Set方法。如果我们在构造的时候传入了true，则这两个实例的初始状态是singnaled，则线程调用WaitOne则会被立即处理。</span></p>\r\n<p><span style=\"font-size: 16px;\"> </span></p>\r\n<p><span style=\"font-size: 16px;\">五、使用ManualResetEventSlim类</span></p>\r\n<p><span style=\"font-size: 16px;\">1. 使用ManualResetEventSlim在线程间传递信号。</span></p>\r\n<p><span style=\"font-size: 16px;\"> 2.代码如下 <br></span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Collections.Generic;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Linq;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Text;\r\n</span><span style=\"color: #0000ff;\">using</span> System.Threading; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">引入线程</span>\r\n<span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Diagnostics; \r\n\r\n</span><span style=\"color: #0000ff;\">namespace</span><span style=\"color: #000000;\"> ThreadSynchronousDemo\r\n{\r\n    </span><span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Program\r\n    {\r\n        </span><span style=\"color: #0000ff;\">static</span> ManualResetEventSlim manuResetWork = <span style=\"color: #0000ff;\">new</span> ManualResetEventSlim(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);      \r\n\r\n        </span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> Main(<span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\">[] args)\r\n        {\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">开始，ManualResetEventSlim 同步</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);       \r\n\r\n                </span><span style=\"color: #0000ff;\">string</span> threadName = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">线程 1</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #0000ff;\">string</span> threadName2 = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">线程 2</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n \r\n\r\n            </span><span style=\"color: #0000ff;\">string</span> threadName3 = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">线程 3</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #0000ff;\">var</span> t = <span style=\"color: #0000ff;\">new</span> Thread((() =&gt; working(threadName, <span style=\"color: #800080;\">3</span><span style=\"color: #000000;\">)));\r\n            </span><span style=\"color: #0000ff;\">var</span> t2 = <span style=\"color: #0000ff;\">new</span> Thread((() =&gt; working(threadName2, <span style=\"color: #800080;\">6</span><span style=\"color: #000000;\">)));\r\n\r\n            </span><span style=\"color: #0000ff;\">var</span> t3 = <span style=\"color: #0000ff;\">new</span> Thread((() =&gt; working(threadName3, <span style=\"color: #800080;\">12</span><span style=\"color: #000000;\">)));\r\n\r\n            t.Start();\r\n            t2.Start();\r\n            t3.Start();\r\n            Thread.Sleep(TimeSpan.FromSeconds(</span><span style=\"color: #800080;\">5</span><span style=\"color: #000000;\">));\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">开始，打开 线程工作大门</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            manuResetWork.Set(); </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">发信号</span>\r\n            Thread.Sleep(TimeSpan.FromSeconds(<span style=\"color: #800080;\">3</span><span style=\"color: #000000;\">));\r\n            manuResetWork.Reset();\r\n           \r\n\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">线程工作大门，关闭</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);         \r\n\r\n            Thread.Sleep(TimeSpan.FromSeconds(</span><span style=\"color: #800080;\">10</span><span style=\"color: #000000;\">));\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">打开线程工作大门第二次打开了</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            manuResetWork.Set(); </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">发信号</span>\r\n            Thread.Sleep(TimeSpan.FromSeconds(<span style=\"color: #800080;\">3</span><span style=\"color: #000000;\">));\r\n            manuResetWork.Reset();\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">线程工作大门，又关闭了</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            Console.Read();\r\n        }\r\n\r\n        </span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> working(<span style=\"color: #0000ff;\">string</span> name,<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> seconds)\r\n        {\r\n\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">{0} 休息</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, name);\r\n            Thread.Sleep(TimeSpan.FromSeconds(seconds));\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">{0}  等待打开线程运行的大门</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n              name);\r\n            manuResetWork.Wait();\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">线程运行的大门打开了，{0} 进行工作</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, name);       \r\n\r\n        }\r\n    }\r\n}</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 16px;\">3.程序运行结果，如下图。</span></p>\r\n<p><span style=\"font-size: 16px;\"><img src=\"http://images2017.cnblogs.com/blog/10343/201711/10343-20171101150504138-2059178676.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-size: 16px;\">      当主程序启动时，首先创建ManualResetEvenSlim类的一个实例，然后启动了三个线程，等待事件信号通知它们继续工作。</span></p>\r\n<p><span style=\"font-size: 16px;\">      ManualResetEvenSlim的工作方式有点像人群通过大门，而AutoResetEvent事件像一个旋转门，一次只能通过一人。</span></p>\r\n<p><span style=\"font-size: 16px;\">      ManualResetEvenSlim打开了大门，一直保持打开，直到调用了Reset方法。直到再次调用Set方法打开 大门。</span></p>\r\n<p><span style=\"font-size: 16px;\"> </span></p>\r\n<p><span style=\"font-size: 16px;\">六、使用CountDownEvent类</span></p>\r\n<p><span style=\"font-size: 16px;\">1. 使用CountDownEvent信号类来等待直到一定数量的操作完成。</span></p>\r\n<p><span style=\"font-size: 16px;\">2.代码如下</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Collections.Generic;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Linq;\r\n</span><span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Text;\r\n</span><span style=\"color: #0000ff;\">using</span> System.Threading; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">引入线程</span>\r\n<span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Diagnostics; \r\n\r\n</span><span style=\"color: #0000ff;\">namespace</span><span style=\"color: #000000;\"> ThreadSynchronousDemo\r\n{\r\n    </span><span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Program\r\n    {\r\n        </span><span style=\"color: #0000ff;\">static</span> CountdownEvent CountDownWork = <span style=\"color: #0000ff;\">new</span> CountdownEvent(<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">);      \r\n\r\n        </span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> Main(<span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\">[] args)\r\n        {\r\n\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">开始，CountdownEvent 同步</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);       \r\n\r\n            </span><span style=\"color: #0000ff;\">var</span> t = <span style=\"color: #0000ff;\">new</span> Thread((() =&gt; working(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">第 1 个工作线程任务</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800080;\">3</span><span style=\"color: #000000;\">)));\r\n            </span><span style=\"color: #0000ff;\">var</span> t2 = <span style=\"color: #0000ff;\">new</span> Thread((() =&gt; working(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">第 2 个工作线程任务</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800080;\">6</span><span style=\"color: #000000;\">)));\r\n\r\n            //</span><span style=\"color: #008000;\">var t3 = new Thread((() =&gt; working(\"第 3 个工作线程任务\", 12)));</span>\r\n<span style=\"color: #000000;\">            t.Start();\r\n            t2.Start();\r\n            //</span><span style=\"color: #008000;\">t3.Start();</span>\r\n            Thread.Sleep(TimeSpan.FromSeconds(<span style=\"color: #800080;\">5</span><span style=\"color: #000000;\">));\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">开始，线程工作计数</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            CountDownWork.Wait();           \r\n\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">计数完成，2个工作 已经完成！</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果把上面代码注释的第三个线程还原，释放对象，可以造成第三个线程的抛出错误</span>\r\n<span style=\"color: #000000;\">\r\n            CountDownWork.Dispose();     \r\n\r\n            Console.Read();\r\n        } \r\n\r\n        </span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> working(<span style=\"color: #0000ff;\">string</span> message,<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> seconds)\r\n        {\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">工作前休息 {0}</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,DateTime.Now.Second);\r\n            Thread.Sleep(TimeSpan.FromSeconds(seconds));\r\n            Console.WriteLine(message);          \r\n\r\n            CountDownWork.Signal();\r\n            Console.WriteLine(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">发出计数信号， 工作已经完成一项</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);      \r\n\r\n        }\r\n    }\r\n}\r\n\r\n </span></pre>\r\n</div>\r\n<p><span style=\"font-size: 16px;\">3.程序运行结果如下图。</span></p>\r\n<p><span style=\"font-size: 16px;\"><img src=\"http://images2017.cnblogs.com/blog/10343/201711/10343-20171101150526357-802183576.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-size: 16px;\">     程序启动时，创建了一个CountDownEven实例，在构造中指定了，当两个操作完成时给出信号。然后我们启动了两个线程进行工作，当第二个线程完成操作时，主线程从等待CountDownEvent的状态中返回并继续工作。这个类使用场景是，主线程需要等待多个线程完成工作之后，才能继续的情形。</span></p>\r\n<p><span style=\"font-size: 16px;\">缺点：必须要等待指定数量的线程全部完成工作，否则就一直会等待，请确保使用CountDownEvent时，所有线程完成工作后，都要调用Signal方法。</span></p>\r\n<p><span style=\"font-size: 16px;\">说明：</span></p>\r\n<p><span style=\"font-size: 16px;\">1)  把上面代码中注释的第三个线程的代码，还原则会出现以下错误。</span></p>\r\n<p><span style=\"font-size: 16px;\"> <img src=\"http://images2017.cnblogs.com/blog/10343/201711/10343-20171101150542295-177565557.png\" alt=\"\"></span></p>\r\n<p align=\"left\"><span style=\"font-size: 16px;\">2) 如果把 第三个线程启用，同时把 CountDownWork.Dispose();注释，则会出现以下错误信息。</span></p>\r\n<p><span style=\"font-size: 16px;\"> <img src=\"http://images2017.cnblogs.com/blog/10343/201711/10343-20171101150629123-976557768.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-size: 16px;\"> </span></p>\r\n<p><span style=\"font-size: 16px;\"> </span></p>\r\n<p><span style=\"font-size: 16px;\"> </span></p>\r\n<p><span style=\"font-size: 16px;\"> </span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 15:08</span> <a href=\"http://www.cnblogs.com/chillsrc/\">DotNet菜园</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766589\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766589);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=13897,cb_entryId=7766589,cb_blogApp=currentBlogApp,cb_blogUserGuid='c642360b-63cf-dd11-9e4d-001cf0cd104b',cb_entryCreatedDate='2017/11/1 15:08:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 261, "image_url": ["https:"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "程序员的未来在哪里？", "url": "http://www.cnblogs.com/chanshuyi/p/the_future_of_coder.html", "author": "陈树义", "article_desc": "程序员的未来在哪里？ 随着互联网创业潮的兴起，作为互联网核心的工程师们逐渐走入了大众的视野。但不知为何，程序员在许多人中的印象并不是特别好，蓬头垢面、满脸油光、格子衫、小短裤似乎成了程序员的代名词。 反观同一公司里的其它岗位，产品、运营、市场岗位，却并不会给人留下不好的印象。同样作为程序员的我，不得 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/chanshuyi/p/the_future_of_coder.html\">程序员的未来在哪里？</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"程序员的未来在哪里\">程序员的未来在哪里？</h1>\n<p><img src=\"http://images2017.cnblogs.com/blog/595137/201711/595137-20171101151050904-1203771584.jpg\"></p>\n<p>随着互联网创业潮的兴起，作为互联网核心的工程师们逐渐走入了大众的视野。但不知为何，程序员在许多人中的印象并不是特别好，蓬头垢面、满脸油光、格子衫、小短裤似乎成了程序员的代名词。</p>\n<p>反观同一公司里的其它岗位，产品、运营、市场岗位，却并不会给人留下不好的印象。同样作为程序员的我，不得不去思考这个问题：为什么收入并不比别人低，但为什么形象却不如人家？既然这样，那我们的努力有何意义？我们的未来到底在哪里？</p>\n<h1 id=\"文章首发于博客园-陈树义点击跳转到原文程序员的未来在哪里\">文章首发于<a href=\"http://www.cnblogs.com/chanshuyi\">【博客园-陈树义】</a>，点击跳转到原文<a href=\"http://www.cnblogs.com/chanshuyi/p/the_future_of_coder.html\">程序员的未来在哪里？</a>。</h1>\n<h2 id=\"程序员的出身\">程序员的出身</h2>\n<p>要透彻地思考这个问题，就避不开出身这个根源问题。</p>\n<p>当离开养育我十几年的故乡踏上广州的求学之路时，我每个月只有800块的生活费。而这其实已经算是挺不错的生活条件了，有更多生活条件比我还差的同学。在吃饭问题刚刚得到解决，没有闲钱的情况下，人是没有能力去追求更高的物质享受的。</p>\n<p>在大学四年的时间里，我一心牵挂的是如何好好学习找到一份养家糊口的工作。于是乎我的大学可以说是比较平平淡淡的，经常是和好基友在自习室看书到晚上十余点。在现在看来，有时候会有那么一瞬间会觉得浪费了大学的大好时光，没有花点时间去学点才艺，但仔细想想也实属无奈，吃饭都成问题，还怎么追求精神享受呢。</p>\n<p>相信许多选读计算机的朋友也和我一样，并不是来自于大富大贵的家庭，更多的是普通的家庭。有一句话说得很好：穷人读工科、中产读商科、富人读艺术。对于绝大部分的普通人来说，合理的套路是：第一代读理工医科，有一技之长，安家立命，打好基础；第二代才能读金融商科，可以利用第一代的资源人脉，加强资本积累；最后第三代读人文社科，有前两代的基础，知道如何长久的维护他们手上的资源。根据我的观察，周围的程序员们确实出身于普通家庭，有的甚至是大山里的孩子。对于没有背景没有人脉的他们，有一技之长，安家立命才是最重要的。</p>\n<h2 id=\"程序员的本质\">程序员的本质</h2>\n<p>在大学毕业后，毕业后拿到一份还算可以的薪资，但至少能养活自己。而且在后面几年里薪资也不断增长，至少现在的我已经不需要担心生存问题了。但这时我发现此时的我除了工作，似乎一无所有，没有兴趣、没有爱好、没有才艺、没有活动。</p>\n<p>我想去充实自己的业余生活，去学一门才艺、去发展一门爱好，但却发现时间怎么都不够用。此时，我渐渐意识到了程序员这个行业的本质所在。程序员钱多，但加班也多，个人的业余时间也变得少了。长此以往，整个人的交际技能会逐渐退化，人的生活也会变得稍微无趣。</p>\n<p>除了工作时间外，工作内容也是让人变得无趣的一个方面。程序员的内容都是各种枯燥的业务逻辑和机器，而且技术难题都需要静下心来才能深入理解。如果你的生活太精彩，你怎么可能静得下心来去做这么枯燥无味的事情啊。</p>\n<p>所以程序员的本质是出卖自己的时间和技能换取金钱，可以说是一个高级点的技工，只不过过得舒服自在点罢了。</p>\n<h2 id=\"程序员为什么不受待见\">程序员为什么不受待见</h2>\n<p>知名科技博主月光博客曾经写过一篇文章《为什么程序员社会地位不高》，这篇文章很深刻地解释了程序员不受待见的原因。</p>\n<p><strong>程序员的自我尊重和自我认知价值太低。</strong>有一个现象可以证明这一点：程序员们互相厌恶。他们通常在非程序员面前抨击别的程序员。把一个程序员的代码给另外一个程序员，往往，常常，后者会给前者的工作以负面评价。艺术家不会这样。销售员不会这样。管理者不会这样。政治家这么做只是为了赢得选票。</p>\n<p>其他专业人士他们会公开的支持同行，即使他们有竞争。（例如律师，请不要问我为什么美国事实上是被这帮混蛋统治的）。简而言之，上面提到的这些行业人员拥有更大的行业事业，以自己的工作和行业自豪。</p>\n<p><strong>程序员们并不追求浮华的头衔，性感的典礼、奖项、他们讨厌聚光灯。</strong></p>\n<p>程序员们喜欢编程。他们想要独自编程。编程是他们的目标，是他们的政治，是他们的荣耀。他们对公共演讲不感兴趣。他们讨厌不如他们聪明的人。他们讨厌不理解C++编程逻辑的人。</p>\n<p>于是他开始慢慢说服自己生来就是内向的。所以他害怕外出，害怕接电话，害怕去泡吧，害怕去见陌生人，害怕所有能为他建立社会关系和社会地位的活动。</p>\n<h2 id=\"程序员的未来\">程序员的未来</h2>\n<p>赚钱有三个层次，第一个层次是拿时间换金钱，第二个层次是拿资源换金钱，第三个层次是用钱赚钱。作为程序员的我显然还是处于拿时间换金钱的阶段，所以在很长时间里，我还是会作为一名程序员生活着。在这个阶段，我们积累技术、资源，为下个阶段做准备。</p>\n<p>当我们有了足够的技术实力和人脉资源之后，我们或许就不必事必躬亲去做一线代码工作了，我们可以拿着我们拥有的资源更加轻松地赚钱。这时候如果你还是喜欢Coding，你可以更加自由地做自己想做的事。这个阶段的你，生活必定比苦哈哈地干活来得有滋有味。</p>\n<p>而当你用资源交换得到的财富到达一个量级时，你完全可以通过投资去获取生活所需要的物质条件，这才真的是躺着赚钱。在这个阶段，你才可以真的说是人身自由的一个人。我想，到了这个阶段，你的梦想和对于这个世界的理解肯定会大有不同吧。</p>\n<p>想想刚刚毕业的我看着这几万几万的房价，一脸迷茫看不到希望，每天都在抱怨高房价中度过。但当我想通了我未来要走的路，我现在处于的阶段，我都释然了。该来的总会来的，该跌的房价总会跌，该涨的收入总会涨，该有的机会总会有。就像十年前总被说脑残的90后、被说成垮掉的一代，现在还不是走上了社会，担任了社会的中坚力量。</p>\n<p>其实回头想一想，程序员还是一个很幸运的群体，有这样一个顺畅的道路让你可以努力往上走。看看那些读机械、读食品专业的同学们，工作三年了现在估计还在几千块工资徘徊。想到这里，我很感激这个时代，给了我这么一个机会。</p>\n<p>想通了以后自己要走的路，该努力的努力，该吃的吃，该玩的玩。做该做的事情，尽量让自己的生活丰富起来，相信生活会越来越美好。</p>\n<h1 id=\"文章首发于博客园-陈树义点击跳转到原文程序员的未来在哪里-1\">文章首发于<a href=\"http://www.cnblogs.com/chanshuyi\">【博客园-陈树义】</a>，点击跳转到原文<a href=\"http://www.cnblogs.com/chanshuyi/p/the_future_of_coder.html\">程序员的未来在哪里？</a>。</h1>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 15:24</span> <a href=\"http://www.cnblogs.com/chanshuyi/\">陈树义</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766584\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766584);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=181264,cb_entryId=7766584,cb_blogApp=currentBlogApp,cb_blogUserGuid='dea53ec9-fa6e-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/11/1 15:24:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 2722, "image_url": ["https://pic.cnblogs.com/face/595137/20171101152702.png"], "date_pub": "2017-11-01", "article_common": 30}
{"title": "Android插件化-RePlugin项目集成与使用", "url": "http://www.cnblogs.com/codingblock/p/7766365.html", "author": "codingblock", "article_desc": "前言：前一段时间新开源了一种全面插件化的方案-- RePlugin，之前一种都在关注 DroidPlugin 并且很早也在项目中试用了，但最终没有投入到真正的生产环节，一方面是项目中没有特别需要插件化的需求，另一方面也考虑到 DroidPlugin 不是特别稳定，Android系统每更新一次 Dro ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/codingblock/p/7766365.html\">Android插件化-RePlugin项目集成与使用</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p data-source-line=\"1\"><strong>前言：</strong>前一段时间新开源了一种全面插件化的方案-- RePlugin，之前一种都在关注 DroidPlugin 并且很早也在项目中试用了，但最终没有投入到真正的生产环节，一方面是项目中没有特别需要插件化的需求，另一方面也考虑到 DroidPlugin 不是特别稳定，Android系统每更新一次 DroidPlugin 可能就会出现一些 Bug，毕竟 Hook 了 Android 原生的太多东西，系统一旦更新引发 Bug 是在所难免的。当然，这些并不能否认 DroidPlugin 的优秀，它的原理和思路值得我们深入探究、学习，前一段时间更新过几篇插件化的原理分析的文章（基于 DrodiPlugin 原理）学习过程中不得不叹服作者的思路和技术深度！前几篇小白也能看懂的插件化系列文章仍然会不定期更新，但目前我们可以先来学习学习 RePlugin，毕竟多学无害，也能互相参考他们的思路，比较优缺点。</p>\n<p data-source-line=\"3\">RePlugin 是一套完整的、稳定的、适合全面使用的、占坑类插件化方案：</p>\n<ul data-source-line=\"4\">\n<li>完整的：让插件运行起来“像单品那样”，支持大部分特性。</li>\n<li>稳定的：官方宣称，其框架奔溃率“万分之一”。</li>\n<li>适合全面使用的：其目的是让应用内的“所有功能皆为插件”。</li>\n<li>占坑类：以稳定为前提的 Manifest 占坑思路。</li>\n<li>插件化方案：基于 Android 原生 API 和语言来开发，充分利用原生特性。</li>\n</ul>\n<p data-source-line=\"10\">（以上定义引自官方wiki）</p>\n<h3 id=\"一-集成主工程\" data-source-line=\"11\">一、集成主工程</h3>\n<h4 id=\"1-在项目根目录的-buildgradle-下添加-replugin-host-gradle-依赖\" data-source-line=\"12\">1、在项目根目录的 build.gradle 下添加 RePlugin Host Gradle 依赖：</h4>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #000000\">buildscript {\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #000000\">    repositories {\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #000000\">        jcenter()\n</span><span style=\"color: #008080\"> 4</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\"> 5</span> <span style=\"color: #000000\">    dependencies {\n</span><span style=\"color: #008080\"> 6</span>         classpath 'com.android.tools.build:gradle:2.3.3'\n<span style=\"color: #008080\"> 7</span>         <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 1、添加RePlugin Host Gradle依赖</span>\n<span style=\"color: #008080\"> 8</span>         classpath 'com.qihoo360.replugin:replugin-host-gradle:2.2.1'\n<span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">10</span> }</pre>\n</div>\n<h4 id=\"2-在-appbuildgradle-下添加-replugin-host-library-依赖为了更清晰的表示出代码添加的位置将原有代码也一并贴出\" data-source-line=\"26\">2、在 app/build.gradle 下添加 RePlugin Host Library 依赖（为了更清晰的表示出代码添加的位置，将原有代码也一并贴出）：</h4>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> apply plugin: 'com.android.application'\n<span style=\"color: #008080\"> 2</span> \n<span style=\"color: #008080\"> 3</span> <span style=\"color: #000000\">android {\n</span><span style=\"color: #008080\"> 4</span>     compileSdkVersion 26\n<span style=\"color: #008080\"> 5</span>     buildToolsVersion \"26.0.1\"\n<span style=\"color: #008080\"> 6</span> <span style=\"color: #000000\">    defaultConfig {\n</span><span style=\"color: #008080\"> 7</span>         applicationId \"cn.codingblock.repluginstudy\"\n<span style=\"color: #008080\"> 8</span>         minSdkVersion 21\n<span style=\"color: #008080\"> 9</span>         targetSdkVersion 26\n<span style=\"color: #008080\">10</span>         versionCode 1\n<span style=\"color: #008080\">11</span>         versionName \"1.0\"\n<span style=\"color: #008080\">12</span>         testInstrumentationRunner \"android.support.test.runner.AndroidJUnitRunner\"\n<span style=\"color: #008080\">13</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">14</span> <span style=\"color: #000000\">    buildTypes {\n</span><span style=\"color: #008080\">15</span> <span style=\"color: #000000\">        release {\n</span><span style=\"color: #008080\">16</span>             minifyEnabled <span style=\"color: #0000ff\">false</span>\n<span style=\"color: #008080\">17</span>             proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'\n<span style=\"color: #008080\">18</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">19</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">20</span> <span style=\"color: #000000\">}\n</span><span style=\"color: #008080\">21</span> \n<span style=\"color: #008080\">22</span> apply plugin: 'replugin-host-gradle'<span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 集成 RePlugin 添加的配置\n</span><span style=\"color: #008080\">23</span> \n<span style=\"color: #008080\">24</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 集成 RePlugin 添加的配置</span>\n<span style=\"color: #008080\">25</span> <span style=\"color: #000000\">repluginHostConfig {\n</span><span style=\"color: #008080\">26</span>     useAppCompat = <span style=\"color: #0000ff\">true</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 如果项目需要支持 AppComat，则需要将此配置置为 true\n</span><span style=\"color: #008080\">27</span>     <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 如果应用需要个性化配置坑位数量，则需要添加以下代码进行配置\n</span><span style=\"color: #008080\">28</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\">    countNotTranslucentStandard = 6\n</span><span style=\"color: #008080\">29</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\">    countNotTranslucentSingleTop = 2\n</span><span style=\"color: #008080\">30</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\">    countNotTranslucentSingleTask = 3\n</span><span style=\"color: #008080\">31</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\">    countNotTranslucentSingleInstance = 2</span>\n<span style=\"color: #008080\">32</span> <span style=\"color: #000000\">}\n</span><span style=\"color: #008080\">33</span> \n<span style=\"color: #008080\">34</span> <span style=\"color: #000000\">dependencies {\n</span><span style=\"color: #008080\">35</span>     compile fileTree(dir: 'libs', include: ['*.jar'<span style=\"color: #000000\">])\n</span><span style=\"color: #008080\">36</span>     androidTestCompile('com.android.support.test.espresso:espresso-core:2.2.2'<span style=\"color: #000000\">, {\n</span><span style=\"color: #008080\">37</span>         exclude group: 'com.android.support', module: 'support-annotations'\n<span style=\"color: #008080\">38</span> <span style=\"color: #000000\">    })\n</span><span style=\"color: #008080\">39</span>     compile 'com.android.support:appcompat-v7:26.+'\n<span style=\"color: #008080\">40</span>     compile 'com.android.support.constraint:constraint-layout:1.0.2'\n<span style=\"color: #008080\">41</span>     compile 'com.qihoo360.replugin:replugin-host-lib:2.2.1' <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 集成 RePlugin 添加的配置</span>\n<span style=\"color: #008080\">42</span>     testCompile 'junit:junit:4.12'\n<span style=\"color: #008080\">43</span> }</pre>\n</div>\n<p data-source-line=\"73\">以上代码有三点需要注意：</p>\n<ul data-source-line=\"74\">\n<li>需要将 apply plugin: 'replugin-host-gradle' 放在 android {...} 之后。</li>\n<li>如果项目需要支持 AppComat，则需要将 repluginHostConfig 的 userAppCompat 置为 true。</li>\n<li>如果应用需要个性化配置坑位数量，则需要在 repluginHostConfig 中添加以下代码进行配置：</li>\n</ul>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:java;gutter:true;\">countNotTranslucentStandard = 6\ncountNotTranslucentSingleTop = 2\ncountNotTranslucentSingleTask = 3\ncountNotTranslucentSingleInstance = 2</pre>\n</div>\n<h4 id=\"3-让工程的-application-直接继承自-repluginapplication\" data-source-line=\"84\">3、让工程的 Application 直接继承自 RePluginApplication：</h4>\n<pre data-source-line=\"86\"> <span class=\"cnblogs_code\"><span style=\"color: #008080\">1</span> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span> MyApplication <span style=\"color: #0000ff\">extends</span> RePluginApplication { }</span> </pre>\n<p data-source-line=\"91\">当然，同时不要忘了在 AndroidManifest 对 MyApplication 的相关配置。</p>\n<ul data-source-line=\"92\">\n<li>说明:有时候由于项目原有结构的需要，我们可能不能直接使用继承 RePluginApplication 的方式，这个问题看来 RePlugin 开发者也想到了，所以还特地多了一种选择，下面是项目的 Application 不继承 RePluginApplication 的方式：</li>\n</ul>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span> MyApplication <span style=\"color: #0000ff\">extends</span><span style=\"color: #000000\"> Application {\n</span><span style=\"color: #008080\"> 2</span> \n<span style=\"color: #008080\"> 3</span> <span style=\"color: #000000\">    @Override\n</span><span style=\"color: #008080\"> 4</span>     <span style=\"color: #0000ff\">protected</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> attachBaseContext(Context base) {\n</span><span style=\"color: #008080\"> 5</span>         <span style=\"color: #0000ff\">super</span><span style=\"color: #000000\">.attachBaseContext(base);\n</span><span style=\"color: #008080\"> 6</span>         RePlugin.App.attachBaseContext(<span style=\"color: #0000ff\">this</span><span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\"> 8</span> \n<span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">    @Override\n</span><span style=\"color: #008080\">10</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> onCreate() {\n</span><span style=\"color: #008080\">11</span>         <span style=\"color: #0000ff\">super</span><span style=\"color: #000000\">.onCreate();\n</span><span style=\"color: #008080\">12</span> <span style=\"color: #000000\">        RePlugin.App.onCreate();\n</span><span style=\"color: #008080\">13</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">14</span> \n<span style=\"color: #008080\">15</span> <span style=\"color: #000000\">    @Override\n</span><span style=\"color: #008080\">16</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> onLowMemory() {\n</span><span style=\"color: #008080\">17</span>         <span style=\"color: #0000ff\">super</span><span style=\"color: #000000\">.onLowMemory();\n</span><span style=\"color: #008080\">18</span> <span style=\"color: #000000\">        RePlugin.App.onLowMemory();\n</span><span style=\"color: #008080\">19</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">20</span> \n<span style=\"color: #008080\">21</span> <span style=\"color: #000000\">    @Override\n</span><span style=\"color: #008080\">22</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span> onTrimMemory(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> level) {\n</span><span style=\"color: #008080\">23</span>         <span style=\"color: #0000ff\">super</span><span style=\"color: #000000\">.onTrimMemory(level);\n</span><span style=\"color: #008080\">24</span> <span style=\"color: #000000\">        RePlugin.App.onTrimMemory(level);\n</span><span style=\"color: #008080\">25</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">26</span> \n<span style=\"color: #008080\">27</span> <span style=\"color: #000000\">    @Override\n</span><span style=\"color: #008080\">28</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> onConfigurationChanged(Configuration newConfig) {\n</span><span style=\"color: #008080\">29</span>         <span style=\"color: #0000ff\">super</span><span style=\"color: #000000\">.onConfigurationChanged(newConfig);\n</span><span style=\"color: #008080\">30</span> <span style=\"color: #000000\">        RePlugin.App.onConfigurationChanged(newConfig);\n</span><span style=\"color: #008080\">31</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">32</span> }</pre>\n</div>\n<h3 id=\"二-集成插件\" data-source-line=\"129\">二、集成插件</h3>\n<p data-source-line=\"130\">新建一个工程做为插件APP，这里为了方便起见，直接在主工程中新建了一个 Module。</p>\n<h4 id=\"1-同集成主工程类似在根目录的-buildgradle-添加-replugin-plugin-gradle-依赖若是单独创建插件工程则不需要添加注释1下面的代码\" data-source-line=\"131\">1、同集成主工程类似，在根目录的 build.gradle 添加 RePlugin Plugin Gradle 依赖（若是单独创建插件工程，则不需要添加注释1下面的代码）：</h4>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">buildscript {\n    repositories {\n        jcenter()\n    }\n    dependencies {\n        classpath </span>'com.android.tools.build:gradle:2.3.3'\n        <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 1、添加RePlugin Host Gradle依赖(主工程用)</span>\n        classpath 'com.qihoo360.replugin:replugin-host-gradle:2.2.1'\n        <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 2、添加RePlugin Plugin Gradle依赖(插件工程用)</span>\n        classpath 'com.qihoo360.replugin:replugin-plugin-gradle:2.2.1'<span style=\"color: #000000\">\n    }\n}</span></pre>\n</div>\n<h4 id=\"2-在-appbuildgradle-中添加-replugin-plugin-gradle-插件和-replugin-plugin-lib-依赖\" data-source-line=\"148\">2、在 app/build.gradle 中添加 replugin-plugin-gradle 插件和 replugin-plugin-lib 依赖:</h4>\n<div class=\"cnblogs_code\">\n<pre>apply plugin: 'com.android.application'<span style=\"color: #000000\">\n\nandroid {\n    ...\n}\n\napply plugin: </span>'replugin-plugin-gradle' <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 集成 RePlugin 添加的配置</span>\n<span style=\"color: #000000\">\ndependencies {\n    compile fileTree(dir: </span>'libs', include: ['*.jar'<span style=\"color: #000000\">])\n    androidTestCompile(</span>'com.android.support.test.espresso:espresso-core:2.2.2'<span style=\"color: #000000\">, {\n        exclude group: </span>'com.android.support', module: 'support-annotations'<span style=\"color: #000000\">\n    })\n    compile </span>'com.android.support:appcompat-v7:26.+'<span style=\"color: #000000\">\n    compile </span>'com.android.support.constraint:constraint-layout:1.0.2'<span style=\"color: #000000\">\n    compile </span>'com.qihoo360.replugin:replugin-plugin-lib:2.2.1' <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 集成 RePlugin 添加的配置</span>\n    testCompile 'junit:junit:4.12'<span style=\"color: #000000\">\n}</span></pre>\n</div>\n<h3 id=\"三-管理插件\" data-source-line=\"171\">三、管理插件</h3>\n<p data-source-line=\"173\">RePlugin 对插件定义两种方式一种是外置插件、一种是内置插件。</p>\n<ul data-source-line=\"174\">\n<li>外置插件：即从网络下载或者从SD卡中获得的，以 .apk 结尾。</li>\n<li>内置插件：内置于 APP 之中，并随 APP 一并发版，需要将插件 apk 改成 .jar 结尾放入主程序的assets/plugins目录。</li>\n</ul>\n<h4 id=\"一外置插件的安装升级-启动-卸载\" data-source-line=\"176\">（一）外置插件的安装（升级）、启动、卸载</h4>\n<ul data-source-line=\"177\">\n<li>安装插件：</li>\n</ul>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:java;gutter:true;\">PluginInfo pluginInfo = RePlugin.install(Environment.getExternalStorageDirectory().getPath().toString() + \"/plugin1.apk\");\nSystem.out.println(pluginInfo);</pre>\n</div>\n<p data-source-line=\"182\">同时别忘了添加文件读写的权限。 输出日下:</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:java;gutter:true;\">10-30 16:10:23.769 20280-20280/cn.codingblock.repluginstudy I/System.out: PInfo { &lt;cn.codingblock.plugin1:1(4)&gt; [APK] [DEX_EXTRACTED] processes=[] js={\"pkgname\":\"cn.codingblock.plugin1\",\"name\":\"cn.codingblock.plugin1\",\"low\":10,\"high\":10,\"ver\":1,\"verv\":2814792716779521,\"path\":\"\\/data\\/user\\/0\\/cn.codingblock.repluginstudy\\/app_p_a\\/-347346251.jar\",\"type\":11,\"frm_ver\":4} dex=/data/data/cn.codingblock.repluginstudy/app_p_od/-347346251.dex nlib=/data/data/cn.codingblock.repluginstudy/app_p_n/-347346251 }</pre>\n</div>\n<p data-source-line=\"188\">安装成功了！ （升级插件也是用 install() 方法，不可降级，同本版可覆盖安装）</p>\n<ul data-source-line=\"190\">\n<li>启动插件</li>\n</ul>\n<p data-source-line=\"192\">先来看一下 RePlugin.java 中启动插件相关的源码:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #008000\">/**</span>\n<span style=\"color: #008080\"> 2</span> <span style=\"color: #008000\"> * 创建一个用来定向到插件组件的Intent &lt;p&gt;\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #008000\"> * &lt;p&gt;\n</span><span style=\"color: #008080\"> 4</span> <span style=\"color: #008000\"> * 推荐用法： &lt;p&gt;\n</span><span style=\"color: #008080\"> 5</span> <span style=\"color: #008000\"> * &lt;code&gt;\n</span><span style=\"color: #008080\"> 6</span> <span style=\"color: #008000\"> * Intent in = RePlugin.createIntent(\"clean\", \"com.qihoo360.mobilesafe.clean.CleanActivity\");\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #008000\"> * &lt;/code&gt; &lt;p&gt;\n</span><span style=\"color: #008080\"> 8</span> <span style=\"color: #008000\"> * 当然，也可以用标准的Android创建方法： &lt;p&gt;\n</span><span style=\"color: #008080\"> 9</span> <span style=\"color: #008000\"> * &lt;code&gt;\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #008000\"> * Intent in = new Intent(); &lt;p&gt;\n</span><span style=\"color: #008080\">11</span> <span style=\"color: #008000\"> * in.setComponent(new ComponentName(\"clean\", \"com.qihoo360.mobilesafe.clean.CleanActivity\"));\n</span><span style=\"color: #008080\">12</span> <span style=\"color: #008000\"> * &lt;/code&gt;\n</span><span style=\"color: #008080\">13</span> <span style=\"color: #008000\"> *\n</span><span style=\"color: #008080\">14</span> <span style=\"color: #008000\"> * </span><span style=\"color: #808080\">@param</span><span style=\"color: #008000\"> pluginName 插件名\n</span><span style=\"color: #008080\">15</span> <span style=\"color: #008000\"> * </span><span style=\"color: #808080\">@param</span><span style=\"color: #008000\"> cls        目标全名\n</span><span style=\"color: #008080\">16</span> <span style=\"color: #008000\"> * </span><span style=\"color: #808080\">@return</span><span style=\"color: #008000\"> 可以被RePlugin识别的Intent\n</span><span style=\"color: #008080\">17</span> <span style=\"color: #008000\"> * </span><span style=\"color: #808080\">@since</span><span style=\"color: #008000\"> 1.0.0\n</span><span style=\"color: #008080\">18</span>  <span style=\"color: #008000\">*/</span>\n<span style=\"color: #008080\">19</span> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">static</span><span style=\"color: #000000\"> Intent createIntent(String pluginName, String cls) {\n</span><span style=\"color: #008080\">20</span>     Intent in = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> Intent();\n</span><span style=\"color: #008080\">21</span> <span style=\"color: #000000\">    in.setComponent(createComponentName(pluginName, cls));\n</span><span style=\"color: #008080\">22</span>     <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> in;\n</span><span style=\"color: #008080\">23</span> <span style=\"color: #000000\">}\n</span><span style=\"color: #008080\">24</span> \n<span style=\"color: #008080\">25</span> <span style=\"color: #008000\">/**</span>\n<span style=\"color: #008080\">26</span> <span style=\"color: #008000\"> * 开启一个插件的Activity &lt;p&gt;\n</span><span style=\"color: #008080\">27</span> <span style=\"color: #008000\"> * 其中Intent的ComponentName的Key应为插件名（而不是包名），可使用createIntent方法来创建Intent对象\n</span><span style=\"color: #008080\">28</span> <span style=\"color: #008000\"> *\n</span><span style=\"color: #008080\">29</span> <span style=\"color: #008000\"> * </span><span style=\"color: #808080\">@param</span><span style=\"color: #008000\"> context Context对象\n</span><span style=\"color: #008080\">30</span> <span style=\"color: #008000\"> * </span><span style=\"color: #808080\">@param</span><span style=\"color: #008000\"> intent  要打开Activity的Intent，其中ComponentName的Key必须为插件名\n</span><span style=\"color: #008080\">31</span> <span style=\"color: #008000\"> * </span><span style=\"color: #808080\">@return</span><span style=\"color: #008000\"> 插件Activity是否被成功打开？\n</span><span style=\"color: #008080\">32</span> <span style=\"color: #008000\"> * FIXME 是否需要Exception来做？\n</span><span style=\"color: #008080\">33</span> <span style=\"color: #008000\"> * </span><span style=\"color: #808080\">@see</span><span style=\"color: #008000\"> #createIntent(String, String)\n</span><span style=\"color: #008080\">34</span> <span style=\"color: #008000\"> * </span><span style=\"color: #808080\">@since</span><span style=\"color: #008000\"> 1.0.0\n</span><span style=\"color: #008080\">35</span>  <span style=\"color: #008000\">*/</span>\n<span style=\"color: #008080\">36</span> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">static</span> <span style=\"color: #0000ff\">boolean</span><span style=\"color: #000000\"> startActivity(Context context, Intent intent) {\n</span><span style=\"color: #008080\">37</span>     <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> TODO 先用旧的开启Activity方案，以后再优化</span>\n<span style=\"color: #008080\">38</span>     ComponentName cn =<span style=\"color: #000000\"> intent.getComponent();\n</span><span style=\"color: #008080\">39</span>     <span style=\"color: #0000ff\">if</span> (cn == <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">) {\n</span><span style=\"color: #008080\">40</span>         <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> TODO 需要支持Action方案</span>\n<span style=\"color: #008080\">41</span>         <span style=\"color: #0000ff\">return</span> <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">42</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">43</span>     String plugin =<span style=\"color: #000000\"> cn.getPackageName();\n</span><span style=\"color: #008080\">44</span>     String cls =<span style=\"color: #000000\"> cn.getClassName();\n</span><span style=\"color: #008080\">45</span>     <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> Factory.startActivityWithNoInjectCN(context, intent, plugin, cls, IPluginManager.PROCESS_AUTO);\n</span><span style=\"color: #008080\">46</span> }</pre>\n</div>\n<p data-source-line=\"241\">根据 RePlugin 的 startActivity() 和 createIntent() 方法注释中的示例可知，启动插件需要先用插件的名字和目标Activity的全路径创建一个 Intent,然后调用 RePlugin.startActviity() 启动即可:</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:java;gutter:true;\">Intent intent = RePlugin.createIntent(\"Plugin1\", \"cn.codingblock.plugin1.MainActivity\");\nif (!RePlugin.startActivity(MainActivity.this, intent)) {\n    Toast.makeText(mContext, \"启动失败\", Toast.LENGTH_LONG).show();\n}</pre>\n</div>\n<p data-source-line=\"248\">点击按钮，输出如下:</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:java;gutter:true;\">10-30 16:21:02.464 20280-20280/cn.codingblock.repluginstudy D/RePlugin.ws001: start activity: intent=Intent { cmp=Plugin1/cn.codingblock.plugin1.MainActivity } plugin=Plugin1 activity=cn.codingblock.plugin1.MainActivity process=-2147483648\n10-30 16:21:02.464 20280-20280/cn.codingblock.repluginstudy D/RePlugin.ws001: start activity: intent=Intent { cmp=Plugin1/cn.codingblock.plugin1.MainActivity } plugin=Plugin1 activity=cn.codingblock.plugin1.MainActivity process=-2147483648 download=true\n10-30 16:21:02.464 20280-20280/cn.codingblock.repluginstudy D/RePlugin.ws001: plugin=Plugin1 not found, start download ...\n10-30 16:21:02.469 20280-20280/cn.codingblock.repluginstudy D/RePlugin.ws001: isNeedToDownload(): V5 file not exists. Plugin = Plugin1</pre>\n</div>\n<p data-source-line=\"255\">启动失败了！（插件名称确实是：Plugin1，而不是 plugin1 ）</p>\n<p data-source-line=\"257\">把 ==createIntent() 方法的第一参数换成插件的包名 cn.codingblock.plugin1 ==试一试，居然可以了。</p>\n<p data-source-line=\"259\">但是，注释总不会这样赤裸裸的坑我们吧！</p>\n<ul data-source-line=\"261\">\n<li>卸载插件</li>\n</ul>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:java;gutter:true;\">RePlugin.uninstall(\"Plugin1\");</pre>\n</div>\n<p data-source-line=\"265\">点击卸载，输入如下:</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:java;gutter:true;\">10-30 16:31:21.988 5006-5006/cn.codingblock.repluginstudy D/RePlugin.ws001: MP.pluginUninstall ... pluginName=Plugin1\n10-30 16:31:21.988 5006-5006/cn.codingblock.repluginstudy D/RePlugin.ws001: Not installed. pluginName=Plugin1</pre>\n</div>\n<p data-source-line=\"270\">没卸载成功？哈哈，这个简单，原套路把参数换成包名，果然可以了:</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:java;gutter:true;\">10-30 16:41:46.179 10193-10193/cn.codingblock.repluginstudy D/RePlugin.ws001: MP.pluginUninstall ... pluginName=cn.codingblock.plugin1\n10-30 16:41:46.202 10193-10193/cn.codingblock.repluginstudy D/RePlugin.ws001: sendIntent pr=cn.codingblock.repluginstudy intent=Intent { act=ACTION_UNINSTALL_PLUGIN (has extras) }\n10-30 16:41:46.203 10193-10193/cn.codingblock.repluginstudy D/RePlugin.ws001: Clear plugin cache. pn=cn.codingblock.plugin1\n10-30 16:41:46.204 10193-10193/cn.codingblock.repluginstudy D/RePlugin.ws001: removeInfo plugin table: info=PInfo { &lt;cn.codingblock.plugin1:1(4)&gt; [APK] processes=[] js={\"pkgname\":\"cn.codingblock.plugin1\",\"name\":\"cn.codingblock.plugin1\",\"low\":10,\"high\":10,\"ver\":1,\"verv\":2814792716779521,\"path\":\"\\/data\\/user\\/0\\/cn.codingblock.repluginstudy\\/app_p_a\\/-347346251.jar\",\"type\":11,\"frm_ver\":4,\"used\":true} dex=/data/user/0/cn.codingblock.repluginstudy/app_p_od/-347346251.dex nlib=/data/user/0/cn.codingblock.repluginstudy/app_p_n/-347346251 } rc=true\n10-30 16:41:46.204 10193-10193/cn.codingblock.repluginstudy D/RePlugin.ws001: cached filename: cn.codingblock.plugin1 -&gt; null\n10-30 16:41:46.275 10193-10263/cn.codingblock.repluginstudy V/RenderScript: 0xb34e8000 Launching thread(s), CPUs 4</pre>\n</div>\n<p data-source-line=\"279\">启动插件那里毕竟在官方教程里面找不到，但是 Plugin.uninstall() 方法传入插件名即可这可是官方文档说的，这次不会是官方文档和源码注释合起伙来坑我们把？ 经过多次试验后，有个有趣的发现：对于启动插件创建 Intent 的createIntent() 方法和 卸载插件的 RePlugin.uninstall() 方法，如果项目是使用继承 RePluginApplication 方式的话，参数传包名才生效；如果不是继承的方式传插件名才生效！（本人是在一款小米3手机上试验的，由于并没有广泛测试，所以不保证其他手机也是这个套路）这真是奇了葩了！</p>\n<p data-source-line=\"282\">卸载插件时有一点需要注意：如果插件正在运行，则不会立即卸载插件，而是将卸载诉求记录下来。直到所有“正在使用插件”的进程结束并重启后才会生效。（引自官方说明）</p>\n<h4 id=\"二内置插件\" data-source-line=\"284\">（二）内置插件</h4>\n<p data-source-line=\"285\">添加内置插件非常简单，首先在主工程的 assets 目录下创建一个 plugins 文件夹，然后将要作为插件的 apk 后缀名改成 .jar 并放入到新建的 plugins 文件夹下，剩下的事情就不用管了，交给 RePlugin 即可，也就说，框架会自动加载插件。</p>\n<ul data-source-line=\"287\">\n<li>内置插件无需开发者安装，启动方式和外置插件一致，但不可删除。</li>\n<li>内置插件可通过 RePlugin.install() 升级(需要先将升级包下载好)，升级后等同于外置插件。</li>\n</ul>\n<h3 id=\"四-小结\" data-source-line=\"290\">四、小结</h3>\n<p data-source-line=\"291\">初步体验了一下发现，虽然目前有可能会有那么一点坑需要踩一踩，在使用起来也不比 DroidPlugin 方便，需要在宿主和插件两端都要做集成工作。但总体明显发现，这次的插件化框架明显比以前那些的插件化框架资料更加的全面、丰富，而且从 wiki 上发现 RePlugin 团队充满了很大的热情在孜孜不倦维护、更新，并且计划明确，哪些功能在未来会添加、哪些功能在未来会被舍弃，一目了然，让我们更加看到了 RePlugin 美好的未来，我相信在未来的插件化领域即使 RePlugin 不能一家独大，也必然处于一个非常重要的地位！</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 14:49</span> <a href=\"http://www.cnblogs.com/codingblock/\">codingblock</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766365\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766365);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=232529,cb_entryId=7766365,cb_blogApp=currentBlogApp,cb_blogUserGuid='530c5f5b-d418-e511-b908-9dcfd8948a71',cb_entryCreatedDate='2017/11/1 14:49:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 85, "image_url": ["https://pic.cnblogs.com/face/776965/20150703230350.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "跨平台这件事儿", "url": "http://www.cnblogs.com/fengzheng/p/7766719.html", "author": "风的姿态", "article_desc": "跨平台很神秘吗 刚刚开始做开发的时候，感觉跨平台是那么高大上，就像夕阳下，湖面上的一朵白莲花，只可远观，不可亵玩焉。那么，跨平台到底是怎么一回事儿。难道真的有什么东西可以跨平台吗，这就像一台多功能交通设备，投到水里能游，放到陆地上能跑，扔到天上能飞，加速到第二宇宙速度都能脱离地球了进行星际航行了。  ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/fengzheng/p/7766719.html\">跨平台这件事儿</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p class=\"second\">跨平台很神秘吗</p>\r\n<p>刚刚开始做开发的时候，感觉跨平台是那么高大上，就像夕阳下，湖面上的一朵白莲花，只可远观，不可亵玩焉。那么，跨平台到底是怎么一回事儿。难道真的有什么东西可以跨平台吗，这就像一台多功能交通设备，投到水里能游，放到陆地上能跑，扔到天上能飞，加速到第二宇宙速度都能脱离地球了进行星际航行了。</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/273364/201711/273364-20171101151829123-1959072701.jpg\" alt=\"\"></p>\r\n<p class=\"second\">揭开跨平台神秘面纱</p>\r\n<p>让我们一起来揭开跨平台神秘的面纱，比起一种语言是不是跨平台的，我们更关心的是功能可不可以跨平台，毕竟我们使用各种开发语言是为了实现某些功能。举个例子，假设我们打算用 Java 开发了一款游戏，这个游戏要跨 Mac、Windows、桌面版Linux 三个平台，怎么完成这个功能呢。</p>\r\n<p>假设要完成游戏中人物的显示，这样一个看似很简单的功能，程序从上层向下层要做下面这些：</p>\r\n<p>1、最上层 Java 要调用一个图像相关的类库；</p>\r\n<p>2、这个类库要调用系统层提供的接口，比如显卡驱动相关接口；</p>\r\n<p>3、这个显卡驱动相关的接口又调用了显卡的硬件接口；</p>\r\n<p>我们再从下向上分析一下，如果要做到跨平台要做到什么？</p>\r\n<p>1、最后调用到了硬件接口，那么首先要保证硬件是相同的，比如显卡是相同的，这就要保证世界上各大显卡厂商使用相同的标准；</p>\r\n<p>2、再往上保证显卡配套的显卡驱动接口是相同的；</p>\r\n<p>3、再往上还要保证系统暴露给上层的驱动接口调用 API 是相同的，这就要求三个平台具有相同的驱动 API 标准；</p>\r\n<p>通过以上我们发现一个语言可不可以跨平台要看它的下一层是不是跨平台，依次类推，最后总会到达硬件层次。最后得出的结论就是只有硬件是同一种标准，那才能实现真正意义上的跨平台。但是由于历史、商业等等各种原因，导致完全统一标准几乎是不可能的。</p>\r\n<p>所以目前所说的语言跨平台、框架跨平台都是用其他方式实现的，并且我们可以把这里的平台理解为语言、框架的下一层级的载体。</p>\r\n<p class=\"second\">几种语言的跨平台方式</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/273364/201711/273364-20171101151843779-470600973.jpg\" alt=\"\"></p>\r\n<p><img class=\"img_loading\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\" alt=\"\" data-s=\"300,640\" data-type=\"jpeg\" data-src=\"https://mmbiz.qpic.cn/mmbiz_jpg/iaWSDo4TfyZjLqUL3ExZvxD3H5o92nLfZxWqV7LnibPnbYx30MInv9KqVQK3o5BBz72FHdhPH6ibBRpYs3FZzs2vg/0?wx_fmt=jpeg\" data-copyright=\"0\" data-ratio=\"0.425531914893617\" data-w=\"940\"></p>\r\n<p>比如说 <strong>HTML</strong> 是跨平台的，他跨的平台指的是浏览器，浏览器几乎都遵循 w3c 标准，所以 HTML 是这样实现跨平台的。</p>\r\n<p>比如说 <strong>C</strong> 语言是不是跨平台的，C 语言常常被用在偏底层的开发。那么 C 语言是如果在多个平台运行的呢？首先要编写代码，编写的代码要兼容要跨的平台，要支持 windows 平台，那么就要为 windows 实现一套代码，要支持 Linux 就要为 Linux 实现一套，然后当要执行的时候，简单粗暴的说就是加上 <code>if else</code>做个判断，是哪个平台就用其对应的代码，著名的 GUI 开发框架 Qt j就是这个原理嘛，框架本身帮你做好了平台判断，在哪个平台就用哪个平台下的 GUI 接口，所以开发者只需要调用它包装包的接口即可。写完代码之后，拿这套代码到各个平台去编译成当前平台需要的格式，这里又涉及到了编译器，不同平台下的编译器也是不同， windows 下的编译器需要把 C 代码编译成 windows 下可执行的文件格式，Linux 下的编译器需要把 C 代码编译成 Linux 下的可执行文件格式。</p>\r\n<p>再比如说 <strong>Java</strong> , Java 的口号是 <strong>Write once, run anywhere</strong>，也就是一次编写，到处运行（跨平台运行）。听上去比 C 语言还要厉害，写一次就好，不用再到各个平台上去编译，厉害了。这都要归功到 JVM（Java 虚拟机）上，JVM 有他自己的字节码格式和具体的执行机制，只要把 Java 代码编译成 JVM 需要的字节码即可。以开发者的视角，确实是跨平台了。但是具体是怎么实现的呢？首先我们安装 JDK 的时候会根据平台不同选择不同的版本，当然 JVM 也就选择了不同的版本，而代码要执行的时候，不同平台版本的 JVM 会根据自身所在的平台，把字节码转换成平台所需的机器码。看着是不是很眼熟，这不就是 C 语言里不同平台的编译器吗。</p>\r\n<p>回到最开始提到的那个交通设备，真的要把把它做出来，那要具备涡轮一类的推水装置、 路面行走的轮子、喷气式装置，甚至核能推进器。总结起来就是说，要跨平台就要有对应平台的功能实现。作为开发者来说，我们使用的一些语言或框架可以方便的跨平台，不需要我们关系细节，是因为语言或框架本身帮我们做了繁杂的适配工作。</p>\r\n<p>揭开跨平台的面纱，是不是感觉这概念没那么神秘了。</p>\r\n<p>欢迎关注公众号「gushidefengzheng」古时的风筝</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/273364/201711/273364-20171101152347138-843465876.jpg\" alt=\"\"></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 15:28</span> <a href=\"http://www.cnblogs.com/fengzheng/\">风的姿态</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766719\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766719);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=83566,cb_entryId=7766719,cb_blogApp=currentBlogApp,cb_blogUserGuid='2f3bb87d-3b37-e011-ac81-842b2b196315',cb_entryCreatedDate='2017/11/1 15:28:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 485, "image_url": ["https://pic.cnblogs.com/face/273364/20140311104117.png"], "date_pub": "2017-11-01", "article_common": 2}
{"title": "JavaScript+HTML5 实现打地鼠小游戏", "url": "http://www.cnblogs.com/jerehedu/p/7767369.html", "author": "杰瑞教育", "article_desc": "打地鼠这个游戏相信大家都不陌生，也是童年时候一款经典的游戏。本次游戏的编写是以html文件形式完成的，并且使用HBulider软件进行编写，使用谷歌浏览器展示效果，游戏将会采用JavaScript实现整体的逻辑流程，最终使用谷歌浏览器来实现游戏的展示和操作。本次游戏需要有一定的HTML5+JavaS ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/jerehedu/p/7767369.html\">JavaScript+HTML5 实现打地鼠小游戏</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><table style='border: 0px solid #000000; border-collapse: collapse; color: #333333; font-family: Georgia, \"Times New Roman\", Times, sans-serif; font-size: 14px; line-height: 25px; width: 100%; height: 38px; background-color: #1570a6' border=\"0\">\n<tbody>\n<tr>\n<td style=\"border-style: solid; border-color: silver; border-collapse: collapse; padding: 3px\"><span style='font-family: \"Microsoft YaHei\"'><strong><span style=\"color: #ffffff; font-size: 14pt\"> 一．游戏简介</span></strong></span></td>\n</tr>\n</tbody>\n</table>\n<p class=\"15\"><span style=\"font-family: 宋体\">打地鼠这个游戏相信大家都不陌生</span>，<span style=\"font-family: 宋体\">也是童年时候一款经典的游戏</span>。<span style=\"font-family: 宋体\">本次游戏的编写是以</span>html<span style=\"font-family: 宋体\">文件形式完成的</span>，<span style=\"font-family: 宋体\">并且使用</span>HBulider<span style=\"font-family: 宋体\">软件进行编写</span>，使用谷歌浏览器展示效果，<span style=\"font-family: 宋体\">游戏将会采用</span>JavaScript<span style=\"font-family: 宋体\">实现整体的逻辑流程</span><span style=\"font-family: 宋体\">，最终使用谷歌浏览器来实现游戏的展示和操作。本次游戏需要有一定的</span>HTML5+JavaScript<span style=\"font-family: 宋体\">基础</span>。</p>\n<p class=\"15\"> </p>\n<table style='border: 0px solid #000000; border-collapse: collapse; color: #333333; font-family: Georgia, \"Times New Roman\", Times, sans-serif; font-size: 14px; line-height: 25px; width: 100%; height: 38px; background-color: #1570a6' border=\"0\">\n<tbody>\n<tr>\n<td style=\"border-style: solid; border-color: silver; border-collapse: collapse; padding: 3px\"><span style='font-family: \"Microsoft YaHei\"'><strong><span style=\"color: #ffffff; font-size: 14pt\">二．游戏最终的效果如下：</span></strong></span></td>\n</tr>\n</tbody>\n</table>\n<p> <img src=\"http://images2017.cnblogs.com/blog/708076/201711/708076-20171101164545779-911519631.gif\" alt=\"\"></p>\n<table style='border: 0px solid #000000; border-collapse: collapse; color: #333333; font-family: Georgia, \"Times New Roman\", Times, sans-serif; font-size: 14px; line-height: 25px; width: 100%; height: 38px; background-color: #1570a6' border=\"0\">\n<tbody>\n<tr>\n<td style=\"border-style: solid; border-color: silver; border-collapse: collapse; padding: 3px\"><span style='font-family: \"Microsoft YaHei\"'><strong><span style=\"color: #ffffff; font-size: 14pt\">三．游戏实现的流程</span></strong></span></td>\n</tr>\n</tbody>\n</table>\n<p class=\"15\">a) <span style=\"font-family: 宋体\">游戏界面的切换和背景音乐的实现</span></p>\n<p class=\"15\">b) <span style=\"font-family: 宋体\">设置按钮的点击效果</span></p>\n<p class=\"15\">c) <span style=\"font-family: 宋体\">地鼠的隐藏与出现</span></p>\n<p class=\"15\">d) <span style=\"font-family: 宋体\">地鼠的随机出现</span></p>\n<p class=\"15\">e) <span style=\"font-family: 宋体\">设置小锤跟随鼠标移动</span></p>\n<p class=\"15\">f) <span style=\"font-family: 宋体\">小锤和地鼠的碰撞</span></p>\n<p class=\"15\"> </p>\n<h2 style=\"margin: 8px 0px 0px; padding: 0px; font-weight: bold; font-size: 16px; line-height: 28px; max-width: 100%; color: #59c3f9; min-height: 32px; border-bottom-width: 1.5px; border-bottom-style: solid; border-color: #59c3f9; text-align: justify\"><span style='font-family: \"Microsoft YaHei\"; font-size: 14px'><span class=\"autonum\" style=\"background-color: #59c3f9; color: #ffffff; display: block; float: left; line-height: 20px; margin: 0px 8px 0px 0px; max-width: 100%; padding: 4px 10px\" title=\"\" data-original-title=\"\">1</span></span></h2>\n<p><span style=\"font-family: 宋体\">首先是游戏界面的切换</span>，<span style=\"font-family: 宋体\">在我们点击开始游戏或者游戏说明时</span>，<span style=\"font-family: 宋体\">都会进行页面的切换</span>，<span style=\"font-family: 宋体\">页面切换效果我们可以使用隐藏属性</span>display:none<span style=\"font-family: 宋体\">。在游戏主菜单界面时，将内容</span><span style=\"font-family: Calibri\">content</span><span style=\"font-family: 宋体\">设置为出现：</span></p>\n<div class=\"cnblogs_code\">\n<pre>document.getElementById(\"content\").style.display=\"block\";</pre>\n</div>\n<p><span style=\"font-family: 宋体\">在进入游戏或者游戏说明时</span>，<span style=\"font-family: 宋体\">将</span>content<span style=\"font-family: 宋体\">内容设置为隐藏</span>，<span style=\"font-family: 宋体\">从而实现界面的切换效果</span></p>\n<div class=\"cnblogs_code\">\n<pre>document.getElementById(\"content\").style.display=\"none\";</pre>\n</div>\n<p> </p>\n<h2 style=\"margin: 8px 0px 0px; padding: 0px; font-weight: bold; font-size: 16px; line-height: 28px; max-width: 100%; color: #59c3f9; min-height: 32px; border-bottom-width: 1.5px; border-bottom-style: solid; border-color: #59c3f9; text-align: justify\"><span style='font-family: \"Microsoft YaHei\"; font-size: 14px'><span class=\"autonum\" style=\"background-color: #59c3f9; color: #ffffff; display: block; float: left; line-height: 20px; margin: 0px 8px 0px 0px; max-width: 100%; padding: 4px 10px\" title=\"\" data-original-title=\"\">2</span><span style=\"font-size: 16px\"><strong class=\"135brush\" style=\"border-color: #59c3f9; color: inherit\" data-brushtype=\"text\"><br></strong></span></span></h2>\n<p> <span style=\"font-family: 宋体\">接下来是音频的实现</span>，HTML5<span style=\"font-family: 宋体\">新特性中的</span>&lt;audio&gt;<span style=\"font-family: 宋体\">标签提供音乐播放的功能，在进入游戏时，音乐自动播放，我们在</span><span style=\"font-family: Calibri\">body</span><span style=\"font-family: 宋体\">中自定义一个按钮，通过按钮来控制音频的播放和暂停，代码如下：</span></p>\n<p>按钮样式：<img src=\"http://images2017.cnblogs.com/blog/708076/201711/708076-20171101161313420-1720531096.png\" alt=\"\"></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">//src中存放音频地址，设置autoplay加载完成自动播放，button按钮控制播放暂停\n</span><span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">audio </span><span style=\"color: #ff0000\">id</span><span style=\"color: #0000ff\">=\"audio\"</span><span style=\"color: #ff0000\"> src</span><span style=\"color: #0000ff\">=\"audio/game_music.ogg\"</span><span style=\"color: #ff0000\"> autoplay</span><span style=\"color: #0000ff\">=\"autoplay\"</span><span style=\"color: #ff0000\"> loop</span><span style=\"color: #0000ff\">=\"loop\"</span>  <span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">audio</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">input </span><span style=\"color: #ff0000\">type</span><span style=\"color: #0000ff\">=\"button\"</span><span style=\"color: #ff0000\"> onclick</span><span style=\"color: #0000ff\">=\"playOrPause()\"</span><span style=\"color: #ff0000\"> id</span><span style=\"color: #0000ff\">=\"playbtn\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">input</span><span style=\"color: #0000ff\">&gt;</span><span style=\"color: #000000\">\n然后再js中自定义按钮的功能，代码如下：</span></pre>\n</div>\n<p><span style=\"font-family: 宋体\">然后再</span>js<span style=\"font-family: 宋体\">中自定义按钮的功能</span>，<span style=\"font-family: 宋体\">代码如下</span>：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\">音频播放与暂停</span>\n<span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> playOrPause(){\n            </span><span style=\"color: #0000ff\">var</span> audio  =    document.getElementById(\"audio\"<span style=\"color: #000000\">);\n            </span><span style=\"color: #0000ff\">if</span><span style=\"color: #000000\">(audio.paused){\n            audio.play();\ndocument.getElementById(</span>\"playbtn\").style.backgroundImage = \"url(img/musicplaying.png)\"<span style=\"color: #000000\">;\n                }</span><span style=\"color: #0000ff\">else</span> <span style=\"color: #0000ff\">if</span><span style=\"color: #000000\">(audio.played){\n                    audio.pause();\n    document.getElementById(</span>\"playbtn\").style.backgroundImage = \"url(img/musicpause.png)\"<span style=\"color: #000000\">;\n                }\n            }</span></pre>\n</div>\n<p> </p>\n<h2 style=\"margin: 8px 0px 0px; padding: 0px; font-weight: bold; font-size: 16px; line-height: 28px; max-width: 100%; color: #59c3f9; min-height: 32px; border-bottom-width: 1.5px; border-bottom-style: solid; border-color: #59c3f9; text-align: justify\"><span style='font-family: \"Microsoft YaHei\"; font-size: 14px'><span class=\"autonum\" style=\"background-color: #59c3f9; color: #ffffff; display: block; float: left; line-height: 20px; margin: 0px 8px 0px 0px; max-width: 100%; padding: 4px 10px\" title=\"\" data-original-title=\"\">3</span></span></h2>\n<p><span style=\"font-family: 宋体\">之后是设置按钮的点击效果，这个比较简单，实际上就是两个图片之间的切换，给按钮一个</span>hover<span style=\"font-family: 宋体\">，通过鼠标移上来实现背景图片的切换</span></p>\n<p><span style=\"font-family: 宋体\"><img src=\"http://images2017.cnblogs.com/blog/708076/201711/708076-20171101164642341-855704470.gif\" alt=\"\"></span></p>\n<p><strong><span style=\"font-family: 宋体\">例</span>：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\">开始按钮被鼠标指向时触发</span>\n<span style=\"color: #000000\">#start:hover{\n                background</span>-image: url(../img/<span style=\"color: #000000\">start2.png);\n            }</span></pre>\n</div>\n<p> </p>\n<h2 style=\"margin: 8px 0px 0px; padding: 0px; font-weight: bold; font-size: 16px; line-height: 28px; max-width: 100%; color: #59c3f9; min-height: 32px; border-bottom-width: 1.5px; border-bottom-style: solid; border-color: #59c3f9; text-align: justify\"><span style='font-family: \"Microsoft YaHei\"; font-size: 14px'><span class=\"autonum\" style=\"background-color: #59c3f9; color: #ffffff; display: block; float: left; line-height: 20px; margin: 0px 8px 0px 0px; max-width: 100%; padding: 4px 10px\" title=\"\" data-original-title=\"\">4</span><span style=\"font-size: 16px\"><strong class=\"135brush\" style=\"border-color: #59c3f9; color: inherit\" data-brushtype=\"text\"><br></strong></span></span></h2>\n<p> <span style=\"font-family: 宋体\">接下来是地鼠的出现功能</span>，<span style=\"font-family: 宋体\">在地鼠出现的区域设置一个</span>div<span style=\"font-family: 宋体\">用来显示地鼠</span>，<span style=\"font-family: 宋体\">在地鼠未出现之前将地鼠隐藏在洞下</span>，<span style=\"font-family: 宋体\">使用定时器</span>setInterval（）<span style=\"font-family: 宋体\">设定地鼠出现的时间</span>，<span style=\"font-family: 宋体\">使用延时器</span>setTimeout（），<span style=\"font-family: 宋体\">设定地鼠待在地面上的时间</span></p>\n<p><span style=\"font-family: 宋体\">首先是</span>div<span style=\"font-family: 宋体\">块</span><span style=\"font-family: 宋体\">（地鼠显示的区域）和地鼠的隐藏</span>div<span style=\"font-family: 宋体\">块</span></p>\n<p><strong><span style=\"font-family: 宋体\">展示效果</span>：</strong></p>\n<p><strong><img src=\"http://images2017.cnblogs.com/blog/708076/201711/708076-20171101164704920-596935099.gif\" alt=\"\"></strong></p>\n<p><strong><span style=\"font-family: 宋体\">例</span>：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\">d0为地鼠出现的区域，m0设置地鼠隐藏的区域</span>\n&lt;div id=\"d0\" &gt;\n    &lt;div id=\"m0\" &gt;&lt;/div&gt;                \n&lt;/div&gt;</pre>\n</div>\n<p>其次是地鼠的出现和消失，</p>\n<p><strong>例：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\">老鼠显示和消失动画</span>\nintervalid= setInterval(<span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(){\n                $(</span>\"#m\"+num).animate({\"marginTop\":0+\"px\"},<span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(){\n\n                    timeId2</span>=  setTimeout(<span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(){\n                        $(</span>\"#m\"+num).animate({\"marginTop\":100+\"px\"<span style=\"color: #000000\">});\n                    },</span>1000<span style=\"color: #000000\">);\n                    \n                });        \n                </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">老鼠被打进洞后，恢复原图</span>\n                    document.getElementById(\"m\"+num).style.backgroundImage = \"url(img/mouse1.png)\"<span style=\"color: #000000\">;\n                    \n                },</span>3000);</pre>\n</div>\n<p> </p>\n<h2 style=\"margin: 8px 0px 0px; padding: 0px; font-weight: bold; font-size: 16px; line-height: 28px; max-width: 100%; color: #59c3f9; min-height: 32px; border-bottom-width: 1.5px; border-bottom-style: solid; border-color: #59c3f9; text-align: justify\"><span style='font-family: \"Microsoft YaHei\"; font-size: 14px'><span class=\"autonum\" style=\"background-color: #59c3f9; color: #ffffff; display: block; float: left; line-height: 20px; margin: 0px 8px 0px 0px; max-width: 100%; padding: 4px 10px\" title=\"\" data-original-title=\"\">5</span><span style=\"font-size: 16px\"><strong class=\"135brush\" style=\"border-color: #59c3f9; color: inherit\" data-brushtype=\"text\"><br></strong></span></span></h2>\n<p> <span style=\"font-family: 宋体\">地鼠的随机出现</span>，<span style=\"font-family: 宋体\">我们可以设定一个随机数</span>，</p>\n<p><strong><span style=\"font-family: 宋体\">例</span></strong>：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\">随机产生0-8之间的随机数，包括0和8</span>\n<span style=\"color: #0000ff\">var</span>  num = Math.floor(Math.random()*9);</pre>\n</div>\n<p><span style=\"font-family: 宋体\">产生</span>0-8<span style=\"font-family: 宋体\">之间的随机数</span>，<span style=\"font-family: 宋体\">指定九个洞中哪个洞出现地鼠</span>，<span style=\"font-family: 宋体\">然后将</span>num<span style=\"font-family: 宋体\">传递给定时器和延时器中的</span><span style=\"font-family: Calibri\">id</span><span style=\"font-family: 宋体\">指定的地鼠</span>，<span style=\"font-family: 宋体\">实现地鼠随机的选取</span>。</p>\n<p><span style=\"font-family: 宋体\">随机出现地鼠展示</span>：</p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/708076/201711/708076-20171101164731857-1871632923.gif\" alt=\"\"></p>\n<p> </p>\n<h2 style=\"margin: 8px 0px 0px; padding: 0px; font-weight: bold; font-size: 16px; line-height: 28px; max-width: 100%; color: #59c3f9; min-height: 32px; border-bottom-width: 1.5px; border-bottom-style: solid; border-color: #59c3f9; text-align: justify\"><span style='font-family: \"Microsoft YaHei\"; font-size: 14px'><span class=\"autonum\" style=\"background-color: #59c3f9; color: #ffffff; display: block; float: left; line-height: 20px; margin: 0px 8px 0px 0px; max-width: 100%; padding: 4px 10px\" title=\"\" data-original-title=\"\">6</span><span style=\"font-size: 16px\"><strong class=\"135brush\" style=\"border-color: #59c3f9; color: inherit\" data-brushtype=\"text\"><br></strong></span></span></h2>\n<p> <span style=\"font-family: 宋体\">设置锤子的移动需要与鼠标移动同步</span>，<span style=\"font-family: 宋体\">使用到</span>JavaScript<span style=\"font-family: 宋体\">中的鼠标移动事件</span>，<span style=\"font-family: 宋体\">首先注册鼠标移动事件</span>，代码如下：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/708076/201711/708076-20171101164752841-153359775.gif\" alt=\"\"></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">var</span> ele=document.getElementById(\"all\"<span style=\"color: #000000\">);\nele.onmousemove</span>=<span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(){GetMouse(event);}\n</span><span style=\"color: #0000ff\">function</span><span style=\"color: #000000\"> GetMouse(oEvent,snum)\n{\n             x</span>=<span style=\"color: #000000\">oEvent.clientX;\n             y</span>=oEvent.clientY;            document.getElementById('Img').style.left=(parseInt(x))+10+\"px\"<span style=\"color: #000000\">;\n            document.getElementById(</span>'Img').style.top=y-30+\"px\"<span style=\"color: #000000\">;        \n             </span><span style=\"color: #0000ff\">var</span> oEvent=oEvent||event;  </pre>\n</div>\n<p> </p>\n<h2 style=\"margin: 8px 0px 0px; padding: 0px; font-weight: bold; font-size: 16px; line-height: 28px; max-width: 100%; color: #59c3f9; min-height: 32px; border-bottom-width: 1.5px; border-bottom-style: solid; border-color: #59c3f9; text-align: justify\"><span style='font-family: \"Microsoft YaHei\"; font-size: 14px'><span class=\"autonum\" style=\"background-color: #59c3f9; color: #ffffff; display: block; float: left; line-height: 20px; margin: 0px 8px 0px 0px; max-width: 100%; padding: 4px 10px\" title=\"\" data-original-title=\"\">7</span><span style=\"font-size: 16px\"><strong class=\"135brush\" style=\"border-color: #59c3f9; color: inherit\" data-brushtype=\"text\"><br></strong></span></span></h2>\n<p><strong> 检测碰撞：</strong></p>\n<p>检测<span style=\"font-family: 宋体\">锤子是否与出现的地鼠相碰撞</span>，使用offsetTop、offsetWidth、offsetHeight<span style=\"font-family: 宋体\">和</span><span style=\"font-family: Calibri\">offsetLeft</span><span style=\"font-family: 宋体\">计算出地鼠和锤子的位置</span>，<span style=\"font-family: 宋体\">根据距离的计算</span>，<span style=\"font-family: 宋体\">判断地鼠与锤子是否重合碰撞</span>。</p>\n<p><strong><span style=\"font-family: 宋体\">效果</span>：</strong></p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/708076/201711/708076-20171101164815295-57891256.gif\" alt=\"\"></p>\n<p><strong><span style=\"font-family: 宋体\">代码如下</span>：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">var</span> l1=document.getElementById('Img'<span style=\"color: #000000\">).offsetLeft;  \n</span><span style=\"color: #0000ff\">var</span> r1=document.getElementById('Img'<span style=\"color: #000000\">)\n.offsetLeft</span>+document.getElementById('Img'<span style=\"color: #000000\">).offsetWidth;  \n</span><span style=\"color: #0000ff\">var</span> t1=document.getElementById('Img'<span style=\"color: #000000\">).offsetTop;  \n</span><span style=\"color: #0000ff\">var</span> b1=document.getElementById('Img'<span style=\"color: #000000\">)\n.offsetTop</span>+document.getElementById('Img'<span style=\"color: #000000\">).offsetHeight;  \n</span><span style=\"color: #0000ff\">var</span> l2=document.getElementById('m'+<span style=\"color: #000000\">num).offsetLeft;  \n</span><span style=\"color: #0000ff\">var</span> r2=document.getElementById('m'+<span style=\"color: #000000\">num)\n.offsetLeft</span>+document.getElementById('m'+<span style=\"color: #000000\">num).offsetWidth;  \n</span><span style=\"color: #0000ff\">var</span> t2=document.getElementById('m'+<span style=\"color: #000000\">num).offsetTop;  \n</span><span style=\"color: #0000ff\">var</span> b2=document.getElementById('m'+<span style=\"color: #000000\">num)\n.offsetTop</span>+document.getElementById('m'+<span style=\"color: #000000\">num).offsetHeight;  \n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">锤子与老鼠碰撞计算</span>\n<span style=\"color: #0000ff\">if</span>(r1&lt;l2 || l1&gt;r2 || b1&lt;t2 || t1&gt;<span style=\"color: #000000\">b2)  \n      {  \n         </span><span style=\"color: #0000ff\">var</span> ele = document.getElementById(\"m\"+<span style=\"color: #000000\">num);\n         </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">实现锤子点击动画</span>\n         ele.onmousedown = <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(){\n         ChangeBg(</span>\"Img\",\"img/hammer2.png\"<span style=\"color: #000000\">);\n         </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">打中老鼠老鼠切换图片</span>\n<span style=\"color: #000000\">        \n         document.form1.score.value </span>=<span style=\"color: #000000\"> beat;\n         console.log(</span>\"总得分为：\"+beat);                                          document.getElementById('m'+<span style=\"color: #000000\">num)\n.style.backgroundImage</span>='url(img/mouse2.png)'<span style=\"color: #000000\">;  \n              } \nbeat</span>+=1<span style=\"color: #000000\">;     \n        }  \n</span><span style=\"color: #0000ff\">else</span><span style=\"color: #000000\">  \n        {  \n           </span><span style=\"color: #0000ff\">var</span> ele = document.getElementById(\"m\"+<span style=\"color: #000000\">num);\n           </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">实现锤子点击动画</span>\n           ele.onmousedown = <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(){\n           ChangeBg(</span>\"Img\",\"img/hammer2.png\");        document.getElementById('m'+num).style.background='<span style=\"color: #000000\">url(img/mouse1.png);  \n}\n                   \n          }</span></pre>\n</div>\n<p><span style=\"font-family: 宋体\">以上是主要功能的代码展示</span>，<span style=\"font-family: 宋体\">需要完整的游戏代码</span>，<span style=\"font-family: 宋体\">可自行下载</span>。</p>\n<p><strong>下载地址：</strong></p>\n<p><a href=\"http://www.jredu100.com/index.php?m=content&amp;c=index&amp;a=show&amp;catid=65&amp;id=37\" target=\"_blank\">http://www.jredu100.com/index.php?m=content&amp;c=index&amp;a=show&amp;catid=65&amp;id=37</a></p>\n<p> </p>\n<div style=\"background: #e6fae6; padding: 10px; border: 1px dashed #e0e0e0; font-family: 微软雅黑; font-size: 15px\">作者：杰瑞教育<br>出处：<span style=\"color: #000000\"><a href=\"http://www.cnblogs.com/jerehedu/\" target=\"_blank\"><span style=\"color: #000000\">http://www.cnblogs.com/jerehedu/</span></a></span> <br><span style='font-family: \"Microsoft YaHei\"; color: #000000'>版权声明：本文版权归<span style=\"color: #000000\">烟</span></span><span style='font-family: \"Microsoft YaHei\"'>台</span><span style='color: #000000; font-family: \"Microsoft YaHei\"'><a href=\"http://www.jredu100.com/\" target=\"_blank\"><span style=\"color: #000000\">杰瑞教育</span></a></span><span style='font-family: \"Microsoft YaHei\"'>科</span><span style='font-family: \"Microsoft YaHei\"; color: #000000'><span style=\"color: #000000\">技有限公司</span>和博客园共有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。\n<br>技术咨询：<a href=\"http://shang.qq.com/wpa/qunwpa?idkey=69fd2f84c1212ecb10062430746aa802c93431c006c1d8cd8c34c5dd4f14772d\" target=\"_blank\"><img title=\"JRedu技术交流\" src=\"http://pub.idqqimg.com/wpa/images/group.png\" alt=\"JRedu技术交流\" border=\"0\"></a></span></div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 17:06</span> <a href=\"http://www.cnblogs.com/jerehedu/\">杰瑞教育</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7767369\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7767369);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210284,cb_entryId=7767369,cb_blogApp=currentBlogApp,cb_blogUserGuid='e4c19907-a88d-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/11/1 17:06:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 454, "image_url": ["https://pic.cnblogs.com/face/708076/20150318090025.png"], "date_pub": "2017-11-01", "article_common": 1}
{"title": "JDBC（三）数据库连接池（DBCP、C3P0）", "url": "http://www.cnblogs.com/zhangyinhua/p/7765626.html", "author": "苦水润喉", "article_desc": "前言 这段时间状态有一点浮躁，希望自己静下心来。还有特别多的东西还没有学懂。需要学习的东西非常的多，加油！ 一、JDBC复习 Java Data Base Connectivity，java数据库连接，在需要存储一些数据，或者拿到一些数据的时候，就需要往数据库里存取数据。那么java如何连接数据库呢 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/zhangyinhua/p/7765626.html\">JDBC（三）数据库连接池（DBCP、C3P0）</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>前言</p>\r\n<p>　　这段时间状态有一点浮躁，希望自己静下心来。还有特别多的东西还没有学懂。需要学习的东西非常的多，加油！</p>\r\n<h1>一、JDBC复习</h1>\r\n<p>　　Java Data Base Connectivity，java数据库连接，在需要存储一些数据，或者拿到一些数据的时候，就需要往数据库里存取数据。那么java如何连接数据库呢？需要哪些步骤？</p>\r\n<h2>1.1、注册驱动</h2>\r\n<p>　　1）什么是驱动</p>\r\n<p>　　　　 驱动就是<span style=\"color: #ff0000;\">JDBC实现类</span>，通俗点讲，就是<span style=\"color: #ff0000;\">能够连接到数据库功能的东西就是驱动</span>，由于市面上有很多数据库，Oracle、MySql等等，所以<span style=\"color: #ff0000;\">java就有一个连接数据库的实现规</span></p>\r\n<p><span style=\"color: #ff0000;\">　　　　范接口，</span><span style=\"color: #ff0000;\">定义一系列的连接数据库接口(java.sql.Driver接口)，但是不提供实现，而每个数据库厂家来提供这些接口的具体实现</span>，这样一来，不管使用的是什么数据库，我</p>\r\n<p>　　　　们开发者写的代码都是相同的，就不必因为数据库的不同，而写法不同，唯一的不同就是数据库驱动不一样，使用mysql，那么就必须使用mysql的驱动，使用Oracle就必</p>\r\n<p>　　　　须使用oracle的驱动实现类。</p>\r\n<p>　　　　看下面mysql连接数据的原理图，看看驱动是在哪里，起什么作用？</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171101102920263-1164052119.png\" alt=\"\" width=\"827\" height=\"226\"></p>\r\n<p>　　2）DriverManager，一个工具类，是用于操作管理JDBC实现类的</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>　原始写法：DriverManager.register(<span style=\"color: #0000ff;\">new</span> Driver());　　<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">因为使用的是MySql，所以在导包时就需要导入com.mysql.jdbc.Driver</span>\r\n<span style=\"color: #000000;\">\r\n　现在写法：Class.forName(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">com.mysql.jdbc.Driver</span><span style=\"color: #800000;\">\"</span>);　　<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">不用导包，会执行com.mysql.jdbc.Driver类中的静态代码块，其静态代码块的内容为</span>\r\n<span style=\"color: #0000ff;\">　          　static</span><span style=\"color: #000000;\"> {\r\n　　　           　 </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {                      \r\n　　　　　　　　　　　　　　　　 java.sql.DriverManager.registerDriver(</span><span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Driver());\r\n   　　　　　　　　　　　　　　　　 } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (SQLException E) {\r\n　　　　　　　　　　　　　　　　　　　　</span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span> RuntimeException(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Can't register driver!</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                    　　　　　　　　　}\r\n               　　　　　　　　 }　　</span></pre>\r\n</div>\r\n<p>　　分析：　</p>\r\n<p>　　　会发现<span style=\"color: #ff0000;\">第二种加载驱动的方法的底层其实就是第一种加载驱动</span>。为什么要这样呢？原因很简单，<span style=\"color: #ff0000;\">　第一种是硬编程</span>，直接将数据库驱动给写死了，无法扩展，如果使用第一</p>\r\n<p>　　　种，那么连接的数据库只能是mysql<span style=\"color: #ff0000;\">，因为导包导的是mysql的驱动包</span>，如果换成Oracle，就会报错，需要在代码中将Oracle的驱动包导入，这样很麻烦，而第二种写法就不</p>\r\n<p>　　　一样了，<span style=\"color: #ff0000;\">第二种是使用</span><span style=\"color: #ff0000;\">的字符串方法注册驱动的，我们只需要将该字符串提取到一个配置文件中</span>，以后想换成oracle数据库，只需要将该字符串换成oracle驱动的类全名即可</p>\r\n<p>　　　，而不需要到代码中去修改什么东西。</p>\r\n<h2>1.2、获取连接</h2>\r\n<p>　　使用DriverManage来获得连接，因为DriverManager是驱动实现类的管理者</p>\r\n<p>　　Connection conn = DriverManager.getConnection(url,user,password);</p>\r\n<p>　　　　url:确定数据库服务器的位置，端口号，数据库名</p>\r\n<p>　　　　　　jdbc:mysql://localhost:3306/<strong>db</strong>　</p>\r\n<p>　　　　user:登录名称，默认root</p>\r\n<p>　　　　password:密码，默认root　　　</p>\r\n<p>　　这里只是说mysql，别的数据库，url格式就不同了。</p>\r\n<p>　　　　MySQL　　　　jdbc:mysql://localhost:3306/<strong>db　　　　</strong>默认端口是3306，粗体为连接时使用的数据库名</p>\r\n<p>　　　　Oracle　　　　 jdbc:oracle:thin:@localhost:1521:<strong>db</strong>　　默认端口号1521</p>\r\n<p>　　　　DB2　　　　　 jdbc:db2://localhost:6789/<strong>db</strong>　　　　　　默认端口号6789</p>\r\n<p>　　　　SQLServer　　jdbc:microsoft:sqlserver://localhost:1433;databaseName=<strong>db</strong>　　默认端口号1433</p>\r\n<p>　　　　SQLServer 2005　　jdbc:sqlserver://localhost:1433;databaseName=<strong>db</strong>　　默认端口号1433</p>\r\n<h2>1.3、获取执行sql对象，PreparedStatement对象　</h2>\r\n<p>　　通过Connection对象获取Statement或者PraparedStament对象(使用它)处理sql</p>\r\n<p>　　1）Statement</p>\r\n<p>　　　　Statement st = conn.createStatement();　　//获取sql语句执行对象</p>\r\n<p>　　　　st.excuteUpdate(sql);　　//执行增删改语句</p>\r\n<p>　　　　st.excuteQuery(sql);　　//执行查询语句　　　　　　</p>\r\n<p>　　　　sql语句必须是完整的。</p>\r\n<p>　　2）PraparedStatment</p>\r\n<p>　　　　sql语句<span style=\"color: #ff0000;\">可以不是完整的，可以将参数用?替代，然后在预编译后加入未知参数</span></p>\r\n<p>　　　　PraparedStatment ps = conn.prapareStatement(sql);　　//获取sql语句执行对象praparedStatment</p>\r\n<p>　　　　赋值</p>\r\n<p>　　　　　　ps.setInt(Index,value);　　ps.setString(index,value);　　//可以设置很多中类型，index从1开始，代表sql语句中的第几个未知参数，</p>\r\n<p>　　　　　　ps.excuteUpdate();　　//执行增删改语句</p>\r\n<p>　　　　　　ps.excuteQuery(sql);　　//执行查询语句</p>\r\n<p> </p>\r\n<p>　　这两个的区别，常使用的是PraparedStatment对象，因为它可以预编译，效率高，可以设置参数等等优点。</p>\r\n<h2>1.4、获取结果集对象</h2>\r\n<p>　　int count = ps.excuteUpdate();　　　//执行增删改的sql语句时，返回一个int类型的整数，代表数据库表影响的行数，</p>\r\n<p>　　Result result = ps.excuteQuery();　　//执行查询sql语句时，返回一个结果集对象，该对象装着所有查询到的数据信息，一行一行的存储数据库表信息。</p>\r\n<h2>1.5、处理结果集</h2>\r\n<p>　　对查询到的Result结果进行处理，拿到所有数据，并封装成对象。</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>　　　　　　　　<span style=\"color: #0000ff;\">while</span><span style=\"color: #000000;\">(rs.next()){\r\n\r\n　　　　　　　　　　获取行数据的第一种方式\r\n　　　　　　　　　　rs.getString(index);</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">index代表第几列，从1开始</span>\r\n<span style=\"color: #000000;\">\r\n　　　　　　　　　　获取行数据的第二中方式\r\n　　　　　　　　　　rs.getString(</span><span style=\"color: #0000ff;\">string</span>);　　<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">string：代表字段名称。</span>\r\n<span style=\"color: #000000;\">\r\n　　　　　　　　}</span></pre>\r\n</div>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171101104216232-1043927436.png\" alt=\"\" width=\"639\" height=\"322\"></p>\r\n<p>　　总结：java的JDBC就分为5步，4个属性</p>\r\n<p>　　　　属性：driver、url、user、password</p>\r\n<p>　　　　五步：</p>\r\n<p>　　　　　　注册驱动、获取连接、获取执行sql语句对象、获取结果集对象、处理结果。</p>\r\n<h1>二、JDBC的CURD操作</h1>\r\n<p>　　创建（Create）、更新（Update）、读取（Retrieve）和删除（Delete）操作</p>\r\n<p>　　查询所有(读取Retrieve)</p>\r\n<h2>2.1、查询所有记录读取（Retrieve）</h2>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('be88f89b-5eed-49ea-a7c2-e0596379ff67')\"><img id=\"code_img_closed_be88f89b-5eed-49ea-a7c2-e0596379ff67\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_be88f89b-5eed-49ea-a7c2-e0596379ff67\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('be88f89b-5eed-49ea-a7c2-e0596379ff67',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_be88f89b-5eed-49ea-a7c2-e0596379ff67\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">@Test\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> findAll() throws Exception{\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">1 注册驱动</span>\r\n        Class.forName(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">com.mysql.jdbc.Driver</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">2 获得连接</span>\r\n        Connection conn = DriverManager.getConnection(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbc:mysql://localhost:3306/test</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">root</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">root</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">3语句执行者，sql语句</span>\r\n        Statement st = conn.praparedStatement(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">select * from t_user</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">4 执行查询语句</span>\r\n        ResultSet rs =<span style=\"color: #000000;\"> st.executeQuery();\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">5处理数据\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> * 如果查询多个使用，使用while循环进行所有数据获取\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> * 技巧：如果查询结果最多1条，使用  if(rs.next()) {  查询到了 } else {  没有数据 }</span>\r\n        <span style=\"color: #0000ff;\">while</span><span style=\"color: #000000;\">(rs.next()){\r\n            </span><span style=\"color: #0000ff;\">int</span> id = rs.getInt(<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">);\r\n            String username </span>= rs.getString(<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">);\r\n            String password </span>=rs.getString(<span style=\"color: #800080;\">3</span><span style=\"color: #000000;\">);\r\n            System.</span><span style=\"color: #0000ff;\">out</span>.print(id + <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">, </span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            System.</span><span style=\"color: #0000ff;\">out</span>.print(username + <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">, </span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            System.</span><span style=\"color: #0000ff;\">out</span><span style=\"color: #000000;\">.println(password);\r\n        }\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">6释放资源</span>\r\n<span style=\"color: #000000;\">        rs.close();\r\n        st.close();\r\n        conn.close();\r\n        \r\n    }</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">findAll()</span></div>\r\n<h2>2.2、增加操作(创建Create)　　</h2>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('b101a1aa-736e-4ea1-968c-4f23f14de503')\"><img id=\"code_img_closed_b101a1aa-736e-4ea1-968c-4f23f14de503\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_b101a1aa-736e-4ea1-968c-4f23f14de503\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('b101a1aa-736e-4ea1-968c-4f23f14de503',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_b101a1aa-736e-4ea1-968c-4f23f14de503\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">@Test\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> save() throws Exception{\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">1 注册驱动</span>\r\n        Class.forName(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">com.mysql.jdbc.Driver</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">2 获得连接</span>\r\n        Connection conn = DriverManager.getConnection(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbc:mysql://localhost:3306/test</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">root</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">root</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">3语句执行者</span>\r\n        Statement st = conn.praparedStatement(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">insert into t_user(username,password) values(?,?)</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">3.1赋值</span>\r\n                st.setString(<span style=\"color: #800080;\">1</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">xiaoming</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                st.setString(</span><span style=\"color: #800080;\">2</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">123</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">4 执行DML语句</span>\r\n        <span style=\"color: #0000ff;\">int</span> r =<span style=\"color: #000000;\"> st.executeUpdate();\r\n        \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">5处理数据</span>\r\n        System.<span style=\"color: #0000ff;\">out</span><span style=\"color: #000000;\">.println(r);\r\n        \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">6释放资源\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">rs.close();</span>\r\n<span style=\"color: #000000;\">        st.close();\r\n        conn.close();\r\n    }</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\"> save()</span></div>\r\n<h2>2.3、更新操作 （Update）</h2>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('5fb93c05-ca55-4fa5-b06c-fdad2257f063')\"><img id=\"code_img_closed_5fb93c05-ca55-4fa5-b06c-fdad2257f063\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_5fb93c05-ca55-4fa5-b06c-fdad2257f063\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('5fb93c05-ca55-4fa5-b06c-fdad2257f063',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_5fb93c05-ca55-4fa5-b06c-fdad2257f063\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">@Test\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> update() throws Exception{\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">1 注册驱动</span>\r\n        Class.forName(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">com.mysql.jdbc.Driver</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">2 获得连接</span>\r\n        Connection conn = DriverManager.getConnection(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbc:mysql://localhost:3306/test</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">root</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">root</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">3语句执行者</span>\r\n        Statement st = conn.praparedStatement(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">update t_user set username = ？ where id = ？ </span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">3.1赋值参数</span>\r\n                st.setString(<span style=\"color: #800080;\">1</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">xiaoye</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                st.setInt(</span><span style=\"color: #800080;\">2</span>,<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">4 执行DML语句</span>\r\n        <span style=\"color: #0000ff;\">int</span> r =<span style=\"color: #000000;\"> st.executeUpdate();\r\n        \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">5处理数据</span>\r\n        System.<span style=\"color: #0000ff;\">out</span><span style=\"color: #000000;\">.println(r);\r\n        \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">6释放资源\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">rs.close();</span>\r\n<span style=\"color: #000000;\">        st.close();\r\n        conn.close();\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\"> update()</span></div>\r\n<h2>2.4、删除操作（delete）</h2>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('68215119-e262-442b-baf1-db4e0b23a8e2')\"><img id=\"code_img_closed_68215119-e262-442b-baf1-db4e0b23a8e2\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_68215119-e262-442b-baf1-db4e0b23a8e2\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('68215119-e262-442b-baf1-db4e0b23a8e2',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_68215119-e262-442b-baf1-db4e0b23a8e2\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">@Test\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> delete() throws Exception{\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">1 注册驱动</span>\r\n        Class.forName(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">com.mysql.jdbc.Driver</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">2 获得连接</span>\r\n        Connection conn = DriverManager.getConnection(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbc:mysql://localhost:3306/test</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">root</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">root</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">3语句执行者</span>\r\n        Statement st = conn.praparedStatement(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">delete from t_user where id = ?</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">3.1赋值参数</span>\r\n                st.setInt(<span style=\"color: #800080;\">1</span>,<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">4 执行DML语句</span>\r\n        <span style=\"color: #0000ff;\">int</span> r =<span style=\"color: #000000;\"> st.executeUpdate();\r\n        \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">5处理数据</span>\r\n        System.<span style=\"color: #0000ff;\">out</span><span style=\"color: #000000;\">.println(r);\r\n        \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">6释放资源\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">rs.close();</span>\r\n<span style=\"color: #000000;\">        st.close();\r\n        conn.close();\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">delete()</span></div>\r\n<p>　　也可以用我前面写的JDBC连接的工具类去连接！</p>\r\n<h1>三、数据库连接池</h1>\r\n<p>　　在上面，我们在进行CRUD时，一直重复性的写一些代码，比如最开始的注册驱动，获取连接代码，一直重复写，通过编写一个获取连接的工具类后，解决了这个问题，但是又</p>\r\n<p>　　会出现新的问题，<span style=\"color: #ff0000;\">每进行一次操作，就会获取一个连接，用完之后，就销毁，就这样一直新建连接，销毁连接，新建，销毁，连接Connection 创建与销毁 比较耗时的</span>。所以应</p>\r\n<p>　　该要想办法解决这个问题？</p>\r\n<p>　　解决方法：</p>\r\n<p>　　　　连接池就是为了解决这个问题而出现的一个方法，<span style=\"color: #ff0000;\">为了提高性能，开发连接池，连接池中一直保持有n个连接，供调用者使用，调用者用完返还给连接池，继续给别的调用</span></p>\r\n<p><span style=\"color: #ff0000;\">　　　　者使</span><span style=\"color: #ff0000;\">用</span>，比如连接池中一开始就有10个连接，当有5个用户拿走了5个连接后，池中还剩5个，当第6个用户在去池中拿连接而前面5个连接还没归还时，连接池就会新建一个</p>\r\n<p>　　　　连接给第六个用户，让池中一直能够保存最少5个连接，而当这样新建了很多连接后，用户归还连接回来时，会比原先连接池中的10个连接更多，<span style=\"color: #ff0000;\">连接池就会设置一个池中</span></p>\r\n<p><span style=\"color: #ff0000;\">　　　　最大空闲的连</span><span style=\"color: #ff0000;\">接数，如果超过了这个数，就会将超过的连接给</span><span style=\"color: #ff0000;\">释放掉</span>，连接池就是这样工作的。</p>\r\n<h2>3.1、连接池概述</h2>\r\n<p>　　数据库连接池<span style=\"color: #ff0000;\">负责分配、管理和释放数据库连接</span>，它<span style=\"color: #ff0000;\">允许应用程序重复使用一个现有的数据库连接，而不是再重新建立一个</span>；<span style=\"color: #ff0000;\">释放空闲时间超过最大空闲时间的数据库连接来避</span></p>\r\n<p><span style=\"color: #ff0000;\">　　免因</span><span style=\"color: #ff0000;\">为没有释放数据库连接而引起的数据库连接遗漏</span>。这项技术能明显提高对数据库操作的性能。</p>\r\n<h2>3.2、比较应用程序直接获取连接和使用连接池</h2>\r\n<p>　　1）应用程序直接获取连接</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171101110238248-1965371301.png\" alt=\"\" width=\"568\" height=\"277\"></p>\r\n<p>　　　　缺点：用户每次请求都需要向数据库获得链接，而数据库创建连接通常需要消耗相对较大的资源，创建时间也较长。</p>\r\n<p>　　　　　　    假设网站一天10万访问量，数据库服务器就需要创建10万次连接，极大的浪费数据库的资源，并且极易造成数据库服务器内存溢出、宕机。</p>\r\n<p>　　2）使用连接池连接</p>\r\n<p>　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171101110455013-1326398434.png\" alt=\"\" width=\"562\" height=\"304\">　</p>\r\n<p>　　　　目的：解决建立数据库连接耗费资源和时间很多的问题，提高性能。</p>\r\n<h1>四、常用的数据库连接池　　</h1>\r\n<p>　　现在很多WEB服务器(Weblogic, WebSphere, Tomcat)都提供了DataSoruce的实现，即连接池的实现。通常我们把DataSource的实现，按其英文含义称之为数据源，</p>\r\n<p>　　数据源中都包含了数据库连接池的实现。<br>　　也有一些开源组织提供了数据源的独立实现：<br>　　　　DBCP 数据库连接池 <br>　　　　C3P0 数据库连接池<br>　　<span style=\"color: #ff0000;\">实际应用时不需要编写连接数据库代码，直接从数据源获得数据库的连接</span>。程序员编程时也应尽量使用这些数据源的实现，以提升程序的数据库访问性能。</p>\r\n<p>　　DBCP、C3P0、tomcat内置连接池(JNDI)是我们开发中会用到的。</p>\r\n<h2>4.1、DBCP连接池</h2>\r\n<p>　　1）概述</p>\r\n<p>　　　　DBCP 是 Apache 软件基金组织下的开源连接池实现，使用DBCP数据源，应用程序应在系统中增加如下两个 jar 文件：<br>　　　　　　Commons-dbcp.jar：连接池的实现<br>　　　　　　Commons-pool.jar：连接池实现的依赖库<br>　　　　Tomcat 的连接池正是<span style=\"color: #ff0000;\">采用该连接池来实现的</span>。该数据库连接池既可以与应用服务器整合使用，也可由应用程序独立使用。</p>\r\n<p>　　1）获取连接的两种方式</p>\r\n<p>　　　　两种方式<span style=\"color: #ff0000;\">获得连接，使用配置文件，不使用配置文件</span></p>\r\n<p>　　　　1.1）不使用配置文件，自己手动设置参数</p>\r\n<p> 　　　　　　第一：导包</p>\r\n<p>　　　　　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171101142542341-1930980814.png\" alt=\"\"></p>\r\n<p>　　　　　　第二：测试例子</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('14a691fe-d3f3-4fb5-a92a-54352db344ed')\"><img id=\"code_img_closed_14a691fe-d3f3-4fb5-a92a-54352db344ed\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_14a691fe-d3f3-4fb5-a92a-54352db344ed\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('14a691fe-d3f3-4fb5-a92a-54352db344ed',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_14a691fe-d3f3-4fb5-a92a-54352db344ed\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">package com.zyh.util;\r\n\r\nimport java.sql.Connection;\r\nimport java.sql.PreparedStatement;\r\nimport java.sql.ResultSet;\r\nimport java.sql.SQLException;\r\n\r\nimport org.apache.commons.dbcp.BasicDataSource;\r\n\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> TestDBCP {\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> main(String[] args) {\r\n        Connection conn </span>=<span style=\"color: #000000;\"> TestDBCP.getConnection();\r\n        </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n            String sql </span>= <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">select id,name,price from book</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n            PreparedStatement ps </span>=<span style=\"color: #000000;\"> conn.prepareStatement(sql);\r\n            ResultSet rs </span>=<span style=\"color: #000000;\"> ps.executeQuery();\r\n            </span><span style=\"color: #0000ff;\">while</span><span style=\"color: #000000;\">(rs.next()){\r\n                String id </span>= rs.getString(<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">);\r\n                String name </span>= rs.getString(<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">);\r\n                </span><span style=\"color: #0000ff;\">double</span> price = rs.getDouble(<span style=\"color: #800080;\">3</span><span style=\"color: #000000;\">);\r\n                System.</span><span style=\"color: #0000ff;\">out</span>.println(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">id=</span><span style=\"color: #800000;\">\"</span>+id+<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">,name=</span><span style=\"color: #800000;\">\"</span>+name+<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">,price=</span><span style=\"color: #800000;\">\"</span>+<span style=\"color: #000000;\">price);\r\n                System.</span><span style=\"color: #0000ff;\">out</span>.println(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">-------------------------</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            }\r\n            \r\n        } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (SQLException e) {\r\n            e.printStackTrace();\r\n        }\r\n        \r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Connection getConnection(){\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">创建核心类</span>\r\n                BasicDataSource bds = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> BasicDataSource();\r\n                </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">配置4个基本参数</span>\r\n                bds.setDriverClassName(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">com.mysql.jdbc.Driver</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                bds.setUrl(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbc:mysql:///book</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                bds.setUsername(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">root</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                bds.setPassword(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">654321</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                \r\n                </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">管理连接配置</span>\r\n                bds.setMaxActive(<span style=\"color: #800080;\">50</span>); <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">最大活动数</span>\r\n                bds.setMaxIdle(<span style=\"color: #800080;\">20</span>);  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">最大空闲数</span>\r\n                bds.setMinIdle(<span style=\"color: #800080;\">5</span>);  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">最小空闲数</span>\r\n                bds.setInitialSize(<span style=\"color: #800080;\">10</span>);  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">初始化个数\r\n                \r\n                </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取连接</span>\r\n                <span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n                     Connection conn </span>=<span style=\"color: #000000;\"> bds.getConnection();\r\n                     </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> conn;\r\n                } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (SQLException e) {\r\n                    </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> RuntimeException(e);\r\n                    }\r\n    }\r\n\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">TestDBCP</span></div>\r\n<p>　　　　1.2）使用<span style=\"color: #ff0000;\">配置文件，参数写入配置文件中即可，也就是通过配置文件来配置驱动、用户名、密码、等信息</span>　　</p>\r\n<p>　　　　　　第一：导包</p>\r\n<p>　　　　　　和上面的一样的</p>\r\n<p>　　　　　　第二：导入配置文件dbcpconfig.properties</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('378a24a8-15a1-4ad0-8ffb-9dc9f8c796c5')\"><img id=\"code_img_closed_378a24a8-15a1-4ad0-8ffb-9dc9f8c796c5\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_378a24a8-15a1-4ad0-8ffb-9dc9f8c796c5\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('378a24a8-15a1-4ad0-8ffb-9dc9f8c796c5',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_378a24a8-15a1-4ad0-8ffb-9dc9f8c796c5\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">#连接设置\r\ndriverClassName</span>=<span style=\"color: #000000;\">com.mysql.jdbc.Driver\r\nurl</span>=jdbc:mysql:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">localhost:3306/book</span>\r\nusername=<span style=\"color: #000000;\">root\r\npassword</span>=<span style=\"color: #800080;\">654321</span><span style=\"color: #000000;\">\r\n\r\n#</span>&lt;!-- 初始化连接 --&gt;<span style=\"color: #000000;\">\r\ninitialSize</span>=<span style=\"color: #800080;\">10</span><span style=\"color: #000000;\">\r\n\r\n#最大连接数量\r\nmaxActive</span>=<span style=\"color: #800080;\">50</span><span style=\"color: #000000;\">\r\n\r\n#</span>&lt;!-- 最大空闲连接 --&gt;<span style=\"color: #000000;\">\r\nmaxIdle</span>=<span style=\"color: #800080;\">20</span><span style=\"color: #000000;\">\r\n\r\n#</span>&lt;!-- 最小空闲连接 --&gt;<span style=\"color: #000000;\">\r\nminIdle</span>=<span style=\"color: #800080;\">5</span><span style=\"color: #000000;\">\r\n\r\n#</span>&lt;!-- 超时等待时间以毫秒为单位 6000毫秒/1000等于60秒 --&gt;<span style=\"color: #000000;\">\r\nmaxWait</span>=<span style=\"color: #800080;\">60000</span><span style=\"color: #000000;\">\r\n\r\n\r\n#JDBC驱动建立连接时附带的连接属性属性的格式必须为这样：[属性名</span>=<span style=\"color: #000000;\">property;] \r\n#注意：</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">user</span><span style=\"color: #800000;\">\"</span> 与 <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">password</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\"> 两个属性会被明确地传递，因此这里不需要包含他们。\r\nconnectionProperties</span>=useUnicode=<span style=\"color: #0000ff;\">true</span>;characterEncoding=<span style=\"color: #000000;\">gbk\r\n\r\n#指定由连接池所创建的连接的自动提交（auto</span>-<span style=\"color: #000000;\">commit）状态。\r\ndefaultAutoCommit</span>=<span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">\r\n\r\n#driver </span><span style=\"color: #0000ff;\">default</span> 指定由连接池所创建的连接的只读（read-<span style=\"color: #000000;\">only）状态。\r\n#如果没有设置该值，则“setReadOnly”方法将不被调用。（某些驱动并不支持只读模式，如：Informix）\r\ndefaultReadOnly</span>=<span style=\"color: #000000;\">\r\n\r\n#driver </span><span style=\"color: #0000ff;\">default</span><span style=\"color: #000000;\"> 指定由连接池所创建的连接的事务级别（TransactionIsolation）。\r\n#可用值为下列之一：（详情可见javadoc。）NONE,READ_UNCOMMITTED, READ_COMMITTED, REPEATABLE_READ, SERIALIZABLE\r\ndefaultTransactionIsolation</span>=READ_UNCOMMITTED</pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">dbcpconfig.properties</span></div>\r\n<p>　　　　　　第三：获取连接，测试例子</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('60c8883a-d48e-4d14-aad2-a7b1007e7ac2')\"><img id=\"code_img_closed_60c8883a-d48e-4d14-aad2-a7b1007e7ac2\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_60c8883a-d48e-4d14-aad2-a7b1007e7ac2\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('60c8883a-d48e-4d14-aad2-a7b1007e7ac2',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_60c8883a-d48e-4d14-aad2-a7b1007e7ac2\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">package com.zyh.util;\r\n\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.sql.Connection;\r\nimport java.sql.PreparedStatement;\r\nimport java.sql.ResultSet;\r\nimport java.sql.SQLException;\r\nimport java.util.Properties;\r\n\r\nimport javax.sql.DataSource;\r\n\r\nimport org.apache.commons.dbcp.BasicDataSourceFactory;\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> TestDBCPPro {\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> main(String[] args) {\r\n        Connection conn </span>=<span style=\"color: #000000;\"> TestDBCPPro.getConnection();\r\n        </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n            String sql </span>= <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">select id,name,price from book</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n            PreparedStatement ps </span>=<span style=\"color: #000000;\"> conn.prepareStatement(sql);\r\n            ResultSet rs </span>=<span style=\"color: #000000;\"> ps.executeQuery();\r\n            </span><span style=\"color: #0000ff;\">while</span><span style=\"color: #000000;\">(rs.next()){\r\n                String id </span>= rs.getString(<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">);\r\n                String name </span>= rs.getString(<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">);\r\n                </span><span style=\"color: #0000ff;\">double</span> price = rs.getDouble(<span style=\"color: #800080;\">3</span><span style=\"color: #000000;\">);\r\n                System.</span><span style=\"color: #0000ff;\">out</span>.println(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">id=</span><span style=\"color: #800000;\">\"</span>+id+<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">,name=</span><span style=\"color: #800000;\">\"</span>+name+<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">,price=</span><span style=\"color: #800000;\">\"</span>+<span style=\"color: #000000;\">price);\r\n                System.</span><span style=\"color: #0000ff;\">out</span>.println(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">-------------------------</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n            }\r\n            \r\n        } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (SQLException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Connection getConnection(){\r\n         </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">通过类加载器获取指定配置文件的输入流，TestDBCPPro是一个类名</span>\r\n        InputStream <span style=\"color: #0000ff;\">in</span> = TestDBCPPro.<span style=\"color: #0000ff;\">class</span>.getClassLoader().getResourceAsStream(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">dbcpconfig.properties</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        Properties properties </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Properties();\r\n        </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n                properties.load(</span><span style=\"color: #0000ff;\">in</span><span style=\"color: #000000;\">);\r\n                </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">加载配置文件，获得配置信息</span>\r\n                DataSource ds =<span style=\"color: #000000;\"> BasicDataSourceFactory.createDataSource(properties);\r\n                Connection conn </span>=<span style=\"color: #000000;\"> ds.getConnection();\r\n                </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> conn;\r\n        } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n    }\r\n    \r\n\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">TestDBCPPro</span></div>\r\n<p>　　　　1.3）编写一个数据源工具类</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('5ed5ba06-e8d6-44e4-acd1-ca7939b3d3a8')\"><img id=\"code_img_closed_5ed5ba06-e8d6-44e4-acd1-ca7939b3d3a8\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_5ed5ba06-e8d6-44e4-acd1-ca7939b3d3a8\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('5ed5ba06-e8d6-44e4-acd1-ca7939b3d3a8',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_5ed5ba06-e8d6-44e4-acd1-ca7939b3d3a8\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">package com.zyh.util;\r\n\r\n\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.net.URL;\r\nimport java.sql.Connection;\r\nimport java.sql.ResultSet;\r\nimport java.sql.SQLException;\r\nimport java.sql.Statement;\r\nimport java.util.Properties;\r\n\r\nimport javax.imageio.stream.FileImageInputStream;\r\nimport javax.sql.DataSource;\r\n\r\nimport org.apache.commons.dbcp.BasicDataSourceFactory;\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> DBCPUtils {\r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">static</span> DataSource ds = <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n    </span><span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\">{\r\n        Properties prop </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Properties();\r\n        </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n            prop.load(DBCPUtils.</span><span style=\"color: #0000ff;\">class</span>.getClassLoader().getResourceAsStream(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">dbcpconfig.properties</span><span style=\"color: #800000;\">\"</span>));<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">根据DBCPUtil的classes的路径，加载配置文件</span>\r\n            ds = BasicDataSourceFactory.createDataSource(prop);<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到一个数据源 </span>\r\n        } <span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception e) {\r\n            </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span> ExceptionInInitializerError(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">初始化错误，请检查配置文件</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        }\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Connection getConnection(){\r\n        </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> ds.getConnection();\r\n        } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (SQLException e) {\r\n            </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span> RuntimeException(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">服务器忙。。。</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        }\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> release(Connection conn,Statement stmt,ResultSet rs){\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">关闭资源</span>\r\n                <span style=\"color: #0000ff;\">if</span>(rs!=<span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">){\r\n                    </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n                        rs.close();\r\n                    } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception e) {\r\n                        e.printStackTrace();\r\n                    }\r\n                    rs </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n                }\r\n                </span><span style=\"color: #0000ff;\">if</span>(stmt!=<span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">){\r\n                    </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n                        stmt.close();\r\n                    } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception e) {\r\n                        e.printStackTrace();\r\n                    }\r\n                    stmt </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n                }\r\n                </span><span style=\"color: #0000ff;\">if</span>(conn!=<span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">){\r\n                    </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n                        conn.close();</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">关闭</span>\r\n                    } <span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception e) {\r\n                        e.printStackTrace();\r\n                    }\r\n                    conn </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n                }\r\n    }\r\n    \r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">DBCPUtils</span></div>\r\n<h2>4.2、C3P0</h2>\r\n<p>　　1）导包</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/999804/201711/999804-20171101150225732-246627734.png\" alt=\"\"></p>\r\n<p>　　2）从配置信息中获取  配置文件必须为xml（c3p0-config.xml）</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('bd20a9bd-4504-4ba8-b048-995ff92e96ee')\"><img id=\"code_img_closed_bd20a9bd-4504-4ba8-b048-995ff92e96ee\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_bd20a9bd-4504-4ba8-b048-995ff92e96ee\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('bd20a9bd-4504-4ba8-b048-995ff92e96ee',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_bd20a9bd-4504-4ba8-b048-995ff92e96ee\" class=\"cnblogs_code_hide\">\r\n<pre>&lt;c3p0-config&gt;\r\n    &lt;!-- 默认配置，如果没有指定则使用这个配置 --&gt;\r\n    &lt;<span style=\"color: #0000ff;\">default</span>-config&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">driverClass</span><span style=\"color: #800000;\">\"</span>&gt;com.mysql.jdbc.Driver&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbcUrl</span><span style=\"color: #800000;\">\"</span>&gt;jdbc:mysql:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">localhost:3306/book&lt;/property&gt;</span>\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">user</span><span style=\"color: #800000;\">\"</span>&gt;root&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">password</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">654321</span>&lt;/property&gt;\r\n    \r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">checkoutTimeout</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">30000</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">idleConnectionTestPeriod</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">30</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">initialPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">10</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">maxIdleTime</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">30</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">maxPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">100</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">minPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">10</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">maxStatements</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">200</span>&lt;/property&gt;\r\n        &lt;user-overrides user=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">test-user</span><span style=\"color: #800000;\">\"</span>&gt;\r\n            &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">maxPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">10</span>&lt;/property&gt;\r\n            &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">minPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">1</span>&lt;/property&gt;\r\n            &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">maxStatements</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">0</span>&lt;/property&gt;\r\n        &lt;/user-overrides&gt;\r\n    &lt;/<span style=\"color: #0000ff;\">default</span>-config&gt; \r\n    &lt;!-- 命名的配置 --&gt;\r\n    &lt;named-config name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jxpx</span><span style=\"color: #800000;\">\"</span>&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">driverClass</span><span style=\"color: #800000;\">\"</span>&gt;com.mysql.jdbc.Driver&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbcUrl</span><span style=\"color: #800000;\">\"</span>&gt;jdbc:mysql:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">localhost:3306/myums&lt;/property&gt;</span>\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">user</span><span style=\"color: #800000;\">\"</span>&gt;root&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">password</span><span style=\"color: #800000;\">\"</span>&gt;root&lt;/property&gt;\r\n    &lt;!-- 如果池中数据连接不够时一次增长多少个 --&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">acquireIncrement</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">5</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">initialPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">20</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">minPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">10</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">maxPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">40</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">maxStatements</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">0</span>&lt;/property&gt;\r\n        &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">maxStatementsPerConnection</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">5</span>&lt;/property&gt;\r\n    &lt;/named-config&gt;\r\n&lt;/c3p0-config&gt;</pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">c3p0-config.xml</span>　　</div>\r\n<p>　　　　从配置文件中看，需要注意一个地方，<span style=\"color: #ff0000;\">一个是default-config，一个是name-config</span>，两者都区别在于<span style=\"color: #ff0000;\">创建核心类对象时，如果将name-config作为参数传进去，</span></p>\r\n<p><span style=\"color: #ff0000;\">　　　　那么将会调用name-config下的配置信息，否则将调用default-config下的配置信息，</span></p>\r\n<p>　　　　两种方式使用c3p0，<span style=\"color: #ff0000;\">加参数，使用named-config 的配置信息</span>，<span style=\"color: #339966;\">不加参数，自动加载配置信息，加载的是default-config中的信息。</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre>        <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">1 c3p0...jar 将自动加载配置文件。规定：WEB-INF/classes (src)  c3p0-config.xml,也就是将配置文件放在src下就会自动加载。\r\n         </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">ComboPooledDataSource dataSource = new ComboPooledDataSource(); </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">自动从配置文件 &lt;default-config&gt;</span>\r\n         ComboPooledDataSource dataSource = <span style=\"color: #0000ff;\">new</span> ComboPooledDataSource(); <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">手动指定配置文件 &lt;named-config name=\"jxpx\"&gt;</span>\r\n         Connection conn =<span style=\"color: #000000;\"> dataSource.getConnection();\r\n         System.</span><span style=\"color: #0000ff;\">out</span>.println(conn);</pre>\r\n</div>\r\n<p> </p>\r\n<p>　　3）编写一个数据源工具类</p>\r\n<p>　　这个工具类的xml是：</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('3070a96d-30fb-458d-b82c-4d7081a8a432')\"><img id=\"code_img_closed_3070a96d-30fb-458d-b82c-4d7081a8a432\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_3070a96d-30fb-458d-b82c-4d7081a8a432\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('3070a96d-30fb-458d-b82c-4d7081a8a432',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_3070a96d-30fb-458d-b82c-4d7081a8a432\" class=\"cnblogs_code_hide\">\r\n<pre>&lt;?xml version=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">1.0</span><span style=\"color: #800000;\">\"</span> encoding=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">UTF-8</span><span style=\"color: #800000;\">\"</span>?&gt;\r\n&lt;c3p0-config&gt;\r\n  &lt;<span style=\"color: #0000ff;\">default</span>-config&gt;\r\n    &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">driverClass</span><span style=\"color: #800000;\">\"</span>&gt;com.mysql.jdbc.Driver&lt;/property&gt;\r\n    &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbcUrl</span><span style=\"color: #800000;\">\"</span>&gt;jdbc:mysql:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">localhost:3306/book/property&gt;</span>\r\n    &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">user</span><span style=\"color: #800000;\">\"</span>&gt;root&lt;/property&gt;\r\n    &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">password</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">654321</span>&lt;/property&gt;\r\n    &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">initialPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">10</span>&lt;/property&gt;\r\n    &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">maxIdleTime</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">30</span>&lt;/property&gt;\r\n    &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">maxPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">100</span>&lt;/property&gt;\r\n    &lt;property name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">minPoolSize</span><span style=\"color: #800000;\">\"</span>&gt;<span style=\"color: #800080;\">10</span>&lt;/property&gt;\r\n\r\n  &lt;/<span style=\"color: #0000ff;\">default</span>-config&gt;\r\n\r\n&lt;/c3p0-config&gt;</pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">c3p0-config.xml</span></div>\r\n<p>　　工具类</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('db12a3ba-afba-4a1e-93f2-67714451c172')\"><img id=\"code_img_closed_db12a3ba-afba-4a1e-93f2-67714451c172\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_db12a3ba-afba-4a1e-93f2-67714451c172\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('db12a3ba-afba-4a1e-93f2-67714451c172',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_db12a3ba-afba-4a1e-93f2-67714451c172\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">package com.zyh.util;\r\n\r\nimport java.beans.PropertyVetoException;\r\nimport java.sql.Connection;\r\nimport java.sql.ResultSet;\r\nimport java.sql.SQLException;\r\nimport java.sql.Statement;\r\n\r\nimport javax.sql.DataSource;\r\n\r\nimport com.mchange.v2.c3p0.ComboPooledDataSource;\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> C3P0Util {\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">得到一个数据源</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">static</span> DataSource dataSource = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> ComboPooledDataSource();\r\n    \r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">从数据源中得到一个连接对象</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> Connection getConnection(){\r\n        </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> dataSource.getConnection();\r\n        } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (SQLException e) {\r\n            </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span> RuntimeException(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">服务器错误</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        }\r\n    }\r\n    \r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> release(Connection conn,Statement stmt,ResultSet rs){\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">关闭资源</span>\r\n                <span style=\"color: #0000ff;\">if</span>(rs!=<span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">){\r\n                    </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n                        rs.close();\r\n                    } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception e) {\r\n                        e.printStackTrace();\r\n                    }\r\n                    rs </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n                }\r\n                </span><span style=\"color: #0000ff;\">if</span>(stmt!=<span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">){\r\n                    </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n                        stmt.close();\r\n                    } </span><span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception e) {\r\n                        e.printStackTrace();\r\n                    }\r\n                    stmt </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n                }\r\n                </span><span style=\"color: #0000ff;\">if</span>(conn!=<span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">){\r\n                    </span><span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\"> {\r\n                        conn.close();</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">关闭</span>\r\n                    } <span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception e) {\r\n                        e.printStackTrace();\r\n                    }\r\n                    conn </span>= <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n                }\r\n    }\r\n    \r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">C3P0Util</span></div>\r\n<h2>4.3、用JavaWeb服务器管理数据源：Tomcat</h2>\r\n<p>　　开发JavaWeb应用，必须使用一个JavaWeb服务器，<span style=\"color: #ff0000;\">JavaWeb服务器都内置数据源</span>。<br>　　Tomcat：（DBCP）<br>　　<span style=\"color: #ff0000;\">数据源只需要配置服务器即可</span>。<br> 　　配置数据源的步骤：<br>　　　　1）<span style=\"color: #ff0000;\">拷贝数据库连接的jar到tomcatlib目录下</span><br>　　　　2）配置数据源XML文件<br>　　　　　　a)如果把配置信息写在tomcat下的conf目录的context.xml中，那么所有应用都能使用此数据源。<br>　　　　　　b)如果是在当前应用的META-INF中创建context.xml, 编写数据源，那么只有当前应用可以使用。</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('9daa112d-e0f4-4fd3-8361-ebef4c7dce3c')\"><img id=\"code_img_closed_9daa112d-e0f4-4fd3-8361-ebef4c7dce3c\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_9daa112d-e0f4-4fd3-8361-ebef4c7dce3c\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('9daa112d-e0f4-4fd3-8361-ebef4c7dce3c',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_9daa112d-e0f4-4fd3-8361-ebef4c7dce3c\" class=\"cnblogs_code_hide\">\r\n<pre>&lt;Context&gt;\r\n  &lt;Resource name=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbc/datasource</span><span style=\"color: #800000;\">\"</span> auth=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Container</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">\r\n            type</span>=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">javax.sql.DataSource</span><span style=\"color: #800000;\">\"</span> username=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">root</span><span style=\"color: #800000;\">\"</span> password=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">654321</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">\r\n            driverClassName</span>=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">com.mysql.jdbc.Driver</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\"> \r\n          url</span>=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbc:mysql://localhost:3306/book</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">\r\n            maxActive</span>=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">8</span><span style=\"color: #800000;\">\"</span> maxIdle=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">4</span><span style=\"color: #800000;\">\"</span>/&gt;\r\n&lt;/Context&gt;</pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">context.xml</span></div>\r\n<p>　　在servlet中进行测试：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>　　Context initCtx = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> InitialContext();\r\n　　Context envCtx </span>= (Context) initCtx.lookup(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">java:comp/env</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);  //path\r\n　　dataSource </span>= (DataSource)envCtx.lookup(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jdbc/datasource</span><span style=\"color: #800000;\">\"</span>);   //context.xml中resource的name</pre>\r\n</div>\r\n<p>　　注意：此种配置下，驱动jar文件需放置在tomcat的lib下　　</p>\r\n<p>　　扩展：</p>\r\n<p>　　　　JNDI技术介绍：</p>\r\n<p>　　　　　　1）JNDI(Java Naming and Directory Interface)，<span style=\"color: #ff0000;\">Java命名和目录接口，它对应于J2SE中的javax.naming包。</span><br>　　　　　　2）这套API的主要作用在于：</p>\r\n<p>　　　　　　　　它可以<span style=\"color: #ff0000;\">把Java对象放在一个容器中（JNDI容器），并为容器中的java对象取一个名称，以后程序想获得Java对象，只需通过名称检索即可</span>。<br>　　　　　　3）其核心API为<span style=\"color: #ff0000;\">Context，它代表JNDI容器</span>，其lookup方法为检索容器中对应名称的对象。</p>\r\n<p>　</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 15:40</span> <a href=\"http://www.cnblogs.com/zhangyinhua/\">苦水润喉</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7765626\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7765626);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=320169,cb_entryId=7765626,cb_blogApp=currentBlogApp,cb_blogUserGuid='e9bdb417-3c54-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/1 15:40:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 209, "image_url": ["https://pic.cnblogs.com/face/999804/20170729235406.png"], "date_pub": "2017-11-01", "article_common": 1}
{"title": "基于.NET CORE微服务框架 -浅析如何使用surging", "url": "http://www.cnblogs.com/fanliang11/p/7766955.html", "author": "fanly11", "article_desc": "\r\n    1、前言 surging受到大家这么强烈的关注，我感到非常意外，比如有同僚在公司的分享会上分享surging, 还有在博客拿其它的RPC框架，微服务做对比等等，这些举动都让我感觉压力很大，毕竟作为个人的开源项目，无法与成熟的开源社区的项目相比，也只有等到后面有许许多多志同道合的朋友加入一起研发完善s ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/fanliang11/p/7766955.html\">基于.NET CORE微服务框架 -浅析如何使用surging</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p align=\"left\"><strong>1</strong><strong>、前言</strong></p>\n<p align=\"left\">      surging受到大家这么强烈的关注，我感到非常意外，比如有同僚在公司的分享会上分享surging, 还有在博客拿其它的RPC框架，微服务做对比等等，这些举动都让我感觉压力很大，毕竟作为个人的开源项目，无法与成熟的开源社区的项目相比，也只有等到后面有许许多多志同道合的朋友加入一起研发完善surging，这样才能让surging 成为流行的微服务框架。</p>\n<p align=\"left\">这篇文章介绍如何使用surging</p>\n<p align=\"left\"> </p>\n<p align=\"left\">开源地址：<a href=\"https://github.com/dotnetcore/surging\" target=\"_blank\">https://github.com/dotnetcore/surging</a></p>\n<h1 align=\"left\"><strong>2</strong><strong>、设计模式</strong></h1>\n<p align=\"left\">Surging 提供了以下四种设计模式</p>\n<h2 align=\"left\">2.1  <strong>代理模式</strong></h2>\n<p align=\"left\">通过代理调用不同的微服务。并且针对于规则控制其访问，如下图所示：</p>\n<p align=\"left\"> <img src=\"http://images2017.cnblogs.com/blog/192878/201711/192878-20171101152551482-1830025418.png\" alt=\"\"></p>\n<h2 align=\"left\"><strong>2.2 </strong><strong>异步消息模式</strong></h2>\n<p align=\"left\">再处理等待而阻塞的问题时候， 基于微服务的架构会选择使用消息队列来代替请求/响应模式，如下图所示：</p>\n<p align=\"left\"><img src=\"http://images2017.cnblogs.com/blog/192878/201711/192878-20171101152633279-1616766763.png\" alt=\"\"></p>\n<p> </p>\n<h2>2.3 链式模式</h2>\n<p>这种模式在接收到请求后会进行互相合并的响应，如下图所示：</p>\n<p>服务A接收到请求后会与服务B进行通信，服务B会同服务C进行通信。所有服务之间的通信使用基于Netty的RPC通信。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/192878/201711/192878-20171101152718888-1434615097.png\" alt=\"\"></p>\n<p> </p>\n<h2>2.4  分支模式</h2>\n<p>这种模式允许调用多个服务提供者,来合并数据进行返回，如下图所示：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/192878/201711/192878-20171101152746998-1184551028.png\" alt=\"\"></p>\n<p> </p>\n<h1 align=\"left\"><strong>3</strong><strong>、外部如何交互</strong></h1>\n<p>服务主要针对提交的数据进行处理，在单个服务或多个服务调用的问题上，采取使用网关统一访问的形式进行处理，如下图所示</p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/192878/201711/192878-20171101152833716-815338177.png\" alt=\"\"></p>\n<p>网关包括以下功能：</p>\n<ol>\n<li>安全身份认证</li>\n<li>统一访问</li>\n<li>流量控制</li>\n<li>分流控制</li>\n<li>数据监控</li>\n<li>缓存拦截</li>\n</ol>\n<h2>2.简单示例</h2>\n<h3>服务端</h3>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">var host = new ServiceHostBuilder()\n               .RegisterServices(option=&gt; {\n                   option.Initialize(); //初始化服务\n                   option.RegisterServices();//依赖注入领域服务\n                   option.RegisterRepositories();//依赖注入仓储\n                   option.RegisterModules();//依赖注入第三方模块\n                   option.RegisterServiceBus();//依赖注入ServiceBus\n               })\n               .RegisterServices(builder =&gt;\n               {\n                   builder.AddMicroService(option =&gt;\n                   {\n                       option.AddServiceRuntime();//\n                       // option.UseZooKeeperManager(new ConfigInfo(\"127.0.0.1:2181\")); //使用Zookeeper管理\n                       option.UseConsulManager(new ConfigInfo(\"127.0.0.1:8500\"));//使用Consul管理\n                       option.UseDotNettyTransport();//使用Netty传输\n                       option.UseRabbitMQTransport();//使用rabbitmq 传输\n                       option.AddRabbitMQAdapt();//基于rabbitmq的消费的服务适配\n                       builder.Register(p =&gt; new CPlatformContainer(ServiceLocator.Current));//初始化注入容器\n                   });\n               })\n               .SubscribeAt()     //消息订阅\n               .UseServer(\"127.0.0.1\", 98)\n             //.UseServer(\"127.0.0.1\", 98，“true”) //自动生成Token\n             //.UseServer(\"127.0.0.1\", 98，“123456789”) //固定密码Token\n               .UseStartup&lt;Startup&gt;()\n               .Build();\n               \n           using (host.Run())\n           {\n               Console.WriteLine($\"服务端启动成功，{DateTime.Now}。\");\n           }\n</pre>\n</div>\n<h3><br>\n服务路由访问配置</h3>\n<p>在接口上，添加以下特性（还未实现统一方法配置）</p>\n<div class=\"cnblogs_code\">\n<pre>   [ServiceBundle(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">api/{Service}</span><span style=\"color: #800000\">\"</span>)]</pre>\n</div>\n<h3>服务创建代理调用 （需要依赖接口创建代理）</h3>\n<div class=\"cnblogs_code\">\n<pre>ServiceLocator.GetService&lt;IServiceProxyFactory&gt;().CreateProxy&lt;T&gt;(key)</pre>\n</div>\n<h3> </h3>\n<h3>服务根据RoutePath 进行调用（不需要依赖接口，耦合性低）</h3>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">ServiceLocator.GetService&lt;IServiceProxyProvider&gt;().Invoke&lt;string&gt;(model, path, serviceKey)\n</pre>\n</div>\n<h3> </h3>\n<h3>本地模块和服务调用</h3>\n<div class=\"cnblogs_code\">\n<pre>ServiceLocator.GetService&lt;T&gt;(key)</pre>\n</div>\n<p>通过以上配置，可以通过网关进行访问，如果我们要访问接口IUserService ,方法为GetUser，路由映射的规则[ServiceBundle(<span style=\"color: #800000\">\"<span style=\"color: #800000\">api/{Service}/{<span style=\"color: #800000\"><span style=\"color: #800000\">Method</span></span>}<span style=\"color: #800000\">\")],所转化地址应该是api/User/GetUser,</span></span></span></p>\n<p>用Postman测试的效果如下：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/192878/201711/192878-20171101155749279-719701076.png\" alt=\"\"></p>\n<h1>4. 总结</h1>\n<p>surging外部通过Api 网关 Rest 访问，内部通过netty RPC访问，surging还在不断完善中，帮助文档也正在赶工中，请大家耐心等待。如感兴趣请多关注或者加入QQ群：615562965</p>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 16:01</span> <a href=\"http://www.cnblogs.com/fanliang11/\">fanly11</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766955\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766955);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=362139,cb_entryId=7766955,cb_blogApp=currentBlogApp,cb_blogUserGuid='5c9afcd8-74ec-df11-ac81-842b2b196315',cb_entryCreatedDate='2017/11/1 16:01:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 1731, "image_url": ["https:"], "date_pub": "2017-11-01", "article_common": 14}
{"title": "linux云服务器常用设置", "url": "http://www.cnblogs.com/xiaohuochai/p/7749727.html", "author": "小火柴的蓝色理想", "article_desc": "[1]更改shell [2]帐号权限 [3]无密码登录 [4]修改端口 [5]设置防火墙 [6]配置nodejs [7]配置nginx [8]域名解析 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/xiaohuochai/p/7749727.html\">linux云服务器常用设置</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h2>前面的话</h2>\r\n<p>　　由于在云服务器上配置自己的网站，将Linux里的常用设置记录如下</p>\r\n<p> </p>\r\n<h3>更改shell</h3>\r\n<p>　　默认地， ubuntu系统默认的shell是dash，但更常用的shell是bash</p>\r\n<p>　　通过下面命令可以将dash更改为bash</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>dpkg-reconfigure dash</pre>\r\n</div>\r\n<p>　　然后选&lt;No&gt;</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171029154859508-848049823.png\" alt=\"\"></div>\r\n<p>　　执行ls -l /bin/sh命令，查看shell类型已经修改为bash</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>ls -l /bin/sh</pre>\r\n</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171029155155008-1787285342.png\" alt=\"\"></div>\r\n<p> </p>\r\n<h3>帐号权限</h3>\r\n<p>　　为了提高服务器安全性，需要设置一个高权限的账号来代替root执行常规操作</p>\r\n<p>　　首先，新建一个用户</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>useradd test</pre>\r\n</div>\r\n<p>　　[注意]在centos系统下，使用useradd会默认在home目录下，新增一个与用户名同名的目录。如果是ubuntu系统，默认不创建目录，如果需要则添加-m参数</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>useradd test -m</pre>\r\n</div>\r\n<p>　　设置用户密码</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>passwd test</pre>\r\n</div>\r\n<p>　　将test用户添加到sudo组中，操作命令前加sudo命令，即可实现root权限</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>gpasswd -a test sudo</pre>\r\n</div>\r\n<p>　　然后使用su test，即切换到test帐号下</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>su test</pre>\r\n</div>\r\n<p> </p>\r\n<h3>无密码登录</h3>\r\n<p>　　SSH是网络上两台机器互联的一套协议，默认需要22端口</p>\r\n<p>　　使用ssh test@1.2.3.4可以以test用户名来登录1.2.3.4服务器，按下ctrl+d可以退出登录</p>\r\n<p>　　下面通过添加SSH key的方式来进行无密码登录</p>\r\n<p>　　首先，在本地机器上执行下列指令</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>$ ssh-keygen</pre>\r\n</div>\r\n<p>　　会出现几个问题，都直接回车取默认值就可以了</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171028210529211-947365957.png\" alt=\"\"></div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171028210657461-361628123.png\" alt=\"\"></div>\r\n<p>　　id_rsa 是私钥，是要严格保密的，id_rsa.pub是公钥，需要上传到服务器的/home/test/.ssh/authorized_keys文件中</p>\r\n<p>　　可以手动拷贝文件，也进入本地的.ssh目录下，然后执行以下命令</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>ssh-copy-id test@<span style=\"color: #800080;\">1.2</span>.<span style=\"color: #800080;\">3.4</span></pre>\r\n</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171029131923273-1204741965.png\" alt=\"\">\r\n<p>　　这样，以后登录就不用再输入密码了</p>\r\n</div>\r\n<p> </p>\r\n<h3>配置git</h3>\r\n<p>　　一般地，服务器要从github等代码托管平台获取最新的代码，所以配置git是必不可少的操作</p>\r\n<p>　　首先，更新apt-get软件包的列表</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>apt-<span style=\"color: #0000ff;\">get</span> update</pre>\r\n</div>\r\n<p>　　接下来，安装git</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>apt-<span style=\"color: #0000ff;\">get</span> install git</pre>\r\n</div>\r\n<p>　　关于apt-get的常用命令如下</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>apt-<span style=\"color: #0000ff;\">get</span><span style=\"color: #000000;\"> update #更新软件包列表\r\napt</span>-<span style=\"color: #0000ff;\">get</span><span style=\"color: #000000;\"> install packagename #安装一个新软件包\r\napt</span>-<span style=\"color: #0000ff;\">get</span><span style=\"color: #000000;\"> remove packagename #卸载一个已安装的软件包（保留配置文档）\r\napt</span>-<span style=\"color: #0000ff;\">get</span> remove --<span style=\"color: #000000;\">purge packagename #卸载一个已安装的软件包（删除配置文档）\r\napt</span>-<span style=\"color: #0000ff;\">get</span><span style=\"color: #000000;\"> autoremove packagename #删除包及其依赖的软件包\r\napt</span>-<span style=\"color: #0000ff;\">get</span> autoremove --purge packagname #删除包及其依赖的软件包+配置文件</pre>\r\n</div>\r\n<p>　　然后，就可以从git地址克隆代码了</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>git clone git@git.xxx/xxx.git</pre>\r\n</div>\r\n<p>　　当代码有改动时，先进入项目目录，如mall，然后使用git pull即可获取最新的代码了</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>cd mall<br>git pull</pre>\r\n</div>\r\n<p> </p>\r\n<h3>修改端口</h3>\r\n<p>　　默认地，SSH端口是22。将其修改为其他端口，可以缩小被扫描和猜测的概率，增加服务器安全性</p>\r\n<p>　　[注意]该操作要在root用户下进行，否则会出现一些不容易解决的问题</p>\r\n<p>　　1、修改/etc/ssh/sshd_config文件里面的port端口为1024以上的任意端口</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171029200737898-1209024372.png\" alt=\"\">\r\n<p>　　2、然后，执行下列命令重启ssh服务</p>\r\n</div>\r\n<div class=\"cnblogs_code\">\r\n<pre>sudo service ssh restart</pre>\r\n</div>\r\n<p>　　3、在阿里云安全规则中添加2000端口</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171029200904351-1927451256.png\" alt=\"\"></div>\r\n<p> </p>\r\n<h3>设置防火墙</h3>\r\n<p>　　在/etc目录下，新建iptables.up.rules文件，内容如下</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\">*filter<br><br></span><span style=\"color: #000000;\">#allow all connections\r\n</span>-A INPUT -m state --state ESTABLISHED,RELATED -<span style=\"color: #000000;\">j ACCEPT\r\n\r\n#allow </span><span style=\"color: #0000ff;\">out</span><span style=\"color: #000000;\"> traffic\r\n</span>-A OUTPUT -<span style=\"color: #000000;\">j ACCEPT\r\n\r\n#allow http https\r\n</span>-A INPUT -p tcp --dport <span style=\"color: #800080;\">443</span> -<span style=\"color: #000000;\">j ACCEPT\r\n\r\n</span>-A INPUT -p tcp --dport <span style=\"color: #800080;\">80</span> -<span style=\"color: #000000;\">j ACCEPT\r\n\r\n#allow ssh port login\r\n</span>-A INPUT -p tcp -m state --state NEW --dport <span style=\"color: #800080;\">2000</span> -<span style=\"color: #000000;\">j ACCEPT\r\n\r\n#allow ping\r\n</span>-A INPUT -p icmp -m icmp --icmp-type <span style=\"color: #800080;\">8</span> -<span style=\"color: #000000;\">j ACCEPT\r\n\r\n#log denied calls\r\n</span>-A INPUT -m limit --limit <span style=\"color: #800080;\">5</span>/min -j LOG --log-prefix <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">iptables denied:</span><span style=\"color: #800000;\">\"</span> --log-level <span style=\"color: #800080;\">7</span><span style=\"color: #000000;\">\r\n<br>#drop incoming sensitive connetions<br>-A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --set<br>-A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --update --seconds 60 --hitcount 150 -j DROP\r\n#reject all other inbound\r\n</span>-A INPUT -<span style=\"color: #000000;\">j REJECT\r\n</span>-A FORWARD -<span style=\"color: #000000;\">j REJECT\r\n\r\nCOMMIT</span></pre>\r\n</div>\r\n<p>　　接着，使用下列命令使防火墙规则生效</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>iptables-restore &lt; /etc/iptables.up.rules</pre>\r\n</div>\r\n<p>　　使用ufw status命令来查看防火墙状态，并使用ufw enable来开启防火墙</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171029203522726-706463389.png\" alt=\"\"></div>\r\n<p>　　下面来设置防火墙开机自动启动，在/etc/network/if-up.d目录下，新建一个iptables脚本文件</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>vi /etc/network/<span style=\"color: #0000ff;\">if</span>-up.d/iptables</pre>\r\n</div>\r\n<p>　　文件内容如下</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>#!/bin/<span style=\"color: #000000;\">sh\r\niptables</span>-restore /etc/iptables.up.rules</pre>\r\n</div>\r\n<p>　　将该脚本文件赋予执行权限</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>chmod +x /etc/network/<span style=\"color: #0000ff;\">if</span>-up.d/iptables</pre>\r\n</div>\r\n<p> </p>\r\n<h3>配置nginx</h3>\r\n<p>　　如果服务器只需要放置一个网站程序，解析网站到服务器的网站，网站程序监听80端口就可以了。如果服务器有很多应用，借助nginx不仅可以实现端口的代理，还可以实现负载均衡</p>\r\n<p>　　首先，安装nginx</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>apt-<span style=\"color: #0000ff;\">get</span> install nginx</pre>\r\n</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171029234510617-929312180.png\" alt=\"\"></div>\r\n<p>　　下面在/etc/nginx/conf.d下新建一个配置文件，命名为test-8081.conf，内容如下</p>\r\n<p>　　[注意]一般以域名-端口号来命名配置文件</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\">upstream xiaohuochai {\r\n        server </span><span style=\"color: #800080;\">127.0</span>.<span style=\"color: #800080;\">0.1</span>:<span style=\"color: #800080;\">8081</span><span style=\"color: #000000;\">;\r\n}\r\nserver{\r\n        listen </span><span style=\"color: #800080;\">80</span><span style=\"color: #000000;\">;\r\n        server_name </span><span style=\"color: #000000;\"><span style=\"color: #800080;\">1.2.3.4</span></span><span style=\"color: #000000;\">;\r\n        location </span>/<span style=\"color: #000000;\"> {\r\n                proxy_set_header X</span>-Real-<span style=\"color: #000000;\">IP $remote_addr;\r\n                proxy_set_header X</span>-Forward-<span style=\"color: #000000;\">For $proxy_add_x_forwarded_for;\r\n                proxy_set_header Host $http_host;\r\n                proxy_set_header X</span>-Nginx-Proxy <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n                proxy_pass http:</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">test;</span>\r\n<span style=\"color: #000000;\">                proxy_redirect off;\r\n\r\n        }\r\n\r\n}</span></pre>\r\n</div>\r\n<p>　　下面使用nginx -t来测试配置文件是否格式正确</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171030023945511-161942930.png\" alt=\"\"></div>\r\n<p>　　如果不想让报文显示server的详细信息，需要将/etc/nginx/nginx.conf主配置文件中的server_tockens off前面的注释取消即可</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171030024734590-2132862856.png\" alt=\"\"> </div>\r\n<p>　　接着，重启nginx服务</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>nginx -s reload</pre>\r\n</div>\r\n<p> </p>\r\n<h3>域名解析</h3>\r\n<p>　　一般地，使用dnspod.cn来进行域名解析。</p>\r\n<p>　　在原域名注册商设置dnspod的DNS解析</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\"> f1g1ns1.dnspod.net\r\n f1g1ns2.dnspod.net</span></pre>\r\n</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171030113133433-1837595474.png\" alt=\"\"></div>\r\n<p>　　在dnspod.cn的域名解析页面填入要解析的域名</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171030113411355-1139893742.png\" alt=\"\"></div>\r\n<p>　　添加域名后，下面来添加记录即可</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171030121810324-793691467.png\" alt=\"\"></div>\r\n<p> </p>\r\n<h3>PM2部署</h3>\r\n<p>　　【1】安装</p>\r\n<p>　　为了让nodejs程序常驻，也为了实现自动化部署，需要使用PM2。使用npm全局安装pm2</p>\r\n<p>　　[注意]一定要全局安装，否则pm2无法使用</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>cnpm install pm2 -g</pre>\r\n</div>\r\n<p>　　pm2常用命令如下</p>\r\n<div class=\"cnblogs_code\">\r\n<pre> pm2 start app.js #启动app.js应用程序\r\n pm2 start app.js --watch # 当文件变化时自动重启应用\r\n pm2 list # 列表 PM2 启动的所有的应用程序\r\n pm2 monit # 显示每个应用程序的CPU和内存占用情况\r\n pm2 show [app-name] # 显示应用程序的所有信息\r\n pm2 logs # 显示所有应用程序的日志\r\n pm2 stop all # 停止所有的应用程序\r\n pm2 stop 0 # 停止 id为 0的指定应用程序\r\n pm2 restart all # 重启所有应用\r\n pm2 delete all # 关闭并删除所有应用\r\n pm2 delete 0 # 删除指定应用 id 0\r\n pm2 startup # 创建开机自启动命令</pre>\r\n</div>\r\n<p>　　【2】部署</p>\r\n<p>　　[注意]官网有详细的部署流程，详细情况<a href=\"http://pm2.keymetrics.io/docs/usage/deployment/\" target=\"_blank\">移步至此</a></p>\r\n<p>　　首先，在服务器用户目录下，新建一个www目录，用于存放后端代码</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>mkdir www</pre>\r\n</div>\r\n<p>　　然后，在本地后端项目目录下，如/server，新建一个ecosystem.json文件，内容如下</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\">{\r\n  </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">apps</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\"> : [{\r\n    </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">name</span><span style=\"color: #800000;\">\"</span>      : <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">mall</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n    </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">script</span><span style=\"color: #800000;\">\"</span>    : <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">./bin/www</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n    </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">env</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">: {\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">COMMON_VARIABLE</span><span style=\"color: #800000;\">\"</span>: <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">true</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">\r\n    },\r\n    </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">env_production</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\"> : {\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">NODE_ENV</span><span style=\"color: #800000;\">\"</span>: <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">production</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">\r\n    }\r\n  }],\r\n  </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">deploy</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\"> : {\r\n    </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">production</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\"> : {\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">user</span><span style=\"color: #800000;\">\"</span> : <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">xxx</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">host</span><span style=\"color: #800000;\">\"</span> : [<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">1.2.3.4</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">],\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">port</span><span style=\"color: #800000;\">\"</span> : <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">22</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">ref</span><span style=\"color: #800000;\">\"</span>  : <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">origin/master</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">repo</span><span style=\"color: #800000;\">\"</span> : <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">git@git.coding.net:ehuo0123/mall.git</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">path</span><span style=\"color: #800000;\">\"</span> : <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">/home/xxx/www/mall</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">post-deploy</span><span style=\"color: #800000;\">\"</span> : <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">source ~/.nvm/nvm.sh &amp;&amp; cd server &amp;&amp; cnpm install &amp;&amp; pm2 startOrRestart ecosystem.json --env production</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">ssh_options</span><span style=\"color: #800000;\">\"</span>: <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">StrictHostKeyChecking=no</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">,\r\n      </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">env</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">  : {\r\n        </span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">NODE_ENV</span><span style=\"color: #800000;\">\"</span>: <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">production</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">\r\n      }\r\n    }\r\n  }\r\n}</span></pre>\r\n</div>\r\n<p>　　然后，在本地git目录下，更新git</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\">git add .\r\ngit commit </span>-m <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">change ecosystem</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">\r\ngit push origin master</span></pre>\r\n</div>\r\n<p>　　接着，在本机的/server目录下，执行下列命令</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>pm2 deploy ecosystem.json production setup</pre>\r\n</div>\r\n<p>　　出现如下标识，表示设置成功</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201711/740839-20171101133638654-2063872788.png\" alt=\"\"></div>\r\n<p>　　接着，使用如下代码，使服务器从git代码托管平台获取最新的代码，且使用pm2自动部署</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>pm2 deploy ecosystem.json production</pre>\r\n</div>\r\n<p>　　出现如下代码，表示部署成功</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201711/740839-20171101134407857-1289254289.png\" alt=\"\"></div>\r\n<p> </p>\r\n<p>　</p>\r\n<h3>mongodb设置</h3>\r\n<p>　　【1】修改mongodb的27017端口</p>\r\n<p>　　为了提高服务器的安装，修改mongodb数据库默认的27017端口，为其他端口，如20000</p>\r\n<p>　　打开/etc/mongod.conf文件</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>sudo vi /etc/mongod.conf</pre>\r\n</div>\r\n<p>　　修改27017端口为20000</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201711/740839-20171101000153904-273774271.png\" alt=\"\"></div>\r\n<p>　　如果想让本地电脑访问mongodb服务器，则需要注释点bindIp，因为bindIp:127.0.0.1表示只允许主机访问，即只匀速服务器访问</p>\r\n<p>　　然后，重启mongod服务即可</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>sudo service mongod restart</pre>\r\n</div>\r\n<p>　　【2】创建管理员</p>\r\n<p>　　下面为mongodb创建管理员及为每一个数据库创建一个用户</p>\r\n<p>　　首先，切换到admin数据库，创建管理员</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>db.createUser({user: \"admin\",pwd: \"123456\",roles:[{role: \"root\",db: \"admin\"}]})</pre>\r\n</div>\r\n<p>　　然后，验证管理员权限</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>db.auth(\"admin\",\"123456\")</pre>\r\n</div>\r\n<p>　　接着，进入mall数据库，并为mall数据库创建一个mall用户</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>use mall;<br>db.createUser({user: \"mall\",pwd: \"123456\",roles:[{role: \"dbOwner\",db: \"mall\"}]})</pre>\r\n</div>\r\n<p>　　然后在当前mall数据库下，对创建的用户进行权限认证</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171030183455199-1315810377.png\" alt=\"\"></div>\r\n<p>　　更改mongob.conf里的内容</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\">security:\r\n    authorization: </span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">enabled</span><span style=\"color: #800000;\">'</span></pre>\r\n</div>\r\n<p>　　然后，重启mongod服务</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>sudo service mongod restart</pre>\r\n</div>\r\n<p>　　使用用户名和密码来登录mongo客户端</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>mongo 127.0.0.1:20000/mall -u mall -p 123456</pre>\r\n</div>\r\n<p>　　【3】数据备份</p>\r\n<p>　　在用户目录下，建立backup目录，进入backup目录</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\">mkdir backup\r\ncd backup</span></pre>\r\n</div>\r\n<p>　　创建一个名称为backup.sh的脚本，来对数据库进行定时备份</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>#!/bin/<span>sh\r\n\r\nbackUpFolder=/home/xxx/<span>backup\r\ndate_now=`date +%Y_%m_%d_%H%<span>M`\r\nbackFileName=<span>mall_$date_now\r\n\r\ncd $backUpFolder\r\nmkdir -<span>p $backFileName\r\n\r\nmongodump -h 127.0.0.1:20000 -d mall -u mall -p 123456 -<span>o $backFileName\r\n\r\ntar zcvf $backFileName.tar.gz $backFileName\r\n\r\nrm -rf $backFileName</span></span></span></span></span></span></pre>\r\n</div>\r\n<p>　　然后在backup目录下，执行sh backup.sh命令来执行脚本文件</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>sh backup.sh</pre>\r\n</div>\r\n<p>　　结果如下图所示</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201711/740839-20171101014310435-1975040286.png\" alt=\"\"></div>\r\n<p>　　输入date，可以查看当前系统时间</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201711/740839-20171101014339716-1578186520.png\" alt=\"\"></div>\r\n<p>　　下面来创建定时任务，输入crontab -e来开启定时任务，然后选择2</p>\r\n<p>　　[注意]一定要在root权限下设置，否则不生效</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>sudo crontab -e</pre>\r\n</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201710/740839-20171030233208418-2080323268.png\" alt=\"\"></div>\r\n<p>　　在打开的nano编辑器中输入如下命令，表示在01:46分，执行如下脚本。</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>46 01 * * * sh /home/xiaohuochai/backup/backup.sh</pre>\r\n</div>\r\n<p>　　然后，按下ctrl+X，按下shif+Y，回车，即可完成定时任务的设置</p>\r\n<p>　　由下图可知，01:46分确实生成了一个包文件</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201711/740839-20171101014636138-1039509871.png\" alt=\"\"></div>\r\n<p>　　【4】上传到七牛云 </p>\r\n<p>　　下面将备份的包文件上传到七牛云进行存储</p>\r\n<p>　　1、首先，修改backup.sh文件</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>#!/bin/<span style=\"color: #000000;\">sh\r\n\r\nbackUpFolder</span>=/home/xxx/<span style=\"color: #000000;\">backup\r\ndate_now</span>=`date +%Y_%m_%d_%H%<span style=\"color: #000000;\">M`\r\nbackFileName</span>=<span style=\"color: #000000;\">mall_$date_now\r\n\r\ncd $backUpFolder\r\nmkdir </span>-<span style=\"color: #000000;\">p $backFileName\r\n\r\nmongodump </span>-h <span style=\"color: #800080;\">127.0</span>.<span style=\"color: #800080;\">0.1</span>:<span style=\"color: #800080;\">20000</span> -d mall -u mall -p <span style=\"color: #800080;\">123456</span> -<span style=\"color: #000000;\">o $backFileName\r\n\r\ntar zcvf $backFileName.tar.gz $backFileName\r\n\r\nrm </span>-<span style=\"color: #000000;\">rf $backFileName\r\n\r\nNODE_ENV</span>=$backUpFolder@$backFileName node /home/xxx/backup/upload.js</pre>\r\n</div>\r\n<p>　　2、在backup目录下，安装七牛模块</p>\r\n<p>　　[注意]一定要本地安装，而不能全局安装</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>npm install qiniu</pre>\r\n</div>\r\n<p>　　3、在backup目录下，创建upload.js文件，内容如下</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">var</span> qiniu = require(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">qiniu</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n\r\n</span><span style=\"color: #0000ff;\">var</span> accessKey = <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">你的accesskey</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">var</span> secretKey = <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">你的secrestkey</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">var</span> mac = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> qiniu.auth.digest.Mac(accessKey, secretKey);\r\n\r\n</span><span style=\"color: #0000ff;\">var</span> bucket = <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">存储空间的名称</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">var</span> options =<span style=\"color: #000000;\"> {\r\n  scope: bucket,\r\n};\r\n</span><span style=\"color: #0000ff;\">var</span> putPolicy = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> qiniu.rs.PutPolicy(options);\r\n</span><span style=\"color: #0000ff;\">var</span> uploadToken=<span style=\"color: #000000;\">putPolicy.uploadToken(mac);\r\n\r\n\r\n</span><span style=\"color: #0000ff;\">var</span> config = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> qiniu.conf.Config();\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">不同的区域，取值不同，华东为z0</span>\r\nconfig.zone =<span style=\"color: #000000;\"> qiniu.zone.Zone_z0;\r\n\r\n</span><span style=\"color: #0000ff;\">var</span> parts = process.env.NODE_ENV.split(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">@</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">);\r\n</span><span style=\"color: #0000ff;\">var</span> key =  parts[<span style=\"color: #800080;\">1</span>] + <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">.tar.gz</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">var</span> localFile =  parts[<span style=\"color: #800080;\">0</span>] + <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">/</span><span style=\"color: #800000;\">'</span> +<span style=\"color: #000000;\"> key;\r\n\r\n</span><span style=\"color: #0000ff;\">var</span> formUploader = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> qiniu.form_up.FormUploader(config);\r\n</span><span style=\"color: #0000ff;\">var</span> putExtra = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> qiniu.form_up.PutExtra();\r\nformUploader.putFile(uploadToken, key, localFile, putExtra, function(respErr,\r\n  respBody, respInfo) {\r\n  </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (respErr) {\r\n    </span><span style=\"color: #0000ff;\">throw</span><span style=\"color: #000000;\"> respErr;\r\n  }\r\n  </span><span style=\"color: #0000ff;\">if</span> (respInfo.statusCode == <span style=\"color: #800080;\">200</span><span style=\"color: #000000;\">) {\r\n    console.log(respBody);\r\n  } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n    console.log(respInfo.statusCode);\r\n    console.log(respBody);\r\n  }\r\n});</span></pre>\r\n</div>\r\n<p>　　4、运行backup.sh文件</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>sudo sh ./backup.sh</pre>\r\n</div>\r\n<p>　　5、查看七牛云，发现备份文件已经成功上传</p>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/740839/201711/740839-20171101024055388-31223788.png\" alt=\"\"></div>\r\n<p> </p>\r\n<script type=\"text/javascript\" src=\"http://files.cnblogs.com/files/xiaohuochai/contextMenu.js\"></script>\r\n<script type=\"text/javascript\" src=\"http://files.cnblogs.com/files/xiaohuochai/catalog.js\"></script></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 14:17</span> <a href=\"http://www.cnblogs.com/xiaohuochai/\">小火柴的蓝色理想</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7749727\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7749727);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=221787,cb_entryId=7749727,cb_blogApp=currentBlogApp,cb_blogUserGuid='fff91f67-38dc-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/11/1 14:17:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 285, "image_url": ["https://pic.cnblogs.com/face/740839/20150730225601.png"], "date_pub": "2017-11-01", "article_common": 1}
{"title": "Appium python自动化测试系列之自动化截图（十一）", "url": "http://www.cnblogs.com/Mushishi_xu/p/7766969.html", "author": "Mushishi_xu", "article_desc": "11.1 截图函数的正常使用 11.1.1 截图方法 无论是在手动测试还是自动化测试中场景复现永远是一个很重要的事情，有时候一些问题可能很难复现，这个都需要测试人员对bug有很高的敏感度，在一般的情况下有一个很好的测试习惯也很重要，发现bug马上截图，不要管那么多。下面我们看一下自动化测试截图的一些 ...", "content": "<div id=\"post_detail\">\r\n\t<div class=\"post\">\r\n\t\t<h2>\r\n\t\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/Mushishi_xu/p/7766969.html\">Appium python自动化测试系列之自动化截图（十一）</a>\r\n\t\t</h2>\r\n\t\t<div id=\"cnblogs_post_body\"><h3>11.1 截图函数的正常使用</h3>\n<h4>11.1.1 截图方法</h4>\n<p>无论是在手动测试还是自动化测试中场景复现永远是一个很重要的事情，有时候一些问题可能很难复现，这个都需要测试人员对bug有很高的敏感度，在一般的情况下有一个很好的测试习惯也很重要，发现bug马上截图，不要管那么多。下面我们看一下自动化测试截图的一些方法：</p>\n<p>1、save_screenshot(). 这个方法的用户最直接driver.save_screenshot('test.png'),他直接是获取当前屏幕的截图，然后进行保存，可能会有人有疑问，这个不能指定目录吗？当然可以，只是你需要使用另外一个截图方法，如下</p>\n<p>2、get_screenshot_as_file(filename) 用法和上面的有一些差别，这个需要指定文件夹driver.get_screenshot_as_file('png/test.png')。</p>\n<p>截图方法常用的是这两个，其他的使用很少，这里不做讲解，如果有兴趣的可以去了解一下一个是以二进制，一个是以base64的形式获取。</p>\n<h3>11.2 以时间戳命名错误图片</h3>\n<h4>11.2.1 时间戳命名图片</h4>\n<p>可能看到这里的人会觉得不懂，为什么我们需要用时间戳来命名，其实这个并不是我们的最终目的，这里是在给大家传递一个思想，你想想在自动化测试中你每个方法都有可能错误，而且每次运行都是在不同的地方出错，那么你这个命名如果按照上面的写死，那么永远只有一张图片，其他的图片找不到了，这个不符合我们设计时的思考，所以我们需要用不同的方式去，显然时间戳是一个不错的选择，只要出错，我们就截图，而且还能保证每张图的名字不一样，是不是感觉很nb,哈哈，开玩笑。</p>\n<p>既然是以时间戳来进行命名，那么首先我们需要有一个获取时间戳的方法，要把它封装好，因为调用这个的地方会很多，所以要进行封装。</p>\n<p> </p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:python;gutter:true;\">import time\ndef getTime(self):\n  tamp = int(time.time())\n  return tamp\n</pre>\n</div>\n<p>　　上面的方法便是我们封装的获取时间戳的方法，我这里使用了一个返回函数，每次当我们调用的时候我们就能够获取到当前的时间戳。接下来看一下在实际中我们如何将时间戳使用到截图方法中：</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:python;gutter:true;\">import time    \n  #获取时间戳，并当作图片名字\n  def getTime(self):\n    tamp = int(time.time())\n    filename = '../jpg/ %s.png' %tamp\n    self.driver.get_screenshot_as_file(filename)\n</pre>\n</div>\n<p>　　看见上面的代码是不是很简单啊，但是不知道你们思考过一个问题没，是不是怎么看怎么觉得别扭啊？接着往下看。</p>\n<h3>11.3 截图功能的封装</h3>\n<h4>11.3.1 截图功能封装实战</h4>\n<p>上面的代码越来越别扭，哈哈，我也是那么觉得的，下面看一下截图功能在实际中的封装，其实和上面差不多，只是需要养成一个习惯，尽可能的将同一类功能封装到一个方法中，so，如下：</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:python;gutter:true;\">import time\n  #截图\n  def getScreenShot(self):\n    time = self.getTime()\n    filename = '../jpg/ %s.png' %time\n    self.driver.get_screenshot_as_file(filename)\n    \n        \n  #获取时间戳\n  def getTime(self):\n    tamp = int(time.time())\n    return tamp\n</pre>\n</div>\n<p>　　</p>\n<p>看到这个是不是稍微好一点点呢？其实这个呢只能算是入门的，那么在实际项目中我们到底是怎么进行的呢？大家下去思考一下。</p>\n<p>　　我看着上面的代码模糊，总感觉这个driver哪里来的呢？是不是又忘记了呢？还记得我们return driver了么？</p>\n<p>提示：在实际项目中我们的截图封装一般会和我们当前的case有关系，基本是按照case执行的来进行命名，那样在图片页面就能够一目了然的指导这个图片是哪个地方出错的。去动手尝试一下吧。</p>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t<p class=\"postfoot\">\r\n\t\t\tposted on <span id=\"post-date\">2017-11-01 16:04</span> <a href=\"http://www.cnblogs.com/Mushishi_xu/\">Mushishi_xu</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766969\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766969);return false;\">收藏</a>\r\n\t\t</p>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=180609,cb_entryId=7766969,cb_blogApp=currentBlogApp,cb_blogUserGuid='e3caa2f2-77b5-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/11/1 16:04:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n\t</div>", "article_view": 146, "image_url": ["https://pic.cnblogs.com/face/617745/20150922180526.png"], "date_pub": "2017-11-01", "article_common": 2}
{"title": "Quart.Net分布式任务管理平台", "url": "http://www.cnblogs.com/clly/p/7767271.html", "author": "不明白的某某某", "article_desc": "无关主题：一段时间没有更新文章了，与自己心里的坚持还是背驰，虽然这期间在公司做了统计分析，由于资源分配问题，自己或多或少的原因，确实拖得有点久了，自己这段时间也有点松懈，借口就不说那么多了，还是进入主题吧。 前言：我相信大多数人公司的业务上都有定时任务这么个功能，我们公司也不例外，刚来公司的时候使用 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/clly/p/7767271.html\">Quart.Net分布式任务管理平台</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><strong>      <span style=\"font-size: 16px;\"> 无关主题：</span></strong>一段时间没有更新文章了，与自己心里的坚持还是背驰，虽然这期间在公司做了统计分析，由于资源分配问题，自己或多或少的原因，确实拖得有点久了，自己这段时间也有点松懈，借口就不说那么多了，还是进入主题吧。</p>\r\n<hr>\r\n<p>      <span style=\"font-size: 16px;\"> </span><strong><span style=\"font-size: 16px;\">前言：</span></strong>我相信大多数人公司的业务上都有定时任务这么个功能，我们公司也不例外，刚来公司的时候使用Quartz.Net为我们组做了第一个任务，<span style=\"font-size: 16px;\"><strong>大致流程是</strong>：</span>新建一个控制台程序，引用需要的程序集，Execute方法中写着咱们需要定时的任务的业务逻辑，同样这边需要用的一些数据库操作类引用的是WebApi项目中的一些类库，然后拿着服务去服务器上部署。随着时间的推移问题和不方便性慢慢被暴露，<span style=\"font-size: 16px;\"><strong>总结一下这样的方式在我公司发生的问题</strong>：</span></p>\r\n<p>第一：随着任务量的增加，我会分配新的同事去开发这样的任务，可能由于我没有交流清楚，导致新的同事会自己下载所需的程序集，上面已经说了服务会引用WebApi中的类库会导致同样的程序集本版不匹配，同样改变Api中的一些程序集依然会出现这样的问题。</p>\r\n<p>第二：业务逻辑集成在了服务类中很多时候产品“大大”会更改逻辑由于部署的方式 那么我们需要下载服务重新编译再次部署。</p>\r\n<p>第三：任务在服务器上没有监听那么意味着服务挂了我们没有感知，案例：我们组会和其他组有着共同的任务，由于一些原因导致数据可能没有正确的相应，这个服务会去检测，客户问我昨晚的数据怎么到现在还是这样，排查后发现服务已经挂了。</p>\r\n<p>第四：我们的服务中充满了业务逻辑导致逻辑分散，同样压力交给了定时服务，那么会导致服务的运行周期和任务执行的时间会冲突。</p>\r\n<p>第五：就是可能部署的人今天请假了，导致这样的部署方式变得不在那么容易。</p>\r\n<p>那么问题出现了，看见了总不能当作没发生，开始自行研究得到今天要分享的主题，但是针对上面的问题我相信很多的解决方案，在各位园友的公司中使用了上述方式没问题也是有可能的。</p>\r\n<hr>\r\n<p>      <span style=\"font-size: 16px;\"><strong>主题：</strong>为了解决上面的问题，便捷性，做出如下“架构图”：<br></span></p>\r\n<p><span style=\"font-size: 16px;\"><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101135012123-540294496.jpg\" alt=\"\"></span></p>\r\n<p> </p>\r\n<p>对应我们的项目层次图如下：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101142040373-225067685.png\" alt=\"\"></p>\r\n<p>说一下两幅图的对应关系按顺序称一图和二图:</p>\r\n<p>一图中的<strong>Quartz服务节点</strong>对应这二图中的<strong>Quartz.Net_RemoteServer</strong>；</p>\r\n<p>一图中的<strong>任务基类</strong>对应着二图中的<strong>Quartz.Net_JobBase</strong>；</p>\r\n<p>一图中的<strong>任务子类</strong>对应着二图中的<strong>TestJob1，TestJob2</strong></p>\r\n<p>对于Mvc站点中我们使用了两层，关于分层这一说比较艺术不作过多讨论，我们项目中没有什么业务逻辑Web直接和“仓储”直接做交互，使用的是EF（ORM）；表现层我们使用BootStrap和Vue.Js完成前端工作。·</p>\r\n<p> </p>\r\n<p> </p>\r\n<p>先简单对一图作一下解释：</p>\r\n<p>第一部分：Quartz服务节点是我们任务运行的调度器，既然是分布式，我们会将调度器部署在三台服务器，Quartz默认是基于内存的既然我们要分布式 ，我们需要持久化，本版本是基于SqlServer，同时Quartz框架在数据库中用锁实现了每个任务只会被一台服务器调用，那么当某个服务器上的调度器挂掉之后，Quartz会检测发现挂了之后会使用其他服务器上的节点来接手挂掉节点中的所有任务，这个都是Quartz自身提供的。具体我们看<strong>Quartz.Net_RemoteServer类库：</strong></p>\r\n<p><strong><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101144055107-607625656.jpg\" alt=\"\"></strong></p>\r\n<p> </p>\r\n<p>Program类中我们将配置调度器这里使用代码配置：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span>   <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Program\r\n</span><span style=\"color: #008080;\"> 2</span> <span style=\"color: #000000;\">    {\r\n</span><span style=\"color: #008080;\"> 3</span>         <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> Main(<span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\">[] args)\r\n</span><span style=\"color: #008080;\"> 4</span> \r\n<span style=\"color: #008080;\"> 5</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\"> 6</span>             <span style=\"color: #0000ff;\">var</span> properties = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> NameValueCollection();\r\n</span><span style=\"color: #008080;\"> 7</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.scheduler.instanceName</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">RemoteServer</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\"> 8</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.threadPool.type</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Quartz.Simpl.SimpleThreadPool, Quartz</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\"> 9</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.threadPool.threadCount</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">5</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">10</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.threadPool.threadPriority</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Normal</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">11</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.scheduler.exporter.type</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Quartz.Simpl.RemotingSchedulerExporter, Quartz</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">12</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.scheduler.exporter.port</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">555</span><span style=\"color: #800000;\">\"</span>;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">端口号</span>\r\n<span style=\"color: #008080;\">13</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.scheduler.exporter.bindName</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">QuartzScheduler</span><span style=\"color: #800000;\">\"</span>;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">名称</span>\r\n<span style=\"color: #008080;\">14</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.scheduler.exporter.channelType</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">tcp</span><span style=\"color: #800000;\">\"</span>;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">通道名</span>\r\n<span style=\"color: #008080;\">15</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.scheduler.exporter.channelName</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">httpQuartz</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">16</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.scheduler.exporter.rejectRemoteRequests</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">true</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">17</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.jobStore.clustered</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">true</span><span style=\"color: #800000;\">\"</span>;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">集群配置\r\n</span><span style=\"color: #008080;\">18</span>             <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">下面为指定quartz持久化数据库的配置</span>\r\n<span style=\"color: #008080;\">19</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.jobStore.type</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Quartz.Impl.AdoJobStore.JobStoreTX, Quartz</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">20</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.jobStore.tablePrefix</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">QRTZ_</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">21</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.jobStore.driverDelegateType</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Quartz.Impl.AdoJobStore.SqlServerDelegate, Quartz</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">22</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.jobStore.dataSource</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">myDS</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">23</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.dataSource.myDS.connectionString</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">@\"</span><span style=\"color: #800000;\">Data Source=.;Initial Catalog=QuartzManager;User ID=sa;Password=123456</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">24</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.dataSource.myDS.provider</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">SqlServer-20</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">25</span>             properties[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">quartz.scheduler.instanceId</span><span style=\"color: #800000;\">\"</span>] = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">AUTO</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">26</span>             <span style=\"color: #0000ff;\">var</span> schedulerFactory = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> StdSchedulerFactory(properties);\r\n</span><span style=\"color: #008080;\">27</span>             <span style=\"color: #0000ff;\">var</span> scheduler =<span style=\"color: #000000;\"> schedulerFactory.GetScheduler();\r\n</span><span style=\"color: #008080;\">28</span>             scheduler.ListenerManager.AddJobListener(<span style=\"color: #0000ff;\">new</span> MyJobListener(), GroupMatcher&lt;JobKey&gt;<span style=\"color: #000000;\">.AnyGroup());\r\n</span><span style=\"color: #008080;\">29</span> <span style=\"color: #000000;\">            scheduler.Start();\r\n</span><span style=\"color: #008080;\">30</span> \r\n<span style=\"color: #008080;\">31</span> <span style=\"color: #000000;\">        }\r\n</span><span style=\"color: #008080;\">32</span>     }</pre>\r\n</div>\r\n<p>这是Quartz代码配置，很多项感兴趣的大家可以自行搜索一下意思；这边注释了客户端将要用的信息，同时我们增加监听器来监听运行服务的状况，Quartz提供了三种监听<strong>IJobListener，ITriggerListener，ISchedulerListener，和相应的实现类JobListenerSupport，TriggerListenerSupport，SchedulerListenerSupport，</strong>在这里我们使用的job的监听器同时我们继承实现类就好了，因为很多很方法不需要。</p>\r\n<p>我们会在任务完成时向数据库中写入此任务当前状态，或者异常信息</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span>                 jobId = Convert.ToInt32(context.JobDetail.JobDataMap[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jobId</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">]);\r\n</span><span style=\"color: #008080;\"> 2</span>                 name =<span style=\"color: #000000;\"> context.Scheduler.GetTriggerState(context.Trigger.Key).ToString();\r\n</span><span style=\"color: #008080;\"> 3</span>                 triggerState =<span style=\"color: #000000;\"> _changeType(context.Scheduler.GetTriggerState(context.Trigger.Key));\r\n</span><span style=\"color: #008080;\"> 4</span>                 customerJobInfoModel = _customerJobInfoRepository.LoadCustomerInfo(x =&gt; x.Id ==<span style=\"color: #000000;\"> jobId);\r\n</span><span style=\"color: #008080;\"> 5</span>                 customerJobInfoModel.TriggerState =<span style=\"color: #000000;\"> triggerState;\r\n</span><span style=\"color: #008080;\"> 6</span>                 <span style=\"color: #0000ff;\">if</span> (jobException == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n</span><span style=\"color: #008080;\"> 7</span> <span style=\"color: #000000;\">                {\r\n</span><span style=\"color: #008080;\"> 8</span> \r\n<span style=\"color: #008080;\"> 9</span> \r\n<span style=\"color: #008080;\">10</span>                     Console.WriteLine(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">任务编号{0}；执行时间：{1},状态：{2}</span><span style=\"color: #800000;\">\"</span>, context.JobDetail.JobDataMap[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jobId</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">], DateTime.Now, name);\r\n</span><span style=\"color: #008080;\">11</span> <span style=\"color: #000000;\">                }\r\n</span><span style=\"color: #008080;\">12</span>                 <span style=\"color: #0000ff;\">else</span>\r\n<span style=\"color: #008080;\">13</span> <span style=\"color: #000000;\">                {\r\n</span><span style=\"color: #008080;\">14</span>                     customerJobInfoModel.Exception =<span style=\"color: #000000;\"> jobException.Message;\r\n</span><span style=\"color: #008080;\">15</span>                     Console.WriteLine(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jobId{0}执行失败：{1}</span><span style=\"color: #800000;\">\"</span>, context.JobDetail.JobDataMap[<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jobId</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">], jobException.Message);\r\n</span><span style=\"color: #008080;\">16</span> <span style=\"color: #000000;\">                }\r\n</span><span style=\"color: #008080;\">17</span>                 _customerJobInfoRepository.UpdateCustomerJobInfo(customerJobInfoModel);</pre>\r\n</div>\r\n<p> </p>\r\n<p>第二部分：要想实现任务执行我们得实现Quartz提供得Excute方法，也就是咱们的具体任务类，任务基类的设计来目的是：首先它是个抽象类，我们的任务基类会引用所需程序集并实现Excute方法，并提供子类必须要实现的方法，这样我们具体开发任务的时候继承我们的基类实现基类中的方法 而我们任务子类除了引用了基类不会在引用其他第三方程序集。继续看<strong>Quartz.Net_RemoteServer类库：</strong></p>\r\n<p><strong><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101150040060-1040502664.jpg\" alt=\"\"></strong></p>\r\n<p> </p>\r\n<p>在这里就像看到一样我们将需要的程序集在基类中引用包括Quartz.dll,日志等，BaseJob封装了任务执行所必要的方法，和子类必须实现的方法：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span>   <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">abstract</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> JobBase : IJob\r\n</span><span style=\"color: #008080;\"> 2</span> <span style=\"color: #000000;\">    {\r\n</span><span style=\"color: #008080;\"> 3</span>         <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">string</span> RequestUrl { <span style=\"color: #0000ff;\">get</span>; <span style=\"color: #0000ff;\">set</span><span style=\"color: #000000;\">; }\r\n</span><span style=\"color: #008080;\"> 4</span>         <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> JobBase()\r\n</span><span style=\"color: #008080;\"> 5</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\"> 6</span> <span style=\"color: #000000;\">            SetRequestUrl();\r\n</span><span style=\"color: #008080;\"> 7</span> <span style=\"color: #000000;\">        }\r\n</span><span style=\"color: #008080;\"> 8</span>         <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">virtual</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Execute(IJobExecutionContext context)\r\n</span><span style=\"color: #008080;\"> 9</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\">10</span>             <span style=\"color: #0000ff;\">try</span>\r\n<span style=\"color: #008080;\">11</span> <span style=\"color: #000000;\">            {\r\n</span><span style=\"color: #008080;\">12</span>                 HttpClient hc = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> HttpClient();\r\n</span><span style=\"color: #008080;\">13</span> <span style=\"color: #000000;\">                hc.GetAsync(RequestUrl);\r\n</span><span style=\"color: #008080;\">14</span> <span style=\"color: #000000;\">            }\r\n</span><span style=\"color: #008080;\">15</span>             <span style=\"color: #0000ff;\">catch</span><span style=\"color: #000000;\"> (Exception ex)\r\n</span><span style=\"color: #008080;\">16</span> <span style=\"color: #000000;\">            {\r\n</span><span style=\"color: #008080;\">17</span>                 <span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Exception(ex.ToString());\r\n</span><span style=\"color: #008080;\">18</span> <span style=\"color: #000000;\">            }\r\n</span><span style=\"color: #008080;\">19</span> <span style=\"color: #000000;\">        }\r\n</span><span style=\"color: #008080;\">20</span>         <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">abstract</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> SetRequestUrl();\r\n</span><span style=\"color: #008080;\">21</span>     }</pre>\r\n</div>\r\n<p>同时可以看到我们的执行的任务本质上就是调用了Api中实现业务的接口，至此我们将业务逻辑和和部分压力点转移到Api中是我们任务做的东西和职责很明确：根据运行周期来执行一个业务，业务本身并不属于自己的功能点，接下来我们在看看具体子类，上面的这些东西在我这边完成后，想加任务的同事只需要编写任务子类就可以在通过管理界面操作，<strong>子类的代码如下：</strong></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span> <span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> Quartz.Net_JobItem;\r\n</span><span style=\"color: #008080;\"> 2</span> <span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System;\r\n</span><span style=\"color: #008080;\"> 3</span> <span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Collections.Generic;\r\n</span><span style=\"color: #008080;\"> 4</span> <span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Linq;\r\n</span><span style=\"color: #008080;\"> 5</span> <span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Text;\r\n</span><span style=\"color: #008080;\"> 6</span> <span style=\"color: #0000ff;\">using</span><span style=\"color: #000000;\"> System.Threading.Tasks;\r\n</span><span style=\"color: #008080;\"> 7</span> \r\n<span style=\"color: #008080;\"> 8</span> <span style=\"color: #0000ff;\">namespace</span><span style=\"color: #000000;\"> TestJob1\r\n</span><span style=\"color: #008080;\"> 9</span> <span style=\"color: #000000;\">{\r\n</span><span style=\"color: #008080;\">10</span>     <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Job1:JobBase\r\n</span><span style=\"color: #008080;\">11</span> <span style=\"color: #000000;\">    {\r\n</span><span style=\"color: #008080;\">12</span>         <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> Job1() {\r\n</span><span style=\"color: #008080;\">13</span> <span style=\"color: #000000;\">            SetRequestUrl();\r\n</span><span style=\"color: #008080;\">14</span> <span style=\"color: #000000;\">        }\r\n</span><span style=\"color: #008080;\">15</span>         <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">override</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> SetRequestUrl()\r\n</span><span style=\"color: #008080;\">16</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\">17</span>             <span style=\"color: #0000ff;\">base</span>.RequestUrl = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">http://localhost:53582/QuartzJobManage/Test</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">18</span> <span style=\"color: #000000;\">        }\r\n</span><span style=\"color: #008080;\">19</span> <span style=\"color: #000000;\">    }\r\n</span><span style=\"color: #008080;\">20</span> }</pre>\r\n</div>\r\n<p>可以看到已经简单的动动小手指就可以了，轻松完成，同时咱们可以看到我们除了引用了基类没有引用其他第三方的框架，来避免上面的问题出现。<strong>基类在编译dll已经放入了Quartz的服务节点和Web站点中。子类我们同样需要放入着两个类库中，方便Quartz服务节点可以找到要执行的任务，和Web站点做反射需要</strong></p>\r\n<p>第三部分：Mvc站点将提供可视化的管理界面。首先看一下界面的模样：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101152151123-482437009.jpg\" alt=\"\"></p>\r\n<p>导航栏是Quartz任务所有的状态，列表是我们任务的具体信息，在一图中中我们将在任务可视化界面中提供：添加任务，运行任务，修改任务运行周期，暂停任务，恢复任务，删除任务操作，也是目前我们需要在公司上线的第一个版本所有功能点。每个状态下的任务能使用的功能会有所不一样，接下来将逐一展示以上提到的功能点实现：</p>\r\n<p>1：添加功能：我们需要将Quartz需要的任务的和我们需要的信息存入到我们自己的表中，以便运行任务的时候从表中取出任务信息提供Quartz。</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101153711966-2047536063.jpg\" alt=\"\"></p>\r\n<p>添加任务的界面，我们需要给出这样的信息以及咱们自己编写的任务子类的dll，我们在这会将dll保存到Quartz服务节点和Web站点中。任务类全名是命名空间加上子类的名字。其他都是Quartz文档上都是会介绍的。程序集名称和上传的文件匹配。具体代码如下：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span> <span style=\"color: #000000;\">   [HttpPost]\r\n</span><span style=\"color: #008080;\"> 2</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n<span style=\"color: #008080;\"> 3</span>         <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 添加任务\r\n</span><span style=\"color: #008080;\"> 4</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n<span style=\"color: #008080;\"> 5</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobName\"&gt;</span><span style=\"color: #008000;\">任务名称</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 6</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobGroupName\"&gt;</span><span style=\"color: #008000;\">任务所在组名称</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 7</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"triggerName\"&gt;</span><span style=\"color: #008000;\">触发器名称</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 8</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"triggerGroupName\"&gt;</span><span style=\"color: #008000;\">触发器所在的组名称</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 9</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"cron\"&gt;</span><span style=\"color: #008000;\">执行周期表达式</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\">10</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"dllName\"&gt;</span><span style=\"color: #008000;\">任务程序集名称（xxxx.dll）</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\">11</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"fullJobName\"&gt;</span><span style=\"color: #008000;\">任务类全名</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\">12</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobDescription\"&gt;</span><span style=\"color: #008000;\">任务描述</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\">13</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobstartTime\"&gt;</span><span style=\"color: #008000;\">开始时间</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\">14</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;returns&gt;&lt;/returns&gt;</span>\r\n<span style=\"color: #008080;\">15</span> \r\n<span style=\"color: #008080;\">16</span>         <span style=\"color: #0000ff;\">public</span> JsonResult AddJob(<span style=\"color: #0000ff;\">string</span> jobName, <span style=\"color: #0000ff;\">string</span> jobGroupName, <span style=\"color: #0000ff;\">string</span> triggerName, <span style=\"color: #0000ff;\">string</span> triggerGroupName, <span style=\"color: #0000ff;\">string</span> cron, <span style=\"color: #0000ff;\">string</span> dllName, <span style=\"color: #0000ff;\">string</span> fullJobName, <span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\"> jobDescription, DateTime jobStartTime)\r\n</span><span style=\"color: #008080;\">17</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\">18</span>             HttpPostedFileBase dllFile = Request.Files[<span style=\"color: #800080;\">0</span>] <span style=\"color: #0000ff;\">as</span><span style=\"color: #000000;\"> HttpPostedFileBase;\r\n</span><span style=\"color: #008080;\">19</span>             <span style=\"color: #0000ff;\">if</span> (dllFile == <span style=\"color: #0000ff;\">null</span> || dllFile.ContentLength &lt;= <span style=\"color: #800080;\">0</span><span style=\"color: #000000;\">)\r\n</span><span style=\"color: #008080;\">20</span> <span style=\"color: #000000;\">            {\r\n</span><span style=\"color: #008080;\">21</span>                 <span style=\"color: #0000ff;\">return</span> Json(ResponseDataFactory.CreateAjaxResponseData(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">-10003</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">无任务文件</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">));\r\n</span><span style=\"color: #008080;\">22</span> <span style=\"color: #000000;\">            }\r\n</span><span style=\"color: #008080;\">23</span> <span style=\"color: #000000;\">            _savePathInWeb(dllFile);\r\n</span><span style=\"color: #008080;\">24</span>             <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">TODO:添加到数据库自己的表</span>\r\n<span style=\"color: #008080;\">25</span>             <span style=\"color: #0000ff;\">var</span> jobId =<span style=\"color: #000000;\"> _customerJobInfoRepository.AddCustomerJobInfo(jobName, jobGroupName, triggerName, triggerGroupName, cron, dllName, fullJobName, jobDescription, jobStartTime);\r\n</span><span style=\"color: #008080;\">26</span> <span style=\"color: #000000;\">            _savePathInRemoteServer(dllFile);\r\n</span><span style=\"color: #008080;\">27</span>             <span style=\"color: #0000ff;\">return</span> Json(ResponseDataFactory.CreateAjaxResponseData(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">1</span><span style=\"color: #800000;\">\"</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">添加成功</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, jobId));\r\n</span><span style=\"color: #008080;\">28</span> \r\n<span style=\"color: #008080;\">29</span>         }</pre>\r\n</div>\r\n<p>添加完之后界面会变成如下这样：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101155139435-1445984741.jpg\" alt=\"\"></p>\r\n<p>可以看到这个任务可以执行运行和删除，运行周期是10秒钟执行一次。下面接着点击运行让这个任务跑起来：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101155422404-1492363061.jpg\" alt=\"\"></p>\r\n<p>这样这个任务就以咱们设置的运行周期运行起来，同时运行的任务提供了暂停，删除，更改运行周期操作：先看任务的运行效果，Quartz服务节点钟我们使用监听器对服务的监听同时输出了一些信息：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101155643498-1130750523.jpg\" alt=\"\"></p>\r\n<p>同时运行任务执行背后的执行逻辑为：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span> <span style=\"color: #000000;\">  [HttpPost]\r\n</span><span style=\"color: #008080;\"> 2</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n<span style=\"color: #008080;\"> 3</span>         <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 启动任务\r\n</span><span style=\"color: #008080;\"> 4</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n<span style=\"color: #008080;\"> 5</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobId\"&gt;</span><span style=\"color: #008000;\">任务编号</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 6</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;returns&gt;&lt;/returns&gt;</span>\r\n<span style=\"color: #008080;\"> 7</span>         <span style=\"color: #0000ff;\">public</span> JsonResult RunJob(<span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> jobId)\r\n</span><span style=\"color: #008080;\"> 8</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\"> 9</span>             <span style=\"color: #0000ff;\">var</span> ajaxResponseData = _operateJob(jobId, (jobDetail) =&gt; { jobDetail.TriggerState = <span style=\"color: #800080;\">0</span>; _customerJobInfoRepository.UpdateCustomerJobInfo(jobDetail); <span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> _jobHelper.RunJob(jobDetail); });\r\n</span><span style=\"color: #008080;\">10</span>             <span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> Json(ajaxResponseData);\r\n</span><span style=\"color: #008080;\">11</span>         }</pre>\r\n</div>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n<span style=\"color: #008080;\"> 2</span>         <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 运行任务\r\n</span><span style=\"color: #008080;\"> 3</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n<span style=\"color: #008080;\"> 4</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobInfo\"&gt;</span><span style=\"color: #008000;\">任务信息</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 5</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;returns&gt;&lt;/returns&gt;</span>\r\n<span style=\"color: #008080;\"> 6</span>         <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">bool</span><span style=\"color: #000000;\"> RunJob(Customer_JobInfo jobInfo)\r\n</span><span style=\"color: #008080;\"> 7</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\"> 8</span>             Assembly assembly = Assembly.LoadFile(AppDomain.CurrentDomain.BaseDirectory + $<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">bin/{jobInfo.DLLName}</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n</span><span style=\"color: #008080;\"> 9</span>             <span style=\"color: #0000ff;\">var</span> type =<span style=\"color: #000000;\"> assembly.GetType(jobInfo.FullJobName);\r\n</span><span style=\"color: #008080;\">10</span>             JobKey jobKey =<span style=\"color: #000000;\"> _createJobKey(jobInfo.JobName, jobInfo.JobGroupName);\r\n</span><span style=\"color: #008080;\">11</span>             <span style=\"color: #0000ff;\">if</span> (!<span style=\"color: #000000;\">_scheduler.CheckExists(jobKey))\r\n</span><span style=\"color: #008080;\">12</span> <span style=\"color: #000000;\">            {\r\n</span><span style=\"color: #008080;\">13</span>                 IJobDetail job =<span style=\"color: #000000;\"> JobBuilder.Create(type)\r\n</span><span style=\"color: #008080;\">14</span> <span style=\"color: #000000;\">                    .WithIdentity(jobKey)\r\n</span><span style=\"color: #008080;\">15</span>                     .UsingJobData(_createJobDataMap(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">jobId</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, jobInfo.Id))\r\n</span><span style=\"color: #008080;\">16</span> <span style=\"color: #000000;\">                    .Build();\r\n</span><span style=\"color: #008080;\">17</span> \r\n<span style=\"color: #008080;\">18</span>                 CronScheduleBuilder scheduleBuilder =<span style=\"color: #000000;\"> CronScheduleBuilder.CronSchedule(jobInfo.Cron);\r\n</span><span style=\"color: #008080;\">19</span>                 ITrigger trigger = TriggerBuilder.Create().StartNow()<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">StartAt(DateTime.SpecifyKind(jobInfo.JobStartTime, DateTimeKind.Local))</span>\r\n<span style=\"color: #008080;\">20</span> <span style=\"color: #000000;\">                    .WithIdentity(jobInfo.TriggerName, jobInfo.TriggerGroupName)\r\n</span><span style=\"color: #008080;\">21</span> <span style=\"color: #000000;\">                    .ForJob(jobKey)\r\n</span><span style=\"color: #008080;\">22</span> <span style=\"color: #000000;\">                    .WithSchedule(scheduleBuilder.WithMisfireHandlingInstructionFireAndProceed())\r\n</span><span style=\"color: #008080;\">23</span> <span style=\"color: #000000;\">                    .Build();\r\n</span><span style=\"color: #008080;\">24</span>           \r\n<span style=\"color: #008080;\">25</span> \r\n<span style=\"color: #008080;\">26</span> <span style=\"color: #000000;\">                _scheduler.ScheduleJob(job, trigger);\r\n</span><span style=\"color: #008080;\">27</span> \r\n<span style=\"color: #008080;\">28</span> <span style=\"color: #000000;\">            }\r\n</span><span style=\"color: #008080;\">29</span>             <span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">30</span>         }</pre>\r\n</div>\r\n<p>这里就用了到了我们第一步添加任务时上传的dll和任务类的全名 我们通过加载程序集通过全名找到我们需要执行的任务类，同时假如额外信息，JobId，以便监听器可以使用id更新自己的表。同样我们可以更改运行周期来调节任务调度的频次：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101161147591-1546497294.jpg\" alt=\"\"></p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101161320091-45323651.jpg\" alt=\"\"></p>\r\n<p>那么在更改运行周期之后我们需要重新构建触发器</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span>   <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n<span style=\"color: #008080;\"> 2</span>         <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 更改任务运行周期\r\n</span><span style=\"color: #008080;\"> 3</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n<span style=\"color: #008080;\"> 4</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"jobInfo\"&gt;</span><span style=\"color: #008000;\">任务信息</span><span style=\"color: #808080;\">&lt;/param&gt;</span>\r\n<span style=\"color: #008080;\"> 5</span>         <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;returns&gt;&lt;/returns&gt;</span>\r\n<span style=\"color: #008080;\"> 6</span>         <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">bool</span><span style=\"color: #000000;\"> ModifyJobCron(Customer_JobInfo jobInfo)\r\n</span><span style=\"color: #008080;\"> 7</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\"> 8</span>             CronScheduleBuilder scheduleBuilder =<span style=\"color: #000000;\"> CronScheduleBuilder.CronSchedule(jobInfo.Cron);\r\n</span><span style=\"color: #008080;\"> 9</span>             <span style=\"color: #0000ff;\">var</span> triggerKey =<span style=\"color: #000000;\"> _createTriggerKey(jobInfo.TriggerName, jobInfo.TriggerGroupName);\r\n</span><span style=\"color: #008080;\">10</span>             ITrigger trigger =<span style=\"color: #000000;\"> TriggerBuilder.Create().StartAt(DateTime.SpecifyKind(jobInfo.JobStartTime, DateTimeKind.Local))\r\n</span><span style=\"color: #008080;\">11</span> <span style=\"color: #000000;\">                    .WithIdentity(jobInfo.TriggerName, jobInfo.TriggerGroupName)\r\n</span><span style=\"color: #008080;\">12</span> <span style=\"color: #000000;\">                   .WithSchedule(scheduleBuilder.WithMisfireHandlingInstructionDoNothing())\r\n</span><span style=\"color: #008080;\">13</span> <span style=\"color: #000000;\">                    .Build();\r\n</span><span style=\"color: #008080;\">14</span> <span style=\"color: #000000;\">            _scheduler.RescheduleJob(triggerKey, trigger);\r\n</span><span style=\"color: #008080;\">15</span>             <span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">16</span>         }</pre>\r\n</div>\r\n<p>这个点是需要注意的！！！</p>\r\n<p>接下来我们使用暂停功能：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101160640482-1329371971.jpg\" alt=\"\"></p>\r\n<p>暂停列表中我们对此任务可进行恢复和删除操作，那么恢复操作就是恢复任务运行，删除就是从调度器中删除这个任务同时我们将自己的表中标记删除。</p>\r\n<p>到现在我们的整体流程就已经走了，但是最终我们的主题是分布式，当然这个已经能满足一部分需求了，所以接下来由于环境有限我这边会启动两个服务节点能模拟多个服务器然后我们关闭掉一个服务节点看另一个是否能拿到任务进行，启动任务后我们可以看到：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101162246466-1190065499.jpg\" alt=\"\"></p>\r\n<p>当我们关闭刚才正在调度此任务的调度器之后看看另一个调度器的结果：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/674112/201711/674112-20171101162509185-1054117005.jpg\" alt=\"\"></p>\r\n<p>可以看到 另一个调度器执行刚才那个任务，原理是 我们在服务端设置了检查时间每个调度器会以这个时间去数据库钟检测另外的节点是否正常，当挂掉后会从数据库钟取出任务信息再次调度。至此我们的分布式调度平台就大致分享完了。由于是第一版，所以很多地方还不合理或者需要改进会在之后的时间磨合中不断去完善。</p>\r\n<p>最后定时框架有很多，大家要的是 第一符合自己的业务，第二自己能熟悉掌控的去选择技术。</p>\r\n<hr>\r\n<p> </p>\r\n<p><span style=\"font-size: 18px;\"><strong>     题外：</strong><span style=\"font-size: 16px;\">分享一些在这次主题钟关于代码这一块的东西，当然对于大牛来说这都是小儿科了，大家可以看到这个项目代码量并不是很大，没有什么业务逻辑，层次也很简单。</span></span></p>\r\n<p><span style=\"font-size: 16px;\">1：因为没有什么业务逻辑的处理，我们不需要很多逻辑层，所以大家对分层这块一定要具体情况具体对待。</span></p>\r\n<p><span style=\"font-size: 16px;\">2：面向抽象编程基本的东西我们还是要去遵守，即使像这个简单的层次的项目，我项目中使用的MEF进行依赖注入的</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span> <span style=\"color: #000000;\">    [Export]\r\n</span><span style=\"color: #008080;\"> 2</span>     <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> QuartzJobManageController : Controller\r\n</span><span style=\"color: #008080;\"> 3</span> <span style=\"color: #000000;\">    {\r\n</span><span style=\"color: #008080;\"> 4</span> \r\n<span style=\"color: #008080;\"> 5</span>         [Import(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">CustomerJobInfoRepository</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">)]\r\n</span><span style=\"color: #008080;\"> 6</span>         <span style=\"color: #0000ff;\">public</span> ICustomerJobInfoRepository _customerJobInfoRepository { <span style=\"color: #0000ff;\">get</span>; <span style=\"color: #0000ff;\">set</span><span style=\"color: #000000;\">; }\r\n</span><span style=\"color: #008080;\"> 7</span>         [Import(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">JobHelper</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">)]\r\n</span><span style=\"color: #008080;\"> 8</span>         <span style=\"color: #0000ff;\">private</span> JobHelper _jobHelper { <span style=\"color: #0000ff;\">get</span>; <span style=\"color: #0000ff;\">set</span><span style=\"color: #000000;\">; }\r\n</span><span style=\"color: #008080;\"> 9</span>         <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> QuartzJobManageController()\r\n</span><span style=\"color: #008080;\">10</span> <span style=\"color: #000000;\">        {\r\n</span><span style=\"color: #008080;\">11</span> <span style=\"color: #000000;\">        }\r\n</span><span style=\"color: #008080;\">12</span> }</pre>\r\n</div>\r\n<div class=\"cnblogs_code\">\r\n<pre>   [Export(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">CustomerJobInfoRepository</span><span style=\"color: #800000;\">\"</span>,<span style=\"color: #0000ff;\">typeof</span><span style=\"color: #000000;\">(ICustomerJobInfoRepository))]\r\n    </span><span style=\"color: #0000ff;\">internal</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> CustomerJobInfoRepository : ICustomerJobInfoRepository\r\n    {\r\n        </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">readonly</span><span style=\"color: #000000;\"> QuartzManagerEntities _dbContext;\r\n        </span><span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> CustomerJobInfoRepository()\r\n        {\r\n            _dbContext </span>=<span style=\"color: #000000;\"> DbContextFactory.DbContext;\r\n        }\r\n}</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 16px;\">同时可以看到我们实现类钟的访问级别，很多时候 上层依然可以看到具体的实现，接口形同虚设，包括上面所提到的任务基类和任务子类，一方面解决了我们程序集不同人可能引入不同版本，本质上还是抽象使依赖降到最低</span></p>\r\n<p><span style=\"font-size: 16px;\">3：同时一些工厂的使用，大家可以看看设计原则和设计模式</span></p>\r\n<p><span style=\"font-size: 16px;\">给大家一下参考文章：<a title=\"参考文章\" href=\"http://www.cnblogs.com/aflyun/p/6515813.html\" target=\"_blank\">http://www.cnblogs.com/aflyun/p/6515813.html</a></span></p>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 16:51</span> <a href=\"http://www.cnblogs.com/clly/\">不明白的某某某</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7767271\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7767271);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=198644,cb_entryId=7767271,cb_blogApp=currentBlogApp,cb_blogUserGuid='7dc3324a-a93f-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/11/1 16:51:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 972, "image_url": ["https://pic.cnblogs.com/face/674112/20160114143847.png"], "date_pub": "2017-11-01", "article_common": 12}
{"title": "Machine-learning of  Andrew Ng", "url": "http://www.cnblogs.com/jasonhaven/p/7765998.html", "author": "Jasonhaven.D", "article_desc": "Machine-learning of  Andrew Ng(Stanford University) ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/jasonhaven/p/7765998.html\">Machine-learning of  Andrew Ng</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h3><span style=\"font-size: 16px;\">1.基础概念       </span></h3>\r\n<p><span style=\"font-size: 16px;\">       机器学习是一门研究在非特定编程条件下让计算机采取行动的学科。最近二十年，机器学习为我们带来了自动驾驶汽车、实用的语音识别、高效的网络搜索，让我们对人类基因的解读能力大大提高。当今机器学习技术已经非常普遍，您很可能在毫无察觉情况下每天使用几十次。许多研究者还认为机器学习是人工智能（AI）取得进展的最有效途径。在本课程中，您将学习最高效的机器学习技术，了解如何使用这些技术，并自己动手实践这些技术。更重要的是，您将不仅将学习理论知识，还将学习如何实践，如何快速使用强大的技术来解决新问题。最后，您将了解在硅谷企业如何在机器学习和AI领域进行创新。</span></p>\r\n<p><span style=\"font-size: 16px;\">        机器学习的基础是数学。数学并非是一个可选可不选的理论方法，而是不可或缺的支柱。如果你是一名计算机工程师，每天使用 UML、ORM、设计模式及其他软件工程工具／技术，那么请闭眼一秒钟，忘掉一切。这并不是说这些概念不重要，绝不是！但是机器学习需要一种不同的方法。如今 Python 如此流行的原因之一是其「原型设计速度」。在机器学习中，一种使用几行代码即可建模算法的语言绝对是必要的。</span></p>\r\n<p><span style=\"font-size: 16px;\">        微积分、线性代数、概率论在机器学习几乎所有算法中不可或缺。如果你的数学背景很扎实，请跳过这一章节。如若不然，那么重新温习一下这些重要概念也不错。考虑到理论的数量，我并不建议大家从大部头开始。尽管一开始可以用它查询具体概念，但是初学者先关注简单的话题比较好。网上有很多好的在线资源（比如 Coursera、可汗学院或优达学城），实用且适合各种背景的人群。但是我建议从提纲之类的简明书籍上手，其中所有核心概念均被涉及，次要概念可在需要的时候自行查询。这种方法虽然不够系统，但却避免了这样的缺陷：大量晦涩概念使得没有扎实理论背景的人望而却步。</span></p>\r\n<p><span style=\"font-size: 16px;\">Recommend  for new：  <a href=\"https://www.coursera.org/learn/machine-learning\" target=\"_blank\">https://www.coursera.org/learn/machine-learning</a></span></p>\r\n<p> </p>\r\n<h2><span style=\"font-size: 16px;\">2.学习</span><span style=\"font-size: 16px;\">小结(ing)</span></h2>\r\n<p style=\"margin-left: 30px;\"><span style=\"font-size: 16px;\">1.<a id=\"CategoryEntryList1_EntryStoryList_ctl00_Entries_TitleUrl_3\" class=\"entrylistItemTitle\" href=\"http://www.cnblogs.com/jasonhaven/p/7762349.html\">What is Machine Learning?</a></span></p>\r\n<p style=\"margin-left: 30px;\"><span style=\"font-size: 16px;\">2.<a id=\"CategoryEntryList1_EntryStoryList_ctl00_Entries_TitleUrl_2\" class=\"entrylistItemTitle\" href=\"http://www.cnblogs.com/jasonhaven/p/7764032.html\">Supervised Learning and Unsupervised Learning</a></span></p>\r\n<p style=\"margin-left: 30px;\"><span style=\"font-size: 16px;\">3.<a id=\"CategoryEntryList1_EntryStoryList_ctl00_Entries_TitleUrl_1\" class=\"entrylistItemTitle\" href=\"http://www.cnblogs.com/jasonhaven/p/7764410.html\">Model Representation and Cost Function</a></span></p>\r\n<p style=\"margin-left: 30px;\"><span style=\"font-size: 16px;\">4.<a id=\"CategoryEntryList1_EntryStoryList_ctl00_Entries_TitleUrl_0\" class=\"entrylistItemTitle\" href=\"http://www.cnblogs.com/jasonhaven/p/7765789.html\">Matrices and Vectors</a></span></p>\r\n<h2> </h2>\r\n<h2><span style=\"font-size: 16px;\">3.应用场景</span></h2>\r\n<p> </p>\r\n<p style=\"margin-left: 30px; text-align: center;\"><img class=\"aligncenter\" src=\"http://images.cnitblog.com/blog/673793/201412/221213379524716.png\" alt=\"\" width=\"473\" height=\"271\"></p>\r\n<p style=\"margin-left: 30px;\"><strong><span style=\"font-size: 15px;\">模式识别</span></strong><br><span style=\"font-size: 15px;\">模式识别=机器学习。两者的主要区别在于前者是从工业界发展起来的概念，后者则主要源自计算机学科。在著名的《Pattern Recognition And Machine Learning》这本书中，Christopher M. Bishop在开头是这样说的“模式识别源自工业界，而机器学习来自于计算机学科。不过，它们中的活动可以被视为同一个领域的两个方面，同时在过去的10年间，它们都有了长足的发展”。</span></p>\r\n<p style=\"margin-left: 30px;\"><strong><span style=\"font-size: 15px;\">数据挖掘</span></strong><br><span style=\"font-size: 15px;\">数据挖掘=机器学习+数据库。这几年数据挖掘的概念实在是太耳熟能详。几乎等同于炒作。但凡说数据挖掘都会吹嘘数据挖掘如何如何，例如从数据中挖出金子，以及将废弃的数据转化为价值等等。但是，我尽管可能会挖出金子，但我也可能挖的是“石头”啊。这个说法的意思是，数据挖掘仅仅是一种思考方式，告诉我们应该尝试从数据中挖掘出知识，但不是每个数据都能挖掘出金子的，所以不要神话它。一个系统绝对不会因为上了一个数据挖掘模块就变得无所不能(这是IBM最喜欢吹嘘的)，恰恰相反，一个拥有数据挖掘思维的人员才是关键，而且他还必须对数据有深刻的认识，这样才可能从数据中导出模式指引业务的改善。大部分数据挖掘中的算法是机器学习的算法在数据库中的优化。</span></p>\r\n<p style=\"margin-left: 30px;\"><strong><span style=\"font-size: 15px;\">统计学习</span></strong><br><span style=\"font-size: 15px;\">统计学习近似等于机器学习。统计学习是个与机器学习高度重叠的学科。因为机器学习中的大多数方法来自统计学，甚至可以认为，统计学的发展促进机器学习的繁荣昌盛。例如著名的支持向量机算法，就是源自统计学科。但是在某种程度上两者是有分别的，这个分别在于：统计学习者重点关注的是统计模型的发展与优化，偏数学，而机器学习者更关注的是能够解决问题，偏实践，因此机器学习研究者会重点研究学习算法在计算机上执行的效率与准确性的提升。</span></p>\r\n<p style=\"margin-left: 30px;\"><strong><span style=\"font-size: 15px;\">计算机视觉</span></strong><br><span style=\"font-size: 15px;\">计算机视觉=图像处理+机器学习。图像处理技术用于将图像处理为适合进入机器学习模型中的输入，机器学习则负责从图像中识别出相关的模式。计算机视觉相关的应用非常的多，例如百度识图、手写字符识别、车牌识别等等应用。这个领域是应用前景非常火热的，同时也是研究的热门方向。随着机器学习的新领域深度学习的发展，大大促进了计算机图像识别的效果，因此未来计算机视觉界的发展前景不可估量。</span></p>\r\n<p style=\"margin-left: 30px;\"><strong><span style=\"font-size: 15px;\">语音识别</span></strong><br><span style=\"font-size: 15px;\">语音识别=语音处理+机器学习。语音识别就是音频处理技术与机器学习的结合。语音识别技术一般不会单独使用，一般会结合自然语言处理的相关技术。目前的相关应用有苹果的语音助手siri等。</span></p>\r\n<p style=\"margin-left: 30px;\"><strong><span style=\"font-size: 15px;\">自然语言处理</span></strong><br><span style=\"font-size: 15px;\">自然语言处理=文本处理+机器学习。自然语言处理技术主要是让机器理解人类的语言的一门领域。在自然语言处理技术中，大量使用了编译原理相关的技术，例如词法分析，语法分析等等，除此之外，在理解这个层面，则使用了语义理解，机器学习等技术。作为唯一由人类自身创造的符号，自然语言处理一直是机器学习界不断研究的方向。按照百度机器学习专家余凯的说法“听与看，说白了就是阿猫和阿狗都会的，而只有语言才是人类独有的”。如何利用机器学习技术进行自然语言的的深度理解，一直是工业和学术界关注的焦点。</span></p>\r\n<p> </p>\r\n<h2><span style=\"font-size: 16px;\">4.推荐学习</span></h2>\r\n<p style=\"margin-left: 30px;\"><span style=\"font-size: 15px;\">机器学习词汇：<a href=\"https://jiqizhixin.github.io/AI-Terminology-page/\" target=\"_blank\">https://jiqizhixin.github.io/AI-Terminology-page/</a></span></p>\r\n<p id=\"activity-name\" class=\"rich_media_title\" style=\"margin-left: 30px;\"><span style=\"font-size: 15px;\">香港科技大学TensorFlow课件分享：<a href=\"https://mp.weixin.qq.com/s/GaK_iSTBl7B4LTdaOtiR_Q\" target=\"_blank\">https://mp.weixin.qq.com/s/GaK_iSTBl7B4LTdaOtiR_Q</a></span></p>\r\n<p class=\"rich_media_title\" style=\"margin-left: 30px;\"><span style=\"font-size: 15px;\">机器之心之机器学习路线：<a href=\"https://mp.weixin.qq.com/s?__biz=MzA3MzI4MjgzMw%3D%3D&amp;mid=2650730755&amp;idx=1&amp;sn=e67c5f5b8d84525f9ea9ef63a57caa89#wechat_redirect\" target=\"_blank\">https://mp.weixin.qq.com</a></span></p>\r\n<p style=\"margin-left: 30px;\"><span style=\"font-size: 15px;\">27 个机器学习、数学、Python 速查表</span><a href=\"http://blog.jobbole.com/112009/\" target=\"_blank\"><span style=\"font-size: 15px;\">http://blog.jobbole.com/112009/</span></a></p>\r\n<p class=\"rich_media_title\"> </p>\r\n<p class=\"rich_media_title\"> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 14:53</span> <a href=\"http://www.cnblogs.com/jasonhaven/\">Jasonhaven.D</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7765998\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7765998);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=367882,cb_entryId=7765998,cb_blogApp=currentBlogApp,cb_blogUserGuid='227797b6-9907-4ac3-2702-08d49c352df3',cb_entryCreatedDate='2017/11/1 14:53:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 90, "image_url": ["https://pic.cnblogs.com/face/1201240/20170814083604.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "RestServer 2.0 正式版发布", "url": "http://www.cnblogs.com/devgis/p/7766167.html", "author": "devgis", "article_desc": "RestServer 可以方便的将MSSQL,Oracle,MySQL,PostGresql数据库发布成rest服务供我们调用减少程序员的编码。RestServer 简单易用 配置非常简单！ RestServer is a Helpful soft to publish MSSQL,Oracle,M... ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/devgis/p/7766167.html\">RestServer 2.0 正式版发布</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h1 class=\"csdn_top\">RestServer 2.0 正式版发布</h1>\r\n<div id=\"article_content\" class=\"article_content csdn-tracking-statistics\" data-mod=\"popu_307\" data-dsm=\"post\"><ol>\r\n<li>使用许可&amp;版权说明</li>\r\n</ol><ol>\r\n<li>在保持本软件完整的情况下可以将本软件用于任何商业用途。</li>\r\n<li>本软件可以自由传播，但是请保持软件相关文件和说明文档完整。</li>\r\n<li>未经许可不得将本软件反编译进行修改。</li>\r\n<li>如不同意以上许可请勿使用本软件。</li>\r\n</ol><ol start=\"2\">\r\n<li>关于RestServer RestServer是一个快捷的rest服务器，用于直接将数据库数据发布成json格式方便其他需要json格式数据的地方调用。此程序免费，代码有偿提供。1.0.0.22支持所有表数据返回以及表数据条件返回。</li>\r\n<li>使用环境</li>\r\n</ol><ol>\r\n<li>服务器:windows xp,7,8,10,windows server 2003,2008,2012。.</li>\r\n<li>.net FrameWork 4.0。</li>\r\n<li>数据库:oracle 9i,10g,11g,MSSql2000,2005,2008,2012,MySQL5以上。</li>\r\n</ol><ol start=\"4\">\r\n<li>RestServer配置使用</li>\r\n</ol><ol>\r\n<li>\r\n<p>解压软件到相应目录。解压后主要有以下文件：</p>\r\n</li>\r\n<li>\r\n<p>安装.net Framework4.0(去微软官方网站下载或者网络搜索即可。)</p>\r\n</li>\r\n<li>\r\n<p>配置配置文件，配置文件在目录下RestServer.exe.config使用记事本打开即可进行编辑修改。只需修改configuration/appSettings配置节下面的内容（配置之前最好先进行复制备份，然后再进行修改），配置文件说明如下：</p>\r\n</li>\r\n</ol>\r\n<p> </p>\r\n<p>1.1.0.35中增加</p>\r\n<p>a) HOSTNAME为当前主机名称,id地址或域名。 b) PORT为需要使用的端口，请使用系统没有用的否则会创建失败。 c) DBTYPE为数据库类型 必须为ORACLE,MSSQL或MYSQL，分别对应使用ORACLE数据库,MS SqlServer,MySQL数据库。 d) DBCONSTRING为数据库的链接内容 请参考下方样本按照DBTYPE类型进行配置。 e) DATATYPE为类型 支持JSON,JSONP。 f) JSONPHANDEL 设置类型为JSONP时需要配置此内容。 g) WRITELOG 为True时写日志 否则不写日志。 4) 启动软件注意win7以上系统包括Server 2008以上系统请使用右键管理员方式执行，否则会启动失败。启动成功后会有如下提示：</p>\r\n<p>表示服务已经启动成功。接下来我们就可以受用了。</p>\r\n<ol start=\"5\">\r\n<li>开始使用 启动成功后就可以使用了。比如上一节配置了t_log和t_car两张表 这时候我们就可以在IE里边输入以下内容进行操作。</li>\r\n</ol><ol>\r\n<li>\r\n<p>查询表中所有内容返回json,输入<a href=\"http://localhost:9001/rest/t_car/query%E6%88%91%E4%BB%AC%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%9C%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E7%9C%8B%E5%88%B0%E5%A6%82%E4%B8%8B%E7%BB%93%E6%9E%9C%EF%BC%9A\" target=\"_blank\">http://localhost:9001/rest/t_car/query我们就可以在浏览器中看到如下结果：</a></p>\r\n</li>\r\n<li>\r\n<p>我们需要对标进行查询，比如carno=\"山A23392\"这时候我们可以进行如下查询：<a href=\"http://localhost:9001/rest/t_car/query/carno=\" target=\"_blank\">http://localhost:9001/rest/t_car/query/carno=</a> carno=\"山A23392\"这时浏览器中显示如下：</p>\r\n</li>\r\n</ol>\r\n<p>当然这里边可以支持sql语句中的where语句进行组合查询。这里就不再做详细说明了。 3) 按列查找 字符类型查找如下：<a href=\"http://localhost:9001/rest/T_TEST/name/'%E5%BC%A0%E4%B8%89\" target=\"_blank\">http://localhost:9001/rest/T_TEST/name/'张三</a>' 查询结果：</p>\r\n<p>按照数值列等查找则值不需要’’如下： <a href=\"http://localhost:9001/rest/T_TEST/id/1\" target=\"_blank\">http://localhost:9001/rest/T_TEST/id/1</a> 查询结果如下：</p>\r\n<p>由于1.1.0.35以后支持JASONP 这时候返回结果类似如下：</p>\r\n<ol start=\"6\">\r\n<li>2.0新增内容 支持Postgresql数据库(各scheme中表名勿重复) localhost:9001/rest/T_TEST/q 查询全部 eq:<a href=\"http://localhost:9001/rest/T_TEST/q\" target=\"_blank\">http://localhost:9001/rest/T_TEST/q</a> localhost:9001/rest/T_TEST/q/{where} 按条件查询 eq:<a href=\"http://localhost:9001/rest/T_TEST/q/id='1\" target=\"_blank\">http://localhost:9001/rest/T_TEST/q/id='1</a>' localhost:9001/rest/T_TEST/{colname}/{colvalue} 按列查询 eq:<a href=\"http://localhost:9001/rest/T_TEST/id/'1\" target=\"_blank\">http://localhost:9001/rest/T_TEST/id/'1</a>' localhost:9001/rest/T_TEST/q/p/{pagesize}/{pageindex} 所有数据分页 eq:<a href=\"http://localhost:9001/rest/T_TEST/q/p/5/1\" target=\"_blank\">http://localhost:9001/rest/T_TEST/q/p/5/1</a> localhost:9001/rest/T_TEST/q/p/{pagesize}/{pageindex}/{where} 按查询条件分页 eq:<a href=\"http://localhost:9001/rest/T_TEST/q/p/10/1/id='1\" target=\"_blank\">http://localhost:9001/rest/T_TEST/q/p/10/1/id='1</a>' *带{}为变量 需要输入相应值或者表达式(Where) 全部为get方式</li>\r\n<li>联系我们 查询所有以及按条件查询已经覆盖了现在互联网上所有的的查询内容需求，当然如果您需要更进一步的功能或者需要源码自己进行深入开发可以通过以下方式联系我： QQ:80163278 淘宝:<a href=\"http://tbflyshop.taobao.com/\" target=\"_blank\">http://tbflyshop.taobao.com</a> 或者发送电子邮件到<a href=\"mailto:devgis@qq.com\" target=\"_blank\">devgis@qq.com</a></li>\r\n</ol>\r\n<div> </div>\r\n<div>下载地址： </div>\r\n<div>百度网盘：http://pan.baidu.com/s/1gfGjVkJ</div>\r\n<div>github:https://github.com/devgis/RestServer</div>\r\n</div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 14:02</span> <a href=\"http://www.cnblogs.com/devgis/\">devgis</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766167\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766167);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=131223,cb_entryId=7766167,cb_blogApp=currentBlogApp,cb_blogUserGuid='25d27456-8023-e011-ac81-842b2b196315',cb_entryCreatedDate='2017/11/1 14:02:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 389, "image_url": ["https://pic.cnblogs.com/face/265880/20140314104803.png"], "date_pub": "2017-11-01", "article_common": 2}
{"title": "【机器学习实战】第11章 使用 Apriori 算法进行关联分析", "url": "http://www.cnblogs.com/jiangzhonglian/p/7766194.html", "author": "片刻", "article_desc": "第11章 使用 Apriori 算法进行关联分析 关联分析 关联分析是一种在大规模数据集中寻找有趣关系的任务。 这些关系可以有两种形式: 频繁项集（frequent item sets）: 经常出现在一块的物品的集合。 关联规则（associational rules）: 暗示两种物品之间可能存在很 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/jiangzhonglian/p/7766194.html\">【机器学习实战】第11章 使用 Apriori 算法进行关联分析</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h1>第11章 使用 Apriori 算法进行关联分析</h1>\n<p><a href=\"https://github.com/apachecn/MachineLearning/blob/master/images/11.Apriori/apachecn_apriori_homepage.jpg\" target=\"_blank\"><img src=\"https://github.com/apachecn/MachineLearning/raw/master/images/11.Apriori/apachecn_apriori_homepage.jpg\" alt=\"\"></a></p>\n<h2><a id=\"user-content-关联分析\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90\"></a>关联分析</h2>\n<p>关联分析是一种在大规模数据集中寻找有趣关系的任务。 这些关系可以有两种形式:</p>\n<ul>\n<li>频繁项集（frequent item sets）: 经常出现在一块的物品的集合。</li>\n<li>关联规则（associational rules）: 暗示两种物品之间可能存在很强的关系。</li>\n</ul>\n<h2><a id=\"user-content-相关术语\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD\"></a>相关术语</h2>\n<ul>\n<li>\n<p>关联分析（关联规则学习): 从大规模数据集中寻找物品间的隐含关系被称作 <code>关联分析(associati analysis)</code> 或者 <code>关联规则学习（association rule learning）</code> 。 下面是用一个 <code>杂货店</code> 例子来说明这两个概念，如下图所示:<br><a href=\"https://github.com/apachecn/MachineLearning/blob/master/images/11.Apriori/apachecn_apriori_association_demo_1.jpg\" target=\"_blank\"><img src=\"https://github.com/apachecn/MachineLearning/raw/master/images/11.Apriori/apachecn_apriori_association_demo_1.jpg\" alt=\"关联分析示例1\"></a></p>\n\n</li>\n<li>\n<p>频繁项集: {葡萄酒, 尿布, 豆奶} 就是一个频繁项集的例子。</p>\n\n</li>\n<li>\n<p>关联规则: 尿布 -&gt; 葡萄酒 就是一个关联规则。这意味着如果顾客买了尿布，那么他很可能会买葡萄酒。</p>\n\n</li>\n\n</ul>\n<p>那么 <code>频繁</code> 的定义是什么呢？怎么样才算频繁呢？ 度量它们的方法有很多种，这里我们来简单的介绍下支持度和可信度。</p>\n<ul>\n<li>支持度: 数据集中包含该项集的记录所占的比例。例如上图中，{豆奶} 的支持度为 4/5。{豆奶, 尿布} 的支持度为 3/5。</li>\n<li>可信度: 针对一条诸如 {尿布} -&gt; {葡萄酒} 这样具体的关联规则来定义的。这条规则的 <code>可信度</code> 被定义为 <code>支持度({尿布, 葡萄酒})/支持度({尿布})</code>，从图中可以看出 支持度({尿布, 葡萄酒}) = 3/5，支持度({尿布}) = 4/5，所以 {尿布} -&gt; {葡萄酒} 的可信度 = 3/5 / 4/5 = 3/4 = 0.75。</li>\n\n</ul>\n<p><code>支持度</code> 和 <code>可信度</code> 是用来量化 <code>关联分析</code> 是否成功的一个方法。 假设想找到支持度大于 0.8 的所有项集，应该如何去做呢？ 一个办法是生成一个物品所有可能组合的清单，然后对每一种组合统计它出现的频繁程度，但是当物品成千上万时，上述做法就非常非常慢了。 我们需要详细分析下这种情况并讨论下 Apriori 原理，该原理会减少关联规则学习时所需的计算量。</p>\n<h2><a id=\"user-content-apriori-原理\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#apriori-%E5%8E%9F%E7%90%86\"></a>Apriori 原理</h2>\n<p>假设我们一共有 4 个商品: 商品0, 商品1, 商品2, 商品3。 所有可能的情况如下:<br><a href=\"https://github.com/apachecn/MachineLearning/blob/master/images/11.Apriori/apachecn_apriori_goods_all_1.jpg\" target=\"_blank\"><img src=\"https://github.com/apachecn/MachineLearning/raw/master/images/11.Apriori/apachecn_apriori_goods_all_1.jpg\" alt=\"4种商品的所有组合\"></a><br>如果我们计算所有组合的支持度，也需要计算 15 次。即 2^N - 1 = 2^4 - 1 = 15。<br>随着物品的增加，计算的次数呈指数的形式增长 ...<br>为了降低计算次数和时间，研究人员发现了一种所谓的 Apriori 原理，即某个项集是频繁的，那么它的所有子集也是频繁的。 例如，如果 {0, 1} 是频繁的，那么 {0}, {1} 也是频繁的。 该原理直观上没有什么帮助，但是如果反过来看就有用了，也就是说如果一个项集是 <code>非频繁项集</code>，那么它的所有超集也是非频繁项集，如下图所示:</p>\n<p><a href=\"https://github.com/apachecn/MachineLearning/blob/master/images/11.Apriori/%E9%9D%9E%E9%A2%91%E7%B9%81%E9%A1%B9%E9%9B%86.png\" target=\"_blank\"><img src=\"https://github.com/apachecn/MachineLearning/raw/master/images/11.Apriori/%E9%9D%9E%E9%A2%91%E7%B9%81%E9%A1%B9%E9%9B%86.png\" alt=\"非频繁项集\"></a></p>\n<p>在图中我们可以看到，已知灰色部分 {2,3} 是 <code>非频繁项集</code>，那么利用上面的知识，我们就可以知道 {0,2,3} {1,2,3} {0,1,2,3} 都是 <code>非频繁的</code>。 也就是说，计算出 {2,3} 的支持度，知道它是 <code>非频繁</code> 的之后，就不需要再计算 {0,2,3} {1,2,3} {0,1,2,3} 的支持度，因为我们知道这些集合不会满足我们的要求。 使用该原理就可以避免项集数目的指数增长，从而在合理的时间内计算出频繁项集。</p>\n<p>Apriori 算法优缺点</p>\n<pre><code>* 优点：易编码实现\n* 缺点：在大数据集上可能较慢\n* 适用数据类型：数值型 或者 标称型数据。\n</code></pre>\n<p>Apriori 算法流程步骤：</p>\n<pre><code>* 收集数据：使用任意方法。\n* 准备数据：任何数据类型都可以，因为我们只保存集合。\n* 分析数据：使用任意方法。\n* 训练数据：使用Apiori算法来找到频繁项集。\n* 测试算法：不需要测试过程。\n* 使用算法：用语发现频繁项集以及物品之间的关联规则。\n</code></pre>\n<h2><a id=\"user-content-apriori-算法的使用\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#apriori-%E7%AE%97%E6%B3%95%E7%9A%84%E4%BD%BF%E7%94%A8\"></a>Apriori 算法的使用</h2>\n<p>前面提到，关联分析的目标包括两项: 发现 <code>频繁项集</code> 和发现 <code>关联规则</code>。 首先需要找到 <code>频繁项集</code>，然后才能发现 <code>关联规则</code>。<br><code>Apriori</code> 算法是发现 <code>频繁项集</code> 的一种方法。 Apriori 算法的两个输入参数分别是最小支持度和数据集。 该算法首先会生成所有单个物品的项集列表。 接着扫描交易记录来查看哪些项集满足最小支持度要求，那些不满足最小支持度要求的集合会被去掉。 燃尽后对生下来的集合进行组合以声场包含两个元素的项集。 接下来再重新扫描交易记录，去掉不满足最小支持度的项集。 该过程重复进行直到所有项集被去掉。</p>\n<h3><a id=\"user-content-生成候选项集\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E7%94%9F%E6%88%90%E5%80%99%E9%80%89%E9%A1%B9%E9%9B%86\"></a>生成候选项集</h3>\n<p>下面会创建一个用于构建初始集合的函数，也会创建一个通过扫描数据集以寻找交易记录子集的函数， 数据扫描的伪代码如下:</p>\n<ul>\n<li>对数据集中的每条交易记录 tran</li>\n<li>对每个候选项集 can\n<ul>\n<li>检查一下 can 是否是 tran 的子集: 如果是则增加 can 的计数值</li>\n\n</ul>\n\n</li>\n<li>对每个候选项集\n<ul>\n<li>如果其支持度不低于最小值，则保留该项集</li>\n<li>返回所有频繁项集列表 以下是一些辅助函数。</li>\n\n</ul>\n\n</li>\n\n</ul>\n<h4><a id=\"user-content-加载数据集\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86\"></a>加载数据集</h4>\n<div class=\"highlight highlight-source-python\">\n<pre><span class=\"pl-c\"><span class=\"pl-c\"># 加载数据集\n<span class=\"pl-k\">def <span class=\"pl-en\">loadDataSet():\n    <span class=\"pl-k\">return [[<span class=\"pl-c1\">1, <span class=\"pl-c1\">3, <span class=\"pl-c1\">4], [<span class=\"pl-c1\">2, <span class=\"pl-c1\">3, <span class=\"pl-c1\">5], [<span class=\"pl-c1\">1, <span class=\"pl-c1\">2, <span class=\"pl-c1\">3, <span class=\"pl-c1\">5], [<span class=\"pl-c1\">2, <span class=\"pl-c1\">5]]</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<h4><a id=\"user-content-创建集合-c1即对-dataset-进行去重排序放入-list-中然后转换所有的元素为-frozenset\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E5%88%9B%E5%BB%BA%E9%9B%86%E5%90%88-c1%E5%8D%B3%E5%AF%B9-dataset-%E8%BF%9B%E8%A1%8C%E5%8E%BB%E9%87%8D%E6%8E%92%E5%BA%8F%E6%94%BE%E5%85%A5-list-%E4%B8%AD%E7%84%B6%E5%90%8E%E8%BD%AC%E6%8D%A2%E6%89%80%E6%9C%89%E7%9A%84%E5%85%83%E7%B4%A0%E4%B8%BA-frozenset\"></a>创建集合 C1。即对 dataSet 进行去重，排序，放入 list 中，然后转换所有的元素为 frozenset</h4>\n<div class=\"highlight highlight-source-python\">\n<pre><span class=\"pl-c\"><span class=\"pl-c\"># 创建集合 C1。即对 dataSet 进行去重，排序，放入 list 中，然后转换所有的元素为 frozenset\n<span class=\"pl-k\">def <span class=\"pl-en\">createC1(<span class=\"pl-smi\">dataSet):\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"createC1（创建集合 C1）\n<span class=\"pl-s\">\n<span class=\"pl-s\">    Args:\n<span class=\"pl-s\">        dataSet 原始数据集\n<span class=\"pl-s\">    Returns:\n<span class=\"pl-s\">        frozenset 返回一个 frozenset 格式的 list\n<span class=\"pl-s\">    <span class=\"pl-pds\">\"\"\"\n\n    C1 <span class=\"pl-k\">= []\n    <span class=\"pl-k\">for transaction <span class=\"pl-k\">in dataSet:\n        <span class=\"pl-k\">for item <span class=\"pl-k\">in transaction:\n            <span class=\"pl-k\">if <span class=\"pl-k\">not [item] <span class=\"pl-k\">in C1:\n                <span class=\"pl-c\"><span class=\"pl-c\"># 遍历所有的元素，如果不在 C1 出现过，那么就 append\n                C1.append([item])\n    <span class=\"pl-c\"><span class=\"pl-c\"># 对数组进行 `从小到大` 的排序\n    <span class=\"pl-c1\">print <span class=\"pl-s\"><span class=\"pl-pds\">'sort 前=<span class=\"pl-pds\">', C1\n    C1.sort()\n    <span class=\"pl-c\"><span class=\"pl-c\"># frozenset 表示冻结的 set 集合，元素无改变；可以把它当字典的 key 来使用\n    <span class=\"pl-c1\">print <span class=\"pl-s\"><span class=\"pl-pds\">'sort 后=<span class=\"pl-pds\">', C1\n    <span class=\"pl-c1\">print <span class=\"pl-s\"><span class=\"pl-pds\">'frozenset=<span class=\"pl-pds\">', <span class=\"pl-c1\">map(<span class=\"pl-c1\">frozenset, C1)\n    <span class=\"pl-k\">return <span class=\"pl-c1\">map(<span class=\"pl-c1\">frozenset, C1)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<h4><a id=\"user-content-计算候选数据集-ck-在数据集-d-中的支持度并返回支持度大于最小支持度minsupport的数据\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E8%AE%A1%E7%AE%97%E5%80%99%E9%80%89%E6%95%B0%E6%8D%AE%E9%9B%86-ck-%E5%9C%A8%E6%95%B0%E6%8D%AE%E9%9B%86-d-%E4%B8%AD%E7%9A%84%E6%94%AF%E6%8C%81%E5%BA%A6%E5%B9%B6%E8%BF%94%E5%9B%9E%E6%94%AF%E6%8C%81%E5%BA%A6%E5%A4%A7%E4%BA%8E%E6%9C%80%E5%B0%8F%E6%94%AF%E6%8C%81%E5%BA%A6minsupport%E7%9A%84%E6%95%B0%E6%8D%AE\"></a>计算候选数据集 CK 在数据集 D 中的支持度，并返回支持度大于最小支持度（minSupport）的数据</h4>\n<div class=\"highlight highlight-source-python\">\n<pre><span class=\"pl-c\"><span class=\"pl-c\"># 计算候选数据集 CK 在数据集 D 中的支持度，并返回支持度大于最小支持度（minSupport）的数据\n<span class=\"pl-k\">def <span class=\"pl-en\">scanD(<span class=\"pl-smi\">D, <span class=\"pl-smi\">Ck, <span class=\"pl-smi\">minSupport):\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"scanD（计算候选数据集 CK 在数据集 D 中的支持度，并返回支持度大于最小支持度 minSupport 的数据）\n<span class=\"pl-s\">\n<span class=\"pl-s\">    Args:\n<span class=\"pl-s\">        D 数据集\n<span class=\"pl-s\">        Ck 候选项集列表\n<span class=\"pl-s\">        minSupport 最小支持度\n<span class=\"pl-s\">    Returns:\n<span class=\"pl-s\">        retList 支持度大于 minSupport 的集合\n<span class=\"pl-s\">        supportData 候选项集支持度数据\n<span class=\"pl-s\">    <span class=\"pl-pds\">\"\"\"\n\n    <span class=\"pl-c\"><span class=\"pl-c\"># ssCnt 临时存放选数据集 Ck 的频率. 例如: a-&gt;10, b-&gt;5, c-&gt;8\n    ssCnt <span class=\"pl-k\">= {}\n    <span class=\"pl-k\">for tid <span class=\"pl-k\">in D:\n        <span class=\"pl-k\">for can <span class=\"pl-k\">in Ck:\n            <span class=\"pl-c\"><span class=\"pl-c\"># s.issubset(t)  测试是否 s 中的每一个元素都在 t 中\n            <span class=\"pl-k\">if can.issubset(tid):\n                <span class=\"pl-k\">if <span class=\"pl-k\">not ssCnt.has_key(can):\n                    ssCnt[can] <span class=\"pl-k\">= <span class=\"pl-c1\">1\n                <span class=\"pl-k\">else:\n                    ssCnt[can] <span class=\"pl-k\">+= <span class=\"pl-c1\">1\n    numItems <span class=\"pl-k\">= <span class=\"pl-c1\">float(<span class=\"pl-c1\">len(D)) <span class=\"pl-c\"><span class=\"pl-c\"># 数据集 D 的数量\n    retList <span class=\"pl-k\">= []\n    supportData <span class=\"pl-k\">= {}\n    <span class=\"pl-k\">for key <span class=\"pl-k\">in ssCnt:\n        <span class=\"pl-c\"><span class=\"pl-c\"># 支持度 = 候选项（key）出现的次数 / 所有数据集的数量\n        support <span class=\"pl-k\">= ssCnt[key]<span class=\"pl-k\">/numItems\n        <span class=\"pl-k\">if support <span class=\"pl-k\">&gt;= minSupport:\n            <span class=\"pl-c\"><span class=\"pl-c\"># 在 retList 的首位插入元素，只存储支持度满足频繁项集的值\n            retList.insert(<span class=\"pl-c1\">0, key)\n        <span class=\"pl-c\"><span class=\"pl-c\"># 存储所有的候选项（key）和对应的支持度（support）\n        supportData[key] <span class=\"pl-k\">= support\n    <span class=\"pl-k\">return retList, supportData</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<p>完整代码地址: <a href=\"https://github.com/apachecn/MachineLearning/blob/master/src/python/11.Apriori/apriori.py\">https://github.com/apachecn/MachineLearning/blob/master/src/python/11.Apriori/apriori.py</a></p>\n<h3><a id=\"user-content-组织完整的-apriori-算法\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E7%BB%84%E7%BB%87%E5%AE%8C%E6%95%B4%E7%9A%84-apriori-%E7%AE%97%E6%B3%95\"></a>组织完整的 Apriori 算法</h3>\n<h4><a id=\"user-content-输入频繁项集列表-lk-与返回的元素个数-k然后输出所有可能的候选项集-ck\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E8%BE%93%E5%85%A5%E9%A2%91%E7%B9%81%E9%A1%B9%E9%9B%86%E5%88%97%E8%A1%A8-lk-%E4%B8%8E%E8%BF%94%E5%9B%9E%E7%9A%84%E5%85%83%E7%B4%A0%E4%B8%AA%E6%95%B0-k%E7%84%B6%E5%90%8E%E8%BE%93%E5%87%BA%E6%89%80%E6%9C%89%E5%8F%AF%E8%83%BD%E7%9A%84%E5%80%99%E9%80%89%E9%A1%B9%E9%9B%86-ck\"></a>输入频繁项集列表 Lk 与返回的元素个数 k，然后输出所有可能的候选项集 Ck</h4>\n<div class=\"highlight highlight-source-python\">\n<pre><span class=\"pl-c\"><span class=\"pl-c\"># 输入频繁项集列表 Lk 与返回的元素个数 k，然后输出所有可能的候选项集 Ck\n<span class=\"pl-k\">def <span class=\"pl-en\">aprioriGen(<span class=\"pl-smi\">Lk, <span class=\"pl-smi\">k):\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"aprioriGen（输入频繁项集列表 Lk 与返回的元素个数 k，然后输出候选项集 Ck。\n<span class=\"pl-s\">       例如: 以 {0},{1},{2} 为输入且 k = 2 则输出 {0,1}, {0,2}, {1,2}. 以 {0,1},{0,2},{1,2} 为输入且 k = 3 则输出 {0,1,2}\n<span class=\"pl-s\">       仅需要计算一次，不需要将所有的结果计算出来，然后进行去重操作\n<span class=\"pl-s\">       这是一个更高效的算法）\n<span class=\"pl-s\">\n<span class=\"pl-s\">    Args:\n<span class=\"pl-s\">        Lk 频繁项集列表\n<span class=\"pl-s\">        k 返回的项集元素个数（若元素的前 k-2 相同，就进行合并）\n<span class=\"pl-s\">    Returns:\n<span class=\"pl-s\">        retList 元素两两合并的数据集\n<span class=\"pl-s\">    <span class=\"pl-pds\">\"\"\"\n    \n    retList <span class=\"pl-k\">= []\n    lenLk <span class=\"pl-k\">= <span class=\"pl-c1\">len(Lk)\n    <span class=\"pl-k\">for i <span class=\"pl-k\">in <span class=\"pl-c1\">range(lenLk):\n        <span class=\"pl-k\">for j <span class=\"pl-k\">in <span class=\"pl-c1\">range(i<span class=\"pl-k\">+<span class=\"pl-c1\">1, lenLk):\n            L1 <span class=\"pl-k\">= <span class=\"pl-c1\">list(Lk[i])[: k<span class=\"pl-k\">-<span class=\"pl-c1\">2]\n            L2 <span class=\"pl-k\">= <span class=\"pl-c1\">list(Lk[j])[: k<span class=\"pl-k\">-<span class=\"pl-c1\">2]\n            <span class=\"pl-c\"><span class=\"pl-c\"># print '-----i=', i, k-2, Lk, Lk[i], list(Lk[i])[: k-2]\n            <span class=\"pl-c\"><span class=\"pl-c\"># print '-----j=', j, k-2, Lk, Lk[j], list(Lk[j])[: k-2]\n            L1.sort()\n            L2.sort()\n            <span class=\"pl-c\"><span class=\"pl-c\"># 第一次 L1,L2 为空，元素直接进行合并，返回元素两两合并的数据集\n            <span class=\"pl-c\"><span class=\"pl-c\"># if first k-2 elements are equal\n            <span class=\"pl-k\">if L1 <span class=\"pl-k\">== L2:\n                <span class=\"pl-c\"><span class=\"pl-c\"># set union\n                <span class=\"pl-c\"><span class=\"pl-c\"># print 'union=', Lk[i] | Lk[j], Lk[i], Lk[j]\n                retList.append(Lk[i] <span class=\"pl-k\">| Lk[j])\n    <span class=\"pl-k\">return retList</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<h4><a id=\"user-content-找出数据集-dataset-中支持度--最小支持度的候选项集以及它们的支持度即我们的频繁项集\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E6%89%BE%E5%87%BA%E6%95%B0%E6%8D%AE%E9%9B%86-dataset-%E4%B8%AD%E6%94%AF%E6%8C%81%E5%BA%A6--%E6%9C%80%E5%B0%8F%E6%94%AF%E6%8C%81%E5%BA%A6%E7%9A%84%E5%80%99%E9%80%89%E9%A1%B9%E9%9B%86%E4%BB%A5%E5%8F%8A%E5%AE%83%E4%BB%AC%E7%9A%84%E6%94%AF%E6%8C%81%E5%BA%A6%E5%8D%B3%E6%88%91%E4%BB%AC%E7%9A%84%E9%A2%91%E7%B9%81%E9%A1%B9%E9%9B%86\"></a>找出数据集 dataSet 中支持度 &gt;= 最小支持度的候选项集以及它们的支持度。即我们的频繁项集。</h4>\n<div class=\"highlight highlight-source-python\">\n<pre><span class=\"pl-c\"><span class=\"pl-c\"># 找出数据集 dataSet 中支持度 &gt;= 最小支持度的候选项集以及它们的支持度。即我们的频繁项集。\n<span class=\"pl-k\">def <span class=\"pl-en\">apriori(<span class=\"pl-smi\">dataSet, <span class=\"pl-smi\">minSupport<span class=\"pl-k\">=<span class=\"pl-c1\">0.5):\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"apriori（首先构建集合 C1，然后扫描数据集来判断这些只有一个元素的项集是否满足最小支持度的要求。那么满足最小支持度要求的项集构成集合 L1。然后 L1 中的元素相互组合成 C2，C2 再进一步过滤变成 L2，然后以此类推，知道 CN 的长度为 0 时结束，即可找出所有频繁项集的支持度。）\n<span class=\"pl-s\">\n<span class=\"pl-s\">    Args:\n<span class=\"pl-s\">        dataSet 原始数据集\n<span class=\"pl-s\">        minSupport 支持度的阈值\n<span class=\"pl-s\">    Returns:\n<span class=\"pl-s\">        L 频繁项集的全集\n<span class=\"pl-s\">        supportData 所有元素和支持度的全集\n<span class=\"pl-s\">    <span class=\"pl-pds\">\"\"\"\n    <span class=\"pl-c\"><span class=\"pl-c\"># C1 即对 dataSet 进行去重，排序，放入 list 中，然后转换所有的元素为 frozenset\n    C1 <span class=\"pl-k\">= createC1(dataSet)\n    <span class=\"pl-c\"><span class=\"pl-c\"># 对每一行进行 set 转换，然后存放到集合中\n    D <span class=\"pl-k\">= <span class=\"pl-c1\">map(<span class=\"pl-c1\">set, dataSet)\n    <span class=\"pl-c1\">print <span class=\"pl-s\"><span class=\"pl-pds\">'D=<span class=\"pl-pds\">', D\n    <span class=\"pl-c\"><span class=\"pl-c\"># 计算候选数据集 C1 在数据集 D 中的支持度，并返回支持度大于 minSupport 的数据\n    L1, supportData <span class=\"pl-k\">= scanD(D, C1, minSupport)\n    <span class=\"pl-c\"><span class=\"pl-c\"># print \"L1=\", L1, \"\\n\", \"outcome: \", supportData\n\n    <span class=\"pl-c\"><span class=\"pl-c\"># L 加了一层 list, L 一共 2 层 list\n    L <span class=\"pl-k\">= [L1]\n    k <span class=\"pl-k\">= <span class=\"pl-c1\">2\n    <span class=\"pl-c\"><span class=\"pl-c\"># 判断 L 的第 k-2 项的数据长度是否 &gt; 0。第一次执行时 L 为 [[frozenset([1]), frozenset([3]), frozenset([2]), frozenset([5])]]。L[k-2]=L[0]=[frozenset([1]), frozenset([3]), frozenset([2]), frozenset([5])]，最后面 k += 1\n    <span class=\"pl-k\">while (<span class=\"pl-c1\">len(L[k<span class=\"pl-k\">-<span class=\"pl-c1\">2]) <span class=\"pl-k\">&gt; <span class=\"pl-c1\">0):\n        <span class=\"pl-c1\">print <span class=\"pl-s\"><span class=\"pl-pds\">'k=<span class=\"pl-pds\">', k, L, L[k<span class=\"pl-k\">-<span class=\"pl-c1\">2]\n        Ck <span class=\"pl-k\">= aprioriGen(L[k<span class=\"pl-k\">-<span class=\"pl-c1\">2], k) <span class=\"pl-c\"><span class=\"pl-c\"># 例如: 以 {0},{1},{2} 为输入且 k = 2 则输出 {0,1}, {0,2}, {1,2}. 以 {0,1},{0,2},{1,2} 为输入且 k = 3 则输出 {0,1,2}\n        <span class=\"pl-c1\">print <span class=\"pl-s\"><span class=\"pl-pds\">'Ck<span class=\"pl-pds\">', Ck\n\n        Lk, supK <span class=\"pl-k\">= scanD(D, Ck, minSupport) <span class=\"pl-c\"><span class=\"pl-c\"># 计算候选数据集 CK 在数据集 D 中的支持度，并返回支持度大于 minSupport 的数据\n        <span class=\"pl-c\"><span class=\"pl-c\"># 保存所有候选项集的支持度，如果字典没有，就追加元素，如果有，就更新元素\n        supportData.update(supK)\n        <span class=\"pl-k\">if <span class=\"pl-c1\">len(Lk) <span class=\"pl-k\">== <span class=\"pl-c1\">0:\n            <span class=\"pl-k\">break\n        <span class=\"pl-c\"><span class=\"pl-c\"># Lk 表示满足频繁子项的集合，L 元素在增加，例如: \n        <span class=\"pl-c\"><span class=\"pl-c\"># l=[[set(1), set(2), set(3)]]\n        <span class=\"pl-c\"><span class=\"pl-c\"># l=[[set(1), set(2), set(3)], [set(1, 2), set(2, 3)]]\n        L.append(Lk)\n        k <span class=\"pl-k\">+= <span class=\"pl-c1\">1\n        <span class=\"pl-c\"><span class=\"pl-c\"># print 'k=', k, len(L[k-2])\n    <span class=\"pl-k\">return L, supportData</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<p>到这一步，我们就找出我们所需要的 <code>频繁项集</code> 和他们的 <code>支持度</code> 了，接下来再找出关联规则即可！</p>\n<p>完整代码地址: <a href=\"https://github.com/apachecn/MachineLearning/blob/master/src/python/11.Apriori/apriori.py\">https://github.com/apachecn/MachineLearning/blob/master/src/python/11.Apriori/apriori.py</a></p>\n<h2><a id=\"user-content-从频繁项集中挖掘关联规则\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E4%BB%8E%E9%A2%91%E7%B9%81%E9%A1%B9%E9%9B%86%E4%B8%AD%E6%8C%96%E6%8E%98%E5%85%B3%E8%81%94%E8%A7%84%E5%88%99\"></a>从频繁项集中挖掘关联规则</h2>\n<p>前面我们介绍了用于发现 <code>频繁项集</code> 的 Apriori 算法，现在要解决的问题是如何找出 <code>关联规则</code>。</p>\n<p>要找到 <code>关联规则</code>，我们首先从一个 <code>频繁项集</code> 开始。 我们知道集合中的元素是不重复的，但我们想知道基于这些元素能否获得其它内容。 某个元素或某个元素集合可能会推导出另一个元素。 从先前 <code>杂货店</code> 的例子可以得到，如果有一个频繁项集 {豆奶,莴苣}，那么就可能有一条关联规则 “豆奶 -&gt; 莴苣”。 这意味着如果有人买了豆奶，那么在统计上他会购买莴苣的概率比较大。 但是，这一条件反过来并不总是成立。 也就是说 “豆奶 -&gt; 莴苣” 统计上显著，那么 “莴苣 -&gt; 豆奶” 也不一定成立。</p>\n<p>前面我们给出了 <code>频繁项集</code> 的量化定义，即它满足最小支持度要求。<br>对于 <code>关联规则</code>，我们也有类似的量化方法，这种量化指标称之为 <code>可信度</code>。<br>一条规则 A -&gt; B 的可信度定义为 support(A | B) / support(A)。（注意: 在 python 中 | 表示集合的并操作，而数学书集合并的符号是 U）。<br><code>A | B</code> 是指所有出现在集合 A 或者集合 B 中的元素。<br>由于我们先前已经计算出所有 <code>频繁项集</code> 的支持度了，现在我们要做的只不过是提取这些数据做一次除法运算即可。</p>\n<h3><a id=\"user-content-一个频繁项集可以产生多少条关联规则呢\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E4%B8%80%E4%B8%AA%E9%A2%91%E7%B9%81%E9%A1%B9%E9%9B%86%E5%8F%AF%E4%BB%A5%E4%BA%A7%E7%94%9F%E5%A4%9A%E5%B0%91%E6%9D%A1%E5%85%B3%E8%81%94%E8%A7%84%E5%88%99%E5%91%A2\"></a>一个频繁项集可以产生多少条关联规则呢？</h3>\n<p>如下图所示，给出的是项集 {0,1,2,3} 产生的所有关联规则:<br><a href=\"https://github.com/apachecn/MachineLearning/blob/master/images/11.Apriori/apachecn_association_rule_demo_1.jpg\" target=\"_blank\"><img src=\"https://github.com/apachecn/MachineLearning/raw/master/images/11.Apriori/apachecn_association_rule_demo_1.jpg\" alt=\"关联规则网格示意图\"></a><br>与我们前面的 <code>频繁项集</code> 生成一样，我们可以为每个频繁项集产生许多关联规则。<br>如果能减少规则的数目来确保问题的可解析，那么计算起来就会好很多。<br>通过观察，我们可以知道，如果某条规则并不满足 <code>最小可信度</code> 要求，那么该规则的所有子集也不会满足 <code>最小可信度</code> 的要求。<br>如上图所示，假设 <code>123 -&gt; 3</code> 并不满足最小可信度要求，那么就知道任何左部为 {0,1,2} 子集的规则也不会满足 <code>最小可信度</code> 的要求。 即 <code>12 -&gt; 03</code> , <code>02 -&gt; 13</code> , <code>01 -&gt; 23</code> , <code>2 -&gt; 013</code>, <code>1 -&gt; 023</code>, <code>0 -&gt; 123</code> 都不满足 <code>最小可信度</code> 要求。</p>\n<p>可以利用关联规则的上述性质属性来减少需要测试的规则数目，跟先前 Apriori 算法的套路一样。<br>以下是一些辅助函数:</p>\n<h4><a id=\"user-content-计算可信度\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E8%AE%A1%E7%AE%97%E5%8F%AF%E4%BF%A1%E5%BA%A6\"></a>计算可信度</h4>\n<div class=\"highlight highlight-source-python\">\n<pre><span class=\"pl-c\"><span class=\"pl-c\"># 计算可信度（confidence）\n<span class=\"pl-k\">def <span class=\"pl-en\">calcConf(<span class=\"pl-smi\">freqSet, <span class=\"pl-smi\">H\n, <span class=\"pl-smi\">supportData, <span class=\"pl-smi\">brl, <span class=\"pl-smi\">minConf<span class=\"pl-k\">=<span class=\"pl-c1\">0.7):\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"calcConf（对两个元素的频繁项，计算可信度，例如： {1,2}/{1} 或者 {1,2}/{2} 看是否满足条件）\n<span class=\"pl-s\">\n<span class=\"pl-s\">    Args:\n<span class=\"pl-s\">        freqSet 频繁项集中的元素，例如: frozenset([1, 3])    \n<span class=\"pl-s\">        H 频繁项集中的元素的集合，例如: [frozenset([1]), frozenset([3])]\n<span class=\"pl-s\">        supportData 所有元素的支持度的字典\n<span class=\"pl-s\">        brl 关联规则列表的空数组\n<span class=\"pl-s\">        minConf 最小可信度\n<span class=\"pl-s\">    Returns:\n<span class=\"pl-s\">        prunedH 记录 可信度大于阈值的集合\n<span class=\"pl-s\">    <span class=\"pl-pds\">\"\"\"\n    <span class=\"pl-c\"><span class=\"pl-c\"># 记录可信度大于最小可信度（minConf）的集合\n    prunedH <span class=\"pl-k\">= []\n    <span class=\"pl-k\">for conseq <span class=\"pl-k\">in H: <span class=\"pl-c\"><span class=\"pl-c\"># 假设 freqSet = frozenset([1, 3]), H = [frozenset([1]), frozenset([3])]，那么现在需要求出 frozenset([1]) -&gt; frozenset([3]) 的可信度和 frozenset([3]) -&gt; frozenset([1]) 的可信度\n\n        <span class=\"pl-c\"><span class=\"pl-c\"># print 'confData=', freqSet, H, conseq, freqSet-conseq\n        conf <span class=\"pl-k\">= supportData[freqSet]<span class=\"pl-k\">/supportData[freqSet<span class=\"pl-k\">-conseq] <span class=\"pl-c\"><span class=\"pl-c\"># 支持度定义: a -&gt; b = support(a | b) / support(a). 假设  freqSet = frozenset([1, 3]), conseq = [frozenset([1])]，那么 frozenset([1]) 至 frozenset([3]) 的可信度为 = support(a | b) / support(a) = supportData[freqSet]/supportData[freqSet-conseq] = supportData[frozenset([1, 3])] / supportData[frozenset([1])]\n        <span class=\"pl-k\">if conf <span class=\"pl-k\">&gt;= minConf:\n            <span class=\"pl-c\"><span class=\"pl-c\"># 只要买了 freqSet-conseq 集合，一定会买 conseq 集合（freqSet-conseq 集合和 conseq 集合是全集）\n            <span class=\"pl-c1\">print freqSet<span class=\"pl-k\">-conseq, <span class=\"pl-s\"><span class=\"pl-pds\">'--&gt;<span class=\"pl-pds\">', conseq, <span class=\"pl-s\"><span class=\"pl-pds\">'conf:<span class=\"pl-pds\">', conf\n            brl.append((freqSet<span class=\"pl-k\">-conseq, conseq, conf))\n            prunedH.append(conseq)\n    <span class=\"pl-k\">return prunedH</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<h4><a id=\"user-content-递归计算频繁项集的规则\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E9%80%92%E5%BD%92%E8%AE%A1%E7%AE%97%E9%A2%91%E7%B9%81%E9%A1%B9%E9%9B%86%E7%9A%84%E8%A7%84%E5%88%99\"></a>递归计算频繁项集的规则</h4>\n<div class=\"highlight highlight-source-python\">\n<pre><span class=\"pl-c\"><span class=\"pl-c\"># 递归计算频繁项集的规则\n<span class=\"pl-k\">def <span class=\"pl-en\">rulesFromConseq(<span class=\"pl-smi\">freqSet, <span class=\"pl-smi\">H, <span class=\"pl-smi\">supportData, <span class=\"pl-smi\">brl, <span class=\"pl-smi\">minConf<span class=\"pl-k\">=<span class=\"pl-c1\">0.7):\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"rulesFromConseq\n<span class=\"pl-s\">\n<span class=\"pl-s\">    Args:\n<span class=\"pl-s\">        freqSet 频繁项集中的元素，例如: frozenset([2, 3, 5])    \n<span class=\"pl-s\">        H 频繁项集中的元素的集合，例如: [frozenset([2]), frozenset([3]), frozenset([5])]\n<span class=\"pl-s\">        supportData 所有元素的支持度的字典\n<span class=\"pl-s\">        brl 关联规则列表的数组\n<span class=\"pl-s\">        minConf 最小可信度\n<span class=\"pl-s\">    <span class=\"pl-pds\">\"\"\"\n    <span class=\"pl-c\"><span class=\"pl-c\"># H[0] 是 freqSet 的元素组合的第一个元素，并且 H 中所有元素的长度都一样，长度由 aprioriGen(H, m+1) 这里的 m + 1 来控制\n    <span class=\"pl-c\"><span class=\"pl-c\"># 该函数递归时，H[0] 的长度从 1 开始增长 1 2 3 ...\n    <span class=\"pl-c\"><span class=\"pl-c\"># 假设 freqSet = frozenset([2, 3, 5]), H = [frozenset([2]), frozenset([3]), frozenset([5])]\n    <span class=\"pl-c\"><span class=\"pl-c\"># 那么 m = len(H[0]) 的递归的值依次为 1 2\n    <span class=\"pl-c\"><span class=\"pl-c\"># 在 m = 2 时, 跳出该递归。假设再递归一次，那么 H[0] = frozenset([2, 3, 5])，freqSet = frozenset([2, 3, 5]) ，没必要再计算 freqSet 与 H[0] 的关联规则了。\n    m <span class=\"pl-k\">= <span class=\"pl-c1\">len(H[<span class=\"pl-c1\">0])\n    <span class=\"pl-k\">if (<span class=\"pl-c1\">len(freqSet) <span class=\"pl-k\">&gt; (m <span class=\"pl-k\">+ <span class=\"pl-c1\">1)):\n        <span class=\"pl-c1\">print <span class=\"pl-s\"><span class=\"pl-pds\">'freqSet******************<span class=\"pl-pds\">', <span class=\"pl-c1\">len(freqSet), m <span class=\"pl-k\">+ <span class=\"pl-c1\">1, freqSet, H, H[<span class=\"pl-c1\">0]\n        <span class=\"pl-c\"><span class=\"pl-c\"># 生成 m+1 个长度的所有可能的 H 中的组合，假设 H = [frozenset([2]), frozenset([3]), frozenset([5])]\n        <span class=\"pl-c\"><span class=\"pl-c\"># 第一次递归调用时生成 [frozenset([2, 3]), frozenset([2, 5]), frozenset([3, 5])]\n        <span class=\"pl-c\"><span class=\"pl-c\"># 第二次 。。。没有第二次，递归条件判断时已经退出了\n        Hmp1 <span class=\"pl-k\">= aprioriGen(H, m<span class=\"pl-k\">+<span class=\"pl-c1\">1)\n        <span class=\"pl-c\"><span class=\"pl-c\"># 返回可信度大于最小可信度的集合\n        Hmp1 <span class=\"pl-k\">= calcConf(freqSet, Hmp1, supportData, brl, minConf)\n        <span class=\"pl-c1\">print <span class=\"pl-s\"><span class=\"pl-pds\">'Hmp1=<span class=\"pl-pds\">', Hmp1\n        <span class=\"pl-c1\">print <span class=\"pl-s\"><span class=\"pl-pds\">'len(Hmp1)=<span class=\"pl-pds\">', <span class=\"pl-c1\">len(Hmp1), <span class=\"pl-s\"><span class=\"pl-pds\">'len(freqSet)=<span class=\"pl-pds\">', <span class=\"pl-c1\">len(freqSet)\n        <span class=\"pl-c\"><span class=\"pl-c\"># 计算可信度后，还有数据大于最小可信度的话，那么继续递归调用，否则跳出递归\n        <span class=\"pl-k\">if (<span class=\"pl-c1\">len(Hmp1) <span class=\"pl-k\">&gt; <span class=\"pl-c1\">1):\n            <span class=\"pl-c1\">print <span class=\"pl-s\"><span class=\"pl-pds\">'----------------------<span class=\"pl-pds\">', Hmp1\n            <span class=\"pl-c\"><span class=\"pl-c\"># print len(freqSet),  len(Hmp1[0]) + 1\n            rulesFromConseq(freqSet, Hmp1, supportData, brl, minConf)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<h4><a id=\"user-content-生成关联规则\" class=\"anchor\" href=\"https://github.com/apachecn/MachineLearning/blob/master/docs/11.%E4%BD%BF%E7%94%A8Apriori%E7%AE%97%E6%B3%95%E8%BF%9B%E8%A1%8C%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.md#%E7%94%9F%E6%88%90%E5%85%B3%E8%81%94%E8%A7%84%E5%88%99\"></a>生成关联规则</h4>\n<div class=\"highlight highlight-source-python\">\n<pre><span class=\"pl-c\"><span class=\"pl-c\"># 生成关联规则\n<span class=\"pl-k\">def <span class=\"pl-en\">generateRules(<span class=\"pl-smi\">L, <span class=\"pl-smi\">supportData, <span class=\"pl-smi\">minConf<span class=\"pl-k\">=<span class=\"pl-c1\">0.7):\n    <span class=\"pl-s\"><span class=\"pl-pds\">\"\"\"generateRules\n<span class=\"pl-s\">\n<span class=\"pl-s\">    Args:\n<span class=\"pl-s\">        L 频繁项集列表\n<span class=\"pl-s\">        supportData 频繁项集支持度的字典\n<span class=\"pl-s\">        minConf 最小置信度\n<span class=\"pl-s\">    Returns:\n<span class=\"pl-s\">        bigRuleList 可信度规则列表（关于 (A-&gt;B+置信度) 3个字段的组合）\n<span class=\"pl-s\">    <span class=\"pl-pds\">\"\"\"\n    bigRuleList <span class=\"pl-k\">= []\n    <span class=\"pl-c\"><span class=\"pl-c\"># 假设 L = [[frozenset([1]), frozenset([3]), frozenset([2]), frozenset([5])], [frozenset([1, 3]), frozenset([2, 5]), frozenset([2, 3]), frozenset([3, 5])], [frozenset([2, 3, 5])]]\n    <span class=\"pl-k\">for i <span class=\"pl-k\">in <span class=\"pl-c1\">range(<span class=\"pl-c1\">1, <span class=\"pl-c1\">len(L)):\n        <span class=\"pl-c\"><span class=\"pl-c\"># 获取频繁项集中每个组合的所有元素\n        <span class=\"pl-k\">for freqSet <span class=\"pl-k\">in L[i]:\n            <span class=\"pl-c\"><span class=\"pl-c\"># 假设：freqSet= frozenset([1, 3]), H1=[frozenset([1]), frozenset([3])]\n            <span class=\"pl-c\"><span class=\"pl-c\"># 组合总的元素并遍历子元素，并转化为 frozenset 集合，再存放到 list 列表中\n            H1 <span class=\"pl-k\">= [<span class=\"pl-c1\">frozenset([item]) <span class=\"pl-k\">for item <span class=\"pl-k\">in freqSet]\n            <span class=\"pl-c\"><span class=\"pl-c\"># 2 个的组合，走 else, 2 个以上的组合，走 if\n            <span class=\"pl-k\">if (i <span class=\"pl-k\">&gt; <span class=\"pl-c1\">1):\n                rulesFromConseq(freqSet, H1, supportData, bigRuleList, minConf)\n            <span class=\"pl-k\">else:\n                calcConf(freqSet, H1, supportData, bigRuleList, minConf)\n    <span class=\"pl-k\">return bigRuleList</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</div>\n<p>到这里为止，通过调用 generateRules 函数即可得出我们所需的 <code>关联规则</code>。</p>\n<ul>\n<li>分级法： 频繁项集-&gt;关联规则\n<ul>\n<li>1.首先从一个频繁项集开始，接着创建一个规则列表，其中规则右部分只包含一个元素，然后对这个规则进行测试。</li>\n<li>2.接下来合并所有剩余规则来创建一个新的规则列表，其中规则右部包含两个元素。</li>\n<li>如下图：</li>\n<li><a href=\"https://github.com/apachecn/MachineLearning/blob/master/images/11.Apriori/%E6%89%80%E6%9C%89%E5%8F%AF%E8%83%BD%E7%9A%84%E9%A1%B9%E9%9B%86%E7%BB%84%E5%90%88.png\" target=\"_blank\"><img src=\"https://github.com/apachecn/MachineLearning/raw/master/images/11.Apriori/%E6%89%80%E6%9C%89%E5%8F%AF%E8%83%BD%E7%9A%84%E9%A1%B9%E9%9B%86%E7%BB%84%E5%90%88.png\" alt=\"所有可能的项集组合\"></a></li>\n</ul>\n</li>\n<li>最后： 每次增加频繁项集的大小，Apriori 算法都会重新扫描整个数据集，是否有优化空间呢？ 下一章：FP-growth算法等着你的到来</li>\n</ul>\n<hr>\n<ul>\n<li>作者：<a href=\"http://www.apache.wiki/display/~jiangzhonglian\">片刻</a></li>\n<li><a href=\"https://github.com/apachecn/MachineLearning\">GitHub地址</a>: <a href=\"https://github.com/apachecn/MachineLearning\">https://github.com/apachecn/MachineLearning</a></li>\n<li>版权声明：欢迎转载学习 =&gt; 请标注信息来源于 <a href=\"http://www.apachecn.org/\">ApacheCN</a></li>\n</ul></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 14:07</span> <a href=\"http://www.cnblogs.com/jiangzhonglian/\">片刻</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766194\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766194);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=209255,cb_entryId=7766194,cb_blogApp=currentBlogApp,cb_blogUserGuid='65f25823-0d89-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/11/1 14:07:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 115, "image_url": ["https://pic.cnblogs.com/face/705906/20141221204153.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "Django+Nginx+uWSGI部署", "url": "http://www.cnblogs.com/faramita2016/p/7736313.html", "author": "faramita2016", "article_desc": "一.介绍 Django的部署有多种方式，采用Nginx+uWSGI的方式是最常见的一种方式。在这种方式中，将Nginx作为服务器前端，接收Web的所有请求，统一管理请求。Nginx自己处理所有静态请求，所有非静态请求通过uWSGI传递给Django，由Django来进行处理，从而完成一次Web请求。 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/faramita2016/p/7736313.html\">Django+Nginx+uWSGI部署</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h3>一.介绍</h3>\n<p>Django的部署有多种方式，采用Nginx+uWSGI的方式是最常见的一种方式。在这种方式中，将Nginx作为服务器前端，接收Web的所有请求，统一管理请求。Nginx自己处理所有静态请求，所有非静态请求通过uWSGI传递给Django，由Django来进行处理，从而完成一次Web请求。</p>\n<p>Django工程创建：<a href=\"http://www.cnblogs.com/faramita2016/p/7736307.html\" target=\"_blank\">Django Web框架入门</a></p>\n<p> </p>\n<h3>二.安装配置</h3>\n<p>环境：Python(3.5.2)、Django(1.11.6)</p>\n<p>1.安装pip</p>\n<p><span class=\"cnblogs_code\">root@787c084a44e4:~# apt-get <span style=\"color: #0000ff\">install</span> -y python3-pip</span> </p>\n<p>2.安装uWSGI</p>\n<p><span class=\"cnblogs_code\">root@787c084a44e4:~# python3 -m pip <span style=\"color: #0000ff\">install</span> uWSGI</span> </p>\n<p>3.安装Django</p>\n<p><span class=\"cnblogs_code\">root@787c084a44e4:~# python3 -m pip <span style=\"color: #0000ff\">install</span> Django</span> </p>\n<p>4.安装Nginx</p>\n<p><span class=\"cnblogs_code\">root@787c084a44e4:~# apt-get <span style=\"color: #0000ff\">install</span> -y nginx</span> </p>\n<p>5.通过文件配置uwsgi，新建文件/root/web/uwsgi.ini</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">[uwsgi]\n# 监听IP和端口\nsocket </span>= <span style=\"color: #800080\">127.0</span>.<span style=\"color: #800080\">0.1</span>:<span style=\"color: #800080\">9090</span><span style=\"color: #000000\">\n# 项目主目录\nchdir </span>= /root/web/<span style=\"color: #000000\">Django\n# uwsgi文件路径\nmodule </span>=<span style=\"color: #000000\"> Django.wsgi:application\n# 允许主进程存在\nmaster </span>=<span style=\"color: #000000\"> True\n# 开启的进程数\nworkers </span>= <span style=\"color: #800080\">1</span><span style=\"color: #000000\">\n# 服务器退出时自动清除环境\nvacuum </span>=<span style=\"color: #000000\"> True\n# 设置工作进程请求上限\nmax</span>-requests = <span style=\"color: #800080\">1000</span><span style=\"color: #000000\">\n# 记录主进行的pid\npidfile </span>= /var/<span style=\"color: #000000\">uwsgi.pid\n# 使进程在后台运行\ndaemonize </span>= /var/uwsgi.log</pre>\n</div>\n<p>6.配置nginx虚拟主机，新建文件/etc/nginx/sites-enabled/django.conf</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\"># nginx需要连接的后端代理\nupstream django {\n    server </span><span style=\"color: #800080\">127.0</span>.<span style=\"color: #800080\">0.1</span>:<span style=\"color: #800080\">9090</span><span style=\"color: #000000\">;\n}\n\n# 虚拟主机配置\nserver {\n    # 监听端口\n    listen </span><span style=\"color: #800080\">8080</span><span style=\"color: #000000\">;\n    # 域名\n    server_name </span><span style=\"color: #800080\">127.0</span>.<span style=\"color: #800080\">0.1</span><span style=\"color: #000000\">;\n    # 编码\n    charset utf</span>-<span style=\"color: #800080\">8</span><span style=\"color: #000000\">;\n    # 静态文件路径\n    location </span>/<span style=\"color: #000000\">static {\n        alias </span>/root/web/Django/<span style=\"color: #000000\">static;\n    }\n    # 将动态请求转发到uwsgi运行的django程序\n    location </span>/<span style=\"color: #000000\"> {\n        uwsgi_pass django;\n        include </span>/etc/nginx/<span style=\"color: #000000\">uwsgi_params;\n    }\n}</span></pre>\n</div>\n<p>7.修改nginx默认运行用户，修改/etc/nginx/nginx.conf文件，user www-data修改为user root<br><br></p>\n<h3>三.验证部署</h3>\n<p>运行工程</p>\n<p><span class=\"cnblogs_code\">root@787c084a44e4:~/web# uwsgi --ini uwsgi.ini &amp; nginx</span> </p>\n<p>访问地址http://127.0.0.1:8080/list，数据和页面css样式正常</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1164036/201710/1164036-20171030203519230-277363626.png\" alt=\"\"></p>\n<p> </p>\n<h3>四.异常情况</h3>\n<p>1.出现DisabllowedHost</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1164036/201711/1164036-20171101133350951-493609802.png\" alt=\"\"></p>\n<p> 修改Django/Django/settings.py文件</p>\n<p> <span class=\"cnblogs_code\">ALLOWED_HOSTS = [<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">*</span><span style=\"color: #800000\">\"</span>]</span> </p>\n<p>2.出现静态文件403异常</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1164036/201710/1164036-20171030194143246-7311332.png\" alt=\"\"></p>\n<p>Nginx使用www-data用户运行，无web目录读取权限，修改/etc/nginx/nginx.conf文件，user www-data修改为user root</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 13:48</span> <a href=\"http://www.cnblogs.com/faramita2016/\">faramita2016</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7736313\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7736313);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=354896,cb_entryId=7736313,cb_blogApp=currentBlogApp,cb_blogUserGuid='f8aeaf22-ddd6-4398-8c34-08d496e5d6ed',cb_entryCreatedDate='2017/11/1 13:48:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 141, "image_url": ["https://pic.cnblogs.com/face/1164036/20171010124002.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "Spring、SpringMVC、SpringData + JPA 整合详解", "url": "http://www.cnblogs.com/crawl/p/7759874.html", "author": "crawl+", "article_desc": "对 Spring，SpringMVC，SpringData 和 JPA 进行了详细的整合说明，并实现了一个常见的分页操作。 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/crawl/p/7759874.html\">Spring、SpringMVC、SpringData + JPA 整合详解</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p> 原创播客，如需转载请注明出处。原文地址：<span style=\"color: #ff0000\"><a id=\"Editor_Edit_hlEntryLink\" title=\"view: Spring、SpringMVC、SpringData + JPA 整合详解\" href=\"http://www.cnblogs.com/crawl/p/7759874.html\" target=\"_blank\"><span style=\"color: #ff0000\">http://www.cnblogs.com/crawl/p/7759874.html</span></a> </span></p>\n<p>----------------------------------------------------------------------------------------------------------------------------------------------------------</p>\n<p>笔记中提供了大量的代码示例，需要说明的是，大部分代码示例都是本人所敲代码并进行测试，不足之处，请大家指正~</p>\n<p>本博客中所有言论仅代表博主本人观点，若有疑惑或者需要本系列分享中的资料工具，敬请联系 <span style=\"color: #ff0000\">qingqing_crawl@163.com</span></p>\n<p>-----------------------------------------------------------------------------------------------------------------------------------------------------------</p>\n<p><span style=\"font-size: 18px; color: #ff0000\">前言</span>：之前详细讲解过了 JPA 和 SpringData，包括 Spring 和 SpringMVC 也进行了详细的讲述。很早就想来一个整合了，因为事情比较多，所以就一直拖着。</p>\n<p>那么现在就来说说 Spring + SpringMVC + SpringData + JPA（下文中简写为 SSSP） 的整合，SSSP 的整合之后再来写一个  CRUD 的小案例，LZ 不打算把增删改查都来一遍了，只介绍一个查询所有员工信息，然后分页显示即可。大家可以对比在 JavaWeb 的过程中写的分页查询，看一看是否简单的许多。下面进行详细的介绍~</p>\n<h3>一、加入 Spring</h3>\n<p>1. 首先当然要新建一个动态的 WEB 的工程了，取名 sssp</p>\n<p>2. 加入 Spring 的 jar 包，观察这些 jar 包，大家可以发现其中<span style=\"color: #ff0000\">既包含了 Spring 的 jar 包，也包含了 SpringMVC 的 jar 包</span></p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031091555590-2098621572.png\" alt=\"\"></p>\n<p>3. web.xml 中配置启动 Spring IOC 的 <span style=\"color: #ff0000\">ContextLoaderListener</span>：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> &lt;!-- 配置启动 Spring IOC 的 Listener --&gt;\n<span style=\"color: #008080\">2</span>     &lt;context-param&gt;\n<span style=\"color: #008080\">3</span>         &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n<span style=\"color: #008080\">4</span>         &lt;param-value&gt;<span style=\"color: #ff0000\">classpath:applicationContext.xml</span>&lt;/param-value&gt;\n<span style=\"color: #008080\">5</span>     &lt;/context-param&gt;\n<span style=\"color: #008080\">6</span> \n<span style=\"color: #008080\">7</span>     &lt;listener&gt;\n<span style=\"color: #008080\">8</span>         &lt;listener-<span style=\"color: #0000ff\">class</span>&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-<span style=\"color: #0000ff\">class</span>&gt;\n<span style=\"color: #008080\">9</span>     &lt;/listener&gt;</pre>\n</div>\n<p>其中 LZ 配置的 Spring 的配置文件在 classpath 下，取名为<span style=\"color: #ff0000\"> applicationContext.xml </span></p>\n<p>4. 这一步当然就是在类路径下创建 Spring 的配置文件：applicationContext.xml 了，在这里先创建好，稍后进行配置。</p>\n<h3>二、加入 SpringMVC</h3>\n<p>1. 首先呢肯定要想到的是先导入 jar 包，这里在加入 Spring 的时候已经导入，前面也已经做了说明。</p>\n<p>2. web.xml 中配置 SpringMVC 的 <span style=\"color: #ff0000\">DispatcherServlet</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> &lt;!-- 配置 SpringMVC 的 DispatcherServlet --&gt;\n<span style=\"color: #008080\"> 2</span>     &lt;!-- 使用默认的 SpringMVC 的配置文件，为 [servlet-name]-servlet.xml 放到 WEB-INF 目录下 --&gt;\n<span style=\"color: #008080\"> 3</span>     &lt;servlet&gt;\n<span style=\"color: #008080\"> 4</span>         &lt;servlet-name&gt;springDispatcherServlet&lt;/servlet-name&gt;\n<span style=\"color: #008080\"> 5</span>         &lt;servlet-<span style=\"color: #0000ff\">class</span>&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-<span style=\"color: #0000ff\">class</span>&gt;\n<span style=\"color: #008080\"> 6</span>         &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n<span style=\"color: #008080\"> 7</span>     &lt;/servlet&gt;\n<span style=\"color: #008080\"> 8</span> \n<span style=\"color: #008080\"> 9</span>     &lt;servlet-mapping&gt;\n<span style=\"color: #008080\">10</span>         &lt;servlet-name&gt;springDispatcherServlet&lt;/servlet-name&gt;\n<span style=\"color: #008080\">11</span>         <span style=\"color: #ff0000\">&lt;url-pattern&gt;/&lt;/url-pattern&gt;</span>\n<span style=\"color: #008080\">12</span>     &lt;/servlet-mapping&gt;</pre>\n</div>\n<p>在这里呢 LZ 删除了一部分配置，我们使用默认的 SpringMVC 的配置文件，这个默认的 SpringMVC 的配置文件的名字为 ：<span style=\"color: #ff0000\">springDispatcherServlet-servlet.xml</span> ，需要注意的是，<strong><span style=\"color: #ff0000\">若使用默认的配置文件，文件的位置需要在 WEB-INF 目录下</span></strong></p>\n<p>3. 在 WEB-INF 目录下新建 SpringMVC 的配置文件： springDispatcherServlet-servlet.xml （注意：LZ 的 Eclipse 中是安装了 Spring 插件的，实质上 LZ 使用 Spring 的插件创建了 SpringMVC 的配置文件，只是文件名不同而已）</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031092829886-669302242.png\" alt=\"\"></p>\n<p>4. 然后我们对 SpringMVC 的配置文件 springDispatcherServlet-servlet.xml 进行配置</p>\n<p>1）<strong><span style=\"color: #ff0000\">加入命名空间</span></strong>，因为我们在新建配置文件的时候没有加入命名空间，所以先加入 context 和 mvc 的命名空间。那么如何加入呢，当我们打开 SpringMVC 的配置文件后，大家可以看到文件的左下角有一些选项卡（如下面图片所示），大家点击第二个选项 Namespaces，</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031093226871-983107644.png\" alt=\"\"></p>\n<p>点开后大家吧 context 和 mvc 选项挑上对勾即可。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031093504418-948998661.png\" alt=\"\"></p>\n<p>2）配置<strong><span style=\"color: #ff0000\">自动扫描的包</span></strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置自动扫描的包：只扫描有 @Controller 和 @ControllerAdvice 注解的包 </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\">2</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">context:component-scan </span><span style=\"color: #ff0000\">base-package</span><span style=\"color: #0000ff\">=\"com.software.sssp\"</span><span style=\"color: #ff0000\"> use-default-filters</span><span style=\"color: #0000ff\">=\"false\"</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">3</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">context:include-filter </span><span style=\"color: #ff0000\">type</span><span style=\"color: #0000ff\">=\"annotation\"</span><span style=\"color: #ff0000\"> expression</span><span style=\"color: #0000ff\">=\"org.springframework.stereotype.Controller\"</span> <span style=\"color: #0000ff\">/&gt;</span>\n<span style=\"color: #008080\">4</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">context:include-filter </span><span style=\"color: #ff0000\">type</span><span style=\"color: #0000ff\">=\"annotation\"</span><span style=\"color: #ff0000\"> expression</span><span style=\"color: #0000ff\">=\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> <span style=\"color: #0000ff\">/&gt;</span>\n<span style=\"color: #008080\">5</span>     <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">context:component-scan</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p>在配置自动扫描的包时，LZ 使用了<strong><span style=\"color: #ff0000\"> context:include-filter</span> </strong>子标签，目的就是<strong><span style=\"color: #ff0000\">让 SpringMVC 只扫描带有 @Controller 和 @ControllerAdvice 注解的包中的类</span></strong>，为什么要这样做呢？<span style=\"color: #ff0000\">因为我们加入 Spring 的时候只创建了 Spring 的配置文件，还没有进行配置，一会我们配置的时候，也会先配置 Spring 的 IOC 扫描的包，这样就有可能出现某些包 Spring 的容器扫描了一遍，SpringMVC 又扫描了一遍，这样就会造成有些对象会创建多次，造成资源的浪费</span>，配置 context:include-filter 标签就是为了解决这个问题，让 Spring 和 SpringMVC 只扫描各自关注的包即可。</p>\n<p>3）配置视图解析器：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置视图解析器 </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\">2</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">bean </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">3</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"prefix\"</span><span style=\"color: #ff0000\"> value</span><span style=\"color: #0000ff\">=\"/WEB-INF/views/\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">4</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"suffix\"</span><span style=\"color: #ff0000\"> value</span><span style=\"color: #0000ff\">=\".jsp\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">5</span>     <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">bean</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p>这里我们使用的是默认的 <span style=\"color: #ff0000\"><strong>InternalResourceViewResolver</strong></span> 视图解析器，然后配置了一个前缀，一个后缀。这里 InternalResourceViewResolver 视图解析器是如何解析工作的，我们配置的 prefix 和 suffix 有什么用，在 LZ 的 <a title=\"深入浅出 SpringMVC - 1\" href=\"http://www.cnblogs.com/crawl/p/7690973.html\" target=\"_blank\">深入浅出 SpringMVC - 1</a> 中已经详细介绍，大家可以自行查看。</p>\n<p>4）既然在配置视图解析器的时候我们配置了 prefix 和 suffix ，那么就需要我们在 WEB-INF 目录下新建一个 views 文件夹，用来存放我们需要的 jsp 页面</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031094812386-983468080.png\" alt=\"\"></p>\n<p> 5）然后我们把 SpringMVC 的两个标配配置上：处理静态请求资源的 <strong><span style=\"color: #ff0000\">&lt;mvc:default-servlet-handler/&gt;</span></strong> 以及 <span style=\"color: #ff0000\"><strong>&lt;mvc:annotation-driven&gt;&lt;/mvc:annotation-driven&gt;</strong></span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">mvc:default-servlet-handler</span><span style=\"color: #0000ff\">/&gt;</span>\n<span style=\"color: #008080\">2</span> <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">mvc:annotation-driven</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">mvc:annotation-driven</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<h3>三、加入 JPA</h3>\n<p>1）使用 JPA 需要导入 HIbernate 和 JPA 的 jar 包</p>\n<p>Hibernate 的 jar 包：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031100634152-2097411697.png\" alt=\"\"></p>\n<p>JPA 的 jar 包：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031100711246-2099181928.png\" alt=\"\"></p>\n<p>2）加入 c3p0 和 MySQL 的驱动</p>\n<p>c3p0：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031100914324-2102867694.png\" alt=\"\"></p>\n<p>MySQL 驱动：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031100951293-1464890427.png\" alt=\"\"></p>\n<p>3）其实在这个小案例中 LZ 还是用了 JPA 的二级缓存，所以还加入了二级缓存相关的 jar 包，和配置文件，这里就不详细说明了。</p>\n<p>关于 JPA 的知识呢，LZ 也写了几篇播客，大家可以参考：</p>\n<p><a title=\"JPA + SpringData 操作数据库原来可以这么简单 ---- 深入了解 JPA - 1\" href=\"http://www.cnblogs.com/crawl/p/7703679.html%20\" target=\"_blank\">JPA + SpringData 操作数据库原来可以这么简单 ---- 深入了解 JPA - 1</a></p>\n<p><span><a title=\"JPA + SpringData 操作数据库原来可以这么简单 ---- 深入了解 JPA - 2\" href=\"http://www.cnblogs.com/crawl/p/7704914.html%20\" target=\"_blank\">JPA + SpringData 操作数据库原来可以这么简单 ---- 深入了解 JPA - 2</a></span></p>\n<p><span><a title=\"JPA + SpringData 操作数据库原来可以这么简单 ---- 深入了解 JPA - 3\" href=\"http://www.cnblogs.com/crawl/p/7718741.html%20\" target=\"_blank\">JPA + SpringData 操作数据库原来可以这么简单 ---- 深入了解 JPA - 3</a></span></p>\n<p><span><a title=\"手把手教你解决无法创建 JPA 工程的问题\" href=\"http://www.cnblogs.com/crawl/p/7703803.html%20\" target=\"_blank\">手把手教你解决无法创建 JPA 工程的问题</a></span></p>\n<h3> 四、配置 Spring 的配置文件</h3>\n<p>1.加入 context 和 tx 的命名空间，关于如何加入命名空间，上文中进行了详细的说明，此处不再赘述。</p>\n<p>2.配置<span style=\"color: #ff0000\">自动扫描的包</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置自动扫描的包 </span><span style=\"color: #008000\">--&gt;</span>\n    <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">context:component-scan </span><span style=\"color: #ff0000\">base-package</span><span style=\"color: #0000ff\">=\"com.software.sssp\"</span><span style=\"color: #0000ff\">&gt;</span>\n        <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">context:exclude-filter </span><span style=\"color: #ff0000\">type</span><span style=\"color: #0000ff\">=\"annotation\"</span><span style=\"color: #ff0000\"> expression</span><span style=\"color: #0000ff\">=\"org.springframework.stereotype.Controller\"</span><span style=\"color: #0000ff\">/&gt;</span>\n         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">context:exclude-filter </span><span style=\"color: #ff0000\">type</span><span style=\"color: #0000ff\">=\"annotation\"</span><span style=\"color: #ff0000\"> expression</span><span style=\"color: #0000ff\">=\"org.springframework.web.bind.annotation.ControllerAdvice\"</span><span style=\"color: #0000ff\">/&gt;</span>\n    <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">context:component-scan</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p>注意，此处我们使用 <strong><span style=\"color: #ff0000\">context:exclude-filter</span></strong> 来设置不进行扫描的包，原因在上文中也已经详细说明。</p>\n<p>3.配置数据源</p>\n<p>1）在类路径下新建一个 db.properties 文件，设置连接数据库的基本信息，在这 LZ 只设置必须的属性</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #000000\">jdbc.user=root\n</span><span style=\"color: #008080\">2</span> <span style=\"color: #000000\">jdbc.password=qiqingqing\n</span><span style=\"color: #008080\">3</span> <span style=\"color: #000000\">jdbc.driverClass=com.mysql.jdbc.Driver\n</span><span style=\"color: #008080\">4</span> jdbc.jdbcUrl=jdbc:mysql://localhost:3306/sssp</pre>\n</div>\n<p>2）在 Spring 的配置文件中导入 db.properties 文件，进行数据源的配置</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置数据源 </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\"> 2</span>     <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 导入资源配置文件 </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\"> 3</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">context:property-placeholder </span><span style=\"color: #ff0000\">location</span><span style=\"color: #0000ff\">=\"classpath:db.properties\"</span><span style=\"color: #0000ff\">/&gt;</span>\n<span style=\"color: #008080\"> 4</span>     \n<span style=\"color: #008080\"> 5</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">bean </span><span style=\"color: #ff0000\">id</span><span style=\"color: #0000ff\">=\"dataSource\"</span><span style=\"color: #ff0000\"> class</span><span style=\"color: #0000ff\">=\"com.mchange.v2.c3p0.ComboPooledDataSource\"</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 6</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"user\"</span><span style=\"color: #ff0000\"> value</span><span style=\"color: #0000ff\">=\"${jdbc.user}\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 7</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"password\"</span><span style=\"color: #ff0000\"> value</span><span style=\"color: #0000ff\">=\"${jdbc.password}\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 8</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"driverClass\"</span><span style=\"color: #ff0000\"> value</span><span style=\"color: #0000ff\">=\"${jdbc.driverClass}\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 9</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"jdbcUrl\"</span><span style=\"color: #ff0000\"> value</span><span style=\"color: #0000ff\">=\"${jdbc.jdbcUrl}\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">10</span>     <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">bean</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p>至此数据源的配置已经结束，在 LZ 的博客中，LZ 不只强调了一次进行分步测试或单元测试的重要性，可以为我们避免不必要的麻烦，接下来就看看我们的数据源是否配置成功。LZ 新建一个测试类 SSSPTest，先来测试一下数据源：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> SSSPTest {\n</span><span style=\"color: #008080\"> 2</span>     \n<span style=\"color: #008080\"> 3</span>     <span style=\"color: #0000ff\">private</span> ApplicationContext ctx = <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">;\n</span><span style=\"color: #008080\"> 4</span>     \n<span style=\"color: #008080\"> 5</span> <span style=\"color: #000000\">    {\n</span><span style=\"color: #008080\"> 6</span>         ctx = <span style=\"color: #0000ff\">new</span> ClassPathXmlApplicationContext(\"applicationContext.xml\"<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\"> 8</span>     \n<span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">    @Test\n</span><span style=\"color: #008080\">10</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span> testDataSource() <span style=\"color: #0000ff\">throws</span><span style=\"color: #000000\"> SQLException {\n</span><span style=\"color: #008080\">11</span>         DataSource dataSource = ctx.getBean(DataSource.<span style=\"color: #0000ff\">class</span><span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">12</span> <span style=\"color: #000000\">        System.out.println(dataSource.getConnection());\n</span><span style=\"color: #008080\">13</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">14</span> \n<span style=\"color: #008080\">15</span> }</pre>\n</div>\n<p>执行 testDataSource 方法，结果为：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031102933402-2059068882.png\" alt=\"\"></p>\n<p>这就证明我们的数据源获取成功！</p>\n<p>4. 配置 JPA 的 <strong><span style=\"color: #ff0000\">EntityManagerFactory </span></strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置 JPA 的 EntityManagerFactory </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\"> 2</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">bean </span><span style=\"color: #ff0000\">id</span><span style=\"color: #0000ff\">=\"entityManagerFactory\"</span><span style=\"color: #ff0000\"> class</span><span style=\"color: #0000ff\">=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 3</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"dataSource\"</span><span style=\"color: #ff0000\"> ref</span><span style=\"color: #0000ff\">=\"dataSource\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 4</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"packagesToScan\"</span><span style=\"color: #ff0000\"> value</span><span style=\"color: #0000ff\">=\"com.software.sssp\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 5</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"jpaVendorAdapter\"</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 6</span>             <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">bean </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">bean</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 7</span>         <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 8</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"jpaProperties\"</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 9</span>             <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">props</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">10</span>                 <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">prop </span><span style=\"color: #ff0000\">key</span><span style=\"color: #0000ff\">=\"hibernate.ejb.naming_strategy\"</span><span style=\"color: #0000ff\">&gt;</span>org.hibernate.cfg.ImprovedNamingStrategy<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">prop</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">11</span>                 <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">prop </span><span style=\"color: #ff0000\">key</span><span style=\"color: #0000ff\">=\"hibernate.hbm2ddl.auto\"</span><span style=\"color: #0000ff\">&gt;</span>update<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">prop</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">12</span>                 <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">prop </span><span style=\"color: #ff0000\">key</span><span style=\"color: #0000ff\">=\"hibernate.show_sql\"</span><span style=\"color: #0000ff\">&gt;</span>true<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">prop</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">13</span>                 <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">prop </span><span style=\"color: #ff0000\">key</span><span style=\"color: #0000ff\">=\"hibernate.format_sql\"</span><span style=\"color: #0000ff\">&gt;</span>true<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">prop</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">14</span>                 <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">prop </span><span style=\"color: #ff0000\">key</span><span style=\"color: #0000ff\">=\"hibernate.dialect\"</span><span style=\"color: #0000ff\">&gt;</span>org.hibernate.dialect.MySQL5InnoDBDialect<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">prop</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">15</span>                 \n<span style=\"color: #008080\">16</span>                 <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">prop </span><span style=\"color: #ff0000\">key</span><span style=\"color: #0000ff\">=\"hibernate.cache.use_second_level_cache\"</span><span style=\"color: #0000ff\">&gt;</span>true<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">prop</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">17</span>                 <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">prop </span><span style=\"color: #ff0000\">key</span><span style=\"color: #0000ff\">=\"hibernate.cache.region.factory_class\"</span><span style=\"color: #0000ff\">&gt;</span>org.hibernate.cache.ehcache.EhCacheRegionFactory<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">prop</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">18</span>                 <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">prop </span><span style=\"color: #ff0000\">key</span><span style=\"color: #0000ff\">=\"hibernate.cache.use_query_cache\"</span><span style=\"color: #0000ff\">&gt;</span>true<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">prop</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">19</span>             <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">props</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">20</span>         <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">21</span>         <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置使用二级缓存的模式：只允许带有 @Cacheable 的类使用二级缓存 </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\">22</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"sharedCacheMode\"</span><span style=\"color: #ff0000\"> value</span><span style=\"color: #0000ff\">=\"ENABLE_SELECTIVE\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">23</span>     <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">bean</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p>解释一下，第 3 行配置数据源，4 行配置扫描的包，5 行配置 JPA 提供商的适配器，8 行配置 JPA 实现产品即 Hibernate 的基本属性，22 行配置二级缓存相关。</p>\n<p>5. 配置 <strong><span style=\"color: #ff0000\">JPA 的注解和基于注解的事务操作</span></strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置 JPA 的注解 </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\">2</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">bean </span><span style=\"color: #ff0000\">id</span><span style=\"color: #0000ff\">=\"transactionManager\"</span><span style=\"color: #ff0000\"> class</span><span style=\"color: #0000ff\">=\"org.springframework.orm.jpa.JpaTransactionManager\"</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">3</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">property </span><span style=\"color: #ff0000\">name</span><span style=\"color: #0000ff\">=\"entityManagerFactory\"</span><span style=\"color: #ff0000\"> ref</span><span style=\"color: #0000ff\">=\"entityManagerFactory\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">property</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">4</span>     <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">bean</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">5</span>     \n<span style=\"color: #008080\">6</span>     <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置基于注解的事务 </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\">7</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">tx:annotation-driven </span><span style=\"color: #ff0000\">transaction-manager</span><span style=\"color: #0000ff\">=\"transactionManager\"</span><span style=\"color: #0000ff\">/&gt;</span></pre>\n</div>\n<p>到这里 JPA 的配置已经完成了，我们再来测试一下 JPA 是否配置成功</p>\n<p>我们新建我们需要的两个实体类，Employee 和 Department，为它们添加基本的 JPA 注解</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">package</span><span style=\"color: #000000\"> com.software.sssp.entity;\n</span><span style=\"color: #008080\"> 2</span> \n<span style=\"color: #008080\"> 3</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> java.util.Date;\n</span><span style=\"color: #008080\"> 4</span> \n<span style=\"color: #008080\"> 5</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.Entity;\n</span><span style=\"color: #008080\"> 6</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.FetchType;\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.GeneratedValue;\n</span><span style=\"color: #008080\"> 8</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.Id;\n</span><span style=\"color: #008080\"> 9</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.JoinColumn;\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.ManyToOne;\n</span><span style=\"color: #008080\">11</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.Table;\n</span><span style=\"color: #008080\">12</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.Temporal;\n</span><span style=\"color: #008080\">13</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.TemporalType;\n</span><span style=\"color: #008080\">14</span> \n<span style=\"color: #008080\">15</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> org.springframework.format.annotation.DateTimeFormat;\n</span><span style=\"color: #008080\">16</span> \n<span style=\"color: #008080\">17</span> @Table(name=\"SSSP_EMPLOYEES\"<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">18</span> <span style=\"color: #000000\">@Entity\n</span><span style=\"color: #008080\">19</span> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Employee {\n</span><span style=\"color: #008080\">20</span>     \n<span style=\"color: #008080\">21</span>     <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> Integer id;\n</span><span style=\"color: #008080\">22</span>     \n<span style=\"color: #008080\">23</span>     <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> String lastName;\n</span><span style=\"color: #008080\">24</span>     \n<span style=\"color: #008080\">25</span>     <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> String email;\n</span><span style=\"color: #008080\">26</span>     \n<span style=\"color: #008080\">27</span>     @DateTimeFormat(pattern=\"yyyy-MM-dd\"<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">28</span>     <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> Date Birth;\n</span><span style=\"color: #008080\">29</span>     \n<span style=\"color: #008080\">30</span>     <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> Date createTime;\n</span><span style=\"color: #008080\">31</span>     \n<span style=\"color: #008080\">32</span>     <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> Department department;\n</span><span style=\"color: #008080\">33</span> \n<span style=\"color: #008080\">34</span> <span style=\"color: #000000\">    @GeneratedValue\n</span><span style=\"color: #008080\">35</span> <span style=\"color: #000000\">    @Id\n</span><span style=\"color: #008080\">36</span>     <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Integer getId() {\n</span><span style=\"color: #008080\">37</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> id;\n</span><span style=\"color: #008080\">38</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">39</span> \n<span style=\"color: #008080\">40</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setId(Integer id) {\n</span><span style=\"color: #008080\">41</span>         <span style=\"color: #0000ff\">this</span>.id =<span style=\"color: #000000\"> id;\n</span><span style=\"color: #008080\">42</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">43</span> \n<span style=\"color: #008080\">44</span>     <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> String getLastName() {\n</span><span style=\"color: #008080\">45</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> lastName;\n</span><span style=\"color: #008080\">46</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">47</span> \n<span style=\"color: #008080\">48</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setLastName(String lastName) {\n</span><span style=\"color: #008080\">49</span>         <span style=\"color: #0000ff\">this</span>.lastName =<span style=\"color: #000000\"> lastName;\n</span><span style=\"color: #008080\">50</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">51</span> \n<span style=\"color: #008080\">52</span>     <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> String getEmail() {\n</span><span style=\"color: #008080\">53</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> email;\n</span><span style=\"color: #008080\">54</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">55</span> \n<span style=\"color: #008080\">56</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setEmail(String email) {\n</span><span style=\"color: #008080\">57</span>         <span style=\"color: #0000ff\">this</span>.email =<span style=\"color: #000000\"> email;\n</span><span style=\"color: #008080\">58</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">59</span> \n<span style=\"color: #008080\">60</span> <span style=\"color: #000000\">    @Temporal(TemporalType.DATE)\n</span><span style=\"color: #008080\">61</span>     <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Date getBirth() {\n</span><span style=\"color: #008080\">62</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> Birth;\n</span><span style=\"color: #008080\">63</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">64</span> \n<span style=\"color: #008080\">65</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setBirth(Date birth) {\n</span><span style=\"color: #008080\">66</span>         Birth =<span style=\"color: #000000\"> birth;\n</span><span style=\"color: #008080\">67</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">68</span> \n<span style=\"color: #008080\">69</span> <span style=\"color: #000000\">    @Temporal(TemporalType.TIMESTAMP)\n</span><span style=\"color: #008080\">70</span>     <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Date getCreateTime() {\n</span><span style=\"color: #008080\">71</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> createTime;\n</span><span style=\"color: #008080\">72</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">73</span> \n<span style=\"color: #008080\">74</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setCreateTime(Date createTime) {\n</span><span style=\"color: #008080\">75</span>         <span style=\"color: #0000ff\">this</span>.createTime =<span style=\"color: #000000\"> createTime;\n</span><span style=\"color: #008080\">76</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">77</span> \n<span style=\"color: #008080\">78</span>     @JoinColumn(name=\"DEPARTMENT_ID\"<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">79</span>     @ManyToOne(fetch=<span style=\"color: #000000\">FetchType.LAZY)\n</span><span style=\"color: #008080\">80</span>     <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Department getDepartment() {\n</span><span style=\"color: #008080\">81</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> department;\n</span><span style=\"color: #008080\">82</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">83</span> \n<span style=\"color: #008080\">84</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setDepartment(Department department) {\n</span><span style=\"color: #008080\">85</span>         <span style=\"color: #0000ff\">this</span>.department =<span style=\"color: #000000\"> department;\n</span><span style=\"color: #008080\">86</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">87</span>     \n<span style=\"color: #008080\">88</span> }</pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">package</span><span style=\"color: #000000\"> com.software.sssp.entity;\n</span><span style=\"color: #008080\"> 2</span> \n<span style=\"color: #008080\"> 3</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.Cacheable;\n</span><span style=\"color: #008080\"> 4</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.Entity;\n</span><span style=\"color: #008080\"> 5</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.GeneratedValue;\n</span><span style=\"color: #008080\"> 6</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.Id;\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> javax.persistence.Table;\n</span><span style=\"color: #008080\"> 8</span> \n<span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">@Cacheable\n</span><span style=\"color: #008080\">10</span> @Table(name=\"SSSP_DEPARTMENT\"<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">11</span> <span style=\"color: #000000\">@Entity\n</span><span style=\"color: #008080\">12</span> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Department {\n</span><span style=\"color: #008080\">13</span>     \n<span style=\"color: #008080\">14</span>     <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> Integer id;\n</span><span style=\"color: #008080\">15</span>     \n<span style=\"color: #008080\">16</span>     <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> String departmentName;\n</span><span style=\"color: #008080\">17</span> \n<span style=\"color: #008080\">18</span> <span style=\"color: #000000\">    @GeneratedValue\n</span><span style=\"color: #008080\">19</span> <span style=\"color: #000000\">    @Id\n</span><span style=\"color: #008080\">20</span>     <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Integer getId() {\n</span><span style=\"color: #008080\">21</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> id;\n</span><span style=\"color: #008080\">22</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">23</span> \n<span style=\"color: #008080\">24</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setId(Integer id) {\n</span><span style=\"color: #008080\">25</span>         <span style=\"color: #0000ff\">this</span>.id =<span style=\"color: #000000\"> id;\n</span><span style=\"color: #008080\">26</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">27</span> \n<span style=\"color: #008080\">28</span>     <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> String getDepartmentName() {\n</span><span style=\"color: #008080\">29</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> departmentName;\n</span><span style=\"color: #008080\">30</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">31</span> \n<span style=\"color: #008080\">32</span>     <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setDepartmentName(String departmentName) {\n</span><span style=\"color: #008080\">33</span>         <span style=\"color: #0000ff\">this</span>.departmentName =<span style=\"color: #000000\"> departmentName;\n</span><span style=\"color: #008080\">34</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">35</span>     \n<span style=\"color: #008080\">36</span> }</pre>\n</div>\n<p>然后同样是在 SSSPTest 中执行测试数据源的那个方法，大家会发现，数据库中多出了两张表</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031103424183-2025038407.png\" alt=\"\"></p>\n<p>这就证明 JPA 配置成功</p>\n<p>6. 加入 SpringData</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置 SpringData </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\">2</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">jpa:repositories </span><span style=\"color: #ff0000\">base-package</span><span style=\"color: #0000ff\">=\"com.software.sssp\"</span> \n<span style=\"color: #008080\">3</span> <span style=\"color: #ff0000\">                                entity-manager-factory-ref</span><span style=\"color: #0000ff\">=\"entityManagerFactory\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">jpa:repositories</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<h3> 五、web.xml 中杂项配置</h3>\n<p>1. 因为案例中会用到中文，我们配置一个<span style=\"color: #ff0000\">字符编码的过滤器</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置字符编码过滤器 </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\"> 2</span>     <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 字符编码过滤器必须配置在所有过滤器的最前面! </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\"> 3</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">filter</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 4</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">filter-name</span><span style=\"color: #0000ff\">&gt;</span>CharacterEncodingFilter<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">filter-name</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 5</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">filter-class</span><span style=\"color: #0000ff\">&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">filter-class</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 6</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">init-param</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 7</span>             <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">param-name</span><span style=\"color: #0000ff\">&gt;</span>encoding<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">param-name</span><span style=\"color: #0000ff\">&gt;</span>        \n<span style=\"color: #008080\"> 8</span>             <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">param-value</span><span style=\"color: #0000ff\">&gt;</span>UTF-8<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">param-value</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 9</span>         <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">init-param</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">10</span>     <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">filter</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">11</span>     \n<span style=\"color: #008080\">12</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">filter-mapping</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">13</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">filter-name</span><span style=\"color: #0000ff\">&gt;</span>CharacterEncodingFilter<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">filter-name</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">14</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">url-pattern</span><span style=\"color: #0000ff\">&gt;</span>/*<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">url-pattern</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">15</span>     <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">filter-mapping</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p><strong><span style=\"color: #ff0000\">需要注意的是，这个字符编码过滤器需要配置在所有过滤器的最前面。</span></strong></p>\n<p>2.因为我们的案例中使用 ResultFul 风格的 URL ，所以在配置一个<strong><span style=\"color: #ff0000\">将 POST 请求转换为 PUT DELETE 请求的 Filter</span></strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #008000\">&lt;!--</span><span style=\"color: #008000\"> 配置将 POST 请求转换为 PUT DELETE 请求的 Filter </span><span style=\"color: #008000\">--&gt;</span>\n<span style=\"color: #008080\"> 2</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">filter</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 3</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">filter-name</span><span style=\"color: #0000ff\">&gt;</span>HiddenHttpMethodFilter<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">filter-name</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 4</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">filter-class</span><span style=\"color: #0000ff\">&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">filter-class</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 5</span>     <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">filter</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 6</span>     \n<span style=\"color: #008080\"> 7</span>     <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">filter-mapping</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 8</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">filter-name</span><span style=\"color: #0000ff\">&gt;</span>HiddenHttpMethodFilter<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">filter-name</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\"> 9</span>         <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">url-pattern</span><span style=\"color: #0000ff\">&gt;</span>/*<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">url-pattern</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #008080\">10</span>     <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">filter-mapping</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p>至此呢，我们的 SSSP 整合所有的配置和测试就完成了！</p>\n<h3>六、实现分页操作</h3>\n<p>SSSP 整合完成后呢，数据库中也生成了对应的数据表，LZ 向数据库中写入了十几条测试数据。然后我们实现分页查询显示的效果。</p>\n<p>思路分析：</p>\n<p>1.<strong><span style=\"color: #ff0000\">DAO 层</span></strong>：直接调用 <strong><span style=\"color: #ff0000\">PagingAndSortingRepository</span> </strong>的 <strong><span style=\"color: #ff0000\">findAll(Pageable pageable)</span></strong> 方法，返回 Page 对象即可（注：关于 PagingAndSortingRepository  的使用 LZ 在介绍 SpringData 的博客已经详细讲解过了）。</p>\n<p>2.<strong><span style=\"color: #ff0000\">Service 层</span></strong>：把 Controller 传入的 pageNo 和 pageSize 封装成为 Pageable 对象，然后调用 DAO 层的方法即可。</p>\n<p>3.<strong><span style=\"color: #ff0000\">Controller 层</span></strong>：获取 pageNo 并对 pageNo 进行校验，然后调用 Service  层的方法返回 Page 对象，将 Page 对象放入到 Request 域中进行页面转发。</p>\n<p>4.JSP 页面：数据的显示</p>\n<p>思路分析完成之后进行编码实现。</p>\n<p>EmployeeRepository：只定义一个继承 <strong><span style=\"color: #ff0000\">JpaRepository</span> </strong>的接口即可。</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">interface</span> EmployeeRepository <span style=\"color: #0000ff\">extends</span> JpaRepository&lt;Employee, Integer&gt;<span style=\"color: #000000\"> {\n</span><span style=\"color: #008080\">2</span>     \n<span style=\"color: #008080\">3</span> \n<span style=\"color: #008080\">4</span> }</pre>\n</div>\n<p>EmployeeService：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #000000\">@Service\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> EmployeeService {\n</span><span style=\"color: #008080\"> 3</span> \n<span style=\"color: #008080\"> 4</span> <span style=\"color: #000000\">    @Autowired\n</span><span style=\"color: #008080\"> 5</span>     <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> EmployeeRepository employeeRepository;\n</span><span style=\"color: #008080\"> 6</span>     \n<span style=\"color: #008080\"> 7</span>     @Transactional(readOnly=<span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 8</span>     <span style=\"color: #0000ff\">public</span> Page&lt;Employee&gt; getPage(<span style=\"color: #0000ff\">int</span> pageNo, <span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> pageSize) {\n</span><span style=\"color: #008080\"> 9</span>         PageRequest pageable = <span style=\"color: #0000ff\">new</span> PageRequest(<span style=\"color: #ff0000\">pageNo - 1</span><span style=\"color: #000000\">, pageSize);\n</span><span style=\"color: #008080\">10</span>         <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> employeeRepository.findAll(pageable);\n</span><span style=\"color: #008080\">11</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">12</span>     \n<span style=\"color: #008080\">13</span> }</pre>\n</div>\n<p>定义了一个 getPage 方法，为该方法添加只读的事务操作注解，然后调用 DAO 的 findAll() 方法即可，<span style=\"color: #ff0000\"><strong>注意 pageNo 是从 0 开始的，所以要对传入的 pageNo 进行 - 1 的处</strong></span>理。</p>\n<p>EmployeeHandler：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #000000\">@Controller\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> EmployeeHandler {\n</span><span style=\"color: #008080\"> 3</span>     \n<span style=\"color: #008080\"> 4</span> <span style=\"color: #000000\">    @Autowired\n</span><span style=\"color: #008080\"> 5</span>     <span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> EmployeeService employeeService;\n</span><span style=\"color: #008080\"> 6</span>     \n<span style=\"color: #008080\"> 7</span>     @RequestMapping(\"/emps\"<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 8</span>     <span style=\"color: #0000ff\">public</span> String list(@RequestParam(value=\"pageNo\", required=<span style=\"color: #0000ff\">false</span>, defaultValue=\"1\"<span style=\"color: #000000\">) String pageNoStr,\n</span><span style=\"color: #008080\"> 9</span>             Map&lt;String, Object&gt;<span style=\"color: #000000\"> map) {\n</span><span style=\"color: #008080\">10</span>         \n<span style=\"color: #008080\">11</span>         <span style=\"color: #0000ff\">int</span> pageNo = 1<span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">12</span>         \n<span style=\"color: #008080\">13</span>         <span style=\"color: #0000ff\">try</span><span style=\"color: #000000\"> {\n</span><span style=\"color: #008080\">14</span>             <span style=\"color: #008000\">//</span><span style=\"color: #008000\">对 pageNo 的校验</span>\n<span style=\"color: #008080\">15</span>             pageNo =<span style=\"color: #000000\"> Integer.parseInt(pageNoStr);\n</span><span style=\"color: #008080\">16</span>             <span style=\"color: #0000ff\">if</span>(pageNo &lt; 0<span style=\"color: #000000\">) {\n</span><span style=\"color: #008080\">17</span>                 pageNo = 1<span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">18</span> <span style=\"color: #000000\">            }\n</span><span style=\"color: #008080\">19</span>         } <span style=\"color: #0000ff\">catch</span><span style=\"color: #000000\"> (Exception e) {}\n</span><span style=\"color: #008080\">20</span>         \n<span style=\"color: #008080\">21</span>         Page&lt;Employee&gt; page = employeeService.getPage(pageNo, 5<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">22</span>         map.put(\"page\"<span style=\"color: #000000\">, page);\n</span><span style=\"color: #008080\">23</span>         \n<span style=\"color: #008080\">24</span>         <span style=\"color: #0000ff\">return</span> \"emp/list\"<span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">25</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">26</span> \n<span style=\"color: #008080\">27</span> }</pre>\n</div>\n<p>创建了一个 list 方法，传入的 pageNoStr 被定义成了 String 类型的，11 行定义了一个 int 型的 pageNo，将 pageNoStr 强转为 int 型，若传入的是一个非数值型的字符串，则会出异常，出了异常不必理会，pageNo 还是一开始定义的那个 pageNo，为 1。然后调用 Service 层的方法，定义 pageSize 为 5，得到 Page 对象，放入到 request  域中。</p>\n<p>list.jsp 进行数据的显示即可：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> &lt;c:<span style=\"color: #0000ff\">if</span> test=\"${page == null || page.numberOfElements == 0 }\"&gt;\n<span style=\"color: #008080\"> 2</span>         &lt;h3&gt;没有员工记录！&lt;/h3&gt;\n<span style=\"color: #008080\"> 3</span>     &lt;/c:<span style=\"color: #0000ff\">if</span>&gt;\n<span style=\"color: #008080\"> 4</span>     \n<span style=\"color: #008080\"> 5</span>     &lt;c:<span style=\"color: #0000ff\">if</span> test=\"${page != null &amp;&amp; page.numberOfElements &gt; 0 }\"&gt;\n<span style=\"color: #008080\"> 6</span>     \n<span style=\"color: #008080\"> 7</span>         &lt;table border=\"1\" cellspacing=\"0\" cellpadding=\"10\"&gt;\n<span style=\"color: #008080\"> 8</span>         \n<span style=\"color: #008080\"> 9</span>             &lt;tr&gt;\n<span style=\"color: #008080\">10</span>                 &lt;th&gt;Id&lt;/th&gt;\n<span style=\"color: #008080\">11</span>                 &lt;th&gt;LastName&lt;/th&gt;\n<span style=\"color: #008080\">12</span>                 \n<span style=\"color: #008080\">13</span>                 &lt;th&gt;Email&lt;/th&gt;\n<span style=\"color: #008080\">14</span>                 &lt;th&gt;Birth&lt;/th&gt;\n<span style=\"color: #008080\">15</span>                 \n<span style=\"color: #008080\">16</span>                 &lt;th&gt;CreateTime&lt;/th&gt;\n<span style=\"color: #008080\">17</span>                 &lt;th&gt;DepartmentName&lt;/th&gt;\n<span style=\"color: #008080\">18</span>                 \n<span style=\"color: #008080\">19</span>                 &lt;th&gt;Edit&lt;/th&gt;\n<span style=\"color: #008080\">20</span>                 &lt;th&gt;Delete&lt;/th&gt;\n<span style=\"color: #008080\">21</span>             &lt;/tr&gt;\n<span style=\"color: #008080\">22</span>             \n<span style=\"color: #008080\">23</span>             &lt;c:forEach items=\"${page.content }\" var=\"emp\"&gt;\n<span style=\"color: #008080\">24</span>                 \n<span style=\"color: #008080\">25</span>                 &lt;tr&gt;\n<span style=\"color: #008080\">26</span>                     &lt;td&gt;${emp.id }&lt;/td&gt;\n<span style=\"color: #008080\">27</span>                     &lt;td&gt;${emp.lastName }&lt;/td&gt;\n<span style=\"color: #008080\">28</span>                     \n<span style=\"color: #008080\">29</span>                     &lt;td&gt;${emp.email }&lt;/td&gt;\n<span style=\"color: #008080\">30</span>                     &lt;td&gt;${emp.birth }&lt;/td&gt;\n<span style=\"color: #008080\">31</span>                     \n<span style=\"color: #008080\">32</span>                     &lt;td&gt;${emp.createTime }&lt;/td&gt;\n<span style=\"color: #008080\">33</span>                     <span style=\"color: #ff0000\"><strong>&lt;td&gt;${emp.department.departmentName }&lt;/td&gt;</strong></span>\n<span style=\"color: #008080\">34</span>                     \n<span style=\"color: #008080\">35</span>                     &lt;td&gt;\n<span style=\"color: #008080\">36</span>                         &lt;a href=\"${pageContext.request.contextPath }/emp/${emp.id}\"&gt;Edit&lt;/a&gt;\n<span style=\"color: #008080\">37</span>                     &lt;/td&gt;\n<span style=\"color: #008080\">38</span>                     &lt;td&gt;\n<span style=\"color: #008080\">39</span>                         &lt;a href=\"${pageContext.request.contextPath }/emp/${emp.id}\" <span style=\"color: #0000ff\">class</span>=\"delete\"&gt;Delete&lt;/a&gt;\n<span style=\"color: #008080\">40</span>                         &lt;input type=\"hidden\" value=\"${emp.lastName }\"&gt;\n<span style=\"color: #008080\">41</span>                     &lt;/td&gt;\n<span style=\"color: #008080\">42</span>                 &lt;/tr&gt;\n<span style=\"color: #008080\">43</span>                 \n<span style=\"color: #008080\">44</span>             &lt;/c:forEach&gt;\n<span style=\"color: #008080\">45</span>             \n<span style=\"color: #008080\">46</span>             &lt;tr&gt;\n<span style=\"color: #008080\">47</span>                 &lt;td colspan=\"8\"&gt;\n<span style=\"color: #008080\">48</span>                     共 ${page.totalElements} 条记录  &amp;nbsp;&amp;nbsp;&amp;<span style=\"color: #000000\">nbsp;\n</span><span style=\"color: #008080\">49</span>                     共 ${page.totalPages} 页  &amp;nbsp;&amp;nbsp;&amp;<span style=\"color: #000000\">nbsp;\n</span><span style=\"color: #008080\">50</span>                     当前为 ${page.number + 1 } 页  &amp;nbsp;&amp;nbsp;&amp;<span style=\"color: #000000\">nbsp;\n</span><span style=\"color: #008080\">51</span>                     \n<span style=\"color: #008080\">52</span>                     &lt;c:<span style=\"color: #0000ff\">if</span> test=\"${page.number + 1 &gt; 1 }\"&gt;\n<span style=\"color: #008080\">53</span>                         &lt;a href=\"?pageNo=${page.number + 1 - 1 }\"&gt;上一页&lt;/a&gt;  &amp;nbsp;&amp;nbsp;&amp;<span style=\"color: #000000\">nbsp;\n</span><span style=\"color: #008080\">54</span>                     &lt;/c:<span style=\"color: #0000ff\">if</span>&gt;\n<span style=\"color: #008080\">55</span>                     \n<span style=\"color: #008080\">56</span>                     &lt;c:<span style=\"color: #0000ff\">if</span> test=\"${page.number + 1 &lt; page.totalPages}\"&gt;\n<span style=\"color: #008080\">57</span>                         &lt;a href=\"?pageNo=${page.number + 1 + 1 }\"&gt;下一页&lt;/a&gt;  &amp;nbsp;&amp;nbsp;&amp;<span style=\"color: #000000\">nbsp;\n</span><span style=\"color: #008080\">58</span>                     &lt;/c:<span style=\"color: #0000ff\">if</span>&gt;\n<span style=\"color: #008080\">59</span>                 &lt;/td&gt;\n<span style=\"color: #008080\">60</span>             &lt;/tr&gt;\n<span style=\"color: #008080\">61</span>                         \n<span style=\"color: #008080\">62</span>         &lt;/table&gt;\n<span style=\"color: #008080\">63</span>         \n<span style=\"color: #008080\">64</span>     &lt;/c:<span style=\"color: #0000ff\">if</span>&gt;</pre>\n</div>\n<p>我们注意第 33 行，在显示 DepartmentName 时使用的是<strong><span style=\"color: #ff0000\">级联属性</span></strong>，<span style=\"color: #ff0000\">为了提高效率，减少 SQL 语句，需要设置 Employee 中的 @ManyToOne(fetch=FetchType.LAZY),但是进行了如此设置使用级联属性会发生懒加载异常</span>(添加了 @Transactional 注解的事务方法，entityManager 的作用范围是从方法开始到方法结束，使用 fetch 为 LAZY，获取的是一个代理对象，若再获取级联属性，则会发生懒加载异常)，所以需要在 web.xml 中配置能够解决懒加载异常问题的 <strong><span style=\"color: #ff0000\">OpenEntityManagerInViewFilter</span></strong>：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> &lt;!-- 配置 OpenEntityManagerInViewFilter,解决懒加载异常的问题 --&gt;\n<span style=\"color: #008080\"> 2</span>     &lt;filter&gt;\n<span style=\"color: #008080\"> 3</span>         &lt;filter-name&gt;OpenEntityManagerInViewFilter&lt;/filter-name&gt;\n<span style=\"color: #008080\"> 4</span>         &lt;filter-<span style=\"color: #0000ff\">class</span>&gt;org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter&lt;/filter-<span style=\"color: #0000ff\">class</span>&gt;\n<span style=\"color: #008080\"> 5</span>     &lt;/filter&gt;\n<span style=\"color: #008080\"> 6</span>     \n<span style=\"color: #008080\"> 7</span>     &lt;filter-mapping&gt;\n<span style=\"color: #008080\"> 8</span>         &lt;filter-name&gt;OpenEntityManagerInViewFilter&lt;/filter-name&gt;\n<span style=\"color: #008080\"> 9</span>         &lt;url-pattern&gt;<span style=\"color: #008000\">/*</span><span style=\"color: #008000\">&lt;/url-pattern&gt;\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #008000\">    &lt;/filter-mapping&gt;</span></pre>\n</div>\n<p>最后呢定义一个程序的入口 index.jsp ,其中定义一个显示员工的超链接：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> &lt;h4&gt;\n<span style=\"color: #008080\">2</span>     &lt;a href=\"emps\"&gt;List All Employees&lt;/a&gt;\n<span style=\"color: #008080\">3</span> &lt;/h4&gt;</pre>\n</div>\n<p>到此我们分页显示的功能就完成了，贴一下运行结果：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1105175/201710/1105175-20171031155459699-1372530649.png\" alt=\"\"></p>\n<p>相比于原生的 JavaWeb 实现分页操作是不是很简单呢，效率也提高了很多。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 11:14</span> <a href=\"http://www.cnblogs.com/crawl/\">crawl+</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7759874\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7759874);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=332470,cb_entryId=7759874,cb_blogApp=currentBlogApp,cb_blogUserGuid='1e18120f-32f1-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/1 11:14:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 444, "image_url": ["https://pic.cnblogs.com/face/1105175/20170212224944.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "pandas.DataFrame学习系列1——定义及属性", "url": "http://www.cnblogs.com/snow-Andy/p/7762151.html", "author": "snow-Andy", "article_desc": "定义： DataFrame是二维的、大小可变的、成分混合的、具有标签化坐标轴（行和列）的表数据结构。基于行和列标签进行计算。可以被看作是为序列对象（Series）提供的类似字典的一个容器，是pandas中主要的数据结构。 形式： 参数含义： 其他构建DataFrame类型的方法： 举例： 属性： 获 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div class=\"post\">\r\n\t<div class=\"postTitle\">\r\n\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/snow-Andy/p/7762151.html\">pandas.DataFrame学习系列1——定义及属性</a>\r\n\t</div>\r\n\t<div id=\"cnblogs_post_body\"><p><strong><span style=\"font-size: 16px\">定义：</span></strong></p>\n<p>DataFrame是二维的、大小可变的、成分混合的、具有标签化坐标轴（行和列）的表数据结构。基于行和列标签进行计算。可以被看作是为序列对象（Series）提供的类似字典的一个容器，是pandas中主要的数据结构。</p>\n<p><strong style=\"font-size: 16px\">形式：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">class</span> pandas.DataFrame(data=None, index=None, columns=None, dtype=None, copy=False)</pre>\n</div>\n<p><strong><span style=\"font-size: 16px\">参数含义：</span></strong></p>\n<div class=\"cnblogs_code\">\n<pre>data : numpy ndarray（多维数组）（结构化或同质化的）, dict（字典）, <span style=\"color: #0000ff\">or</span><span> DataFrame（数据表）</span><span>如果是字典类型，该字典可以包含序列，数组，常量或类列表型对象</span></pre>\n<pre><span style=\"color: #000000\">index : Index </span><span style=\"color: #0000ff\">or</span> array-<span style=\"color: #000000\">like 索引或数组类型，</span><span style=\"color: #000000\">如果输入数据中没有索引信息以及没有提供索引时默认赋值为arange(n)即从0开始的等差数组<br>\ncolumns : Index </span><span style=\"color: #0000ff\">or</span> array-<span style=\"color: #000000\">like 索引或数组类型，</span><span style=\"color: #000000\">没有提供列标签时默认赋值为0开始的等差数组<br>\ndtype : dtype, default None 数据类型，默认为空。</span><span style=\"color: #000000\">只允许有一种数据类型，如果为空，自动推断类型<br>\ncopy : boolean, default False 布尔类型，默认为False。</span>从输入值中拷贝数据，只对输入为DataFrame或者二维数组时有影响</pre>\n</div>\n<p><strong><span style=\"font-size: 16px\">其他构建DataFrame类型的方法：</span></strong></p>\n<div class=\"cnblogs_code\">\n<pre>classmethod DataFrame.from_records(data, index=None, exclude=None, columns=None, coerce_float=False, nrows=<span style=\"color: #000000\">None)[source]\n\nclassmethod DataFrame.from_dict(data, orient</span>=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">columns</span><span style=\"color: #800000\">'</span>, dtype=None)<br><br><code class=\"xref py py-obj docutils literal\"><span class=\"pre\"><a class=\"reference internal\" title=\"pandas.read_csv\" href=\"http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html#pandas.read_csv\">p</a>andas.read_csv</span></code>, pandas.read_table, <code class=\"xref py py-obj docutils literal\"><span class=\"pre\">pandas.read_clipboard,pandas.read_excel等<br></span></code></pre>\n</div>\n<p><strong><span style=\"font-size: 16px\"> 举例：</span></strong></p>\n<div class=\"cnblogs_code\">\n<pre>从字典构建DataFrame<br>&gt;&gt;&gt; d = {<span style=\"color: #800000\">'</span><span style=\"color: #800000\">col1</span><span style=\"color: #800000\">'</span>: [1, 2], <span style=\"color: #800000\">'</span><span style=\"color: #800000\">col2</span><span style=\"color: #800000\">'</span>: [3, 4<span style=\"color: #000000\">]}\n</span>&gt;&gt;&gt; df = pd.DataFrame(data=<span style=\"color: #000000\">d)\n</span>&gt;&gt;&gt;<span style=\"color: #000000\"> df\n   col1  col2\n0     </span>1     3\n1     2     4</pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre>推断类型为int64<br>&gt;&gt;&gt;<span style=\"color: #000000\"> df.dtypes\ncol1    int64\ncol2    int64\ndtype: object</span></pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">强制设置为单一类型\n</span>&gt;&gt;&gt; df = pd.DataFrame(data=d, dtype=<span style=\"color: #000000\">np.int8)\n</span>&gt;&gt;&gt;<span style=\"color: #000000\"> df.dtypes\ncol1    int8\ncol2    int8\ndtype: object</span></pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">从numpy多维数组类型构建DataFrame\n</span>&gt;&gt;&gt; df2 = pd.DataFrame(np.random.randint(low=0, high=10, size=(5, 5<span style=\"color: #000000\">)),\n...                    columns</span>=[<span style=\"color: #800000\">'</span><span style=\"color: #800000\">a</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">b</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">c</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">d</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">e</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">])\n</span>&gt;&gt;&gt;<span style=\"color: #000000\"> df2\n    a   b   c   d   e\n0   </span>2   8   8   3   4\n1   4   2   9   0   9\n2   1   0   7   8<span style=\"color: #000000\">   0\n</span>3   5   1   7   1   3\n4   6   0   2   4   2</pre>\n</div>\n<p><strong><span style=\"font-size: 16px\">属性：</span></strong></p>\n<p>获取和创建DataFrame</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> pandas as pd\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> numpy as np\n</span><span style=\"color: #008080\"> 3</span>  \n<span style=\"color: #008080\"> 4</span> df=pd.read_excel(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">南京银行.xlsx</span><span style=\"color: #800000\">'</span>,index_col=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Date</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 5</span> df1=df[:5<span style=\"color: #000000\">]\n</span><span style=\"color: #008080\"> 6</span> \n<span style=\"color: #008080\"> 7</span> In [38<span style=\"color: #000000\">]:df1.head()\n</span><span style=\"color: #008080\"> 8</span> Out[38<span style=\"color: #000000\">]: \n</span><span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">         Open  High   Low  Close  Trunover    Volume\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #000000\">Date                                                   \n</span><span style=\"color: #008080\">11</span> 2017-09-15  8.06  8.08  8.03   8.04    195.43  24272800\n<span style=\"color: #008080\">12</span> 2017-09-18  8.05  8.13  8.03   8.06    200.76  24867600\n<span style=\"color: #008080\">13</span> 2017-09-19  8.03  8.06  7.94   8.00    433.76  54253100\n<span style=\"color: #008080\">14</span> 2017-09-20  7.97  8.06  7.95   8.03    319.94  39909700\n<span style=\"color: #008080\">15</span> 2017-09-21  8.02  8.10  7.99   8.04    241.94  30056600</pre>\n</div>\n<p>--转置，转置以后DataFrame的index属性值为None</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In [39<span style=\"color: #000000\">]:  df1.T\n</span><span style=\"color: #008080\">2</span> Out[39<span style=\"color: #000000\">]: \n</span><span style=\"color: #008080\">3</span> Date       2017-09-15   2017-09-18   2017-09-19   2017-09-20   2017-09-21\n<span style=\"color: #008080\">4</span> Open             8.06         8.05         8.03         7.97         8.02\n<span style=\"color: #008080\">5</span> High             8.08         8.13         8.06         8.06         8.10\n<span style=\"color: #008080\">6</span> Low              8.03         8.03         7.94         7.95         7.99\n<span style=\"color: #008080\">7</span> Close            8.04         8.06         8.00         8.03         8.04\n<span style=\"color: #008080\">8</span> Trunover       195.43       200.76       433.76       319.94       241.94\n<span style=\"color: #008080\">9</span> Volume    24272800.00  24867600.00  54253100.00  39909700.00  30056600.00</pre>\n</div>\n<p>--基于标签快速访问</p>\n<div class=\"cnblogs_code\">\n<pre>In [35]:  date=pd.to_datetime(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">2017-09-15</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\nIn [</span>36<span style=\"color: #000000\">]:  date\nOut[</span>36]: Timestamp(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">2017-09-15 00:00:00</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\nIn [</span>37]:  df1.at[date,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Open</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">]\nOut[</span>37]: 8.0600000000000005</pre>\n</div>\n<p>--获取行轴和列轴标签名</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In [44<span style=\"color: #000000\">]: df1.axes\n</span><span style=\"color: #008080\">2</span> Out[44<span style=\"color: #000000\">]: \n</span><span style=\"color: #008080\">3</span> [DatetimeIndex([<span style=\"color: #800000\">'</span><span style=\"color: #800000\">2017-09-15</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">2017-09-18</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">2017-09-19</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">2017-09-20</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">4</span>                 <span style=\"color: #800000\">'</span><span style=\"color: #800000\">2017-09-21</span><span style=\"color: #800000\">'</span>], dtype=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">datetime64[ns]</span><span style=\"color: #800000\">'</span>, name=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Date</span><span style=\"color: #800000\">'</span>, freq=<span style=\"color: #000000\">None),\n</span><span style=\"color: #008080\">5</span>  Index([<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Open</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">High</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">Low</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">Close</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">Trunover</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">Volume</span><span style=\"color: #800000\">'</span>], dtype=<span style=\"color: #800000\">'</span><span style=\"color: #800000\">object</span><span style=\"color: #800000\">'</span>)]</pre>\n</div>\n<p> --内置属性</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> In[45<span style=\"color: #000000\">]: df1.blocks\n</span><span style=\"color: #008080\"> 2</span> Out[45<span style=\"color: #000000\">]: \n</span><span style=\"color: #008080\"> 3</span> {<span style=\"color: #800000\">'</span><span style=\"color: #800000\">float64</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">:     Open  High   Low  Close  Trunover\n</span><span style=\"color: #008080\"> 4</span> <span style=\"color: #000000\"> Date                                         \n</span><span style=\"color: #008080\"> 5</span>  2017-09-15  8.06  8.08  8.03   8.04    195.43\n<span style=\"color: #008080\"> 6</span>  2017-09-18  8.05  8.13  8.03   8.06    200.76\n<span style=\"color: #008080\"> 7</span>  2017-09-19  8.03  8.06  7.94   8.00    433.76\n<span style=\"color: #008080\"> 8</span>  2017-09-20  7.97  8.06  7.95   8.03    319.94\n<span style=\"color: #008080\"> 9</span>  2017-09-21  8.02  8.10  7.99   8.04    241.94<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">10</span>  <span style=\"color: #800000\">'</span><span style=\"color: #800000\">int64</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">:               Volume\n</span><span style=\"color: #008080\">11</span> <span style=\"color: #000000\"> Date                \n</span><span style=\"color: #008080\">12</span>  2017-09-15  24272800\n<span style=\"color: #008080\">13</span>  2017-09-18  24867600\n<span style=\"color: #008080\">14</span>  2017-09-19  54253100\n<span style=\"color: #008080\">15</span>  2017-09-20  39909700\n<span style=\"color: #008080\">16</span>  2017-09-21  30056600}</pre>\n</div>\n<p>--各列数据类型</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In[46<span style=\"color: #000000\">]:  df1.dtypes\n</span><span style=\"color: #008080\">2</span> Out[46<span style=\"color: #000000\">]: \n</span><span style=\"color: #008080\">3</span> <span style=\"color: #000000\">Open        float64\n</span><span style=\"color: #008080\">4</span> <span style=\"color: #000000\">High        float64\n</span><span style=\"color: #008080\">5</span> <span style=\"color: #000000\">Low         float64\n</span><span style=\"color: #008080\">6</span> <span style=\"color: #000000\">Close       float64\n</span><span style=\"color: #008080\">7</span> <span style=\"color: #000000\">Trunover    float64\n</span><span style=\"color: #008080\">8</span> <span style=\"color: #000000\">Volume        int64\n</span><span style=\"color: #008080\">9</span> dtype: object</pre>\n</div>\n<p> --判断DataFrame是否完全为空</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In [47<span style=\"color: #000000\">]: df1.empty\n</span><span style=\"color: #008080\">2</span> Out[47]: False</pre>\n</div>\n<p>--返回稀疏或密集的标示及数据类型</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In[48<span style=\"color: #000000\">]:  df1.ftypes\n</span><span style=\"color: #008080\">2</span> Out[48<span style=\"color: #000000\">]: \n</span><span style=\"color: #008080\">3</span> <span style=\"color: #000000\">Open        float64:dense\n</span><span style=\"color: #008080\">4</span> <span style=\"color: #000000\">High        float64:dense\n</span><span style=\"color: #008080\">5</span> <span style=\"color: #000000\">Low         float64:dense\n</span><span style=\"color: #008080\">6</span> <span style=\"color: #000000\">Close       float64:dense\n</span><span style=\"color: #008080\">7</span> <span style=\"color: #000000\">Trunover    float64:dense\n</span><span style=\"color: #008080\">8</span> <span style=\"color: #000000\">Volume        int64:dense\n</span><span style=\"color: #008080\">9</span> dtype: object</pre>\n</div>\n<p>--快速整数标量定位（到具体元素，相当于给出坐标）</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In[49]:  df1.iat[0,1<span style=\"color: #000000\">] #第1行，第2列\n</span><span style=\"color: #008080\">2</span> Out[49]: 8.0800000000000001\n<span style=\"color: #008080\">3</span> \n<span style=\"color: #008080\">4</span> In[50]:  df1.iat[1<span style=\"color: #000000\">,0] #第2行，第1列\n</span><span style=\"color: #008080\">5</span> Out[50]: 8.0500000000000007</pre>\n</div>\n<p> --用于位置选择的基于整数定位的索引（切片）</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> In [<span style=\"color: #800080\">2</span>]:  df1.iloc[<span style=\"color: #800080\">0</span>:<span style=\"color: #800080\">1</span><span style=\"color: #000000\">]\n</span><span style=\"color: #008080\"> 2</span> Out[<span style=\"color: #800080\">2</span><span style=\"color: #000000\">]: \n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #000000\">            Open  High   Low  Close  Trunover    Volume\n</span><span style=\"color: #008080\"> 4</span> <span style=\"color: #000000\">Date                                                   \n</span><span style=\"color: #008080\"> 5</span> <span style=\"color: #800080\">2017</span>-<span style=\"color: #800080\">09</span>-<span style=\"color: #800080\">15</span>  <span style=\"color: #800080\">8.06</span>  <span style=\"color: #800080\">8.08</span>  <span style=\"color: #800080\">8.03</span>   <span style=\"color: #800080\">8.04</span>    <span style=\"color: #800080\">195.43</span>  <span style=\"color: #800080\">24272800</span><span style=\"color: #008080\"><br></span></pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In [<span style=\"color: #800080\">3</span>]:  df1.iloc[<span style=\"color: #800080\">0</span>:<span style=\"color: #800080\">1</span>,<span style=\"color: #800080\">2</span><span style=\"color: #000000\">:]\n</span><span style=\"color: #008080\">2</span> Out[<span style=\"color: #800080\">3</span><span style=\"color: #000000\">]: \n</span><span style=\"color: #008080\">3</span> <span style=\"color: #000000\">             Low  Close  Trunover    Volume\n</span><span style=\"color: #008080\">4</span> <span style=\"color: #000000\">Date                                       \n</span><span style=\"color: #008080\">5</span> <span style=\"color: #800080\">2017</span>-<span style=\"color: #800080\">09</span>-<span style=\"color: #800080\">15</span>  <span style=\"color: #800080\">8.03</span>   <span style=\"color: #800080\">8.04</span>    <span style=\"color: #800080\">195.43</span>  <span style=\"color: #800080\">24272800</span></pre>\n</div>\n<p>--混合方式定位（基于整数位置或标签名以及它们的组合，可以只用行标签，但是不能只用列标签）</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In [<span style=\"color: #800080\">6</span>]:  df1.ix[<span style=\"color: #800080\">1</span>,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Open</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">]\n</span><span style=\"color: #008080\">2</span> Out[<span style=\"color: #800080\">6</span>]: <span style=\"color: #800080\">8.0500000000000007</span></pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In [<span style=\"color: #800080\">7</span>]:  df1.ix[<span style=\"color: #800080\">1</span><span style=\"color: #000000\">]\n</span><span style=\"color: #008080\">2</span> Out[<span style=\"color: #800080\">7</span><span style=\"color: #000000\">]: \n</span><span style=\"color: #008080\">3</span> Open               <span style=\"color: #800080\">8.05</span>\n<span style=\"color: #008080\">4</span> High               <span style=\"color: #800080\">8.13</span>\n<span style=\"color: #008080\">5</span> Low                <span style=\"color: #800080\">8.03</span>\n<span style=\"color: #008080\">6</span> Close              <span style=\"color: #800080\">8.06</span>\n<span style=\"color: #008080\">7</span> Trunover         <span style=\"color: #800080\">200.76</span>\n<span style=\"color: #008080\">8</span> Volume      <span style=\"color: #800080\">24867600.00</span>\n<span style=\"color: #008080\">9</span> Name: <span style=\"color: #800080\">2017</span>-<span style=\"color: #800080\">09</span>-<span style=\"color: #800080\">18</span> <span style=\"color: #800080\">00</span>:<span style=\"color: #800080\">00</span>:<span style=\"color: #800080\">00</span>, dtype: float64</pre>\n</div>\n<p>--选择位置的基于标签名的索引</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In[7]:  df1.loc[date,<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Low</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">]\n</span><span style=\"color: #008080\">2</span> Out[7]: 8.0299999999999994\n<span style=\"color: #008080\">3</span> \n<span style=\"color: #008080\">4</span> In [8]: df1.loc[df1.index[0],<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Low</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">]\n</span><span style=\"color: #008080\">5</span> Out[8]: 8.0299999999999994</pre>\n</div>\n<p>--坐标轴个数</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In [10<span style=\"color: #000000\">]: df1.ndim\n</span><span style=\"color: #008080\">2</span> Out[10]: 2</pre>\n</div>\n<p>--DataFrame的形状（行列数）</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In [11<span style=\"color: #000000\">]:  df1.shape\n</span><span style=\"color: #008080\">2</span> Out[11]: (5, 6)</pre>\n</div>\n<p>--DataFrame的大小（元素个数）</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In [12<span style=\"color: #000000\">]:  df1.size\n</span><span style=\"color: #008080\">2</span> Out[12]: 30</pre>\n</div>\n<p>--返回DataFrame样式对象</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> In [13<span style=\"color: #000000\">]:  df1.style\n</span><span style=\"color: #008080\">2</span> Out[13]: &lt;pandas.io.formats.style.Styler at 0x1c410cf8eb8&gt;</pre>\n</div>\n<p>--返回DataFrame里的数值（二维数组）</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> In [14<span style=\"color: #000000\">]: df1.values\n</span><span style=\"color: #008080\"> 2</span> Out[14<span style=\"color: #000000\">]: \n</span><span style=\"color: #008080\"> 3</span> array([[  8.06000000e+00,   8.08000000e+00,   8.03000000e+00<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 4</span>           8.04000000e+00,   1.95430000e+02,   2.42728000e+07<span style=\"color: #000000\">],\n</span><span style=\"color: #008080\"> 5</span>        [  8.05000000e+00,   8.13000000e+00,   8.03000000e+00<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 6</span>           8.06000000e+00,   2.00760000e+02,   2.48676000e+07<span style=\"color: #000000\">],\n</span><span style=\"color: #008080\"> 7</span>        [  8.03000000e+00,   8.06000000e+00,   7.94000000e+00<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 8</span>           8.00000000e+00,   4.33760000e+02,   5.42531000e+07<span style=\"color: #000000\">],\n</span><span style=\"color: #008080\"> 9</span>        [  7.97000000e+00,   8.06000000e+00,   7.95000000e+00<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">10</span>           8.03000000e+00,   3.19940000e+02,   3.99097000e+07<span style=\"color: #000000\">],\n</span><span style=\"color: #008080\">11</span>        [  8.02000000e+00,   8.10000000e+00,   7.99000000e+00<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">12</span>           8.04000000e+00,   2.41940000e+02,   3.00566000e+07]])</pre>\n</div>\n<p><span style=\"font-size: 16px\"><strong>以上为DataFrame的主要属性，后面继续介绍DataFrame的方法。</strong></span></p>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t<div class=\"postDesc\">posted on <span id=\"post-date\">2017-11-01 13:06</span> <a href=\"http://www.cnblogs.com/snow-Andy/\">snow-Andy</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7762151\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7762151);return false;\">收藏</a></div>\r\n</div>\r\n<script type=\"text/javascript\">var allowComments=true,cb_blogId=261404,cb_entryId=7762151,cb_blogApp=currentBlogApp,cb_blogUserGuid='7bf65f73-ce01-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/11/1 13:06:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\r\n</div>", "article_view": 83, "image_url": ["https://pic.cnblogs.com/face/556772/20140617171153.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "Kotlin——最详细的枚举类（Enum）详解", "url": "http://www.cnblogs.com/Jetictors/p/7766005.html", "author": "Jetictors", "article_desc": "在 \"上一章节\" 中，详细的 做了一个实例讲解，提到了 的实例化、构造函数、声明、实现方式、和 中类的区别等。但是对于 中的类的使用还远远不止那些。并且在上文中提到了关于类的类别。故而这篇文章就详细说一说 中的`枚举类、的使用。 如果还对 中的类还没有一个清晰的概念及认识的朋友请阅读我的上一篇博文： ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div class=\"post\">\r\n\t<div class=\"postTitle\">\r\n\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/Jetictors/p/7766005.html\">Kotlin——最详细的枚举类（Enum）详解</a>\r\n\t</div>\r\n\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p><img src=\"http://upload-images.jianshu.io/upload_images/6304125-f6370db1e135eb94.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\"></p>\n<p>在<a href=\"http://www.jianshu.com/p/f9b089d216c4\">上一章节</a>中，详细的<code>类(class)</code>做了一个实例讲解，提到了<code>类(class)</code>的实例化、构造函数、声明、实现方式、和<code>Java</code>中类的区别等。但是对于<code>Kotlin</code>中的类的使用还远远不止那些。并且在上文中提到了关于类的类别。故而这篇文章就详细说一说<code>Kotlin</code>中的<code>枚举类、的使用。 如果还对</code>Kotlin`中的类还没有一个清晰的概念及认识的朋友请阅读我的上一篇博文：<br>\n<a href=\"http://www.jianshu.com/p/f9b089d216c4\">Kotlin从无到有系列之类(calss)的使用</a></p>\n<h2 id=\"目录\">目录</h2>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/6304125-f7e2e1aac79c292a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\"></p>\n<h2 id=\"一声明方式及枚举常量\">一、声明方式及枚举常量</h2>\n<blockquote>\n<ul>\n<li>关键字：<code>enum</code></li>\n<li>枚举常量：即枚举类下的对象，每个枚举类包含0个到多个枚举常量。</li>\n</ul>\n</blockquote>\n<p><strong>1、声明</strong></p>\n<blockquote>\n<p><code>enum</code>关键字在类头中的<code>class</code>关键字前面</p>\n</blockquote>\n<p>声明格式：</p>\n<pre><code>enum class 类名{\n      ...\n}</code></pre>\n<p><strong>2、枚举常量</strong></p>\n<blockquote>\n<p>枚举类中的每一个枚举常量都是一个对象，并且他们之间用逗号分隔。</p>\n</blockquote>\n<p>例：</p>\n<pre><code>/**\n * 例：关于一个网络请求结果的枚举类\n */\nenum class State{\n    /*\n         NORMAL : 正常\n         NO_DATA : 数据为空\n         NO_INTERNET : 网络未连接\n         ERROR : 错误\n         OTHER : 其他\n     */\n\n    NORMAL,NO_DATA,NO_INTERNET,ERROR,OTHER\n}</code></pre>\n<p><strong>3、访问枚举常量</strong></p>\n<blockquote>\n<ul>\n<li>不需要实例化枚举类就可以访问枚举常量</li>\n</ul>\n</blockquote>\n<p>使用方式为：</p>\n<pre><code>枚举类名.枚举常量.属性</code></pre>\n<p>通过上面例子来实例讲解：</p>\n<pre><code>// 使用中缀符号访问枚举常量\nState.NORMAL.name\nState.NO_DATA.name\nState.NO_INTERNET.name\nState.ERROR.name\nState.OTHER.name</code></pre>\n<p>这里只是让大家明白怎样去访问一个枚举常量。没有讲解到枚举常量的使用。枚举常量的使用请大家耐心的看下去。在下面会详细介绍怎样去使用它。</p>\n<h2 id=\"二枚举常量的初始化\">二、枚举常量的初始化</h2>\n<blockquote>\n<ul>\n<li>因为每一个枚举都是枚举类的实例，所以他们可以是初始化过的。</li>\n</ul>\n</blockquote>\n<p>例：</p>\n<pre><code> enum class Color(var argb : Int){\n     RED(0xFF0000),\n     WHITE(0xFFFFFF),\n     BLACK(0x000000),\n     GREEN(0x00FF00)\n}</code></pre>\n<h2 id=\"三枚举常量的匿名类\">三、枚举常量的匿名类</h2>\n<blockquote>\n<ul>\n<li>要实现枚举常量的匿名类，则必须提供一个抽象方法（必须重写的方法）。且该方法定义在枚举类内部。而且必须在枚举变量的后面。</li>\n<li>枚举变量之间使用逗号（<code>,</code>）分割开。但是最后一个枚举变量必须使用分号结束。不然定义不了抽象方法。</li>\n<li>在上面已经说过，每一个枚举常量就是一个对象。</li>\n</ul>\n</blockquote>\n<p>例：</p>\n<pre><code>fun main(args: Array&lt;String&gt;) {\n    ConsoleColor.BLACK.print()\n}\n\nenum class ConsoleColor(var argb : Int){\n    RED(0xFF0000){\n        override fun print() {\n            println(\"我是枚举常量 RED \")\n        }\n    },\n    WHITE(0xFFFFFF){\n        override fun print() {\n            println(\"我是枚举常量 WHITE \")\n        }\n    },\n    BLACK(0x000000){\n        override fun print() {\n            println(\"我是枚举常量 BLACK \")\n        }\n   },\n    GREEN(0x00FF00){\n        override fun print() {\n            println(\"我是枚举常量 GREEN \")\n        }\n    };\n\n    abstract fun print()\n}</code></pre>\n<p>输出结果为：</p>\n<pre><code>我是枚举常量 BLACK </code></pre>\n<h2 id=\"四枚举类的使用\">四、枚举类的使用</h2>\n<blockquote>\n<ul>\n<li>每个枚举常量都包含两个属性：<code>name（枚举常量名）</code>和<code>ordinal（枚举常量位置）</code></li>\n<li>提供了<code>values()</code>和<code>valueOf()</code>方法来检测指定的名称与枚举类中定义的任何枚举常量是否匹配。</li>\n<li>自 <code>Kotlin 1.1</code>起，可以使用 <code>enumValues&lt;T&gt;()</code>和 <code>enumValueOf&lt;T&gt;()</code>函数以泛型的方式访问枚举类中的常量。</li>\n</ul>\n</blockquote>\n<p><strong>1、访问枚举变量属性</strong></p>\n<p>例：</p>\n<pre><code>fun main(args: Array&lt;String&gt;) {\n    println(\"name = \" + Color.RED.name + \"\\tordinal = \" + Color.RED.ordinal)\n    println(\"name = \" + Color.WHITE.name + \"\\tordinal = \" + Color.WHITE.ordinal)\n    println(\"name = \" + Color.BLACK.name + \"\\tordinal = \" + Color.BLACK.ordinal)\n    println(\"name = \" + Color.GREEN.name + \"\\tordinal = \" + Color.GREEN.ordinal)\n}\n\nenum class Color(var argb : Int){\n     RED(0xFF0000),\n     WHITE(0xFFFFFF),\n     BLACK(0x000000),\n     GREEN(0x00FF00)\n}  </code></pre>\n<p>输出结果为：</p>\n<pre><code>name = RED  ordinal = 0\nname = WHITE    ordinal = 1\nname = BLACK    ordinal = 2\nname = GREEN    ordinal = 3</code></pre>\n<p><strong>2、使用enumValues</strong></p>\n<p>例： 枚举类还是上面例子中的<code>Color</code>类</p>\n<pre><code>println(enumValues&lt;Color&gt;().joinToString { it.name })\nprintln(enumValueOf&lt;Color&gt;(\"RED\"))</code></pre>\n<p>输出结果为：</p>\n<pre><code>RED, WHITE, BLACK, GREEN\nRED</code></pre>\n<p><strong>3、使用valueOf()和values()检测</strong></p>\n<p>例：</p>\n<pre><code>println(Color.valueOf(\"RED\"))\nprintln(Color.values()[0])\nprintln(Color.values()[1])\nprintln(Color.values()[2])\nprintln(Color.values()[3])</code></pre>\n<p>输出结果为：</p>\n<pre><code>RED\nRED\nWHITE\nBLACK\nGREEN</code></pre>\n<p>其中，若使用<code>Color.valueOf(\"不存在的枚举常量\")</code>，则会抛出<code>IllegalArgumentException</code> 异常，即枚举变量不存在。若使用<code>Color.values()[大于枚举常量位置]</code>，则会抛出下标越界异常。</p>\n<h2 id=\"五枚举类的源码分析\">五、枚举类的源码分析</h2>\n<blockquote>\n<p>即<code>Enum.kt</code>这个源文件。</p>\n</blockquote>\n<p>在这里我大致的说明一下这个源文件的方法、属性等。有兴趣的可以去看看这个源文件。其实里面也没几个方法。</p>\n<p><strong>1、默认实现了<code>companion object {}</code></strong></p>\n<blockquote>\n<p>这也是我们访问枚举常量无需实例化枚举类的原因。</p>\n</blockquote>\n<p><strong>2、仅提供了两个属性</strong></p>\n<blockquote>\n<ul>\n<li>即我们上面用到的枚举常量名称(<code>name</code>)和枚举常量位置(<code>ordinal</code>)</li>\n</ul>\n</blockquote>\n<p>贴上这两个属性的源码：</p>\n<pre><code>/**\n * Returns the name of this enum constant, exactly as declared in its enum declaration.\n */\npublic final val name: String\n\n/**\n * Returns the ordinal of this enumeration constant (its position in its enum declaration, where the initial constant\n * is assigned an ordinal of zero).\n */\npublic final val ordinal: Int</code></pre>\n<p><strong>3、实现了<code>Comparable</code>接口</strong></p>\n<blockquote>\n<ul>\n<li>这也是我们能获取枚举常量位置的原因。</li>\n</ul>\n</blockquote>\n<p>这是<code>Enum.kt</code>源文件。让大家看看它实现了<code>Comparable</code>接口</p>\n<pre><code>public abstract class Enum&lt;E : Enum&lt;E&gt;&gt;(name: String, ordinal: Int): Comparable&lt;E&gt;{\n      ...\n}</code></pre>\n<p>再来看看<code>Comparable.kt</code>里面做了些什么。其实里面就提供了一个方法罢了...</p>\n<pre><code>public interface Comparable&lt;in T&gt; {\n    /**\n     * Compares this object with the specified object for order. Returns zero if this object is equal\n     * to the specified [other] object, a negative number if it's less than [other], or a positive number\n     * if it's greater than [other].\n     */\n    public operator fun compareTo(other: T): Int\n}</code></pre>\n<p>关于枚举类的讲解就写到这里了。不清楚的可以多看看文章，或者看看源码、官方文档等等。当然，自己按照我的例子去敲一遍代码也是非常不错的。</p>\n<h2 id=\"六-总结\">六、 总结</h2>\n<p>我个人是从事<code>Android</code>开发的，以前用<code>Java</code>语言开发<code>APP</code>时因为考虑到手机性能的问题几乎用不到枚举的。因为枚举太消耗内存了。当然用<code>Kotlin</code>语言开发<code>Android</code>项目中是否要用到枚举去便利去解决一些问题，此待小生自己研究。但是开发服务端项目时，一些问题用枚举是非常便利性的。</p>\n<p><a href=\"https://github.com/Jetictors/KotlinLeran/blob/master/src/com/kotlin/leran/cls/classDemo/EnumDemo.kt\">项目源代码</a></p>\n<p>如果各位大佬看了之后感觉还阔以，就请各位大佬随便star一下，您的关注是我最大的动力。<br>\n我的个人博客：<a href=\"https://jetictors.github.io/\">Jetictors</a><br>\n我的简书：<a href=\"http://www.jianshu.com/u/9877d6088780\" class=\"uri\">http://www.jianshu.com/u/9877d6088780</a><br>\n我的博客园：<a href=\"http://www.cnblogs.com/Jetictors/\" class=\"uri\">http://www.cnblogs.com/Jetictors/</a></p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t<div class=\"postDesc\">posted on <span id=\"post-date\">2017-11-01 13:22</span> <a href=\"http://www.cnblogs.com/Jetictors/\">Jetictors</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766005\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766005);return false;\">收藏</a></div>\r\n</div>\r\n<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=387491,cb_entryId=7766005,cb_blogApp=currentBlogApp,cb_blogUserGuid='0b2cc0dd-4737-48fa-16ae-08d4ef52ecb6',cb_entryCreatedDate='2017/11/1 13:22:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\r\n</div>", "article_view": 135, "image_url": ["https://pic.cnblogs.com/face/1255627/20171012102640.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "Linux系列教程（九）——Linux常用命令之网络和关机重启命令", "url": "http://www.cnblogs.com/ysocean/p/7746790.html", "author": "YSOcean", "article_desc": "前一篇博客我们讲解了Linux压缩和解压缩命令，使用的最多的是tar命令，因为现在很多源码包都是.tar.gz的格式，通过 tar -zcvf 能完成解压。然后对于.zip格式的文件，使用gunzip 命令解压，对于.zip格式的文件，使用unzip 命令解压，最后对于比较大的文件，我们使用bunz ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/ysocean/p/7746790.html\">Linux系列教程（九）——Linux常用命令之网络和关机重启命令</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　前一篇博客我们讲解了<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/ysocean/p/7746786.html\">Linux压缩和解压缩命令</a>，使用的最多的是tar命令，因为现在很多源码包都是.tar.gz的格式，通过 tar -zcvf 能完成解压。然后对于.zip格式的文件，使用gunzip 命令解压，对于.zip格式的文件，使用unzip 命令解压，最后对于比较大的文件，我们使用bunzip2命令来进行解压。</p>\r\n<p>　　这篇博客是我们讲解Linux命令的最后一篇了——网络和关机重启命令。</p>\r\n<h3>1、网络命令</h3>\r\n<h4>　一、给指定用户发送信息：write</h4>\r\n<p>　　①、命令名称：write</p>\r\n<p>　　②、英文原意：</p>\r\n<p>　　③、命令所在路径：/usr/bin/write</p>\r\n<p>　　④、执行权限：所有用户</p>\r\n<p>　　⑤、功能描述：给指定用户发送信息，以Ctrl+D 保存结束</p>\r\n<p>　　⑥、语法： write【用户名】</p>\r\n<p>　　范例：给vae用户发送信息：write vae</p>\r\n<p> </p>\r\n<h4>　二、给所有用户发送广播信息：wall</h4>\r\n<p>　　①、命令名称：wall</p>\r\n<p>　　②、英文原意：write all</p>\r\n<p>　　③、命令所在路径：/usr/bin/wall</p>\r\n<p>　　④、执行权限：所有用户</p>\r\n<p>　　⑤、功能描述：发送广播信息</p>\r\n<p>　　⑥、语法： wall【信息内容】</p>\r\n<p>　　范例：发送广播信息：wall hello linux!!!</p>\r\n<p> </p>\r\n<h4>　三、测试网络连通性：ping</h4>\r\n<p>　　①、命令名称：ping</p>\r\n<p>　　②、英文原意：</p>\r\n<p>　　③、命令所在路径：/bin/ping</p>\r\n<p>　　④、执行权限：所有用户</p>\r\n<p>　　⑤、功能描述：测试网络连通性</p>\r\n<p>　　⑥、语法： ping 【-c n】【IP地址】</p>\r\n<p>　　　　　　　　-c  n是指定发送次数，如果不指定次数，那么将不断发送连接信息</p>\r\n<p>　　范例：测试与百度的连接：ping www.baidu.com</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171029102638883-358376637.png\" alt=\"\"></p>\r\n<p> </p>\r\n<h4>　四、查看和设置网卡信息：ifconfig</h4>\r\n<p>　　①、命令名称：ifconfig</p>\r\n<p>　　②、英文原意：interface configure</p>\r\n<p>　　③、命令所在路径：/sbin/ifconfig</p>\r\n<p>　　④、执行权限：root</p>\r\n<p>　　⑤、功能描述：查看和设置网卡信息</p>\r\n<p>　　⑥、语法：ifconfig 【网卡名称】【IP地址】</p>\r\n<p>　　范例1：查看本机网卡信息：ifconfig</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171029102930195-1120323060.png\" alt=\"\"></p>\r\n<p>　　范例2：查看eth0 的网卡信息：ifconfig eth0 </p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171029103109758-1953102965.png\" alt=\"\"></p>\r\n<p> </p>\r\n<h4>　五、查看发送电子邮件：mail</h4>\r\n<p>　　①、命令名称：mail </p>\r\n<p>　　②、英文原意：</p>\r\n<p>　　③、命令所在路径：/bin/mail</p>\r\n<p>　　④、执行权限：所有用户</p>\r\n<p>　　⑤、功能描述：查看发送电子邮件</p>\r\n<p>　　⑥、语法：mail【用户名】</p>\r\n<p>　　范例：给root用户发送邮件：mail root</p>\r\n<p>　　</p>\r\n<h4>　六、列出所有登录系统的用户信息：last</h4>\r\n<p>　　①、命令名称：last</p>\r\n<p>　　②、英文原意：</p>\r\n<p>　　③、命令所在路径：/usr/bin/last</p>\r\n<p>　　④、执行权限：所有用户</p>\r\n<p>　　⑤、功能描述：列出所有登录过系统的用户信息</p>\r\n<p>　　⑥、语法：last</p>\r\n<p>　　范例：查看所有登录系统的用户：last</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171029103437180-358242756.png\" alt=\"\"></p>\r\n<p> </p>\r\n<h4>　七、显示数据包到主机间的路径：traceroute</h4>\r\n<p>　　①、命令名称：traceroute</p>\r\n<p>　　②、英文原意：</p>\r\n<p>　　③、命令所在路径：/usr/bin/traceroute</p>\r\n<p>　　④、执行权限：所有用户</p>\r\n<p>　　⑤、功能描述：显示数据包到主机间的路径</p>\r\n<p>　　⑥、语法：traceroute 【IP地址】</p>\r\n<p> </p>\r\n<h4>　八、显示网络相关信息：netstat</h4>\r\n<p>　　①、命令名称：netstat</p>\r\n<p>　　②、英文原意：</p>\r\n<p>　　③、命令所在路径：/bin/netstat</p>\r\n<p>　　④、执行权限：所有用户</p>\r\n<p>　　⑤、功能描述：显示网络相关信息</p>\r\n<p>　　⑥、语法：netstat【选项】</p>\r\n<p>　　　　　　-t　　TCP协议</p>\r\n<p>　　　　　　-u　　UDP协议</p>\r\n<p>　　　　　　-l　　监听</p>\r\n<p>　　　　　　-r　　路由</p>\r\n<p>　　　　　　-n　　显示IP地址和端口号</p>\r\n<p>　　范例1：netstat -tlun 查看本机监听的端口</p>\r\n<p>　　范例2：netstat -an  查看本机所有的网络连接</p>\r\n<p>　　范例3：netstat -rn  查看本机路由表</p>\r\n<p> </p>\r\n<h4>　九、配置网络：setup</h4>\r\n<p>　　①、命令名称：setup</p>\r\n<p>　　②、英文原意：</p>\r\n<p>　　③、命令所在路径：/usr/bin/setup</p>\r\n<p>　　④、执行权限：root</p>\r\n<p>　　⑤、功能描述：配置网络，比如IP地址，子网掩码等</p>\r\n<p>　　⑥、语法：setup</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201710/1120165-20171029104705601-1738945460.png\" alt=\"\"></p>\r\n<p> </p>\r\n<p>　　</p>\r\n<h4>　十、挂载命令：mount</h4>\r\n<p>　　①、命令名称：mount</p>\r\n<p>　　②、英文原意：</p>\r\n<p>　　③、命令所在路径：/bin/mount</p>\r\n<p>　　④、执行权限：所有用户</p>\r\n<p>　　⑤、功能描述：给光盘、U盘等外界存储设备分配类似于windows系统的盘符，便于访问</p>\r\n<p>　　⑥、语法：mount 【-t 文件系统】设备文件名  挂载点</p>\r\n<p>　　范例：在虚拟机光盘里面放入一张CD</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201711/1120165-20171101083325904-1842067847.png\" alt=\"\"></p>\r\n<p>　　将光盘挂载到 /mnt/cdrom 目录下：mount -t iso9960 /dev/sr0  /mnt/cdrom。-t iso9660 可以省略</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1120165/201711/1120165-20171101083427029-627659387.png\" alt=\"\"></p>\r\n<p>　　卸载：umount /dev/sr0</p>\r\n<h3>2、关机重启命令</h3>\r\n<h4>　一、shutdown命令(推荐使用)</h4>\r\n<p>　　①、命令名称：shutdown</p>\r\n<p>　　②、英文原意：</p>\r\n<p>　　③、命令所在路径：/sbin/shutdown</p>\r\n<p>　　④、执行权限：root</p>\r\n<p>　　⑤、功能描述：进行关机重启操作</p>\r\n<p>　　⑥、语法：shutdown 【选项】 【时间】</p>\r\n<p>　　　　　　　　-c　　取消前一个关机命令</p>\r\n<p>　　　　　　　　-h　　关机</p>\r\n<p>　　　　　　　　-r　　重启</p>\r\n<p>　　范例1：马上关机：shutdown -h now</p>\r\n<p>　　范例2：晚上八点半关机：shutdown -h 20:30</p>\r\n<p>　　<strong>注意：推荐使用该命令进行关机，此命令关机之前会正确的关闭系统的服务。</strong></p>\r\n<h4>　二、其他关机命令</h4>\r\n<p>　　①、halt</p>\r\n<p>　　②、poweroff</p>\r\n<p>　　③、init0</p>\r\n<h4>　三、其他重启命令</h4>\r\n<p>　　①、reboot</p>\r\n<p>　　②、init6</p>\r\n<h4>　四、退出登录命令</h4>\r\n<p>　　①、logout</p>\r\n<p> </p>\r\n<h3>3、总结</h3>\r\n<p>　　本篇博客我们介绍了Linux的网络和关机重启命令，网络命令我们用的比较多的测试网络连通性ping,查看网卡信息，比如查看本机IP地址ifconfig，配置网络setup等等。关机重启命令大家只需要记住shutdown的用法就好了，shutdown命令在执行关机的时候会正确的关闭系统的相关服务，而别的关机重启命令在这里不推荐。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 13:33</span> <a href=\"http://www.cnblogs.com/ysocean/\">YSOcean</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7746790\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7746790);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=338076,cb_entryId=7746790,cb_blogApp=currentBlogApp,cb_blogUserGuid='126783d2-1103-e711-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/1 13:33:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 242, "image_url": ["https://pic.cnblogs.com/face/1120165/20170526223410.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "django-rest-framework之序列化", "url": "http://www.cnblogs.com/0zcl/p/7765807.html", "author": "前程明亮", "article_desc": "前言：昨天学习了rest-framework序列化方面的知识，故写了博客记录一下。官网:http://www.django-rest-framework.org/tutorial/1-serialization/#working-with-serializers。 前后端分离：前台的开发和后台的开发 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/0zcl/p/7765807.html\">django-rest-framework之序列化</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><span style=\"font-size: 15px;\"><strong><span style=\"font-size: 16px;\">前言：</span></strong>昨天学习了rest-framework序列化方面的知识，故写了博客记录一下。官网:http://www.django-rest-framework.org/tutorial/1-serialization/#working-with-serializers。</span></p>\r\n<p><span style=\"font-size: 15px;\"> </span></p>\r\n<p><span style=\"font-size: 15px;\"><strong><span style=\"background-color: #00ffff;\">前后端分离</span></strong>：前台的开发和后台的开发分离开。这个方案的实现就是要<span style=\"color: #ff0000;\">借助API</span>，API简单说就是开发人员提供编程接口被其他人调用，他们调用之后会返回数据供其使用。API的类型有多种，但是现在比较主流且实用的就是RESTful API。</span></p>\r\n<p> </p>\r\n<h3 id=\"getting-started\"><span style=\"font-size: 14pt;\">一、开始</span></h3>\r\n<p><span style=\"font-size: 15px;\">Okay, we're ready to get coding. To get started, let's create a new project to work with.首先创建一个Django项目。</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\">cd ~<span style=\"color: #000000;\">\r\ndjango</span>-<span style=\"color: #000000;\">admin.py startproject tutorial\r\ncd tutorial</span></span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">Once that's done we can create an app that we'll use to create a simple Web API.接着创建一个APP</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\">python manage.py startapp snippets</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">We'll need to add our new <code>snippets</code> app and the <code>rest_framework</code> app to <code>INSTALLED_APPS</code>. Let's edit the <code>tutorial/settings.py</code> file:修改全局配置文件。</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\">INSTALLED_APPS =<span style=\"color: #000000;\"> (\r\n    ...\r\n    </span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">rest_framework</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">,\r\n    </span><span style=\"color: #ff0000;\">'snippets.apps.SnippetsConfig'</span><span style=\"color: #000000;\">,\r\n)</span></span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">Please note that if you're using Django &lt;1.9, you need to replace <code>snippets.apps.SnippetsConfig</code> with <code>snippets</code>.</span></p>\r\n<p><span style=\"font-size: 15px;\">如果你使用的Django &lt;1.9，则需要更换<span style=\"color: #ff0000;\"><code>snippets.apps.SnippetsConfig为</code><code>snippets</code></span>。</span></p>\r\n<p> </p>\r\n<h3 id=\"_3\"><span style=\"font-size: 14pt;\">二、创建模型类</span></h3>\r\n<p><span style=\"font-size: 15px;\">For the purposes of this tutorial we're going to start by creating a simple <code>Snippet</code> model that is used to store code snippets(片段). Go ahead and edit the <code>snippets/models.py</code> file.</span></p>\r\n<p><span style=\"font-size: 15px;\">我们将首先创建一个<code>Snippet</code>用于<span style=\"color: #ff0000;\">存储代码片段的简单模型</span>，编辑<code>snippets/models.py</code>文件。</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\"><span style=\"color: #0000ff;\">from</span> django.db <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> models\r\n\r\n</span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> Create your models here.</span>\r\n\r\n<span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> pygments可以实现代码高亮　官网:http://pygments.org/</span>\r\n<span style=\"color: #0000ff;\">from</span> pygments.lexers <span style=\"color: #0000ff;\">import</span> get_all_lexers  <span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> lexers:词法分析器</span>\r\n<span style=\"color: #0000ff;\">from</span> pygments.styles <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> get_all_styles\r\n\r\n\r\nLEXERS </span>= [item <span style=\"color: #0000ff;\">for</span> item <span style=\"color: #0000ff;\">in</span> get_all_lexers() <span style=\"color: #0000ff;\">if</span> item[1<span style=\"color: #000000;\">]]\r\nLANGUAGE_CHOICES </span>= sorted([(item[1][0], item[0]) <span style=\"color: #0000ff;\">for</span> item <span style=\"color: #0000ff;\">in</span><span style=\"color: #000000;\"> LEXERS])\r\nSTYLE_CHOICES </span>= sorted((item, item) <span style=\"color: #0000ff;\">for</span> item <span style=\"color: #0000ff;\">in</span><span style=\"color: #000000;\"> get_all_styles())\r\n\r\n\r\n</span><span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Snippet(models.Model):\r\n    created </span>= models.DateTimeField(auto_now_add=True)  <span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> 自动添加创建时间</span>\r\n    title = models.CharField(max_length=100, blank=True, default=<span style=\"color: #800000;\">''</span><span style=\"color: #000000;\">)\r\n    code </span>=<span style=\"color: #000000;\"> models.TextField()\r\n    linenos </span>= models.BooleanField(default=<span style=\"color: #000000;\">False)\r\n    language </span>= models.CharField(choices=LANGUAGE_CHOICES, default=<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">python</span><span style=\"color: #800000;\">'</span>, max_length=100<span style=\"color: #000000;\">)\r\n    style </span>= models.CharField(choices=STYLE_CHOICES, default=<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">friendly</span><span style=\"color: #800000;\">'</span>, max_length=100<span style=\"color: #000000;\">)\r\n\r\n    </span><span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Meta:\r\n        ordering </span>= (<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">created</span><span style=\"color: #800000;\">'</span>,)  <span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> 根据创建时间来排序</span></span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">初始化并且同步到数据库:</span></p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:python;gutter:true;\"><span style=\"font-size: 13px;\">python manage.py makemigrations snippets\r\npython manage.py migrate\r\n</span></pre>\r\n</div>\r\n<p>　　</p>\r\n<h3 id=\"_4\"><span style=\"font-size: 14pt;\">三、创建序列化类</span></h3>\r\n<p><span style=\"font-size: 15px;\">The first thing we need to get started on our Web API is to provide a way of serializing(序列化) and deserializing(反序列化) the snippet instances into representations such as <code>json</code>. We can do this by declaring(声明) serializers that work very similar to Django's forms. </span></p>\r\n<p><span style=\"font-size: 15px;\">首先我要问你了，通常情况下，前端从调用后台API，API肯定需要返回数据给前端，那返回的数据是什么类型呢？</span></p>\r\n<p><span style=\"font-size: 15px;\">目前主流用的比较多的是JSON，可能有少部分还在用XML。</span></p>\r\n<p><span style=\"font-size: 15px;\">那我们在学习django-rest-framework时，有没有提供什么方法能够将数据实例信息自动转换为JSON？而且也可以将前端传给后台的JSON数据转换为python的数据类型(dict/list/set...)。当然有，<span style=\"color: #ff0000;\">序列化器(serializers)</span>可以实现。首先你得声明(引入)序列化器，请看下面这个例子：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\"><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> 用Web API的第一件事是提供一种将代码片段实例序列化和反序列化为表示形式的方法json。</span><span style=\"color: #008000;\">\r\n#</span><span style=\"color: #008000;\"> 我们可以通过声明与Django表单非常相似的序列化器来做到这一点。在snippets命名的目录中创建一个文件，</span><span style=\"color: #008000;\">\r\n#</span><span style=\"color: #008000;\"> serializers.py并添加以下内容</span>\r\n\r\n<span style=\"color: #0000ff;\">from</span> rest_framework <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> serializers\r\n</span><span style=\"color: #0000ff;\">from</span> snippets.models <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> Snippet, LANGUAGE_CHOICES, STYLE_CHOICES\r\n\r\n\r\n</span><span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> SnippetSerializer(serializers.Serializer):\r\n    </span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> 序列化器类的第一部分定义了序列化/反序列化的字段。</span>\r\n    id = serializers.IntegerField(read_only=<span style=\"color: #000000;\">True)\r\n    title </span>= serializers.CharField(required=False, allow_blank=True, max_length=100<span style=\"color: #000000;\">)\r\n    </span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> 利用字段标志控制序列化器渲染到HTML页面时的的显示模板</span>\r\n    code = serializers.CharField(style={<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">base_template</span><span style=\"color: #800000;\">'</span>: <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">textarea.html</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">})\r\n    linenos </span>= serializers.BooleanField(required=<span style=\"color: #000000;\">False)\r\n    language </span>= serializers.ChoiceField(choices=LANGUAGE_CHOICES, default=<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">python</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">)\r\n    style </span>= serializers.ChoiceField(choices=STYLE_CHOICES, default=<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">friendly</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">)\r\n\r\n    </span><span style=\"color: #0000ff;\">def</span><span style=\"color: #000000;\"> create(self, validated_data):\r\n        </span><span style=\"color: #800000;\">\"\"\"</span><span style=\"color: #800000;\">\r\n        The create() and update() methods define how fully fledged instances are created\r\n        or modified when calling serializer.save()\r\n        Create and return a new `Snippet` instance, given the validated data.\r\n        给定经过验证的数据，创建并返回一个新的 Snippet 实例\r\n        </span><span style=\"color: #800000;\">\"\"\"</span>\r\n        <span style=\"color: #0000ff;\">return</span> Snippet.objects.create(**<span style=\"color: #000000;\">validated_data)\r\n\r\n    </span><span style=\"color: #0000ff;\">def</span><span style=\"color: #000000;\"> update(self, instance, validated_data):\r\n        </span><span style=\"color: #800000;\">\"\"\"</span><span style=\"color: #800000;\">\r\n        Update and return an existing `Snippet` instance, given the validated data.\r\n        给定经过验证的数据，更新并返回一个已经存在的 Snippet 实例\r\n        </span><span style=\"color: #800000;\">\"\"\"</span><span style=\"color: #000000;\">\r\n        instance.title </span>= validated_data.get(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">title</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">, instance.title)\r\n        instance.code </span>= validated_data.get(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">code</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">, instance.code)\r\n        instance.linenos </span>= validated_data.get(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">linenos</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">, instance.linenos)\r\n        instance.language </span>= validated_data.get(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">language</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">, instance.language)\r\n        instance.style </span>= validated_data.get(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">style</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">, instance.style)\r\n        instance.save()  </span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> 更新</span>\r\n        <span style=\"color: #0000ff;\">return</span> instance</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">序列化器类的第一部分定义了序列化/反序列化的字段。该<code>create()</code>和<code>update()</code>方法分别定义实例如何创建和更新。</span></p>\r\n<p><span style=\"font-size: 15px;\">关于下面这行代码：</span></p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:python;gutter:true;\"><span style=\"font-size: 13px;\">code = serializers.CharField(style={'base_template': 'textarea.html'})</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">暂时需要知道的就是它的功能是控制序列化器渲染到HTML页面时的的显示模板，至于为什么要这样做，是因为这对于控制如何显示可浏览的API特别有用，这将在后面的文章中看到。</span></p>\r\n<p><span style=\"font-size: 15px;\">实际上也可以通过使用<span style=\"color: #ff0000;\"><code>ModelSerializer</code></span></span><span><span style=\"font-size: 15px;\">来节省自己的时间</span><span><span style=\"font-size: 15px;\">，我们稍后会看到，接下来看看序列化器的具体作用。</span><br></span></span></p>\r\n<p> </p>\r\n<h3 id=\"_5\"><span style=\"font-size: 14pt;\">四、使用序列化器</span></h3>\r\n<p><span style=\"font-size: 15px;\">在我们进一步了解之前，我们将熟悉使用我们新的Serializer类。我们进入Django shell：</span></p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:python;gutter:true;\"><span style=\"font-size: 13px;\">python manage.py shell</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">接下来的操作就和学习Django的ORM时那样，创建并保存Snippet模型实例：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\"><span style=\"color: #0000ff;\">from</span> snippets.models <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> Snippet\r\n</span><span style=\"color: #0000ff;\">from</span> snippets.serializers <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> SnippetSerializer\r\n</span><span style=\"color: #0000ff;\">from</span> rest_framework.renderers <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> JSONRenderer\r\n</span><span style=\"color: #0000ff;\">from</span> rest_framework.parsers <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> JSONParser\r\n\r\nsnippet </span>= Snippet(code=<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">foo = \"bar\"\\n</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">)\r\nsnippet.save()\r\n\r\nsnippet </span>= Snippet(code=<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">print \"hello, world\"\\n</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">)\r\nsnippet.save()</span></span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">这个时候查看数据库就会发现相关的表中已经多了两行数据，就是我们刚才创建的数据： </span></p>\r\n<p><span><img src=\"http://images2017.cnblogs.com/blog/1038183/201711/1038183-20171101122545623-717389209.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-size: 15px;\">我们现在有几个片段实例可以玩。我们来看看序列化这些<span style=\"color: #ff0000;\">实例之一</span></span></p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:python;gutter:true;\"><span style=\"font-size: 13px;\">serializer = SnippetSerializer(snippet)\r\nserializer.data\r\n# {'id': 2, 'title': u'', 'code': u'print \"hello, world\"\\n', 'linenos': False, 'language': u'python', 'style': u'friendly'}\r\n</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">At this point we've translated the model instance into Python native datatypes. </span></p>\r\n<p><span style=\"font-size: 15px;\">从上面的代码，可以看到，我们已经将model的实例信息转换为python原生的数据类型，即字典。</span></p>\r\n<p><span style=\"font-size: 15px;\">To finalize the serialization process we render the data into <code>json</code>.</span></p>\r\n<p><span style=\"font-size: 15px;\">为了完成序列化过程，我们<span style=\"color: #ff0000;\">将数据转换成<code>json</code></span>。</span></p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:python;gutter:true;\"><span style=\"font-size: 13px;\">content = JSONRenderer().render(serializer.data)\r\ncontent\r\n# '{\"id\": 2, \"title\": \"\", \"code\": \"print \\\\\"hello, world\\\\\"\\\\n\", \"linenos\": false, \"language\": \"python\", \"style\": \"friendly\"}'</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">这里已经出现了json格式，也就是说这个json格式的数据就是要展示在某个URL上，大概可以感觉到，等下我们在访问某个URL时，会返回上面这堆数据供你使用，这其实就完成了一个序列化的过程，也可以看出客户端的功能雏形。</span></p>\r\n<p><span style=\"font-size: 15px;\">序列化是为了返回json格式的数据给客户端查看和使用数据，那么当客户端需要修改、增加或者删除数据时，就要把过程反过来了，也就是反序列化，把客户端提交的json格式的数据反序列化。</span></p>\r\n<p><span style=\"font-size: 15px;\"><span style=\"color: #ff0000;\">反序列化</span>是类似的。首先我们将一个流解析为Python本机数据类型...</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\"><span style=\"color: #0000ff;\">from</span> django.utils.six <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> BytesIO\r\n\r\nstream </span>=<span style=\"color: #000000;\"> BytesIO(content)\r\ndata </span>= JSONParser().parse(stream)</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">...then we restore those native datatypes into a fully populated object instance.</span></p>\r\n<p><span style=\"font-size: 15px;\">先<span style=\"color: #ff0000;\">检查数据是否有误</span>，再保存数据：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\">serializer = SnippetSerializer(data=<span style=\"color: #000000;\">data)\r\n<span style=\"color: #ff0000;\">serializer.is_valid()\r\n</span></span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> True</span>\r\n<span style=\"color: #000000;\">serializer.validated_data\r\n</span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> OrderedDict([('title', ''), ('code', 'print \"hello, world\"\\n'), ('linenos', False), ('language', 'python'), ('style', 'friendly')])</span>\r\n<span style=\"color: #000000;\">serializer.save()\r\n</span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> &lt;Snippet: Snippet object&gt;</span></span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">这个时候查看数据库又多了一条数据：</span></p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/1038183/201711/1038183-20171101133526373-1919897008.png\" alt=\"\"></p>\r\n<p><span style=\"font-size: 15px;\">We can also serialize querysets instead of model instances. To do so we simply add a <code>many=True</code> flag to the serializer arguments.</span></p>\r\n<p><span style=\"font-size: 15px;\">我们也可以<span style=\"color: #ff0000;\">序列化查询集</span>而不是模型实例。为此，我们只需要为serializer参数添加一个<span style=\"color: #ff0000;\">标志many=True</span></span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\">serializer = SnippetSerializer(Snippet.objects.all(), many=<span style=\"color: #000000;\">True)\r\nserializer.data\r\n</span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> [OrderedDict([('id', 1), ('title', u''), ('code', u'foo = \"bar\"\\n'), ('linenos', False), ('language', 'python'), ('style', 'friendly')]), OrderedDict([('id', 2), ('title', u''), ('code', u'print \"hello, world\"\\n'), ('linenos', False), ('language', 'python'), ('style', 'friendly')]), OrderedDict([('id', 3), ('title', u''), ('code', u'print \"hello, world\"'), ('linenos', False), ('language', 'python'), ('style', 'friendly')])]</span></span></pre>\r\n</div>\r\n<p> </p>\r\n<p> </p>\r\n<h3 id=\"modelserializers\"><span style=\"font-size: 14pt;\">五、使用 ModelSerializers</span></h3>\r\n<p><span style=\"font-size: 15px;\">在上面的SnippetSerializer类中，我们继承的是serializers.Serializer类，可以看到<span style=\"color: #ff0000;\">SnippetSerializer类中有很多代码其实是和models.py中的Snippet模型类似一样的</span>，所以这里我们可以改进一下。就像在Django中提供了Form类和ModelForm类一样，<span style=\"color: #ff0000;\">django-rest-framework为我们提供了Serializer类和ModelSerializer类</span>。利用它可以让我们的代码简洁很多，修改serializers.py：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\"><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> Our SnippetSerializer class is replicating a lot of information that's also contained in the Snippet model.</span><span style=\"color: #008000;\">\r\n#</span><span style=\"color: #008000;\"> It would be nice if we could keep our code a bit more concise.</span>\r\n<span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> SnippetSerializer(serializers.ModelSerializer):\r\n    </span><span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Meta:\r\n        model </span>=<span style=\"color: #000000;\"> Snippet\r\n        fields </span>= (<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">id</span><span style=\"color: #800000;\">'</span>, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">title</span><span style=\"color: #800000;\">'</span>, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">code</span><span style=\"color: #800000;\">'</span>, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">linenos</span><span style=\"color: #800000;\">'</span>, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">language</span><span style=\"color: #800000;\">'</span>, <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">style</span><span style=\"color: #800000;\">'</span>)</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">One nice property that serializers have is that you can inspect(检查/查看) all the fields in a serializer instance, by printing its representation. Open the Django shell with <code>python manage.py shell</code>, then try the following:</span></p>\r\n<p><span style=\"font-size: 15px;\">序列化器具有的一个不错的属性是可以通过打印其表示来<span style=\"color: #ff0000;\">检查序列化器实例中的所有字段</span>。打开Django shell <code>python manage.py shell</code>，然后尝试以下操作：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\"><span style=\"color: #0000ff;\">from</span> snippets.serializers <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> SnippetSerializer\r\nserializer </span>=<span style=\"color: #000000;\"> SnippetSerializer()\r\n</span><span style=\"color: #0000ff;\">print</span><span style=\"color: #000000;\">(repr(serializer))\r\n</span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> SnippetSerializer():</span><span style=\"color: #008000;\">\r\n#</span><span style=\"color: #008000;\">    id = IntegerField(label='ID', read_only=True)</span><span style=\"color: #008000;\">\r\n#</span><span style=\"color: #008000;\">    title = CharField(allow_blank=True, max_length=100, required=False)</span><span style=\"color: #008000;\">\r\n#</span><span style=\"color: #008000;\">    code = CharField(style={'base_template': 'textarea.html'})</span><span style=\"color: #008000;\">\r\n#</span><span style=\"color: #008000;\">    linenos = BooleanField(required=False)</span><span style=\"color: #008000;\">\r\n#</span><span style=\"color: #008000;\">    language = ChoiceField(choices=[('Clipper', 'FoxPro'), ('Cucumber', 'Gherkin'), ('RobotFramework', 'RobotFramework'), ('abap', 'ABAP'), ('ada', 'Ada')...</span><span style=\"color: #008000;\">\r\n#</span><span style=\"color: #008000;\">    style = ChoiceField(choices=[('autumn', 'autumn'), ('borland', 'borland'), ('bw', 'bw'), ('colorful', 'colorful')...</span></span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">记住，ModelSerializer类不会做任何特别神奇的事情，它们只是创建序列化器类的快捷方式：</span></p>\r\n<ul>\r\n<li><span style=\"font-size: 15px;\">一组自动确定的字段。</span></li>\r\n<li><span style=\"font-size: 15px;\">简单的默认实现create()和update()方法。</span></li>\r\n</ul>\r\n<p> </p>\r\n<h3 id=\"django\"><span style=\"font-size: 14pt;\">六、编写常规的Django视图</span></h3>\r\n<p><span style=\"font-size: 15px;\">接下来要做的就是使用我们的新的Serializer类编写一些API视图。编辑snippets/views.py：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">from</span> django.shortcuts <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> render\r\n\r\n</span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\"> Create your views here.</span>\r\n<span style=\"color: #0000ff;\">from</span> django.http <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> HttpResponse, JsonResponse\r\n</span><span style=\"color: #0000ff;\">from</span> django.views.decorators.csrf <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> csrf_exempt\r\n</span><span style=\"color: #0000ff;\">from</span> rest_framework.renderers <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> JSONRenderer\r\n</span><span style=\"color: #0000ff;\">from</span> rest_framework.parsers <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> JSONParser\r\n</span><span style=\"color: #0000ff;\">from</span> snippets.models <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> Snippet\r\n</span><span style=\"color: #0000ff;\">from</span> snippets.serializers <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> SnippetSerializer\r\n\r\n\r\n@csrf_exempt\r\n</span><span style=\"color: #0000ff;\">def</span><span style=\"color: #000000;\"> snippet_list(request):\r\n    </span><span style=\"color: #800000;\">\"\"\"</span><span style=\"color: #800000;\">\r\n    because we want to be able to POST to this view from clients\r\n    that won't have a CSRF token we need to mark the view as csrf_exempt\r\n    List all code snippets, or create a new snippet.\r\n    </span><span style=\"color: #800000;\">\"\"\"</span>\r\n    <span style=\"color: #0000ff;\">if</span> request.method == <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">GET</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">:\r\n        snippets </span>=<span style=\"color: #000000;\"> Snippet.objects.all()\r\n        serializer </span>= SnippetSerializer(snippets, many=<span style=\"color: #000000;\">True)\r\n        </span><span style=\"color: #0000ff;\">return</span> JsonResponse(serializer.data, safe=<span style=\"color: #000000;\">False)\r\n\r\n    </span><span style=\"color: #0000ff;\">elif</span> request.method == <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">POST</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">:\r\n        data </span>=<span style=\"color: #000000;\"> JSONParser().parse(request)\r\n        serializer </span>= SnippetSerializer(data=<span style=\"color: #000000;\">data)\r\n        </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> serializer.is_valid():\r\n            serializer.save()\r\n            </span><span style=\"color: #0000ff;\">return</span> JsonResponse(serializer.data, status=201<span style=\"color: #000000;\">)\r\n        </span><span style=\"color: #0000ff;\">return</span> JsonResponse(serializer.errors, status=400<span style=\"color: #000000;\">)\r\n\r\n\r\n@csrf_exempt\r\n</span><span style=\"color: #0000ff;\">def</span><span style=\"color: #000000;\"> snippet_detail(request, pk):\r\n    </span><span style=\"color: #800000;\">\"\"\"</span><span style=\"color: #800000;\">\r\n    Retrieve, update or delete a code snippet.\r\n    </span><span style=\"color: #800000;\">\"\"\"</span>\r\n    <span style=\"color: #0000ff;\">try</span><span style=\"color: #000000;\">:\r\n        snippet </span>= Snippet.objects.get(pk=<span style=\"color: #000000;\">pk)\r\n    </span><span style=\"color: #0000ff;\">except</span><span style=\"color: #000000;\"> Snippet.DoesNotExist:\r\n        </span><span style=\"color: #0000ff;\">return</span> HttpResponse(status=404<span style=\"color: #000000;\">)\r\n\r\n    </span><span style=\"color: #0000ff;\">if</span> request.method == <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">GET</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">:\r\n        serializer </span>=<span style=\"color: #000000;\"> SnippetSerializer(snippet)\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> JsonResponse(serializer.data)\r\n\r\n    </span><span style=\"color: #0000ff;\">elif</span> request.method == <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">PUT</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">:\r\n        data </span>=<span style=\"color: #000000;\"> JSONParser().parse(request)\r\n        serializer </span>= SnippetSerializer(snippet, data=<span style=\"color: #000000;\">data)\r\n        </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> serializer.is_valid():\r\n            serializer.save()\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> JsonResponse(serializer.data)\r\n        </span><span style=\"color: #0000ff;\">return</span> JsonResponse(serializer.errors, status=400<span style=\"color: #000000;\">)\r\n\r\n    </span><span style=\"color: #0000ff;\">elif</span> request.method == <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">DELETE</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">:\r\n        snippet.delete()\r\n        </span><span style=\"color: #0000ff;\">return</span> HttpResponse(status=204)</pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">上面的代码都比较好理解，定<span style=\"color: #ff0000;\">义了不同http动作时后台不同的操作</span>，在这里也体现了restful API的理念。</span></p>\r\n<p><span style=\"font-size: 15px;\">because we want to be able to POST to this view from clients that won't have a CSRF token we need to mark the view as <code>csrf_exempt</code>.</span></p>\r\n<p><span style=\"font-size: 15px;\">因为我们希望能够从不具有CSRF令牌的客户端对此视图进行POST，因此我们需要给视图加个一个<span style=\"color: #ff0000;\">装饰器</span><span style=\"color: #ff0000;\"><code>csrf_exempt</code></span></span></p>\r\n<p> </p>\r\n<p><span style=\"font-size: 15px;\">为了让视图函数被调用，那当然需要设计一下url了，这里的处理和平时Django开发时是一样的。首先创建snippets/urls.py</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\"><span style=\"color: #0000ff;\">from</span> django.conf.urls <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> url\r\n</span><span style=\"color: #0000ff;\">from</span> snippets <span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> views\r\n\r\nurlpatterns </span>=<span style=\"color: #000000;\"> [\r\n    url(r</span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">^snippets/$</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">, views.snippet_list),\r\n    url(r</span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">^snippets/(?P&lt;pk&gt;[0-9]+)/$</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">, views.snippet_detail),\r\n]</span></span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">We also need to wire up the root urlconf, in the <code>tutorial/urls.py</code> file, to include our snippet app's URLs.</span></p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:python;gutter:true;\"><span style=\"font-size: 13px;\">from django.conf.urls import url, include\r\n\r\nurlpatterns = [\r\n    url(r'^', include('snippets.urls')),\r\n]\r\n</span></pre>\r\n</div>\r\n<p>　　</p>\r\n<h3 id=\"api\"><span style=\"font-size: 14pt;\">七、对API进行测试</span></h3>\r\n<p><span style=\"font-size: 15px;\">完成了上面那些工作后，就可以开始测试了，退出shell模式并启动服务器，根据我们刚才设计的url发送请求，需要先安装httpie模块：</span></p>\r\n<div class=\"codehilite\">\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 13px;\">pip install httpie</span></pre>\r\n</div>\r\n<p><span style=\"font-size: 15px;\">然后在命令行窗口访问，效果如下： </span></p>\r\n<img src=\"http://images2017.cnblogs.com/blog/1038183/201711/1038183-20171101135437685-1837373040.png\" alt=\"\" width=\"465\" height=\"490\">\r\n<p><span style=\"font-size: 15px;\">也可以访问指定id的数据： </span></p>\r\n<img src=\"http://images2017.cnblogs.com/blog/1038183/201711/1038183-20171101135445576-1179074385.png\" alt=\"\">\r\n<p><span style=\"font-size: 15px;\"> 当然了，也可以直接在浏览器查看，直接输入那个URL就可以了： </span></p>\r\n</div>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/1038183/201711/1038183-20171101135507638-1279203267.png\" alt=\"\" width=\"1979\" height=\"87\"></p>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 14:31</span> <a href=\"http://www.cnblogs.com/0zcl/\">前程明亮</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7765807\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7765807);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=309748,cb_entryId=7765807,cb_blogApp=currentBlogApp,cb_blogUserGuid='2d754e22-4a8d-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/1 14:31:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 92, "image_url": ["https://pic.cnblogs.com/face/1038183/20170210110513.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "ASP.NET Core中的OWASP Top 10 十大风险-SQL注入", "url": "http://www.cnblogs.com/chen-jie/p/owasp-top-10-asp-net-core-sql-injection.html", "author": "东城慕水", "article_desc": "不定时更新翻译系列，此系列更新毫无时间规律，文笔菜翻译菜求各位看官老爷们轻喷，如觉得我翻译有问题请挪步原博客地址 本博文翻译自： \" https://dotnetcoretutorials.com/2017/10/11/owasp top 10 asp net core sql injection/ ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/chen-jie/p/owasp-top-10-asp-net-core-sql-injection.html\">ASP.NET Core中的OWASP Top 10 十大风险-SQL注入</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p><strong>不定时更新翻译系列，此系列更新毫无时间规律，文笔菜翻译菜求各位看官老爷们轻喷，如觉得我翻译有问题请挪步原博客地址</strong></p>\n<p><strong>本博文翻译自：</strong><br>\n<a href=\"https://dotnetcoretutorials.com/2017/10/11/owasp-top-10-asp-net-core-sql-injection/\"><strong>https://dotnetcoretutorials.com/2017/10/11/owasp-top-10-asp-net-core-sql-injection/</strong></a></p>\n<p>OWASP或者说是开放Web应用程序安全项目，这是一个非营利性的组织，其目的是促进安全的web应用程序的开发和设计。当他们在世界各地举办不同的研讨会和活动时，你可能听说过他们，因为“OWASP Top Ten”项目。每隔几年，OWASP就会发布十大最重要的web安全风险列表。当然，这并不意味着您需要检查这10个项目，您的网站现在是安全的，但它绝对涵盖了您的网站上最常见的攻击媒介的基础。</p>\n<p>当我第一次开始编程并听说OWASP的时候，对我来说最困难的事情就是把它变成实际的东西，例如，当有人开始谈论“CSRF”时，我想知道在.NET中，它是什么样子，它保护自己的基本原则是什么，.NET的系统中有什么(如果有的话)?这篇10部分的文章系列将尝试在ASP.net Core的领域中回答这些问题。您绝对不会突然对所有网络攻击都可以免疫，但是希望可以帮助您从ASP.net Core角度了解OWASP十大安全风险。</p>\n<p>另外要注意的是，我将基于<a href=\"https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project#tab=OWASP_Top_10_for_2017_Release_Candidate_1\">OWASP 2017 候选发布版</a>的前10名。这些尚未被接受为2017年的官方十强，如果他们改变，我一定会添加额外的文章来涵盖一切。</p>\n<p>所以不用多说，我们开始吧！我们列出的第一个项目是SQL注入。</p>\n<h3 id=\"sql注入如何工作\">SQL注入如何工作？</h3>\n<p>SQL注入可以通过修改一个已知的输入参数来修改SQL语句，而这个SQL语句的执行方式与我们预期的非常不同。这听起来像是一大堆的胡言乱语，我们来举个例子吧。</p>\n<p>如果您想要在您的机器上运行整个工作代码项目，您可以从<a href=\"https://github.com/DotNetCoreTutorials/OWASP_Top10_SQLInjection\">Github</a>那里获取任何东西。您仍然可以在没有代码的情况下继续进行下去，因为我将在整个过程中发布代码示例和屏幕截图。</p>\n<p>首先让我们创建一个包含两个表的数据库。第一个表名为“NonsensitiveDataTable”,它包含一些我们不敏感可以向用户分享的数据。第二个表名为“SensitiveDataTable”它包含用户信用卡和社会保障号码。下面是SQL Server中的表。</p>\n<p><img src=\"https://i2.wp.com/dotnetcoretutorials.com/wp-content/uploads/2017/10/SQLInjectionTables.png?resize=506%2C159\" title=\"SQLInjectionTables\"></p>\n<p>现在我们假设我们有一个API方法。这个方法的作用就是让我们通过id来向NonSensitiveDataTable表请求数据。</p>\n<pre><code>[HttpGet]\n[Route(\"nonsensitive\")]\npublic string GetNonSensitiveDataById()\n{\n    using (SqlConnection connection = new SqlConnection(_configuration.GetValue&lt;string&gt;(\"ConnectionString\")))\n    {\n        connection.Open();\n        SqlCommand command = new SqlCommand($\"SELECT * FROM NonSensitiveDataTable WHERE Id = {Request.Query[\"id\"]}\", connection);\n        using (var reader = command.ExecuteReader())\n        {\n            if (reader.Read())\n            {\n                string returnString = string.Empty;\n                returnString += $\"Name : {reader[\"Name\"]}. \";\n                returnString += $\"Description : {reader[\"Description\"]}\";\n                return returnString;\n            }\n            else\n            {\n                return string.Empty;\n            }\n        }\n    }\n}</code></pre>\n<p>这是一个相当极端的例子，编码相当差，但它说明了这一点。我们通过调用这个方法获取数据，似乎没问题。</p>\n<p><img src=\"https://i2.wp.com/dotnetcoretutorials.com/wp-content/uploads/2017/10/SQLInjectionWorking.png?resize=419%2C71\" title=\"SQLInjectionWorking\"></p>\n<p>但是只要看代码，我们就可以看到有疑问的东西。值得注意的是：</p>\n<pre><code>SqlCommand command = new SqlCommand($\"SELECT * FROM NonSensitiveDataTable WHERE Id = {Request.Query[\"id\"]}\", connection);</code></pre>\n<p>我们正在将Id参数直接传递到SQL语句中，难道我们可以在那里输入任何东西？那么我们知道当我们要求2的ID时，“Mark Twain”的记录就会被返回。但让我们来试试这个：</p>\n<p><img src=\"https://i2.wp.com/dotnetcoretutorials.com/wp-content/uploads/2017/10/SQLInjectionOR.png?resize=487%2C68\" title=\"SQLInjectionOR\"></p>\n<p>哇…。那么为什么我们添加测试“OR id = 1”会突然改变一切。答案在于我们上面的代码。当我们简单地将“2”的id传递给我们的代码时，最终执行这个语句。</p>\n<pre><code>SELECT * FROM NonSensitiveDataTable WHERE Id = 2</code></pre>\n<p>但是当我们通过OR语句时，它实际上会像这样读取：</p>\n<pre><code>SELECT * FROM NonSensitiveDataTable WHERE Id = 2 OR Id = 1</code></pre>\n<p>所以在这里我们已经设法通过更改查询参数来修改执行的SQL语句。但没有什么大不了的对吗？用户将收到错误的数据，那就是结束了。那么，因为我们知道我们可以修改SQL语句。让我们尝试一些时髦的东西。让我们试试这个网址：</p>\n<p><img src=\"https://i2.wp.com/dotnetcoretutorials.com/wp-content/uploads/2017/10/SQLInjectionCreditCardLeak.png?resize=702%2C70\" title=\"SQLInjectionCreditCardLeak\"></p>\n<p>呃哦，看起来不好看 运行的查询结果如下所示：</p>\n<pre><code>SELECT * FROM NonSensitiveDataTable WHERE Id = 999 UNION SELECT * FROM SensitiveDataTable</code></pre>\n<p>我们在NonSensitiveDataTable表中查询ID为999的记录，并且和SensitiveDataTable表的数据关联起来，因为没有999的ID的记录我们会立即跳过，不过我们发现我们的敏感信息已经被泄露。</p>\n<p>如果这是一个电子商务网站，他们将会有一个“客户”表和一个“订单”表等等。那么这个时候我们的信息已经被泄露，SQL注入并不像复制粘贴URL那样简单，但是有了它们我们好像有了打开王国大门的钥匙。</p>\n<p>好的，让我们再试一次。让我们尝试以下查询。它会告诉我们数据库中的表名。</p>\n<pre><code>SELECT * FROM NonSensitiveDataTable WHERE Id = 999 UNION SELECT 1 as ID, Name as NAME, Name as Description FROM sys.Tables WHERE name &lt;&gt; 'NonSensitiveDataTable'</code></pre>\n<p><img src=\"https://i2.wp.com/dotnetcoretutorials.com/wp-content/uploads/2017/10/SQLInjectionShowTables.png?resize=629%2C81\" title=\"SQLInjectionShowTables\"></p>\n<p>您经常会在web上发现SQL注入的“规则”，其中有大量的SQL命令可以尝试。你有它，少一点猜测。我们可以在这里坐上几天，把命令扔到这里。在SQL注入的情况下，对方的数据库里有什么简直一目了然</p>\n<p>我将留给您一个最后的查询，您可以尝试并运行。假设你在试图获取数据时感到沮丧，你只是想毁掉某人的一天。想象一下运行以下命令:</p>\n<pre><code>SELECT * FROM NonSensitiveDataTable WHERE Id = 999; DROP TABLE SensitiveDataTable</code></pre>\n<p>这里我们已经放弃了，我们只需要删除一个表。也许我们甚至可以获取所有的数据，如果我们只是想让DBA的生活变得痛苦。这肯定是一种方法!</p>\n<p>现在我们大致知道了SQL注入是什么，让我们继续保护自己！</p>\n<h3 id=\"清理您的输入\">清理您的输入</h3>\n<p>您经常会发现，关于任何描述SQL注入攻击的文章的第一条评论是“始终对您的输入进行清理”（紧接着“在您的查询中使用参数代替更好！” ）- 但这些稍后再说。对您的输入进行清理可能意味着几件事情，让我们来看看。</p>\n<h4 id=\"转换为非字符串类型\">转换为非字符串类型</h4>\n<p>在我们的示例代码中，因为我们知道我们的Id应该是一个int。我们可以这样：</p>\n<pre><code>int id = int.Parse(Request.Query[\"id\"]);\nSqlCommand command = new SqlCommand($\"SELECT * FROM NonSensitiveDataTable WHERE Id = {id}\", connection);</code></pre>\n<p>完美！现在如果有人试图在我们的查询字符串中添加进一步的信息，它不会被解析为int，我们就会避免注入！</p>\n<p>在ASP.net Cor中一个有个更简单的例子只要允许我们的路由为我们工作，我们就可以达到上面的目的。</p>\n<pre><code>[HttpGet]\n[Route(\"nonsensitiveroute/{id}\")]\npublic string GetNonSensitiveDataByIdWithRoute(int id)</code></pre>\n<p>现在我们甚至不需要做任何手工解析。ASP.net Core路由将为我们处理它!</p>\n<p>当然，如果您的查询实际上是针对整数列的，那么这能起作用。如果我们真的需要传递字符串，那又会怎样呢?</p>\n<h4 id=\"白名单黑名单字符替换\">白名单/黑名单/字符替换</h4>\n<p>老实说，我不想深入到这个问题，因为我认为这是一个很容易出错的处理SQL注入的方法。但是，如果必须，您可以在传递到SQL之前，对已知正确值的白名单或黑名单运行字符串。或者您可以替换某些字符的所有实例（引号，分号等）。但是所有这些都依赖于你在攻击之前的一步。你也会把你对SQL语言的复杂性的知识与别人混淆。</p>\n<p>虽然像PHP这样的语言具有“转义”SQL字符串的内置函数，但.NET core不支持。<a href=\"https://stackoverflow.com/questions/5741187/sql-injection-that-gets-around-mysql-real-escape-string\">此外，简单地转义引号也不能从根本解决SQL注入问题</a>.。</p>\n<p>始终对输入进行清理需要您“记住”来做到这一点。这并不是一种可以遵循的模式。这很有效。但这不是理想的解决方案。</p>\n<h3 id=\"参数化查询\">参数化查询</h3>\n<p>在您的SQL查询中使用参数将成为您抵御SQL注入攻击的首选。即使您正在使用某种类型的ORM(在下面讨论了一点)，但在幕后，他们可能会使用参数化的查询。</p>\n<p>那么我们如何在我们的示例项目中使用它们呢？我们将会稍微改变一下，而不是在我们的NonSensitiveDataTable表中直接使用“name”字段中进行查询。这样做只是因为它给了我们更多的灵活性。</p>\n<pre><code>[HttpGet]\n[Route(\"nonsensitivewithparam\")]\npublic string GetNonSensitiveDataByNameWithParam()\n{\n    using (SqlConnection connection = new SqlConnection(_configuration.GetValue&lt;string&gt;(\"ConnectionString\")))\n    {\n        connection.Open();\n        SqlCommand command = new SqlCommand($\"SELECT * FROM NonSensitiveDataTable WHERE Name = @name\", connection);\n        command.Parameters.AddWithValue(\"@name\", Request.Query[\"name\"].ToString());\n        using (var reader = command.ExecuteReader())\n        {\n            if (reader.Read())\n            {\n                string returnString = string.Empty;\n                returnString += $\"Name : {reader[\"Name\"]}. \";\n                returnString += $\"Description : {reader[\"Description\"]}\";\n                return returnString;\n            }\n            else\n            {\n                return string.Empty;\n            }\n        }\n    }\n}</code></pre>\n<p>你可以看到我们在我们的查询中添加了哪些参数吗？那么这是如何工作的？那么在SQL Profiler的帮助下，正在发送的实际SQL如下所示：</p>\n<pre><code>exec sp_executesql N'SELECT * FROM NonSensitiveDataTable WHERE Name = @name'\n,N'@name nvarchar(12)'\n,@name=N'Bart Simpson'</code></pre>\n<p>哇...这是一个很大的不同。那么这里发生了什么？我们正在发送查询，但是说“以后，我将告诉您查询什么数据”。我们传递想要查询的确切值，而不是实际的SELECT语句。通过这种方式，我们的原始查询保持不变，并且不影响用户对查询字符串的类型。</p>\n<p>使用参数的最好的方法是它们成为一个简单的模式。你不必“记住”来逃避某些字符串，或者“记住”使用白名单。</p>\n<h3 id=\"存储过程\">存储过程</h3>\n<p>SQL存储过程是避免SQL注入攻击的另一个好方法。尽管现在存储过程似乎对开发人员无所适从，但是它们与参数化查询类似，因为您将通过SELECT语句和查询数据在两个不同的“批次”中传递。我们快速创建一个存储过程来尝试（如果您使用GIT中的示例项目，则您的数据库中已经有该SP，并且不需要运行以下操作）。</p>\n<pre><code>CREATE PROCEDURE SP_GetNonSensitiveDataByName\n    @Name nvarchar(MAX)\nAS\nBEGIN\n    SET NOCOUNT ON;\n    SELECT * FROM NonSensitiveDataTable WHERE Name = @Name\nEND</code></pre>\n<p>让我们创建一个API方法，运行它。</p>\n<pre><code>[HttpGet]\n[Route(\"nonsensitivewithsp\")]\npublic string GetNonSensitiveDataByNameWithSP()\n{\n    using (SqlConnection connection = new SqlConnection(_configuration.GetValue&lt;string&gt;(\"ConnectionString\")))\n    {\n        connection.Open();\n        SqlCommand command = new SqlCommand(\"SP_GetNonSensitiveDataByName\", connection);\n        command.CommandType = System.Data.CommandType.StoredProcedure;\n        command.Parameters.AddWithValue(\"@name\", Request.Query[\"name\"].ToString());\n        using (var reader = command.ExecuteReader())\n        {\n            if (reader.Read())\n            {\n                string returnString = string.Empty;\n                returnString += $\"Name : {reader[\"Name\"]}. \";\n                returnString += $\"Description : {reader[\"Description\"]}\";\n                return returnString;\n            }\n            else\n            {\n                return string.Empty;\n            }\n        }\n    }\n}</code></pre>\n<p>当我们使用SQL Profiler运行这个方法时，我们可以看到以下运行。</p>\n<pre><code>exec SP_GetNonSensitiveDataByName @name=N'bart simpson'</code></pre>\n<p>如您所见，它与上面的参数化查询非常相似，我们的查询的实际细节是单独发送的。虽然现在很少看到一个围绕存储过程构建的整个项目，但它们可以保护您免受SQL注入攻击。</p>\n<h3 id=\"使用orm\">使用ORM</h3>\n<p>现在下一部分是减轻SQL注入攻击的有趣部分。因为在某种意义上，它成为一个一站式的保护。但是我把它放在最后的原因是因为我认为最好能理解在保护你的ORM的基础上发生了什么。</p>\n<p>如果您使用的实体框架。当您运行Linq查询以获取数据时，任何linq“Where”语句将被打包为参数查询并发送到SQL Server。这意味着你真的需要走出自己的方式来打开自己，直到SQL注入，但这不是不可能的！几乎所有的ORM都可以发送原始的SQL查询，如果你真的想。看看Microsoft的这篇文章<a href=\"https://docs.microsoft.com/en-us/ef/core/querying/raw-sql\">通过Entity Framework Core发送原始SQL</a>。至少，使用ORM可以使SQL注入成为“默认”，而不是从外部添加一些东西。</p>\n<h3 id=\"赋予最低的权限\">赋予最低的权限</h3>\n<p>还记得我们的drop table命令吗?如果你忘了，下面是:</p>\n<pre><code>SELECT * FROM NonSensitiveDataTable WHERE Id = 999; DROP TABLE SensitiveDataTable</code></pre>\n<p>我们的网站真的需要删除一个表吗?不太可能然而，在我们的场景中，我们已经把王国大门的钥匙交给了外人让他去做任何它喜欢做的事。授予细粒度权限或最低权限级别是我们“停止”SQL注入攻击的最后一步。我把“停止”放在引号中，因为在现实中我们仍然容易受到敏感数据泄露的攻击，但是我们的攻击者至少不能删除表（但是它们仍然可以运行delete命令！）。</p>\n<p>大多数SQL系统（MYSQL，Postgres，MSSQL）内置SQL角色，只允许简单的读取和写入来完成，但不能修改实际的表模式。应尽可能使用这些角色来限制任何可能的攻击。</p>\n<h3 id=\"总结\">总结</h3>\n<p>正如我们所看到的，SQL注入对于泄露敏感数据甚至是毁灭它可能是非常残酷的。但是我们也看到ASP.net Core 已经有了我们可以保护自己的方法。在依赖于输入解析/类型转换的过程中，我们可以使用参数化查询，来避免SQL注入。</p>\n<p><strong>欢迎转载，转载请注明翻译原文出处(本文章)，原文出处(原博客地址)，然后谢谢观看</strong></p>\n<p><strong>如果觉得我的翻译对您有帮助，请点击推荐支持：）</strong></p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 14:00</span> <a href=\"http://www.cnblogs.com/chen-jie/\">东城慕水</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766048\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766048);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=231604,cb_entryId=7766048,cb_blogApp=currentBlogApp,cb_blogUserGuid='ab7f2b3a-ac11-e511-b908-9dcfd8948a71',cb_entryCreatedDate='2017/11/1 14:00:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 277, "image_url": ["https://pic.cnblogs.com/face/774226/20170730190037.png"], "date_pub": "2017-11-01", "article_common": 3}
{"title": "聊聊 Material Design 里，阴影的那些事儿！", "url": "http://www.cnblogs.com/plokmju/p/7766076.html", "author": "承香墨影", "article_desc": "当你的设计师要求你在某个 View 上增加阴影效果，那你只需要认真阅读本文，阴影的问题就不再是问题。 一、前言 设计师的世界，与常人不同，有时候想要扁平化的风格，有时候又想要拟物化的风格。而在 Material Design 出来之后，为 UI 元素引入了高度的概念，它可以让某个元素更为突出，显示出 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/plokmju/p/7766076.html\">聊聊 Material Design 里，阴影的那些事儿！</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/011ad8e77a7794301a73d61abae00612\"></p>\n<blockquote>\n<p>当你的设计师要求你在某个 View 上增加阴影效果，那你只需要认真阅读本文，阴影的问题就不再是问题。</p>\n</blockquote>\n<h2 id=\"一前言\">一、前言</h2>\n<p>设计师的世界，与常人不同，有时候想要扁平化的风格，有时候又想要拟物化的风格。而在 Material Design 出来之后，为 UI 元素引入了高度的概念，它可以让某个元素更为突出，显示出它的重要性，更让人有点击的欲望。</p>\n<p>在拟物化的设计里，UI 元素的高度，反应在效果上，就是在边框上有阴影的效果，感觉它是距离底部有一个层次的关系。在 Material Design 的设计中，也大量的使用了 <strong>阴影</strong> 的效果，例如：FloatingActionButton、CardView 这些控件，都是默认支持阴影效果的。</p>\n<p>如果你想了解 Material Design 中，更多关于阴影的设计，可以查阅官方文档。</p>\n<blockquote>\n<p><a href=\"https://material.io/guidelines/material-design/elevation-shadows.html?hl=zh-cn\" class=\"uri\">https://material.io/guidelines/material-design/elevation-shadows.html?hl=zh-cn</a></p>\n</blockquote>\n<p>接下来，我们就来介绍一下，在 Android 的不同版本中，使用不同的方式，去实现阴影的效果。</p>\n<p>先来看看实现的效果，虽然多，但是它们实现的方法都不相同。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/1118c3fc6c939da6a7620840e08e4bfb\" alt=\"/all_5.jpeg\"></p>\n<h2 id=\"二阴影的效果\">二、阴影的效果</h2>\n<p>在拟物化的世界里，阴影主要是对三维空间中的 Z 属性进行操作。下面是官网的介绍。</p>\n<blockquote>\n<p>由 Z 属性所表示的视图高度将决定其阴影的视觉外观：拥有较高 Z 值的视图将投射更大且更柔和的阴影。 拥有较高 Z 值的视图将挡住拥有较低 Z 值的视图；不过视图的 Z 值并不影响视图的大小。</p>\n<p>阴影是由提升的视图的父项所绘制，因此将受到标准视图裁剪的影响，而在默认情况下裁剪将由父项执行。</p>\n<p><a href=\"https://developer.android.com/training/material/shadows-clipping.html?hl=zh-cn#Elevation\" class=\"uri\">https://developer.android.com/training/material/shadows-clipping.html?hl=zh-cn#Elevation</a></p>\n</blockquote>\n<p>静态效果如下：</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/60256aa68dd1545861b4624975388802\" alt=\"/shadows-depth.png\"></p>\n<p>再加上，动态的效果应该更能让你对阴影有所理解。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/7ce76d239ad44c2db1e440e340629ab6\"></p>\n<h2 id=\"三使用标准-api\">三、使用标准 Api</h2>\n<p>Material Design 首次出现在 Android 5.0 中，之后又有一些 Support 包，让更低的版本，对 Material Design 进行支持。</p>\n<p>而在 Api Level 21 之中，增加了两个属性 ：</p>\n<ul>\n<li>elevation：高度，用于提升 UI 元素高度的属性。</li>\n<li>translationZ：Z 轴的变换效果。</li>\n</ul>\n<p>这两个属性，有对应的 xml 属性和 <code>setXxx()</code> 方法，而 Z 轴的改变，主要是由这两个属性决定的。</p>\n<blockquote>\n<p><strong>Z = elevation + translationZ</strong></p>\n</blockquote>\n<p>所以，如果你的 App 的 minSdkVersion 就是 21 的话，直接使用这两个属性是最优的解决办法。</p>\n<h3 id=\"elevation-属性\">3.1 elevation 属性</h3>\n<p>elevation 属性，主要用于给 View 增加一个高度，可以直接被加在 View 控件上，呈现在界面上，就是一个带阴影的效果。</p>\n<p>在 layout-xml 布局中，可以通过 <code>android:elevation</code> 属性来设置，而在 Java 代码中，通过 <code>View.setElevation()</code> 方法来使用它。</p>\n<p>直接使用 elevation 属性设置即可，它接收一个高度的参数，只需要按我们的需要配置即可。</p>\n<p>需要注意的是，View 的阴影一定是需要有背景的 View 在视觉上增高之后，投射出来的。也就是类似于打光的阴影效果。简单来说，就是需要为 View 设置一个 Background，可以使用 <code>android:background</code> 属性或者 <code>View.setBackground()</code> 方法设置，否者 elevation 的属性设置将无效。这里的 Background 只需要设置一个 Drawable 即可，你当然也可以选择一个图片或者一个纯色的 </p>\n<p>下面来看看 elevation 属性的效果：</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/7aa6af02946f3db3102a800a591fb280\" alt=\"/setElevation.png\"></p>\n<p>往深里再看看 elevation 属性的实现方式。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/927c41ec0cfe6b64d113812177775072\" alt=\"/setElevationMethod.png\"></p>\n<p>它最终还是调用的 mRenderNode 去做的操作，在追踪下去，就会发现它底层是用的 native 的方法实现的，所以应该不是我们所理解的用 2D 的渐变模拟阴影的效果。</p>\n<h3 id=\"translationz-属性\">3.2 translationZ 属性</h3>\n<p>translationZ 属性，主要用于给 View 增加一个在 Z 轴上的变换效果。它和 elevation 配合起来，就是一个一加一等于二的效果。也可以用于设置 View 的高度。</p>\n<p>在 layout-xml 布局中，可以通过 <code>android:translationZ</code> 属性来设置它，而在 Java 代码中，可以通过 <code>View.setTranslationZ()</code> 方法来使用它。</p>\n<p>一般来说，我们可以直接使用 <code>android:translationZ</code> 属性来设置 View，当你配合 <code>android:elevation</code> 属性一起使用的时候，它们对 View 的高度是累加的，当然你也可以只使用其中一个属性。</p>\n<p>而看到 translationZ 这样的属性，很轻易就联想到了 translationX 和 translationY 了，它们实际上就是不同维度的设置，思路上很像，但是原理不同。对 X、Y 轴的操作并没有 Api Level 的限制，这一点需要清楚。</p>\n<p>和 elevation 属性一样，translationZ 也是需要配合 Background 的设置才会生效的，这个应该不难理解。</p>\n<p>下面我们来看看 translationZ 属性的设置效果：</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/27e1a540a9af8534964be14456a202ae\" alt=\"/setTranslationZ.png\"></p>\n<p>使用 translationZ 属性实现的效果，看着和 elevation 的效果很像，而它内部也是依赖于 mRenderNode 去做的实现。</p>\n<h3 id=\"viewcompat-来兼容-api\">3.3 ViewCompat 来兼容 Api</h3>\n<p>前面就已经提到，当你的 minSdkVersion 达不到 elevation 和 translationZ 这两个 Api 的要求，设置为 Api Level 21（Android 5.0） 以下。你在使用这两个属性的时候，会给你提示 Warning，如果打包的时候有 Lint 的校验，也是会提示并且导致打包失败的。</p>\n<p>不过看提示你也能发现到底是什么问题：</p>\n<blockquote>\n<p>Attribute elevation is only used in API level 21 and higher</p>\n</blockquote>\n<p>如果已经明确在低于 Api Level 21 之下的版本，都不加阴影的效果，你可以在布局中，使用 <code>tools:targetApi=\"lollipop\"</code> 来消除这个 Warning。</p>\n<p>如果你是在 Java 代码中，为 View 动态设置 elevation 或者 translationZ 属性的话，除了使用 <code>Build.VERSION_CODES.LOLLIPOP</code> 判断之外，还可以使用 <strong>ViewCompat</strong> 这个 Android 为我们提供的标准的 View 兼容类，当然，这里推荐使用 ViewCompat。</p>\n<p>既然要用到 ViewCompat 的话，那我们来看看它的原理是什么。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/4b9112093c7b356a91a90494993de0c1\" alt=\"/ViewCompatImpl.png\"></p>\n<p>在 ViewCompat 中，会有很多个实现了 ViewCompatBaseImpl 的接口类，它们分别对应了不同的 Api Level ，会在静态代码块中，根据当前运行设备的 Api Level ，做不同的实现。而这些，都是高版本继承低版本的实现，来达到继承兼容的效果。</p>\n<p>ViewCompatBaseImpl 这个接口中，定义了很多关于 View 的操作 Api ，这些 Api 都是存在不同的 Api 版本限制的。</p>\n<p>在 Api Level 21 中，本身就已经支持了这两个属性，也就不存在兼容性的问题了，所以它其中会直接调用 <code>setElevation()</code> 和 <code>setTranslationZ()</code> 方法。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/9203ff18f54b1446b1faebdc449949e1\" alt=\"/ViewCompatV21.png\"></p>\n<p>那么，我们只需要关心 Api Level 21 以下的实现。通常来说，我们做兼容处理，一个方案就是在低版本上，使用一些只在低版本上存在 Api，来对高版本的效果进行模拟；另外一个方案就是放弃低版本，完全对它不做任何处理。</p>\n<p>我们来看看 ViewCompat 是对 Elevation 是选用的那个方案。其实 Api Level 21 之下，都没有对这两个属性的操作方法，做任何的处理，你一路追踪下去可以追踪到 ViewCompatBaseImpl 。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/618382d9bfff2ed95c6d5b1024edf5a5\" alt=\"/ViewCompatBaseImpl.png\"></p>\n<p>从这里可以看出，ViewCompat 没有对这两个方法做任何的兼容，在低版本上，没有做任何的操作，这也导致了你如果使用 ViewCompat 的话，在低版本上是不会有阴影的效果的。没有就是没有，这里就不再单独展示了。</p>\n<p>那看看使用 ViewCompat 在高版本上的效果图，其实和之前的也没啥区别，不过摆在一起看更清晰一些。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/a0fed2507eb104e0c19c7bf0c35c2fb5\" alt=\"/Api-demo-pic.png\"></p>\n<h3 id=\"标准-api-小结\">3.4 标准 Api 小结</h3>\n<p>到现在你也能看到，如果不在意 Api level 的话，你完全可以使用 <code>android:elevation</code> 和 <code>android:translationZ</code> 两个属性来做的阴影的效果，效果也是非常好的，而且它的阴影实际上是不占用 View 的布局大小的，它会在原本的布局之外，向外扩散，所以也不会影响 View 本身大小的视觉效果。</p>\n<p>不过它也有缺陷，你只能通过设定这两个属性来调整阴影的大小，没办法做到精确掌控，并且无法修改阴影的颜色。</p>\n<p>最新的 Android 版本市场占有率，你可以在这个网站上查到。</p>\n<blockquote>\n<p><a href=\"https://developer.android.com/about/dashboards/index.html?hl=zh-cn\" class=\"uri\">https://developer.android.com/about/dashboards/index.html?hl=zh-cn</a></p>\n</blockquote>\n<p>截止到本文编写的时候，低于 5.0 的版本，差不多在 20% 左右，是否对这部分用户，放弃阴影的效果，取决于你的产品和设计师。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/230746b626ba25fc2abcbe32f7100bd8\" alt=\"/Android-level.png\"></p>\n<p>如果你需要兼容低版本的设备，后面介绍的一些方法，都可以做到，继续往下阅读吧。</p>\n<h2 id=\"四使用9patch图\">四、使用9Patch图</h2>\n<h3 id=\"什么上-9patch-图\">4.1 什么上 9Patch 图</h3>\n<p>如果你需要兼容低版本的 Android 设备，使用 android:elevation 和 android:translationZ 是无法做到的，它们会在低版本上失效，完全没有效果，当然前提是你需要做好 Warning 的处理。</p>\n<p>而这种阴影的效果，使用 <code>.9</code>图，也是一个不错的选择。</p>\n<p><code>.9</code> 图 就是 9Patch， 引用官网的介绍：</p>\n<blockquote>\n<p>Draw 9-patch 工具是 Android Studio 中包含的一种 WYSIWYG（所见即所得）编辑器，利用此工具，您可以创建能够自动调整大小以适应视图内容和屏幕尺寸的位图图像。图像的选定部分可以根据图像内绘制的指示器在水平或竖直方向上调整比例。</p>\n<p><a href=\"https://developer.android.com/studio/write/draw9patch.html?hl=zh-cn\" class=\"uri\">https://developer.android.com/studio/write/draw9patch.html?hl=zh-cn</a></p>\n</blockquote>\n<h3 id=\"使用-9patch-设置阴影\">4.2 使用 9Patch 设置阴影</h3>\n<p>直接制作一个带阴影效果的 <code>.9</code> 图片，然后设置好内容区域和拉伸区域，就可以在其中模拟出阴影的效果。</p>\n<p>举个例子，使用一个 <code>.9</code> 图，然后设置在 ImageView 上的背景。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/b5407a3cea1e7c7b6cf704490e78f7f4\" alt=\"/9patch.png\"></p>\n<p>在 layout-xml 上，只需要给 ImageView 设置好 <code>android:background</code> 就可以了。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/67048a11ece767b3a701a30b4a710fc5\" alt=\"/9patch-xml.png\"></p>\n<p>来看看它实现的效果：</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/3c158aff7788845d4b01c88ba935dae4\" alt=\"/9patch-xiaoguo.png\"></p>\n<p>使用 <code>.9</code> 图设置的阴影，效果一般都是有保障的。不过它会作为 View 的背景被设置，所以阴影上占据 View 的大小的，所以使用图片模拟出来的阴影，View 本身的视觉效果会小。</p>\n<p>放张单图，可能看不出效果，将一个使用 ViewCompat 实现的效果，放在一起，你就可以看到对比的效果。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/9b72bb154121bcd1e37fd673438844be\" alt=\"/9patch-duibi.png\"></p>\n<p>这里，两个 ImageView ，实际设置的大小，都是 100dp，但是视觉上，使用 .9 实现的效果，视觉效果就会小。</p>\n<h3 id=\"快速制作-9patch\">4.3 快速制作 9Patch</h3>\n<p><code>.9</code> 的图，一般都是设计师会提供给我们。这里也推荐一个可以制作阴影效果的在线工具。</p>\n<blockquote>\n<p><a href=\"http://inloop.github.io/shadow4android/\" class=\"uri\">http://inloop.github.io/shadow4android/</a></p>\n</blockquote>\n<p>通过这个工具，你可以对 <code>.9</code> 图做各种调整，例如：圆角、阴影的大小、阴影的颜色等等，都是非常方便的设置。前面例子中使用的 <code>.9</code> 文件，就是使用此工具制作的。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/e5d4c8223d385aeb0e2b12deeeb0e114\" alt=\"/9patch-web.png\"></p>\n<p>还有一种方式，就是使用 </p>\n<h3 id=\"patch-模拟阴影小结\">4.4 9Patch 模拟阴影小结</h3>\n<p>使用 .9 图，制作阴影，基本上不需要担心效果的问题，使用起来也非常的方便。唯一的问题就是它的阴影部分，会占用 View 本身的大小，导致 View 在视觉上缩小。</p>\n<p>总结来说，它的优点：</p>\n<ol>\n<li>实现方便，只需要设置背景即可。</li>\n<li>阴影的效果可控，颜色、圆角、阴影大小都是可以调整的。</li>\n</ol>\n<p>它的缺点也非常的明显：</p>\n<ol>\n<li>为了让 View 在视觉上和效果图匹配，需要预留出阴影的空间。</li>\n</ol>\n<h2 id=\"五使用-fab-的原理模拟阴影\">五、使用 FAB 的原理模拟阴影</h2>\n<p>我们知道，在 Android 对 Material Design 的效果中，有一些控件，就是自带阴影效果的，并且它也是对低版本兼容的。例如：FloatingActionButton 、CardView 等。</p>\n<p>那么，本小结就来看看 FloatingActionButton 实现阴影的原理。</p>\n<h3 id=\"fab-的阴影原理\">5.1 FAB 的阴影原理</h3>\n<p>就 FAB 这种有 Support.design 包支持的控件，一般都有对 不同的 Api Level 做支持处理，在 FAB 之中也是一样的，它会根据不同的 Api Level 实现不同的逻辑。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/431b82f59df425a01f543422cef9a4b7\" alt=\"/fab-createImpl.png\"></p>\n<p>可以看到，这里会根据 21、14、&lt;14 三个条件，分别使用不同的实现类，它们内部实际上实现的都是相同的功能。</p>\n<p>如果仔细观察这些 FAB 不同版本的实现类的源码，你可以发现它的阴影效果，都是基于一个 ShadowDrawableWrapper 这个 Drawable 来实现的。</p>\n<p>例如在 FloatingActionButtonGingerbread 中，就有这样一段设置背景的代码。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/db14998645a80403ad5c32c9b77893b6\" alt=\"/fab-gingerbread-background.png\"></p>\n<p>这里完全上依赖 ShadowDrawableWrapper 来做的阴影效果。</p>\n<p>不过 ShadowDrawableWrapper 被声明的可见性为包内可见，所以我们没有办法直接使用它。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/dcb6ba448ac0d1f9f56ffc8b8b7780c3\" alt=\"/fab-shadowdrawable-class.png\"></p>\n<p>不过，鉴于 support.design 包中的类，一般都是为了兼容做处理，这里我们只需要将它和它实现的接口 DrawableWrapper 这两个类，拷贝出来，就可以直接使用了。它们的源码都在 <code>android.support.design/widget</code> 包下面，非常容易找到。</p>\n<p>它的原理是在你本文需要设置的 Drawable 之外，再包装一个 Drawable ，然后在这个包装的 Drawable 上绘制阴影。</p>\n<p>绘制的代码挺多的，这里就不贴代码了，有兴趣可以看看它的源码，主要关注 <code>drawShadow()</code> 方法即可。</p>\n<p>而如果你在拷贝源码的时候，应该能发现，它实际上是可以支持改变阴影的颜色的，如果你有这种需求，只需要再扩展它的构造方法，或者直接在 colors.xml 中配置对应的颜色，它设置颜色地方如下。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/8f41acbc57dfc710c4c5325ca220e4d4\" alt=\"/shadowWrapper-method2.png\"></p>\n<p>可以看到，它主要用三个颜色来做一个渐变的阴影效果。</p>\n<h3 id=\"使用-fab-的原理模拟阴影效果\">5.2 使用 FAB 的原理模拟阴影效果</h3>\n<p>前面说的，我们只需要将 ShadowDrawableWrapper 和 DrawableWrapper 这两个文件复制到我们的工程内，稍微修改一下它们的依赖关系。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/e53d9bcf7932bdbb302b8dcf74e2c991\" alt=\"/fab-project-path.png\"></p>\n<p>如果直接拷贝源码，你会发现它还依赖三个颜色，分别是用于设置阴影的颜色的，这个前面也提到过。一般而言，我们不需要设置它，直接从源码中将它们拷贝出来就可以了。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/572ad8b6b1401e73e9b836e57cc78ae4\" alt=\"/fab-shadow-colors.png\"></p>\n<p>然后我们就可以在 Java 代码中，为 View 动态设置一个阴影效果。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/fd55352aac926cb77f9290ef406c8ccd\" alt=\"/fab-shadow-javacode.png\"></p>\n<p>这些参数，你可以自行根据效果配置，它们的含义，其实看看方法的签名，你就清楚了，这里就不再赘述了。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/a5437f9965ec3b7533308cee13e88b12\" alt=\"/shadowWrapper-method.png\"></p>\n<p>那么，我们来看看使用 FAB 的 ShadowDrawableWrapper 模拟出来的阴影效果如何。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/536516aba62cc0b740084912689127e4\" alt=\"/fab-xiaoguo.png\"></p>\n<h3 id=\"fab-模拟阴影效果小结\">5.3 FAB 模拟阴影效果小结</h3>\n<p>前面提到，ShadowDrawableWrapper 的原理是对原本的 Drawable 做一个包装，在外围绘制阴影的效果，所以说它实际上，阴影部分也是需要占据 View 的空间的，依然会有视觉上，View 会变小。</p>\n<p>不过它的阴影颜色上可控的，也就是说我们可以动态的为其设置阴影的颜色，这样应该会更灵活一些。</p>\n<h2 id=\"六模拟-cardview-实现的阴影\">六、模拟 CardView 实现的阴影</h2>\n<p>我们知道，在 Android 对 Material Design 的效果中，有一些控件，就是自带阴影效果的，并且它也是对低版本兼容的。例如：FloatingActionButton 、CardView 等。</p>\n<p>那么，本小结就来看看 CardView 实现阴影的原理。</p>\n<h3 id=\"cardview-的阴影原理\">6.1 CardView 的阴影原理</h3>\n<p>CardView 在 support.design 包中，你是找不到的，它被放在了 cardview-v7 包中，现在已经可以单独引用了。</p>\n<p>CardView-v7 包中，代码非常的少。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/36f271d6e9b3e4ca092afbfe19941c64\" alt=\"/cardview-lib-path.png\"></p>\n<p>一共就这么几个，一样就可以看到来，有一些类是做 Api 版本兼容的，并且也上如此。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/a5417a05e051d7625f30e7e09d379779\" alt=\"/cardview-impl.png\"></p>\n<p>在其中，还有一个 RoundRectDrawableWithShadow 类，它就是我们要找到，CardView 实现的 Drawable，它只在 CardViewJellybeanMr1 和 cardViewGingerbread 这两个类中使用，CardViewApi21 中，依然是使用的 <code>setElevation()</code> 方法来处理的阴影。</p>\n<p>用之前 FAB 的经验，将 RoundRectDrawableWithShadow 直接拷贝出来，然后运行你会发现有报错。主要是因为其中有个静态的变量 sRoundRectHelper 为空了，没有被初始化。</p>\n<p>仔细查源码你会发现，它在 CardViewJellybeanMr1 和 CardViewGingerbread 的实现原理并不相同。它们会在 <code>initStatic()</code> 方法中，对 sRoundRectHelper 变量进行初始化。</p>\n<p>CardViewJellybeanMr1.initStatic() 方法如下：</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/c429cfe8b5cfd6d7d072a1e8b8ac407f\" alt=\"/cardview-jellybean-initstatic.png\"></p>\n<p>CardViewGingerbread.initStatic() 方法如下：</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/a358181557b2bf5876de180de04e3f26\" alt=\"/cardview-bread-initstatic.png\"></p>\n<p>可以看到它们的实现方法，差异还是挺大的。</p>\n<p>了解清楚这些，我们只需要 RoundRectDrawableWithShadow 的构造方法中，根据 Api Level 对他们进行不同的初始化即可，这些代码也上拷贝出来就可以直接用的。</p>\n<p>绘制阴影的部分都大同小异，这里就不详细看了，有兴趣的可以执行查看源码，主要关注 drawShadow() 方法即可。</p>\n<h3 id=\"举个-cardview-阴影的例子\">6.2 举个 CardView 阴影的例子</h3>\n<p>首先，将 ShadowDrawableWrapper 完整的拷贝到我们的工程里，并且在构造方法中，根据 Api Level ，用不同的逻辑初始化 sRoundRectHelper 。</p>\n<p>还需要将 ShadowDrawableWrapper 使用到的几个默认参数值也拷贝出来，当然我们已经有源码了，直接写死也可以，我这里选择将它们原样拷贝出来。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/a804ba5695ffb6f5974f0bf6bc92f075\" alt=\"/cardview-dims.png\"></p>\n<p>然后我们就可以在代码中，使用这个 RoundRectDrawableWithShadow 了。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/ff8179d84f391a236f796c01a92f26db\" alt=\"/cardview-javacode.png\"></p>\n<p>最终，看看实现的阴影效果：</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/80ba80f38bf0966ed2e52c78cd06b167\" alt=\"/cardview-xiaoguo.png\"></p>\n<h3 id=\"cardview-模拟阴影小结\">6.3 CardView 模拟阴影小结</h3>\n<p>CardView 模拟的阴影效果，在低版本上，也上会占用 View 的原本的大小来绘制阴影，所以视觉上也会偏小。不过在高版本上，依然上使用 elevation来实现的，也就会造成在不同 Api Level 下，显示的效果不一致的问题。</p>\n<h2 id=\"七使用开源库-shadowlayout\">七、使用开源库 ShadowLayout</h2>\n<p>最后再介绍一个开源库，用一个 LayoutView 来实现阴影的效果。</p>\n<p>Github 地址：</p>\n<blockquote>\n<p><a href=\"https://github.com/dmytrodanylyk/shadow-layout\" class=\"uri\">https://github.com/dmytrodanylyk/shadow-layout</a></p>\n</blockquote>\n<p>它完整的库也只有一个类加一些属性，整个项目结构如下。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/3b6c01c2f93606e74d7db44702bcce88\" alt=\"/shadowlayout-project.png\"></p>\n<p>并且提供了几个属性，用于配置阴影的效果。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/2763aa37def7f24df268077350b13f7b\" alt=\"/shadowlayout-res.png\"></p>\n<p>使用起来也非常的方便，它上直接继承自 FrameLayout 的，所以需要作为一个布局来使用。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/4077f3f745396b3f7fa3e64f9153f2ea\" alt=\"/shadowlayout-xml.png\"></p>\n<p>最后看看实现的效果。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/c6ac0db9b32b77dbbf59eeed217d5b33\" alt=\"/shadowlayout-xiaoguo.png\"></p>\n<p>它基本上可以实现一个类阴影的效果，不过应该是算法的问题，导致阴影的边缘太齐了，看着不真实，一般不推荐使用。</p>\n<h2 id=\"八结语\">八、结语</h2>\n<p>介绍了这么多在 Android 下实现阴影的效果，接下来给一张完整的效果图吧，如果本文都看完了，我想你应该知道自己应该选择那种方案了。</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/343571a1a29b878b434b23195ea0b185\" alt=\"/WechatIMG30.jpeg\"></p>\n<blockquote>\n<p>今天在<strong>承香墨影</strong>公众号的后台，回复『<strong>成长</strong>』。我会送你一些我整理的学习资料，包含：Android反编译、算法、设计模式、Web项目源码。</p>\n</blockquote>\n<p>推荐阅读：</p>\n<ul>\n<li><a href=\"http://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484787&amp;idx=1&amp;sn=655e94f3c18bc4af5f3184ab439412b7&amp;chksm=97851c52a0f29544128ee2f485a7e30c83215d8e33d769910e375777abec01deae26ffb64ee9#rd\">Glide 这样用，更省内存！！！</a></li>\n<li><a href=\"http://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484781&amp;idx=1&amp;sn=2ec1ade65648fda5c7626976240c279a&amp;chksm=97851c4ca0f2955a26daa3663c3009885dc414660fcc93ff49b9dd062ed4a09953298b2df5fb#rd\">跳槽前，不思考这些等于白跳！！！</a></li>\n<li><a href=\"http://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484762&amp;idx=1&amp;sn=7141731d407cbdf23de70725efbbd6fd&amp;chksm=97851c7ba0f2956d50534fadcaab25fbf363d7f5bade8c348e4b5a0e0b4b01eeb248f2f99bf0#rd\">哪些年熬过的夜，终将会\"回报\"你的</a></li>\n<li><a href=\"http://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484743&amp;idx=1&amp;sn=28a18c03d375a4f5761d6cf7429870ef&amp;chksm=97851c66a0f29570fbb4922d06ac578aac8c0feae1b6bb81048380299219a5d2bf526d20a1f1#rd\">当你只有一个设备的时候，如何做好屏幕适配</a></li>\n<li><a href=\"http://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484741&amp;idx=1&amp;sn=69215d5b524ffb352ad96b8301a91b8f&amp;chksm=97851c64a0f295725d9177cd6ee4422330c9a2184cf842fe06db84fa5aadbf1e2189ba77ec00#rd\">Android 源码，在线阅读更方便！！！</a></li>\n</ul>\n<p><img src=\"https://user-gold-cdn.xitu.io/2017/11/1/40319da1991c323a70a89fbaea6103a2\"></p>\n<p>点赞或者分享吧~</p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 13:45</span> <a href=\"http://www.cnblogs.com/plokmju/\">承香墨影</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7766076\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7766076);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=141671,cb_entryId=7766076,cb_blogApp=currentBlogApp,cb_blogUserGuid='f8b928a6-a703-e011-ac81-842b2b196315',cb_entryCreatedDate='2017/11/1 13:45:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 196, "image_url": ["https://pic.cnblogs.com/face/u234895.jpg?id=28112946"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "再论分布式事务：从理论到实践", "url": "http://www.cnblogs.com/xybaby/p/7756163.html", "author": "xybaby", "article_desc": "在前面《从银行转账失败到分布式事务：总结与思考》一文中，已经总结了分布式事务的各种解决方法，以及自己的一点思考。本文算是对上文的一个补充：进一步的思考，主要是这些解决方法在工程上的具体实施。如果后面在工作学习中有新的想法，也会持续更新到本文。 本文地址：http://www.cnblogs.com/ ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/xybaby/p/7756163.html\">再论分布式事务：从理论到实践</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p> </p>\r\n<p>　　在前面《<a href=\"http://www.cnblogs.com/xybaby/p/7465816.html\" target=\"_blank\">从银行转账失败到分布式事务：总结与思考</a>》一文中，已经总结了分布式事务的各种解决方法，以及自己的一点思考。本文算是对上文的一个补充：进一步的思考，主要是这些解决方法在工程上的具体实施。如果后面在工作学习中有新的想法，也会持续更新到本文。</p>\r\n<p>　　本文地址：<a href=\"http://www.cnblogs.com/xybaby/p/7756163.html\" target=\"_blank\">http://www.cnblogs.com/xybaby/p/7756163.html</a></p>\r\n<p>　　在<a href=\"http://www.cnblogs.com/xybaby/p/7465816.html\" target=\"_blank\">前文</a>中，已经简要介绍了2PC、TCC、基于异步消息、1PC这几种分布式事务解决办法，这里在补充一种：best effort。</p>\r\n<h1>Best Effort</h1>\r\n<p>　　best effort即尽最大努力交付，主要用于在这样一种场景：<strong>不同的服务平台之间的事务性保证</strong>。比如我们在电商购物，使用支付宝支付；又比如玩网游的时候，通过App Store充值。拿购物为例，电商平台与支付平台是相互独立的，隶属于不同的公司，即使是同一个公司也很可能是独立的部门。因此，这两个平台是不可能使用同一套分布式事务框架的，2PC不行，tcc也不行，异步消息也不行。</p>\r\n<p>　　其实在上面电商平台与支付平台的例子中，涉及到多重事务性：</p>\r\n<blockquote>\r\n<p>　　电商平台与支付平台之间的事务性：电商的下单操作与支付平台扣款的原子性，不能说支付平台扣了用户的钱，但电商平台不发货；或者说，电商平台先发了货，支付平台没有扣用户的钱；</p>\r\n<p>　　电商平台内部的事务性：比如订单与优惠券、红包等；</p>\r\n<p>　　支付平台内部的事务性：比如用户账户、商户账户等；</p>\r\n</blockquote>\r\n<p>　　不管是因为技术原因，还是说安全策略，支付平台只会提供给电商平台一些Http接口，即开放支付服务。电商平台在发出一笔支付请求后，是不大可能立刻获得支付是成功还是失败的确切消息，更多的时候应该是请求已被接受，处理中。这个时候支付平台已经将该请求持久化，保证一定会处理这个请求。当支付平台处理完这个支付请求之后，怎么将结果通知给电商平台呢，要么是电商平台定时轮训，要么是电商平台在初始支付请求的时候携带一个callback，提供给支付平台回调。在<a href=\"http://www.cnblogs.com/dinglang/p/5679542.html\" target=\"_blank\">这篇文章</a>中提到，支付宝采用的是回调的形式：</p>\r\n<blockquote>\r\n<p>　　“做过支付宝交易接口的同学都知道，我们一般会在支付宝的回调页面和接口里，解密参数，然后调用系统中更新交易状态相关的服务，将订单更新为付款成功。同时，只有当我们回调页面中输出了success字样或者标识业务处理成功相应状态码时，支付宝才会停止回调请求。否则，支付宝会每间隔一段时间后，再向客户方发起回调请求，直到输出成功标识为止。”</p>\r\n</blockquote>\r\n<p>　　这个例子，绘制成流程图就是这样样子的：</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1089769/201710/1089769-20171031181131824-1610479794.png\" alt=\"\"></p>\r\n<p>　　再想想上文提到的银行转账的例子，很可能也是采用best effort这种模式，银行之间肯定是相互独立的。首先是本地银行先扣款，然后通知另外一个银行加款，但为什么对方加款失败，没有通知到本地银行，就不清楚了</p>\r\n<h1>分布式事务解决方案比较</h1>\r\n<p>　　在这里主要通过以下几个维度来对比分析：</p>\r\n<ul>\r\n<li>一致性</li>\r\n<li>资源锁粒度：是否要利用到数据库的锁机制，加锁的粒度</li>\r\n<li>子事务串并行：组成 一个事务的多个子事务是并发执行，还是串行执行</li>\r\n<li>回滚（补偿）：是哪个层面的回滚（补偿）、回滚的代价</li>\r\n</ul>\r\n<p>　　注意，上面提到的回滚和补偿是一个意思，“回滚”不局限于DB里面的术语，而是指通用的对某个操作的逆反操作</p>\r\n<p> </p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1089769/201710/1089769-20171030194022777-1791638071.png\" alt=\"\"></p>\r\n<p> </p>\r\n<p>　　2PC的强一致性依赖于数据库，而TCC的强一致性依赖于应用层的Commit与cancel。异步消息，1PC，best effort都只保证最终一致性（且最终一致性还可能依赖于人工介入，是否应该算弱一致性？）</p>\r\n<p> 　　2PC需要对整个资源加锁，因此不适用于高并发的分布式场景；而tcc只对需要的资源进行加锁，加锁的粒度小，且try commit Cancel都是本地短事务，因此能在保证强一致性的同时最大化提高系统可用性。而异步消息，1PC，best effort都是先提交一部分事务，无需加锁。</p>\r\n<p>　　2PC是有数据库来保证回滚，而TCC是应用层实现回滚：为每一个try操作提供一个对应的cancel操作。而异步消息，1PC适用于理论上一定会成功的场景，难以回滚。best effort这种模式，需要服务的调用者实现完整的一个事务操作用于回滚，比如支付失败的情况。数据库的回滚较简单，而应用层的回滚较为困难，更重要的是，<strong>回滚也需要作为一个事务进行</strong>，部分回滚失败的情况最可怕。</p>\r\n<p>　　至于子事务的串行、并行，在其他文章中并没有看见过相关讨论，但肯定是实践的时候必须要考虑的问题。即一个分布式事务肯定是由多个分支事务组成，那么多个分支事务是并发执行，还是串行执行呢？特别对于2PC，TCC这些分为多个阶段的解决方案，每个阶段是并发，还是串行呢</p>\r\n<h1>分支事务串并行与LPO</h1>\r\n<p> 　　首先，对于异步消息，best effort，肯定都是串行的，其中一个分支事务完成之后，再去做另一个分支事务。</p>\r\n<p> 　　但对于2PC，TCC，理论上看起来是并行的，但工程实践中有可以串行。以2PC为例</p>\r\n<p>　　2PC从介绍的文章来看，多属于并行：即协调者同时让参与者prepare，然后在第二阶段同时通知参与者commit或者abort，下面<a href=\"http://blog.jobbole.com/95632/\" target=\"_blank\">两个图</a>说明了这个并行的过程。</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1089769/201710/1089769-20171030190419480-44025798.png\" alt=\"\"> <img src=\"http://images2017.cnblogs.com/blog/1089769/201710/1089769-20171030190431355-59278115.png\" alt=\"\"></p>\r\n<p>　　上面分别是两阶段提交协议成功commit与失败abort的情况，可以看出在prepare阶段，多个参与者是并行的。</p>\r\n<p> </p>\r\n<p>　　而2PC的串行模式，就是说，先通知一个参与者准备，成功的话再通知另一个参与者准备，即准备阶段是串行的。下图来自<a href=\"https://wenku.baidu.com/view/7756b49183c4bb4cf6ecd19e.html\" target=\"_blank\">支付宝</a>：</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1089769/201710/1089769-20171030190736074-1656996130.png\" alt=\"\"> <img src=\"http://images2017.cnblogs.com/blog/1089769/201710/1089769-20171030190754027-1771924411.png\" alt=\"\"></p>\r\n<p>　　<strong>注意</strong> 上面的图示，第二阶段（commit 或者 abort）也画成串行的，这里应该是可以并行的。</p>\r\n<p>　　</p>\r\n<p>　　那么串行、并行的区别在于哪里呢</p>\r\n<p> 　　（1）并行效率高，整个事务的耗时更少；</p>\r\n<p> 　　（2）而串行在prepare阶段失败的情况下，只需部分回滚；</p>\r\n<p> 　　</p>\r\n<p>　　在工程实践中为什么会采用串行这种方式呢，这是另外一个重要的优化： “<strong>最末参与者优化</strong>”（Last Participant Optimization，术语来自<a href=\"https://wenku.baidu.com/view/7756b49183c4bb4cf6ecd19e.html\" target=\"_blank\">支付宝</a>），即允许两阶段提交协议中有一个参与者不实现“准备”操作，在其余参与者都prepare ok的情况下，直接提交自己的分式事务。</p>\r\n<p> 　　网络上关于LPO的介绍并不多，在oracle官网<a href=\"&gt;https://docs.oracle.com/cd/E13222_01/wls/docs92/jta/llr.html\" target=\"_blank\">Logging Last Resource Transaction Optimization</a>中有如下介绍：</p>\r\n<blockquote>\r\n<p> The LLR resource uses a local transaction for its transaction work. The WebLogic Server transaction manager prepares all other resources in the transaction and then determines the commit decision for the global transaction based on the outcome of the LLR resource’s local transaction.　　</p>\r\n</blockquote>\r\n<p> 　　最末参与者优化的原理如下图所示：</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1089769/201710/1089769-20171030191211933-669350606.png\" alt=\"\"> <img src=\"http://images2017.cnblogs.com/blog/1089769/201710/1089769-20171030191221761-1382176498.png\" alt=\"\"></p>\r\n<p>　　本质上，LPO是将最后一个参与者的准备操作与提交/放弃操作合并成一个提交操作，这样提高了分布式事务的执行效率。也可以看到，要使用LPO，在prepare阶段一定是串行的。</p>\r\n<p> </p>\r\n<p>　　对于TCC，流程也是非常类似2PC，即在Try阶段，也可以使用LPO，在<a href=\"https://segmentfault.com/a/1190000005969526\" target=\"_blank\">《</a><a href=\"https://segmentfault.com/a/1190000005969526\" target=\"_blank\">说说分布式事务 </a><a href=\"https://segmentfault.com/a/1190000005969526\" target=\"_blank\">》</a>一文中，给出了一个实例的详细流程图。</p>\r\n<p>　　在一些业务场景，是无需单独的协调者，即事务的发起者同时是组成事务的分支事务。比如支付宝的例子，业务服务和账户服务组成一个分布式事务，在业务服务上发起事务请求，因此没有单独的协调者服务器，使用LPO也比较适合。</p>\r\n<h1>再论TCC</h1>\r\n<p>　　前面已经介绍过TCC的三个阶段，Try负责预留资源，Commit提交预留的资源，Cancel“回滚”预留的资源。那么某一个分支事务的Try操作是否可以直接做Commit所做的事情呢，即Try操作直接提交分支事务。在这种情况下，如果所有分支事务的Try阶段都返回OK，那么该分支事务的Commit就什么都不用做，如果需要Cancel，那么就实现回滚。</p>\r\n<p>　　当然，我看到的更多形式，比如支付宝的XTS，都只是冻结资源：加额外的字段，表明有多少数量的资源处于特殊状态。</p>\r\n<p>　　我们以一个扣款操作作为分支事务，比如要从账户A扣除100元。如果Try阶段直接执行事务，那么就从A的账户上真正扣除了，而Cancel阶段则加上100，看起来很容易；如果Try阶段只是冻结，那么就会复杂一些，一个可行的方案增加forzen字段的值，同时扣除账户。</p>\r\n<p>　　但如果考虑加款操作作为分支事务，Try阶段直接执行事务的话，很可能出现cancel阶段钱不够的情况（假设资金不能为负）</p>\r\n<p>　　因此，个人觉得，TCC框架是不用关心具体形式的，业务只需向框架注册这三个操作就行了，具体怎么操作，完全取决于业务，能满足业务的需求就行。</p>\r\n<p>　　</p>\r\n<h1>实践案例</h1>\r\n<p>　　在龙果学院退出的课程《<a href=\"http://www.roncoo.com/course/view/7ae3d7eddc4742f78b0548aa8bd9ccdb\" target=\"_blank\">微服务架构的分布式事务解决方案</a>》中，综合运用了各种分布式事务解决方案，如下如所示：</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/1089769/201710/1089769-20171031182622121-726504272.jpg\" alt=\"\"></p>\r\n<p>　　在上图中，使用了三种分布式事务解决办法：</p>\r\n<p>　　（1）基于可靠消息的最终一致性方案（异步确保型），这个使用比较广，适用于分支事务大概率成功的情况；</p>\r\n<p>　　上图中使用于：对应支付系统会计异步记账业务，银行通知结果信息存储与驱动订单处理</p>\r\n<p>　　（2）TCC事务补偿性方案，使用在同时需要保证一致性与高性能的场景</p>\r\n<p>　　对应上图中支付系统的订单账户操作：订单处理，资金账户处理，积分账户处理</p>\r\n<p>　　（3）best effort，最大努力通知型方案，适用于跨平台之间的事务原子性保证</p>\r\n<p>　　对应上图中支付系统的商户业务通知场景</p>\r\n<p> </p>\r\n<h1>references</h1>\r\n<p><a href=\"http://www.cnblogs.com/xybaby/p/7465816.html\" target=\"_blank\">从银行转账失败到分布式事务：总结与思考</a></p>\r\n<p><a href=\"https://wenku.baidu.com/view/7756b49183c4bb4cf6ecd19e.html\" target=\"_blank\">支付宝分布式事务设计草案</a></p>\r\n<p><a href=\"https://segmentfault.com/a/1190000005969526\" target=\"_blank\">说说分布式事务 </a></p>\r\n<p><a href=\"http://www.roncoo.com/course/view/7ae3d7eddc4742f78b0548aa8bd9ccdb\" target=\"_blank\">微服务架构的分布式事务解决方案</a> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 09:00</span> <a href=\"http://www.cnblogs.com/xybaby/\">xybaby</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7756163\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7756163);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=325907,cb_entryId=7756163,cb_blogApp=currentBlogApp,cb_blogUserGuid='b331fb74-c6d0-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/11/1 9:00:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 439, "image_url": ["https://pic.cnblogs.com/face/1089769/20170112222533.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "Azure 基础 : 使用 template 简化部署", "url": "http://www.cnblogs.com/sparkdev/p/7762967.html", "author": "sparkdev", "article_desc": "笔者在前文中介绍了如何使用 PowerShell 脚本在 Azure 上创建虚拟主机。正如你所看到的，整个创建过程还是有点繁琐的，因为我们需要使用 PowerShell 脚本创建并关联所有相关的组件。其实 Azure 为运维人员提供了效率更高的操作方式：模板。我们可以通过声明式的语法来创建模板，然后 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/sparkdev/p/7762967.html\">Azure 基础 : 使用 template 简化部署</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">笔者在<a href=\"http://www.cnblogs.com/sparkdev/p/7725965.html\" target=\"_blank\">前文</a>中介绍了如何使用 PowerShell 脚本在 Azure 上创建虚拟主机。正如你所看到的，整个创建过程还是有点繁琐的，因为我们需要使用 PowerShell 脚本创建并关联所有相关的组件。其实 Azure 为运维人员提供了效率更高的操作方式：模板。我们可以通过声明式的语法来创建模板，然后通过模板来简化部署操作。</span><br><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">Azure 提供了强大的模板功能，不仅支持用户创建模板，还可以从当前的配置中导出模板。本文暂不关注创建模板的细节，只是把<a href=\"http://www.cnblogs.com/sparkdev/p/7725965.html\" target=\"_blank\">前文</a>脚本创建的资源中导出为模板，并通过导出的模板创建新的资源。</span></p>\r\n<h1><span style=\"font-family: Microsoft YaHei; font-size: 18pt;\">从现有的资源导出模板</span></h1>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">MS 建议我们尽量把同一个项目中的资源放置在同一个 resource manager 中管理，所以前文中我们在常见虚拟主机的同时创建了一个新的名为 vmpool 的 resource manager：</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\"><img src=\"http://images2017.cnblogs.com/blog/952033/201710/952033-20171031182743511-281287124.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">所有创建的资源都属于这个 resource manager。接下来我们就把这个 resource manager 中的所有资源都导出到模板中。如下图所示，先选择 \"Automation script\"，然后点 \"Download\" 就可以了：</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\"><img src=\"http://images2017.cnblogs.com/blog/952033/201710/952033-20171031182826183-50201079.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">打开下载到的压缩包，里面的文件如下：</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\"><img src=\"http://images2017.cnblogs.com/blog/952033/201710/952033-20171031182851386-259932498.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">Azure 默认支持通过 PowerShell, shell, ruby 和 C# 部署模板，并提供了相应的脚本文件。也就是说我们只需要执行下载到的 PowerShell 脚本就可以部署一个和 vmpool 一模一样的 resource group 了！</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">接下来我们使用 powershell 脚本进行演示，简单起见我们只保留 deploy.ps1 和 template.json， 其它文件都删除掉。</span></p>\r\n<h1><span style=\"font-family: Microsoft YaHei; font-size: 18pt;\">修改模板中默认的名称</span></h1>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">如果我们使用同一个订阅号进行部署，需要修改一下模板文件中 stroage account 的名称，不然的话会和已经存在的资源名称发生冲突。这里我们在 template.json 文件中默认的 stroage account 名称前面添加 \"check\" 字样：</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\"><img src=\"http://images2017.cnblogs.com/blog/952033/201710/952033-20171031183312668-373819940.png\" alt=\"\"></span></p>\r\n<h1><span style=\"font-family: Microsoft YaHei; font-size: 18pt;\">依赖问题</span></h1>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">笔者在测试的过程中碰到了一个很奇怪的依赖错误：</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\"><img src=\"http://images2017.cnblogs.com/blog/952033/201710/952033-20171031183339121-1919510974.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">提示出现了循环引用，按照提示找到 template.json 文件中对应的行。查看之后感觉模板文件应该是正确的，按理说不应该有这样的错误提示。但是尝试了好几次都是相同的错误，索性删除提示出错的行：</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\"><img src=\"http://images2017.cnblogs.com/blog/952033/201710/952033-20171031183410152-392537361.png\" alt=\"\"></span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">把红框中的行删除，不要忘记删除前面的一个逗号。然后重试，错误消失。按理说新建的 networkinterfaces 和虚机有依赖关系是没有问题的，但是却出问题了，估计是个 bug。</span></p>\r\n<h1><span style=\"font-family: Microsoft YaHei; font-size: 18pt;\">执行命令进行部署</span></h1>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">在执行 PowerShell 脚本进行部署前，我们还需要确定几个参数。首先是你的订阅号的 ID，这个参数决定你的资源被部署在哪个订阅号的下面。还有就是新的 resource group 的名称和位置。最后需要给本次的部署起个名字：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre>-subscriptionId <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</span><span style=\"color: #800000;\">\"</span>\r\n-resourceGroupName <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">checkRG</span><span style=\"color: #800000;\">\"</span>\r\n-resourceGroupLocation <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Korea Central</span><span style=\"color: #800000;\">\"</span>\r\n-deploymentName <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">testdeployment</span><span style=\"color: #800000;\">\"</span></pre>\r\n</div>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">如果不在命令行中指定这些参数就需要在执行过程中和用户交互。我们希望做到自动化的部署过程，所以应该事先准备好这些参数，从而避免执行过程中的交互操作。</span><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">因此最后我们要执行的部署命令为：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre>./deploy.ps1 -subscriptionId <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</span><span style=\"color: #800000;\">\"</span> `<br>             -resourceGroupName <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">checkRG</span><span style=\"color: #800000;\">\"</span> `<br>             -resourceGroupLocation <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Korea Central</span><span style=\"color: #800000;\">\"</span> `<br>             -deploymentName <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">testdeployment</span><span style=\"color: #800000;\">\"</span></pre>\r\n</div>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">执行上面的命令，我们会得到一个名为 checkRG 的 resource group，其内容和母版 vmpool 几乎是一样的(storage account 的名称不一样)：</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\"><img src=\"http://images2017.cnblogs.com/blog/952033/201710/952033-20171031183550980-1029129385.png\" alt=\"\"></span></p>\r\n<h1><span style=\"font-family: Microsoft YaHei; font-size: 18pt;\">访问权限问题</span></h1>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">在 azure 上执行操作需要用户先进行登录，那么在 PowerShell 脚本中该如何做呢(需要避免执行脚本的过程中与用户交互)？</span><br><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">笔者在《<a href=\"http://www.cnblogs.com/sparkdev/p/6358266.html\" target=\"_blank\">Azure 基础：用 PowerShell 自动登录</a>》一文中有详细的介绍，有兴趣的朋友可以参考。</span></p>\r\n<h1><span style=\"font-family: Microsoft YaHei; font-size: 18pt;\">总结</span></h1>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 15px;\">本文通过一个简单的 demo 演示了如何通过 PowerShell 和模板在 azure 上部署资源。与单纯的使用 PowerShell 脚本来创建所有的资源相比，使用模板可以简化整个部署的过程。并且模板使用的是 json 格式，与具体的编程语言无关。你可以使用任何 Azure 支持的语言来部署模板中声明的资源。</span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 08:42</span> <a href=\"http://www.cnblogs.com/sparkdev/\">sparkdev</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7762967\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7762967);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=287522,cb_entryId=7762967,cb_blogApp=currentBlogApp,cb_blogUserGuid='636ea2f4-ca14-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/1 8:42:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 774, "image_url": ["https://pic.cnblogs.com/face/952033/20160916141655.png"], "date_pub": "2017-11-01", "article_common": 3}
{"title": "jvm - 垃圾回收", "url": "http://www.cnblogs.com/itkk/p/7765016.html", "author": "obejct-itkk", "article_desc": "\r\n    jvm 垃圾回收 注意 : 本系列文章为学习系列,部分内容会取自相关书籍或者网络资源,在文章中间和末尾处会有标注 垃圾回收的意义 它使得java程序员不再时时刻刻的关注内存管理方面的工作. 垃圾回收机制会自动的管理jvm内存空间,将那些已经不会被使用到了的\"垃圾对象\"清理掉\",释放出更多的空间给其他 ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/itkk/p/7765016.html\">jvm - 垃圾回收</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"jvm---垃圾回收\">jvm - 垃圾回收</h1>\n<p>注意 : 本系列文章为学习系列,部分内容会取自相关书籍或者网络资源,在文章中间和末尾处会有标注</p>\n<h2 id=\"垃圾回收的意义\"><strong>垃圾回收的意义</strong></h2>\n<p>它使得java程序员不再时时刻刻的关注内存管理方面的工作.</p>\n<p>垃圾回收机制会自动的管理jvm内存空间,将那些已经不会被使用到了的\"垃圾对象\"清理掉\",释放出更多的空间给其他对象使用.</p>\n<h2 id=\"何为对象的引用\"><strong>何为对象的引用?</strong></h2>\n<p>Java中的垃圾回收一般是在Java堆中进行，因为堆中几乎存放了Java中所有的对象实例</p>\n<p>在java中,对引用的概念简述如下(引用强度依次减弱) :</p>\n<ul>\n<li><p><strong>强引用</strong> : 这类引用是Java程序中最普遍的,只要强引用还存在，垃圾收集器就永远不会回收掉被引用的对象</p></li>\n<li><p><strong>软引用</strong> : 用来描述一些非必须的对象,在系统内存不够使用时,这类对象会被垃圾收集器回收,JDK提供了SoftReference类来实现软引用</p></li>\n<li><p><strong>弱引用</strong> : 用来描述一些非必须的对象,只要发生GC,无论但是内存是否够用,这类对象就会被垃圾收集器回收,JDK提供了WeakReference类来实现弱引用</p></li>\n<li><p><strong>虚引用</strong> : 与其他几种引用不同,它不影响对象的生命周期,如果这个对象是虚运用,则就跟没有引用一样,在任何时刻都可能会回收,JDK提供了PhantomReference类来实现虚引用</p></li>\n</ul>\n<p><strong>如下为相关示例代码</strong></p>\n<div class=\"sourceCode\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span class=\"kw\">public</span> <span class=\"kw\">class</span> ReferenceDemo {\n    <span class=\"kw\">public</span> <span class=\"dt\">static</span> <span class=\"dt\">void</span> <span class=\"fu\">main</span>(String[] arge) {\n        <span class=\"co\">//强引用</span>\n        Object object = <span class=\"kw\">new</span> Object();\n        Object[] objects = <span class=\"kw\">new</span> Object[<span class=\"dv\">100</span>];\n\n        <span class=\"co\">//软引用</span>\n        SoftReference&lt;String&gt; stringSoftReference = <span class=\"kw\">new</span> SoftReference&lt;&gt;(<span class=\"kw\">new</span> String(<span class=\"st\">\"SoftReference\"</span>));\n        System.<span class=\"fu\">out</span>.<span class=\"fu\">println</span>(stringSoftReference.<span class=\"fu\">get</span>());\n        System.<span class=\"fu\">gc</span>();\n        System.<span class=\"fu\">out</span>.<span class=\"fu\">println</span>(stringSoftReference.<span class=\"fu\">get</span>()); <span class=\"co\">//手动GC,这时内存充足,对象没有被回收</span>\n\n        System.<span class=\"fu\">out</span>.<span class=\"fu\">println</span>();\n\n        <span class=\"co\">//弱引用</span>\n        WeakReference&lt;String&gt; stringWeakReference = <span class=\"kw\">new</span> WeakReference&lt;&gt;(<span class=\"kw\">new</span> String(<span class=\"st\">\"WeakReference\"</span>));\n        System.<span class=\"fu\">out</span>.<span class=\"fu\">println</span>(stringWeakReference.<span class=\"fu\">get</span>());\n        System.<span class=\"fu\">gc</span>();\n        System.<span class=\"fu\">out</span>.<span class=\"fu\">println</span>(stringWeakReference.<span class=\"fu\">get</span>()); <span class=\"co\">//手动gc,这时,返回null,对象已经被回收</span>\n\n        System.<span class=\"fu\">out</span>.<span class=\"fu\">println</span>();\n\n        <span class=\"co\">//虚引用</span>\n        <span class=\"co\">//虚引用主要用来跟踪对象被垃圾回收器回收的活动。</span>\n        <span class=\"co\">//虚引用与软引用和弱引用的一个区别在于：虚引用必须和引用队列 （ReferenceQueue）联合使用。</span>\n        <span class=\"co\">//当垃圾回收器准备回收一个对象时，如果发现它还有虚引用，就会在回收对象的内存之前，把这个虚引用加入到与之 关联的引用队列中</span>\n        ReferenceQueue&lt;String&gt; stringReferenceQueue = <span class=\"kw\">new</span> ReferenceQueue&lt;&gt;();\n        PhantomReference&lt;String&gt; stringPhantomReference = <span class=\"kw\">new</span> PhantomReference&lt;&gt;(<span class=\"kw\">new</span> String(<span class=\"st\">\"PhantomReference\"</span>), stringReferenceQueue);\n        System.<span class=\"fu\">out</span>.<span class=\"fu\">println</span>(stringPhantomReference.<span class=\"fu\">get</span>());\n    }\n}</code></pre></div>\n<p>当然,关于这几种引用还有很多知识点,本文只做简单的介绍,后续有机会再单独的文章详细介绍.</p>\n<h2 id=\"如何确定需要回收的垃圾对象\"><strong>如何确定需要回收的垃圾对象?</strong></h2>\n<h3 id=\"引用计数器\"><strong>引用计数器</strong></h3>\n<p>每个对象都有一个引用计数器 , 新增一个引用的时候就+1,引用释放的时候就-1,当计数器为0的时候,就表示可以回收</p>\n<p>引用计数算法的实现简单，判定效率也很高，在大部分情况下它都是一个不错的选择，当Java语言并没有选择这种算法来进行垃圾回收，主要原因是它很难解决对象之间的相互循环引用问题</p>\n<div class=\"sourceCode\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span class=\"kw\">public</span> <span class=\"kw\">class</span> LoopReferenceDemo {\n    \n    <span class=\"kw\">public</span> <span class=\"dt\">static</span> <span class=\"dt\">void</span> <span class=\"fu\">main</span>(String[] args) {\n        TestA a = <span class=\"kw\">new</span> <span class=\"fu\">TestA</span>(); <span class=\"co\">//1</span>\n        TestB b = <span class=\"kw\">new</span> <span class=\"fu\">TestB</span>(); <span class=\"co\">//2</span>\n        a.<span class=\"fu\">b</span> = b; <span class=\"co\">//3</span>\n        b.<span class=\"fu\">a</span> = a; <span class=\"co\">//4</span>\n        a = <span class=\"kw\">null</span>; <span class=\"co\">//5</span>\n        b = <span class=\"kw\">null</span>; <span class=\"co\">//6</span>\n    }\n    \n}\n\n<span class=\"kw\">class</span> TestA {\n    <span class=\"kw\">public</span> TestB b;\n\n}\n\n<span class=\"kw\">class</span> TestB {\n    <span class=\"kw\">public</span> TestA a;\n}</code></pre></div>\n<blockquote>\n<p>虽然a和b都为null,但是a和b存在循环引用,这样a和b就永远不会被回收</p>\n</blockquote>\n<p>如果你在互联网上搜索\"引用计数器\"这个关键字,通常都会得到以上这一个结论,但是究竟为什么a和b不会被回,收其实还是没有说清楚的,下面简单说明一下 :</p>\n<ul>\n<li><p><strong>第一行</strong> : TestA的引用计数器加1,TestA的引用数量为1</p></li>\n<li><p><strong>第二行</strong> : TestB的引用计数器加1,TestB的引用数量为1</p></li>\n<li><p><strong>第三行</strong> : TestB的引用计数器加1,TestB的引用数量为2</p></li>\n<li><p><strong>第四行</strong> : TestA的引用计数器加1,TestA的引用数量为2</p></li>\n</ul>\n<p><strong>内存分布如下图</strong></p>\n<p><img src=\"https://static.oschina.net/uploads/img/201710/23172228_AUQ1.png\" title=\"引用计数器示例-1\" alt=\"引用计数器示例-1\"></p>\n<ul>\n<li><p><strong>第五行</strong> : 将a变量设置为null,不再指向堆中的引用,所以TestA的引用计数器减1,TestA的引用数量为1</p></li>\n<li><p><strong>第六行</strong> : 将b变量设置为null,不再指向堆中的引用,所以TestB的引用计数器减1,TestB的引用数量为1</p></li>\n</ul>\n<p><strong>内存分布如下图</strong></p>\n<p><img src=\"https://static.oschina.net/uploads/img/201710/23172237_0Pnt.png\" title=\"引用计数器示例-2\" alt=\"引用计数器示例-2\"></p>\n<ul>\n<li><strong>结论</strong> : 虽然上面程序将a和b设置为null了,但是在堆中,TestA和TestB还是互相持有对方的引用,引用计数器依然不等于0,这个就称为循环引用,所以说\"引用计数器\"会存在这个问题,导致这类对象无法被清理掉.</li>\n</ul>\n<p>以上的知识点参考 : <a href=\"https://www.zhihu.com/question/21539353\" class=\"uri\">https://www.zhihu.com/question/21539353</a></p>\n<h3 id=\"可达性分析\"><strong>可达性分析</strong></h3>\n<p>虽然以上的\"引用计数器\"算法存在\"循环引用\"的问题,不过目前主流的虚拟机都采用\"可达性分析(GC Roots Tracing)\"算法来标记那些对象是可以被回收的.</p>\n<p>该算法是从GC Roots开始向下搜索,搜索走过的路径称之为引用链.当一个对象到GC Roots没有任何引用链相连时,就代表这个对象是不可用的.称为\"不可达对象\"</p>\n<p>GC Roots包括:</p>\n<ul>\n<li><p>虚拟机栈(栈帧中的本地变量表)中的引用对象</p></li>\n<li><p>方法区中的静态属性实体引用的对象</p></li>\n<li><p>方法区中常量引用的对象</p></li>\n<li><p>本地方法栈中JNI(Native方法)引用的对象</p></li>\n</ul>\n<p>实际上，在根搜索算法中，要真正宣告一个对象死亡，至少要经历两次标记过程 :</p>\n<ul>\n<li><p>如果对象在进行根搜索后发现没有与GC Roots相连接的引用链，那它会被第一次标记并且进行一次筛选，筛选的条件是此对象是否有必要执行finalize（）方法</p></li>\n<li><p>当对象没有覆盖finalize（）方法，或finalize（）方法已经被虚拟机调用过，虚拟机将这两种情况都视为没有必要执行</p></li>\n<li><p>如果该对象被判定为有必要执行finalize（）方法，那么这个对象将会被放置在一个名为F-Queue队列中，并在稍后由一条由虚拟机自动建立的、低优先级的Finalizer线程去执行finalize（）方法</p></li>\n<li><p>finalize（）方法是对象逃脱死亡命运的最后一次机会（因为一个对象的finalize（）方法最多只会被系统自动调用一次）, 稍后GC将对F-Queue中的对象进行第二次小规模的标记，如果要在finalize（）方法中成功拯救自己，只要在finalize（）方法中让该对象重引用链上的任何一个对象建立关联即可</p></li>\n<li><p>而如果对象这时还没有关联到任何链上的引用，那它就会被回收掉</p></li>\n</ul>\n<p><strong>如下图所示</strong></p>\n<p><img src=\"https://static.oschina.net/uploads/img/201710/24083318_S5Mg.png\" title=\"可达性分析\" alt=\"可达性分析\"></p>\n<p>从上图上看,reference1,2,3都是gc roots</p>\n<p>reference1指向instance1,reference2指向instance4,并且instance4又指向了instance6,reference3则指向了instance2</p>\n<p>所以说instance1,2,4,6都具有gc roots可达性,是存活着的对象,不会被垃圾回收器回收掉</p>\n<p>而instance3,5则不具备gc roots可达性,是不可用对象,将会被垃圾回收器回收掉</p>\n<p>从上图描述\"引用计数器\"的图例场景来看,TestA和TestB虽然互相有持有引用,但是并不具备gc roots可达性,所以,在\"可达性分析\"算法下,是会被垃圾回收器回收掉的</p>\n<h2 id=\"垃圾收集的算法\"><strong>垃圾收集的算法</strong></h2>\n<h3 id=\"标记-清除-算法\"><strong>标记-清除 算法</strong></h3>\n<p>算法分为\"标记\"和\"清除\"两个阶段,首先标记出需要回收的对象,在标记完成后,统一回收掉之前被标记的所有对象. 它是最基础的收集算法 . 后续的收集算法都是基于这种思想,并且对其缺点进行改进而产生的</p>\n<p><img src=\"https://static.oschina.net/uploads/img/201710/24092218_5hES.png\" title=\"标记-清除\" alt=\"标记-清除\"></p>\n<p>主要缺点:</p>\n<ul>\n<li><p>效率问题 : 需要标记和清除两次扫描</p></li>\n<li><p>空间问题 : 标记和清除之后会产生大量的不连续的内存碎片,可能会导致,当程序需要分配一个较大内存空间的时候,无法找到足够的连续内存,从而不得不提前出发另外一次垃圾回收动作</p></li>\n</ul>\n<h3 id=\"复制-算法\"><strong>复制 算法</strong></h3>\n<p>将可用内存按容量划分为两块,每次只使用其中的一块,当内存使用完了后,就将还存活着的对象复制到另外一块上面,然后在把前面一块内存一次性清理掉</p>\n<p><img src=\"https://static.oschina.net/uploads/img/201710/25090444_9alp.png\" title=\"复制\" alt=\"复制\"></p>\n<p>优点 :</p>\n<ul>\n<li>每次只操作一块内存,分配内存的时候无需考虑内存碎片的情况,只需要移动对象的指针,按顺序分配内存即可,实现简单,运行高效</li>\n</ul>\n<p>缺点 :</p>\n<ul>\n<li><p>会将内存缩小为原来的一半</p></li>\n<li><p>持续复制长生期的对象则导致效率降低 (没理解) (对于存活率较高的对象,就会对其进行多次复制,从而导致效率降低)</p></li>\n</ul>\n<h3 id=\"标记-压缩-算法\"><strong>标记-压缩 算法</strong></h3>\n<p>和标记-清除算法一样,只不过标记后的动作不是清除,而是将所有对象向一端移动,然后直接清理掉边界以外的对象(被标记的对象)</p>\n<p><img src=\"https://static.oschina.net/uploads/img/201710/25090543_Th7a.png\" title=\"标记-压缩\" alt=\"标记-压缩\"></p>\n<p>特点 :</p>\n<ul>\n<li><p>复制算法比较适合于新生代，在老年代中，对象存活率比较高，如果执行较多的复制操作，效率将会变低，所以老年代一般会选用其他算法，如标记—清理算法</p></li>\n<li><p>该算法标记的过程与标记—清除算法中的标记过程一样，但对标记后出的垃圾对象的处理情况有所不同，它不是直接对可回收对象进行清理，而是让所有的对象都向一端移动，然后直接清理掉端边界以外的内存</p></li>\n</ul>\n<h3 id=\"分代收集-算法\">分代收集 算法</h3>\n<p>把java的堆分为\"新生代\"和\"老年代\",对于不同的年代采用不同算法</p>\n<p><img src=\"https://static.oschina.net/uploads/img/201710/31135147_aRV0.png\" title=\"分代管理\" alt=\"分代管理\"></p>\n<p>在新生代中,由于对象生命周期非常短暂,所以每次垃圾回收的时候都会有大量的对象死去,只有少量存活,这样,采用\"复制算法\",就只需要付出少量存活对象的复制成本,就能完成回收</p>\n<p>在老年代中,由于对象生命周期比较长,存活率较高,没有额外的空间对它进行分配和担保,那就必须使用\"标记-清除算法\"或者\"标记-压缩算法\"来进行回收</p>\n<p><strong>Minor GC:</strong> 从年轻代空间(包括Eden和Survivor区域)回收内存被称为Minor GC</p>\n<p><strong>Major GC:</strong> 清理老年代</p>\n<p><strong>Full GC:</strong> 清理整个堆空间—包括年轻代和老年代</p>\n<p><strong>年轻代:</strong> 是所有新对象产生的地方.年轻代被分为3个部分(Enden区和两个Survivor区,也叫From和To),当Eden区被对象填满时,就会执行<strong>Minor GC</strong>,并把所有存活下来的对象转移到其中一个survivor区(Form),Minor GC同样会检查存活下来的对象,并把它们转移到另一个survivor区(To),这样在一段时间内,总会有一个空的survivor区,经过多次GC周期后，仍然存活下来的对象会被转移到年老代内存空间,常这是在年轻代有资格提升到年老代前通过设定年龄阈值来完成的,需要注意，Survivor的两个区是对称的,没先后关系,from和to是相对的.</p>\n<p><strong>老年代:</strong> 在年轻代中经历了N次回收后仍然没有被清除的对象,就会被放到年老代中,都是生命周期较长的对象.对于年老代,则会执行<strong>Major GC</strong>,来清理.在某些情况下,则会触发<strong>Full GC</strong>,来清理整个堆内存</p>\n<p><strong>元空间:</strong> 堆外的一部分内存,通常直接使用的是系统内存,用于存放运行时常量池,等内容,垃圾回收对应元空间来说没有明显的影响</p>\n<h2 id=\"垃圾收集器\"><strong>垃圾收集器</strong></h2>\n<p>垃圾收集器是内存回收算法的具体实现，Java虚拟机规范中对垃圾收集器应该如何实现并没有任何规定，因此不同厂商、不同版本的虚拟机所提供的垃圾收集器都可能会有很大的差别</p>\n<p>Sun HotSpot虚拟机1.6版包含了如下收集器：Serial、ParNew、Parallel Scavenge、CMS、Serial Old、Parallel Old</p>\n<p>这些收集器以不同的组合形式配合工作来完成不同分代区的垃圾收集工作,如下是垃圾收集器简单介绍 :</p>\n<h3 id=\"serial收集器\"><strong>Serial收集器</strong></h3>\n<p>串行收集器,最古老,最稳定,以及效率高的收集器,但是可能会造成程序较长时间的停顿,只使用一个线程去回收.新生代,老年代使用串行回收</p>\n<p>新生代使用\"复制算法\"</p>\n<p>老年代使用\"标记压缩算法\"</p>\n<p>垃圾回收的过程中会\"程序暂停\"(Stop the world)</p>\n<h3 id=\"parnew收集器\"><strong>ParNew收集器</strong></h3>\n<p>是Serial收集器的多线程版,新生代并行,老年代串行</p>\n<p>新生代使用\"复制算法\"</p>\n<p>老年代使用\"标记压缩算法\"</p>\n<p>垃圾回收的过程中会\"程序暂停\"(Stop the world)</p>\n<h3 id=\"paralle收集器\"><strong>Paralle收集器</strong></h3>\n<p>类似于ParNew收集器,但是更关注系统的吞吐量.</p>\n<p>可以通过参数来打开\"自适应调节策略\",虚拟机会根据系统当前的运行情况收集性能监控信息,动态调整这些参数以便提供最合适的停顿时间和最大的吞吐量</p>\n<p>也可以通过参数控制GC的时间不大于多少毫秒或者比例</p>\n<p>新生代使用\"复制算法\"</p>\n<p>老年代使用\"标记压缩算法\"</p>\n<h3 id=\"parallel-old收集器\"><strong>Parallel Old收集器</strong></h3>\n<p>是Paralle收集器的老年代版本 , 使用多线程和\"标记-整理算法\",这个收集器在JDK1.6中才开始使用</p>\n<h3 id=\"cms收集器\"><strong>CMS收集器</strong></h3>\n<p>是基于\"标记-清除\"算法实现的,它的运作过程相对于前面的其中收集器要复杂一些,整个过程分为4个步骤,包括 :</p>\n<ul>\n<li><p>初始标记(CMS initial mark)</p></li>\n<li><p>并发标记(CMS concurrent mark)</p></li>\n<li><p>重新标记(CMS remark)</p></li>\n<li><p>并发清除(CMS concurrent sweep)</p></li>\n</ul>\n<p>初始标记和并发标记仍需要Stop the World.</p>\n<p>初始标记仅仅只是标记一下GC Root能直接关联到的对象,速度很快.</p>\n<p>并发标记阶段就是进行GC Root Tracing的过程.</p>\n<p>重新标记这是为了修正并发标记期间,因用户程序继续运作而导致标记变动的那一部分的标记记录,这一阶段的停顿时间会比初始标记阶段的时间稍长一些,但远比并发标记时间短</p>\n<p>整个过程中耗时最长的并发标记和并发清除过程中,收集器线程可以与用户线程一起工作,所以总体来说,CMS收集器的内存回收是与用户线程一起并发执行的</p>\n<p>优点 : 并发收集,低停顿</p>\n<p>缺点 : 产生大量的空间碎片,并发阶段会降低吞吐量</p>\n<h3 id=\"g1收集器\"><strong>G1收集器</strong></h3>\n<p>与CMS收集器项目,G1收集器有以下特点 :</p>\n<ul>\n<li><p>空间整合 :</p>\n<ul>\n<li>G1收集器采用标记-整理算法,不会产生空间碎片.分配大对象时不会应为找不到连续的空间而提前触发下一次GC</li>\n</ul></li>\n<li><p>可预测停顿 :</p>\n<ul>\n<li><p>降低停顿时间是G1和CMS的共同关注点</p></li>\n<li><p>G1除了追求低停顿外,还能建立可预测的停顿时间模型.</p></li>\n<li><p>能让使用者明确指定在一个长度为N毫秒的时间片段内,消耗在垃圾收集上的时间不得超过N毫秒,几乎已经是实时java(RTSJ)垃圾回收的特征了</p></li>\n</ul></li>\n</ul>\n<p>上面提到的垃圾收集器,收集的范围都是整个新生代或者老年代,而G1不在是这样.</p>\n<p>使用G1收集器的时候,JAVA堆的内存布局与其他的收集器有很大的差别,它将这个java堆划分为多个大小相等的独立区域(Region),虽然还保留新生代和老年代的概念,但新生代和老年代不再是物理隔阂了,他们都是一部分(可以不连续)Region的集合</p>\n<p>G1的新生代收集器跟ParNew类似,当新生代占用达到一定的比例的时候,开始触发收集</p>\n<p>和CMS类似,G1收集器收集老年代对象的时候会有短暂停顿</p>\n<p>收集步骤如下 :</p>\n<ul>\n<li><p>标记阶段 :</p>\n<ul>\n<li>首先初始标记(initial mark),这个阶段是停顿的(Stop the world event),并且会触发一次普通的Mintor GC(从年轻代空间回收)</li>\n</ul></li>\n<li><p>Root Region Scanning :</p>\n<ul>\n<li>运行程序过程中会回收survivor区(存活到老年代),这一过程必须在young GC之前完成</li>\n</ul></li>\n<li><p>Concurrent Marking :</p>\n<ul>\n<li><p>在整个java堆中进行并发标记(和应用程序并发执行),此过程可能会被young GC中断</p></li>\n<li><p>若发现区域对象中的所有对象都是垃圾,那个区域就会被立即回收</p></li>\n<li><p>同时,并发标记过程中,会去计算每个区域的对象活性(区域中存活对象的比例)</p></li>\n</ul></li>\n<li><p>Remark :</p>\n<ul>\n<li><p>再标记,会有短暂停顿(STW)</p></li>\n<li><p>是用来收集并发标记阶段,产生新的垃圾(并发阶段和应用程序一同执行)</p></li>\n<li><p>G1中采用了比CMS更快的初始快照算法 : snapshot-at-the-beginning (SATB)</p></li>\n</ul></li>\n<li><p>Copy / Clean up :</p>\n<ul>\n<li><p>多线程清除失活对象,会有STW</p></li>\n<li><p>G1将回收区域的存活对象拷贝到新的区域,清除Remember Sets,并发清空回收区域,并把它返回到空闲的区域链表中</p></li>\n</ul></li>\n<li><p>复制/清除过程后 :</p>\n<ul>\n<li>回收区域的活性对象已经被收集器回收到\"最近复制的年轻代\"(recently copied in young generation)和\"最近复制的老年代\"(recently copied in old generation)区域中了</li>\n</ul></li>\n</ul>\n<h2 id=\"参考文献\"><strong>参考文献</strong></h2>\n<p>&lt;&lt;深入理解JVM虚拟机&gt;&gt;</p>\n<h2 id=\"结束\"><strong>结束</strong></h2>\n<p>本文提到的点很多,有对象引用,如何定义垃圾对象,gc算法,现有的垃圾收集器,等.</p>\n<p>由于篇幅和时间原因,每个点都提及的不深入(当然,本篇文章的每个点深入的聊起来,都够写本书的了,呵呵).</p>\n<p>后续会找机会逐个的将这些点跟大家深入的讨论.</p>\n<p>总之 \"学无止境\" , 与大家共勉 .</p>\n<h2 id=\"代码仓库-博客配套代码\"><strong>代码仓库</strong> (博客配套代码)</h2>\n<ul>\n<li><p><a href=\"https://gitee.com/wangkang/udf\">udf-starter : 基础项目,脚手架,框架</a></p></li>\n<li><p><a href=\"https://gitee.com/wangkang/udf-sample\">udf-sample : 集成样例</a></p></li>\n</ul>\n<hr>\n<p>想获得最快更新,请关注公众号</p>\n<p><img src=\"https://static.oschina.net/uploads/img/201705/24155414_Pukg.jpg\" title=\"想获得最快更新,请关注公众号\" alt=\"想获得最快更新,请关注公众号\"></p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 09:52</span> <a href=\"http://www.cnblogs.com/itkk/\">obejct-itkk</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7765016\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7765016);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=376144,cb_entryId=7765016,cb_blogApp=currentBlogApp,cb_blogUserGuid='6cf42170-1c57-4345-8fd3-08d49c352df3',cb_entryCreatedDate='2017/11/1 9:52:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 284, "image_url": ["https:"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "写了一个bug，最后却变成了feature，要不要修呢？", "url": "http://www.cnblogs.com/aspwebchh/p/7764840.html", "author": "陈宏鸿", "article_desc": "事情是这样子的，前不久接到一个需求，为一个游戏开发礼包码功能 通常一款游戏运营期间会搞各种各样的活动吸引玩家，其中最常见的就是发放礼包， 玩家可以通过礼包码兑换礼包。 用礼包码兑换礼包有个一限制，游戏运营商不会让玩家无限制兑换， 针对某一次发放礼包的活动，一个账号只能兑换一次， 即使玩家手上有多个礼 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/aspwebchh/p/7764840.html\">写了一个bug，最后却变成了feature，要不要修呢？</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><div id=\"img-content\">\r\n<div id=\"js_content\" class=\"rich_media_content \">\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">事情是这样子的，前不久接到一个需求，为一个游戏开发礼包码功能</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">通常一款游戏运营期间会搞各种各样的活动吸引玩家，其中最常见的就是发放礼包，  玩家可以通过礼包码兑换礼包。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">用礼包码兑换礼包有个一限制，游戏运营商不会让玩家无限制兑换， 针对某一次发放礼包的活动，一个账号只能兑换一次， 即使玩家手上有多个礼包码也不能多次兑换。 打个比方，某一款游戏搞活动向玩家发放礼包，这个礼包内总共有10000个礼包码， 玩家可以通过这些码去游戏中兑换。 参加活动的玩家每人手上只有一个礼包码，而某一个玩家通过某种方法拿到多个这次活动的礼包码，那么当他登录账号去兑换这批码时，是不会成功的，他只能兑换一次，其余的码只能通过不同的账号去兑换。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">这是面向玩家的客户端逻辑。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">在后端呢，有一套针对礼包的管理系统供游戏运营的同事使用， 当要发放一个礼包时， 他们可以在表单内填写礼包的名称、礼包码的数量、使用礼包码兑换礼包的道具之类的信息生成礼包， 然后把礼包码分给玩家。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">这很和谐，一点问题也没有。然而这只是假象，我做的这个功能，在只发放一个礼包时是没问题的，但是要同时发放多个礼包， 就会触发一个bug。因为每次在系统中添加一个礼包后，在游戏中并不能直接生效，而是要使用系统提供的同步功能将礼包同步至游戏中。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">人有一个特点， 做事情喜欢分类。比如说我们小时候做作业，肯定是先做完某一门功课的作业，再去做另一门功课的作业，我们不可能以做一道语文题，接着做一道数学题，然后再做一道语文题的方式来完成作业。人脑不是电脑，没有多线程， 事情只能一样一样做。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">这下问题来了</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">运营的同事有时候会需要同时发放多个礼包，碰到这种情况，他们的操作步骤是</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"><span style=\"color: #ff00ff;\">添加礼包，添加礼包，添加礼包，</span><span style=\"color: #0000ff;\">同步礼包到游戏，同步礼包到游戏，同步礼包到游戏</span></span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">而我开发程序时根本没有想到会出现同时添加多个礼包的情况，所以发放礼包只能按照</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"><span style=\"color: #ff00ff;\">添加礼包</span>，<span style=\"color: #0000ff;\">同步礼包到游戏</span>，<span style=\"color: #ff00ff;\">添加礼包</span>，<span style=\"color: #0000ff;\">同步礼包到游戏</span>，<span style=\"color: #ff00ff;\">添加礼包</span>，<span style=\"color: #0000ff;\">同步礼包到游戏</span></span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">这个步骤来</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">否则，  这些新添加的不同礼包都会被按照同一个礼包来看待， 就算玩家分别拿到不同礼包的礼包码，  也只能领取一次。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">这显然是个bug， 虽然按照第二种方法的步骤操作能得到正确的结果， 但是这即不符合人的直觉，我也没有在说明文档里注明这一点， 甚至刚开始的时候连我自己都不知道要通过这么繁琐的操作才能得到正确的结果，那我又凭什么要求系统的用户去这么做呢。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">当我发现这个问题时，脊背上感受到一阵凉意，因为这个功能已经发布到线上使用，假如运营的同事一次性同时发布多个礼包，那这个bug会波及到很多玩家，直接影响游戏的口碑。要是bug真被触发，那就是运营事故，而且这个锅肯定是我的， 甩也甩不掉。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">我心怀揣揣的把这个问题和游戏运营的同事说明，然后表示要修复这个bug， 然而他们的回应却是：“原来是个bug啊！ 我们还以为是你开发的功能呢，这个bug挺好用的，我们需要它”</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">震惊，我百思不得其解，在平常bug可是他们最痛恨的东西。 </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">原来， 他们发放礼包的时候有一种需求，同时发放两个礼包， 两个礼包的道具虽然不同， 但是价值确实相似的， 他们只允许一个玩家只能领取两个礼包中的其中一个， 也就是说就算玩家分别拿到这两个礼包的礼包码，  兑换的话也只能兑换其中一个。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">歪打正着， 这个bug不折不扣满足运营同事的特殊的需求。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">把 bug开发成feature，我内心隐隐有种自豪感，然而这个feature 却是个定时炸弹，一旦有不知道底细的新同学使用这个功能， 那这个bug还是一个bug，而且杀伤力巨大。</span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\"> </span></p>\r\n<p><span style=\"font-family: Microsoft YaHei; font-size: 18px;\">所以， 问题来了， 这个bug到底要不要修呢， 纠结。</span></p>\r\n</div>\r\n</div>\r\n<div id=\"js_toobar3\" class=\"rich_media_tool\"> </div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 09:13</span> <a href=\"http://www.cnblogs.com/aspwebchh/\">陈宏鸿</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7764840\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7764840);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=90004,cb_entryId=7764840,cb_blogApp=currentBlogApp,cb_blogUserGuid='da7888d6-0888-e011-a53f-842b2b196315',cb_entryCreatedDate='2017/11/1 9:13:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 3465, "image_url": ["https://pic.cnblogs.com/face/303980/20170327140123.png"], "date_pub": "2017-11-01", "article_common": 25}
{"title": "流程设计-流程模式", "url": "http://www.cnblogs.com/1834235472qq/p/7765124.html", "author": "潇洒丶疯一回", "article_desc": "工作流基本包含如下多种模式用于工作流过程建模和分析： （1）、基本模式 5种 ● 顺序模式 按照顺序执行各项活动 ● 并行分支模式 同时运行两个活动 ● 同步模式 同步两个并行的执行线程 ● 单选模式 从多条路径中选择一个执行 ● 简单合并模式 合并两个二选一路径 （2）、高级分支与同步模式 5种  ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/1834235472qq/p/7765124.html\">流程设计-流程模式</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><div>\n<div class=\"newsview_content\">\n<p>工作流基本包含如下多种模式用于工作流过程建模和分析：</p>\n<p>（1）、基本模式 5种</p>\n<p>      ● 顺序模式---- 按照顺序执行各项活动</p>\n<p>      ● 并行分支模式----同时运行两个活动</p>\n<p>      ● 同步模式----同步两个并行的执行线程</p>\n<p>      ● 单选模式----从多条路径中选择一个执行</p>\n<p>      ● 简单合并模式----合并两个二选一路径</p>\n<p>（2）、高级分支与同步模式 5种</p>\n<p>      ● 多选模式----从多条执行路径中选出几条</p>\n<p>      ● 同步合并模式----合并多条路径，如果有多条路径被选择，则进行同步；如果只有一条路径被选择，则进行简单合并</p>\n<p>      ● 多合并模式----合并多条路径</p>\n<p>      ● 鉴别器模式----合并多条路径而不进行同步，只执行一次后续活动</p>\n<p>      ● M中的N模式-----合并多条路径，进行部分同步，只执行一次后续活动</p>\n<p>（3）、结构模式 2种</p>\n<p>      ● 任意循环模式----没有任何限制的执行工作流</p>\n<p>      ● 隐含终断模式----如果没有事情可做，就结束</p>\n<p>（4）、多实例模式</p>\n<p>      ● 设计期多实例---流程设计时已知实例数目</p>\n<p>      ● 运行时前置多实例---实例数目在运行时才能确定</p>\n<p>      ● 运行时非前置多实例---实例数目无法确定</p>\n<p>      ● 同一任务多实例并要求同步运行</p>\n<p>（5）、基于状态模式</p>\n<p>      ● 延期选择---执行两个可选进程之一，选择执行进程是隐含的</p>\n<p>      ● 交叉并行路由---随机执行一个任务但不并行</p>\n<p>      ● 里程碑---直到达到某个里程碑方激活一个任务</p>\n<p>（6）、取消模式</p>\n<p>      ● 取消活动---取消或禁止一个活动</p>\n<p>      ● 取消过程---取消或禁止一个过程</p>\n<p>（7）、其它模式</p>\n<p>      ● 结构化循环</p>\n<p>          ● 递归</p>\n<p>          ● 临时触发器</p>\n<p>          ● 持续触发器</p>\n<p>          ● 取消范围</p>\n<p>          ● 多实例的取消</p>\n<p>          ● 多实例的手工完成</p>\n<p>          ● 鉴别阻塞</p>\n<p>          ● 鉴别取消</p>\n<p>          ● 结构化N选M</p>\n<p>          ● N选M阻塞</p>\n<p>          ●  N选M取消</p>\n<p>          ●  AND合并</p>\n<p>          ● 多实例的N选M</p>\n<p>          ● 多实例的N选M取消</p>\n<p>          ● 动态多实例的N选M</p>\n<p>          ● 循环的同步合并</p>\n<p>          ● 同步合并</p>\n<p>          ● 区域互斥</p>\n<p>          ● 交叉路由</p>\n<p>          ● 线程合并</p>\n<p>          ● 线程分支</p>\n<p>          ● 显式终止</p>\n<h3>3.2.1   基本模式</h3>\n<p>（1）、顺序模式（Sequence）</p>\n<p>    最基本的过程模型：按照顺序执行各项活动，前驱活动的完成是后续活动开始的必要条件，每一个工作流系统都直接实现了这种模式，这个模式是工作流能运行的一个重要基石。 </p>\n<p align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100625279-942511488.png\" alt=\"\"></p>\n<p> </p>\n<p align=\"center\"> </p>\n<p>     这个理论模型十分简单，只是一个工作单元完成了，紧接着无条件执行下一个工作单元。</p>\n<p>（2）、并行分支模式（Parallel Split）</p>\n<p>     在流程执行过程中，需要将单进程的某个控制点分成可以并行执行的多进程控制，于是允许任务同时执行或者以任何顺序执行。此一模式，实际就是我们常接触到的 AND 模型。 </p>\n<p align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100636763-635575475.png\" alt=\"\"></p>\n<p> </p>\n<p align=\"center\"> </p>\n<p>    值得注意的是这个定义来说一般B、C、D之间是并发的，实现上一般是几个不同的线程/进程。</p>\n<p>（3）、同步模式（Synchronization）</p>\n<p>     AND分支以后，一个最为普遍的合并方式就是AND合并。当多个并行任务都完成后才能开始执行下一任务。 </p>\n<p align=\"center\"> </p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100647638-1309913237.png\" alt=\"\"></p>\n<p> </p>\n<p><br>    需要注意的细节是\"同步\"这个问题，很多时候存在现实业务的考虑，即使是同一个动作，也不一定是非要合并不可。</p>\n<p>    一般情况下，并行分支和合并是组合使用，组合执行模型如下： </p>\n<p align=\"center\"> </p>\n<p>（4）、单选模式（Exclusive Choice）</p>\n<p>     单选模式其实就是“排它选择”模式，在流程的某一节点，依据一个结果或流程控制数据, 从多个分支路径中选定一个路径执行。 </p>\n<p align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100705326-467170685.png\" alt=\"\"></p>\n<p> </p>\n<p align=\"center\"> </p>\n<p>    需要注意的是这个\"排他\"性，只能选择其中一个分支，另外多个分支将不会走下去。一般来说，这个模式的实现一般为在运行时的条件选择，就是条件判断的代码放到XOR 这个结点，然后去根据这些代码去判断下一步的走向。</p>\n<p>（5）、简单合并模式（Simple Merge）</p>\n<p>     在流程中某点，需将两个或更多可选分支聚合而不同步；换言之，“合并”在任一入口连接触发时被触发。 </p>\n<p align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100719810-401465921.png\" alt=\"\"></p>\n<p> </p>\n<p align=\"center\"> </p>\n<p>    这个模式主要是为了应付前躯只有一个分支的流程，这个模式也是一个很常用的模式。在许多的流程图中，没有显式说明的一般都可以看作是 XOR-join，就是任意一个前躯完成，就触发下一个工作单元。</p>\n<p>    一般情况下，单选模式和简单合并模式是组合使用的，组合模式如下： </p>\n<p align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100734638-1748988230.png\" alt=\"\"></p>\n<p> </p>\n<p align=\"center\"> </p>\n<p> </p>\n<p>    通过对基本模式的分析和了解后，在实际的应用中，经常将五种模式进行组合使用，组合使用的模型如下： </p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100744404-926451362.png\" alt=\"\"></p>\n<p> </p>\n<h3>3.2.2   高级分支与同步模式</h3>\n<p>（1）、多选模式（Multiple Choice）</p>\n<p>    在工作流过程的某点，依据判定或工作流控制数据，选择一个或多个分支来进行执行。通常意义上来讲就是我们所说的OR_Split</p>\n<p align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100549107-934670517.png\" alt=\"\"></p>\n<p> </p>\n<p align=\"center\"> </p>\n<p>（2）、同步合并模式（Synchronising Join）</p>\n<p>    流程中某点多条路径聚合成一个线程，若多于一条路径触发，则活动线程需同步；若仅有一条路径触发，则可选分支应再收敛，无需同步。</p>\n<p>    工作流程中的多个路径在一个点被汇合成一个单一的进程。如果多于一个的路径到达了，活动线程就需要进行同步。如果只有一个路径到达，那么其它的路径应该异步的重新会聚。</p>\n<p>    这一个模式是为了应付多选模式（Multiple Choice）或者通常意义所说的 OR-Split 所产生的分支。 </p>\n<p align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100532623-81076409.png\" alt=\"\"></p>\n<p> </p>\n<p align=\"center\"> </p>\n<p>     说明：这个分支的合并，需要了解上下文的关系。如果前面只产生了A分支，那么到达同步-JOIN节点就可以触发后续活动D。如果前面产生的分支A、B、C都被激活触发，并且A、B、C分支是并发的，那么当A、B都已到达同步-JOIN节点，但是C分支还没有到达，那么就需要进行等待，等到C分支也到达本节点后，才能触发执行下一节点D活动。</p>\n<p>（3）、多合并模式（Multiple Merge）</p>\n<p>    多合并模式即多路合并，在流程中某节点，两条或更多分支无同步再收敛。若多于一个分支被激活或多个分支被同时激活，流程需要对每个被激活分支进行响应一次，则需要采用多合并模式。其实多路合并并不是真正意义的合并，而是到达多路_JOIN节点时继续相同的后续分支。 </p>\n<p align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100519701-719755407.png\" alt=\"\"></p>\n<p> </p>\n<p align=\"center\"> </p>\n<p>       说明：如图所示，B\\C\\D三个活动，当B先到达“多路_JOIN”节点时，则触发E1，C到达时候，触发E2,D到达时候，触发E3，触发完成全部分支后，E触发完成结束。其实每次触发的都是相同的E，但是产生的任务为E1,E2,E3,他们是对每一个流入的分支都进行响应一次功效。当全部触发完成后，流程继续进入E后续的流程活动。</p>\n<p>（4）、鉴别器模式（Discriminator）</p>\n<p>    路径鉴别器是指在流程的某点，激活后续任务之前等待许多流入分支的完成。从它开始之时起，等待所有剩余分支的完成并“忽略”它们。一旦所有的流入分支都被触发，它使自己复位，以便可被再次触发。 </p>\n<p> </p>\n<p align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100505545-1822230283.png\" alt=\"\"></p>\n<p> </p>\n<p align=\"center\"> </p>\n<p>     鉴别器模式只只对And_Split同时执行的情况；此种模式有三种情况：</p>\n<p>         （1）、B、C同时到达鉴别器Discriminator节点，则执行D</p>\n<p>               一般这种情况不会发生，因为计算机执行的时候，总是有先后执行顺序的，总有一个为先执行。</p>\n<p>         （2）、B先到达鉴别器Discriminator节点，那么就不必等待C的执行结果，直接执行D，当C到完成后到达鉴别器Discriminator节点时，流程将自动忽略C的结果，将鉴别器Discriminator恢复原位，继续等待被触发。</p>\n<p>         （3）、C先到达鉴别器Discriminator节点，那么就不必等待B的执行结果，直接执行D，当B到完成后到达鉴别器Discriminator节点时，流程将自动忽略B的结果，将鉴别器Discriminator恢复原位，继续等待被触发。</p>\n<p>（5）、M中的N模式（N-out-of-M Join）</p>\n<p>    M中选N合并是指流程的某点M 条并行路径聚合到一点，只要其中N条路径完成则激活后续任务，所有其它剩余路径的完成应被忽略。类似于路由鉴别,只要所有流入分支被触发,则该合并使自己复位，以便可被再次触发。M中选N其实就是合并多条路径，进行部分同步，只执行一次后续活动。 </p>\n<p align=\"center\"><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100434810-1964684846.png\" alt=\"\"></p>\n<p> </p>\n<p align=\"center\"> </p>\n<p>     说明：上图所示 M 为3，N我们设定为2 ，则，如果B\\C 都完成到达N-out-of-M Join节点，则满足N-out-of-M 规则，则不必等待D的执行结果，直接转向执行E；当D完成后到达N-out-of-M Join节点，流程则忽略D的执行结果，将N-out-of-M Join节点复位等待再次被触发。</p>\n<h3>3.2.3   结构模式</h3>\n<p>（1）、任意循环模式（Arbitrary Cycles）</p>\n<p>      在工作流过程的执行过程中，一个或多个任务可被重复执行。 </p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100419545-1507472427.png\" alt=\"\"></p>\n<p> </p>\n<p>（2）、隐含终断模式（Implicit Termination）</p>\n<p>     这个模式叫隐式结束，或者自然结束。就是当所有正在运行结点都没有后继结点，流程就视为结束了。也就是不需要指明结束的结点，只要跑完所有的结点（或者没有找到后继结点），就视为流程结束。</p>\n<p> </p>\n<p> </p>\n<p> </p>\n<h3>3.2.4   多实例模式</h3>\n<p>（1）、设计期多实例（Multiple Instances with a Priori Design-Time Knowledge）</p>\n<p>     流程中的某个任务可能需要创建多个实例，其数目在设计模型时已知。即在某种情形下，一个任务被激活多次，其指定任务在给定情况下实例的个数在设计时已知。这一模式是用于确立多实例的入口方式。入口主要处理的问题就是确定所需要生成的实例个数 N 。而这个 N 在设计流程的时候就确定了。</p>\n<p>（2）、运行时前置多实例（Multiple Instances with a Priori Run-Time Knowledge）</p>\n<p>     一个任务的实例个数是动态的，亦即在设计时未知，而在运行期间所有实例需被执行前的某点可获知其数目。可以将本模式看作一初始化该任务的For循环。在某种情况下，任务可被激活多次，给定任务的实例数在指定情形下是一变量，取决于情况特征或资源的可用性, 但在运行期的某些阶段才已知, 即该任务的实例在运行时候才确定。</p>\n<p>    入口方式也可以动态确定，这一模式是表示在流程运行的过程中，B 中第一个实例产生以前就确定 N 。当然了，确定这个N 的时机可以是前面 A，也可以是 A 前的工作任务。总之是在第一个实例产生前就确定下来的，也可以视作该模式的应用。</p>\n<p>（3）、运行时非前置多实例（Multiple Instances without a Priori Run-Time Knowledge）</p>\n<p>     实例的数目是动态的，亦即实例数设计时不知，在运行期间，所有这些实例需要被激活前的任何阶段都无法知道。可将本模式看作是任务实例化的WHILE循环。</p>\n<p>（4）、同步多实例（Multiple Instances without a Priori Run-Time Knowledge）</p>\n<p>     实例数在设计时未知，任务的所有实例完成后另一任务才能启动（或开始）。</p>\n<h3>3.2.5   基于状态模式</h3>\n<p>（1）、延期选择（Deferred Choice）</p>\n<p>     一个线程激活任务A, 另一线程激活任务 B，而两个任务都在任务列表中)，只要一个线程启动, 另一线程应消失(亦即若任务 A 启动，则任务B 应从工作列表中消失)。</p>\n<p>     工作流中的一个节点，有一个或多个分支已经被选择。与XOR拆分相比，并没有明确的选择，但是，选择是取决于环境的。与AND拆分相比，两者中只有一个被执行。这意味着一旦环境启动了其中的一个，另一个就被取消。要注意，选择是被延迟到两个分支中的一个真正开始执行时，也就是说，选择是可以尽可能的推后的。例子：在收到货物之后，有两种方法可以将其送到。选择取决于相关资源的可用性。因此，选择会被推迟到直到其中一个资源可用为止。</p>\n<p>（2）、交叉并行路由（Interleaved Parallel Routing）</p>\n<p>     一组活动以任意的顺序执行，每个活动都被执行，他们的顺序是在运行时决定的，并且在任意一个时刻都不会有两个活动在执行。</p>\n<p>（3）、里程碑（Milestone）</p>\n<p>     一个活动能否执行取决于一个指定的状态。也就是说，只有在到达一个特定的未过期的里程碑时，活动才被执行。</p>\n<h3>3.2.6   取消模式</h3>\n<p>（1）、取消活动（Cancel Activity）</p>\n<p>    一个可执行的活动被强制失效了，也就是说，一个正在等待执行的活动所在线程被移除了。</p>\n<p>    例子：如果顾客取消了一个请求，那么与之相关的活动也被取消了。</p>\n<p>（2）、取消过程（Cancel Case）</p>\n<p>    一个过程实例, 被完全取消。</p>\n<h3>3.2.7   其它模式</h3>\n<p>（1）、结构化循环（Cancel Activity）</p>\n<p>（2）、递归（Recursion）</p>\n<p>（3）、临时触发器（Transient Trigger）</p>\n<p>（4）、持续触发器（Persistent Trigger）</p>\n<p>（5）、取消范围（Cancel Region）</p>\n<p>（6）、多实例的取消（Cancel Multiple Instance Activity）</p>\n<p>（7）、多实例的手工完成（Complete Multiple Instance Activity）</p>\n<p>（8）、鉴别阻塞（Blocking Discriminator）</p>\n<p>（9）、鉴别取消（Cancelling Discriminator）</p>\n<p>（10）、结构化N选M（Structured Partial Join）</p>\n<p>（11）、N选M阻塞（Blocking Partial Join）</p>\n<p>（12）、N选M取消（Cancelling Partial Join）</p>\n<p>（13）、AND合并（Generalised AND-Join）</p>\n<p>（14）、多实例的N选M（Static Partial Join for Multiple Instances）</p>\n<p>（15）、多实例的N选M取消（Cancelling Partial Join for Multiple Instances）（16）、动态多实例的N选M（Dynamic Partial Join for Multiple Instances）</p>\n<p>（17）、循环的同步合并（Acyclic Synchronizing Merge）</p>\n<p>（18）、同步合并（General Synchronizing Merge）</p>\n<p>（19）、区域互斥（Critical Section）</p>\n<p>（20）、交叉路由（Interleaved Routing）</p>\n<p>（21）、线程合并（Thread Merge）</p>\n<p>（22）、线程分支（Thread Split）</p>\n<p>（23）、显式终止（Explicit Termination）</p>\n<h2>3.3  过程推进</h2>\n<p>    过程推进是针对工作流系统正常流转的一个整体的引擎调度流程，它是工作流系统完整流转的整体过程描述。</p>\n<p>   （1）、业务创建</p>\n<p>         用户在WEB端创建单据</p>\n<p>         业务流程创建业务单据、公文流程编制文稿数据，此时业务单据的状态为草稿状态，同时产生一条状态为【初始】的过程实例。如果用户删除业务单据，则同时删除产生的过程实例。</p>\n<p>   （2）、流程启动</p>\n<p>         第一步完成后，启动工作流程。流程的启动方式分多种，手工启动、自动启动、事件启动、邮件启动、外部启动等。</p>\n<p>             &lt;A&gt;、将流程定义模型导入到运行库（工作流流程的执行情况表）中；运行库包含如下内容：</p>\n<p>                   ● 过程执行情况：生成过程记录，状态为【初始】</p>\n<p>                   ● 活动执行情况：</p>\n<p>                   ● 任务执行情况</p>\n<p>             &lt;B&gt;、将过程实例状态变迁为【运行】</p>\n<p>             &lt;C&gt;、生成所有活动的活动实例。</p>\n<p>             &lt;D&gt;、将第一开始活动的活动实例状态变迁为完成。</p>\n<p>             &lt;E&gt;、生成开始活动的工作任务，将状态变迁为完成。</p>\n<p>             &lt;F&gt;、更新运行库记录。将过程记录状态变更为【运行】，生成一条第一开始活动的执行情况记录，状态为【完成】，生成第一活动的任务执行情况记录，状态修改为【完成】。</p>\n<p>   （3）、过程执行</p>\n<p>         流程启动后，SDP工作流流程的设计模式是已经完成了第一开始活动的所有任务，直接进行第二活动的执行，此时整个过程开始真正的执行，那么我们就需要开始分析活动实例，在许可状态（Running）下，分析活动类型：</p>\n<p>               &lt;A&gt;、普通</p>\n<p>                     普通类型是指在工作流过程中，各个活动（人工活动或自动活动）相互之间路径没有分支，只有单一的流向，此种类型属于普通活动。如图所示： <br><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100357451-1183571465.png\" alt=\"\"></p>\n<p> </p>\n<p><br>     此种情况下直接读取活动变迁表的后续活动的字段信息。</p>\n<p>               &lt;B&gt;、路由</p>\n<p>                     路由类型是指在工作流过程中，活动相互之间的路径变迁有多种（大于1）分支，此种情况属于路由类型。路由分几种情况：分裂、汇聚、循环 <br><br><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100259716-77968764.png\" alt=\"\"></p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100311435-1212413480.png\" alt=\"\"></p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1213349/201711/1213349-20171101100321966-2026966801.png\" alt=\"\"></p>\n<p> </p>\n<p> </p>\n<p align=\"right\"> </p>\n<p align=\"right\"> </p>\n<p align=\"right\"> </p>\n<p>          第一开始活动执行完成后，根据迁移条件是否开始激活运行下一步活动实例，活动实例在过程实例创建时候已经全部创建完成，此处只要执行激活运行活动实例，激活运行活动实例的条件是必须至少一个工作任务被创建并且满足启动运行的条件，那么此时就需要先创建工作任务项，并且启动运行工作任务，即工作任务的状态变迁为运行，变更完成后，将活动实例状态变迁运行。</p>\n<p>   （4）、业务结束</p>\n<p>         业务单据及工作流流程的结束。结束方式分：完成（正常流转完成），终止（非正常的结束），中断（因工作流在挂起状态下被发现过程实例超过了它的生存周期，有工作流引擎自动执行过程中断。）</p>\n<p>         业务和流程的结束，工作流引擎将自动清除过程实例、活动实例、工作任务记录。运行库中，将过程执行情况、活动执行情况、任务执行情况的记录状态变更为相应的结束状态（注意：当非正常结束时，需要清除未完     成的活动和任务记录）。</p>\n<p>    过程推进是由工作流系统的调度引擎来执行，它是工作流系统完整流转的整体过程描述。</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</div>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 10:09</span> <a href=\"http://www.cnblogs.com/1834235472qq/\">潇洒丶疯一回</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7765124\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7765124);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=373238,cb_entryId=7765124,cb_blogApp=currentBlogApp,cb_blogUserGuid='44b19b6f-0057-4b4b-5ae6-08d49c352df3',cb_entryCreatedDate='2017/11/1 10:09:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 291, "image_url": ["https://pic.cnblogs.com/face/1213349/20171101094008.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "【深度学习系列】手写数字识别--卷积神经网络CNN原理详解(一)", "url": "http://www.cnblogs.com/charlotte77/p/7759802.html", "author": "Charlotte77", "article_desc": "上篇文章我们给出了用paddlepaddle来做手写数字识别的示例，并对网络结构进行到了调整，提高了识别的精度。有的同学表示不是很理解原理，为什么传统的机器学习算法，简单的神经网络(如多层感知机)都可以识别手写数字，我们要采用卷积神经网络CNN来进行别呢？CNN到底是怎么识别的？用CNN有哪些优势呢 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/charlotte77/p/7759802.html\">【深度学习系列】手写数字识别--卷积神经网络CNN原理详解(一)</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　<span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>上篇文章我们给出了用paddlepaddle来做手写数字识别的示例，并对网络结构进行到了调整，提高了识别的精度。有的同学表示不是很理解原理，为什么传统的机器学习算法，简单的神经网络(如多层感知机)都可以识别手写数字，我们要采用卷积神经网络CNN来进行别呢？CNN到底是怎么识别的？用CNN有哪些优势呢？我们下面就来简单分析一下。在讲CNN之前，为避免完全零基础的人看不懂后面的讲解，我们先简单回顾一下传统的神经网络的基本知识。</span></p>\n<hr>\n<p> </p>\n<p>　<span style=\"font-size: 18px; background-color: #ffffff\">　<strong><span style='color: #0000ff; background-color: #ccffff; font-family: \"comic sans ms\", sans-serif'>神经网络的预备知识</span></strong></span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif'><span style=\"font-size: 16px; color: #ff6600\"><strong>     <span style=\"color: #ff0000\">为什么要用神经网络？</span></strong></span></span></p>\n<ul>\n<li><span style='font-family: \"comic sans ms\", sans-serif'><span style=\"font-size: 15px; color: #0000ff\">特征提取的高效性。</span></span></li>\n</ul>\n<p><span style='font-size: 15px; color: #0000ff; font-family: \"comic sans ms\", sans-serif'><strong> 　　</strong><span style=\"color: #000000\">大家可能会疑惑，对于同一个分类任务，我们可以用机器学习的算法来做，为什么要用神经网络呢？大家回顾一下，一个分类任务，我们在用机器学习算法来做时，首先要明确feature和label，然后把这个数据\"灌\"到算法里去训练，最后保存模型，再来预测分类的准确性。但是这就有个问题，即我们需要实现确定好特征，每一个特征即为一个维度，<span style=\"color: #0000ff\">特征数目过少，我们可能无法精确的分类出来，即我们所说的欠拟合，如果特征数目过多，可能会导致我们在分类过程中过于注重某个特征导致分类错误，即过拟合。</span></span></span></p>\n<p><span style='font-size: 15px; color: #0000ff; font-family: \"comic sans ms\", sans-serif'><span style=\"color: #000000\">　　举个简单的例子，现在有一堆数据集，让我们分类出西瓜和冬瓜，如果只有两个特征：形状和颜色，可能没法分区来；如果特征的维度有：形状、颜色、瓜瓤颜色、瓜皮的花纹等等，可能很容易分类出来；如果我们的特征是：形状、颜色、瓜瓤颜色、瓜皮花纹、瓜蒂、瓜籽的数量，瓜籽的颜色、瓜籽的大小、瓜籽的分布情况、瓜籽的XXX等等，很有可能会过拟合，譬如有的冬瓜的瓜籽数量和西瓜的类似，模型训练后这类特征的权重较高，就很容易分错。这就导致我们在特征工程上需要花很多时间和精力，才能使模型训练得到一个好的效果。然而神经网络的出现使我们不需要做大量的特征工程，譬如提前设计好特征的内容或者说特征的数量等等，我们可以直接把数据灌进去，让它自己训练，自我“修正”，即可得到一个较好的效果。</span></span></p>\n<ul>\n<li><span style='font-size: 15px; color: #0000ff; font-family: \"comic sans ms\", sans-serif'>数据格式的简易性</span></li>\n</ul>\n<p><span style='color: #000000; font-family: \"comic sans ms\", sans-serif'><span><span style=\"font-size: 15px\">　　在一个传统的机器学习分类问题中，我们“灌”进去的数据是不能直接灌进去的，需要对数据进行一些处理，譬如量纲的归一化，格式的转化等等，不过在神经网络里我们不需要额外的对数据做过多的处理，具体原因可以看后面的详细推导。</span></span></span></p>\n<ul>\n<li><span style='color: #0000ff; font-family: \"comic sans ms\", sans-serif'><span><span style=\"font-size: 15px\">参数数目的少量性</span></span></span></li>\n</ul>\n<p><span style='color: #0000ff; font-family: \"comic sans ms\", sans-serif'><span><span style=\"font-size: 15px\">　<span style=\"color: #000000\">　<span style='font-family: \"comic sans ms\", sans-serif'>在面对一个分类问题时，如果用SVM来做，我们需要调整的参数需要调整核函数，惩罚因子，松弛变量等等，不同的参数组合对于模型的效果也不一样，想要迅速而又准确的调到最适合模型的参数需要对背后理论知识的深入了解(当然，如果你说全部都试一遍也是可以的，但是花的时间可能会更多),对于一个基本的三层神经网络来说(输入-隐含-输出)，我们只需要初始化时给每一个神经元上随机的赋予一个权重w和偏置项b，在训练过程中，这两个参数会不断的修正，调整到最优质，使模型的误差最小。所以从这个角度来看，我们对于调参的背后理论知识并不需要过于精通(只不过做多了之后可能会有一些经验，在初始值时赋予的值更科学，收敛的更快罢了)</span></span></span></span></span></p>\n<p><strong><span style=\"font-size: 16px; color: #0000ff\"><span style='font-family: \"comic sans ms\", sans-serif'>   <span style=\"color: #ff0000\">有哪些应用？</span></span></span></strong></p>\n<p><span style=\"font-size: 15px\">　　<span style='font-family: \"comic sans ms\", sans-serif'>应用非常广，不过大家注意一点，我们现在所说的神经网络，并不能称之为深度学习，神经网络很早就出现了，只不过现在因为不断的加深了网络层，复杂化了网络结构，才成为深度学习，并在图像识别、图像检测、语音识别等等方面取得了不错的效果。</span></span></p>\n<p><span style=\"font-size: 16px; color: #0000ff\"><span style='font-family: \"comic sans ms\", sans-serif'>    <strong><span style=\"color: #ff0000\">基本网络结构</span></strong></span></span></p>\n<p><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>　　一个神经网络最简单的结构包括输入层、隐含层和输出层，每一层网络有多个神经元，上一层的神经元通过激活函数映射到下一层神经元，每个神经元之间有相对应的权值，输出即为我们的分类类别。</span></p>\n<p><strong><span style='font-size: 16px; font-family: \"comic sans ms\", sans-serif; color: #ff0000'>　详细数学推导</span></strong></p>\n<p>　　<span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>去年中旬我参考吴恩达的UFLDL和mattmazur的博客写了篇文章详细讲解了一个最简单的神经网络从前向传播到反向传播的直观推导，大家可以先看看这篇文章--<a href=\"http://www.cnblogs.com/charlotte77/p/5629865.html\" target=\"_blank\">一文弄懂神经网络中的反向传播法--BackPropagation</a>。</span></p>\n<p><strong><span style='font-size: 16px; font-family: \"comic sans ms\", sans-serif; color: #ff0000'><span style='font-family: \"comic sans ms\", sans-serif'>　优缺点</span></span></strong></p>\n<p>　　<span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>前面说了很多优点，这里就不多说了，简单说说缺点吧。我们试想一下如果加深我们的网络层，每一个网络层增加神经元的数量，那么参数的个数将是M*N（m为网络层数，N为每层神经元个数），所需的参数会非常多，参数一多，模型就复杂了，越是复杂的模型就越不好调参，也越容易过拟合。此外我们从神经网络的反向传播的过程来看，梯度在反向传播时，不断的迭代会导致梯度越来越小，即梯度消失的情况，梯度一旦趋于0，那么权值就无法更新，这个神经元相当于是不起作用了，也就很难导致收敛。尤其是在图像领域，用最基本的神经网络，是不太合适的。后面我们会详细讲讲为啥不合适。</span></p>\n<p> </p>\n<hr>\n<p>　　<span style=\"font-size: 18px; background-color: #ccffff\"><strong><span style=\"color: #0000ff\">为什么要用卷积神经网络？</span></strong></span></p>\n<p><span style=\"background-color: #ffffff; font-size: 16px\"><span style=\"color: #0000ff; font-size: large\"><strong>　 <span style='font-family: \"comic sans ms\", sans-serif'> <span style=\"font-size: 16px; color: #ff0000\">传统神经网络的劣势</span></span></strong></span></span></p>\n<p>　　<span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>前面说到在图像领域，用传统的神经网络并不合适。我们知道，图像是由一个个像素点构成，每个像素点有三个通道，分别代表RGB颜色，那么，如果一个图像的尺寸是（28，28，1），即代表这个图像的是一个长宽均为28，channel为1的图像（channel也叫depth,此处1代表灰色图像）。如果使用全连接的网络结构，即，网络中的神经与与相邻层上的每个神经元均连接，那就意味着我们的网络有28 * 28 =784个神经元，hidden层采用了15个神经元，那么简单计算一下，我们需要的参数个数(w和b)就有：784*15*10+2=117602个，这个参数太多了，随便进行一次反向传播计算量都是巨大的，从计算资源和调参的角度都不建议用传统的神经网络。<span style=\"color: #3366ff\">(评论中有同学对这个参数计算不太理解，我简单说一下：图片是由像素点组成的，用矩阵表示的，28*28的矩阵，肯定是没法直接放到神经元里的，我们得把它“拍平”，变成一个28*28=784 的一列向量，这一列向量和隐含层的15个神经元连接，就有784*15=11760个权重w，隐含层和最后的输出层的10个神经元连接，就有11760*10=117600个权重w，再加上输入层和隐含层的两个偏置项b，就是117602个参数了)</span></span></p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/853467/201710/853467-20171031123650574-11330636.png\" alt=\"\" width=\"518\" height=\"451\"></p>\n<p>　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　图1 三层神经网络识别手写数字</p>\n<p>　　</p>\n<p><strong><span style=\"color: #0000ff\">　　<span style='font-size: 16px; font-family: \"comic sans ms\", sans-serif; color: #ff0000'>卷积神经网络是什么？</span></span></strong></p>\n<p><strong><span style=\"color: #0000ff\">　　<span style='font-size: 16px; font-family: \"comic sans ms\", sans-serif'>三个基本层</span></span></strong></p>\n<ul>\n<li><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'> <span style=\"font-size: 16px\"><strong><span style=\"color: #0000ff\">卷积层（Convolutional Layer）</span></strong></span></span></li>\n</ul>\n<p>　　<span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>上文提到我们用传统的三层神经网络需要大量的参数，原因在于每个神经元都和相邻层的神经元相连接，但是思考一下，这种连接方式是必须的吗？全连接层的方式对于图像数据来说似乎显得不这么友好，因为图像本身具有“二维空间特征”，通俗点说就是<span style=\"color: #0000ff\">局部特性</span>。譬如我们看一张猫的图片，可能看到猫的眼镜或者嘴巴就知道这是张猫片，而不需要说每个部分都看完了才知道，啊，原来这个是猫啊。所以如果我们可以用某种方式对一张图片的某个典型特征识别，那么这张图片的类别也就知道了。这个时候就产生了卷积的概念。举个例子，现在有一个4*4的图像，我们设计两个卷积核，看看运用卷积核后图片会变成什么样。</span></p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/853467/201710/853467-20171031163928996-1414714519.png\" alt=\"\" width=\"588\" height=\"368\"></p>\n<p style=\"text-align: center\"> 图2　4*4 image与两个2*2的卷积核操作结果</p>\n<p> </p>\n<p><span style=\"color: #000000\">　　<span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>由上图可以看到，原始图片是一张灰度图片,每个位置表示的是像素值，0表示白色，1表示黑色，（0，1）区间的数值表示灰色。对于这个4*4的图像，我们采用两个2*2的卷积核来计算。设定步长为1，即每次以2*2的固定窗口往右滑动一个单位。以第一个卷积核filter1为例，计算过程如下：</span></span></p>\n<blockquote>\n<pre><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif; background-color: #ffffff; color: #333333'>feature_map1(1,1) = 1*1 + 0*(-1) + 1*1 + 1*(-1) = 1 \nfeature_map1(1,2) = 0*1 + 1*(-1) + 1*1 + 1*(-1) = -1 \n``` \nfeature_map1(3,3) = 1*1 + 0*(-1) + 1*1 + 0*(-1) = 2</span></pre>\n</blockquote>\n<p>　　<span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>可以看到这就是最简单的内积公式。feature_map1(1,1)表示在通过第一个卷积核计算完后得到的feature_map的第一行第一列的值，随着卷积核的窗口不断的滑动，我们可以计算出一个3*3的feature_map1;同理可以计算通过第二个卷积核进行卷积运算后的feature_map2，那么这一层卷积操作就完成了。<span style=\"color: #0000ff\">feature_map尺寸计算公式：[ (原图片尺寸 -卷积核尺寸)/ 步长 ] + 1</span>。这一层我们设定了两个2*2的卷积核，在paddlepaddle里是这样定义的：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> conv_pool_1 =<span style=\"color: #000000\"> paddle.networks.simple_img_conv_pool(\n</span><span style=\"color: #008080\">2</span>         input=<span style=\"color: #000000\">img,\n</span><span style=\"color: #008080\">3</span>         filter_size=3<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">4</span>         num_filters=2<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">5</span>         num_channel=1<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">6</span>         pool_stride=1<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">7</span>         act=paddle.activation.Relu())</pre>\n</div>\n<p><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>　　这里调用了networks里simple_img_conv_pool函数，激活函数是Relu(修正线性单元)，我们来看一看源码里是如何实现的：</span></p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_3d338399-3e90-4aaa-87fc-996d70e981e4\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_3d338399-3e90-4aaa-87fc-996d70e981e4\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_3d338399-3e90-4aaa-87fc-996d70e981e4\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> simple_img_conv_pool(input,\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #000000\">                         filter_size,\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #000000\">                         num_filters,\n</span><span style=\"color: #008080\"> 4</span> <span style=\"color: #000000\">                         pool_size,\n</span><span style=\"color: #008080\"> 5</span>                          name=<span style=\"color: #000000\">None,\n</span><span style=\"color: #008080\"> 6</span>                          pool_type=<span style=\"color: #000000\">None,\n</span><span style=\"color: #008080\"> 7</span>                          act=<span style=\"color: #000000\">None,\n</span><span style=\"color: #008080\"> 8</span>                          groups=1<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 9</span>                          conv_stride=1<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">10</span>                          conv_padding=<span style=\"color: #000000\">0,\n</span><span style=\"color: #008080\">11</span>                          bias_attr=<span style=\"color: #000000\">None,\n</span><span style=\"color: #008080\">12</span>                          num_channel=<span style=\"color: #000000\">None,\n</span><span style=\"color: #008080\">13</span>                          param_attr=<span style=\"color: #000000\">None,\n</span><span style=\"color: #008080\">14</span>                          shared_bias=<span style=\"color: #000000\">True,\n</span><span style=\"color: #008080\">15</span>                          conv_layer_attr=<span style=\"color: #000000\">None,\n</span><span style=\"color: #008080\">16</span>                          pool_stride=1<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">17</span>                          pool_padding=<span style=\"color: #000000\">0,\n</span><span style=\"color: #008080\">18</span>                          pool_layer_attr=<span style=\"color: #000000\">None):\n</span><span style=\"color: #008080\">19</span>     <span style=\"color: #800000\">\"\"\"</span>\n<span style=\"color: #008080\">20</span> <span style=\"color: #800000\">    Simple image convolution and pooling group.\n</span><span style=\"color: #008080\">21</span> <span style=\"color: #800000\">    Img input =&gt; Conv =&gt; Pooling =&gt; Output.\n</span><span style=\"color: #008080\">22</span> <span style=\"color: #800000\">    :param name: group name.\n</span><span style=\"color: #008080\">23</span> <span style=\"color: #800000\">    :type name: basestring\n</span><span style=\"color: #008080\">24</span> <span style=\"color: #800000\">    :param input: input layer.\n</span><span style=\"color: #008080\">25</span> <span style=\"color: #800000\">    :type input: LayerOutput\n</span><span style=\"color: #008080\">26</span> <span style=\"color: #800000\">    :param filter_size: see img_conv_layer for details.\n</span><span style=\"color: #008080\">27</span> <span style=\"color: #800000\">    :type filter_size: int\n</span><span style=\"color: #008080\">28</span> <span style=\"color: #800000\">    :param num_filters: see img_conv_layer for details.\n</span><span style=\"color: #008080\">29</span> <span style=\"color: #800000\">    :type num_filters: int\n</span><span style=\"color: #008080\">30</span> <span style=\"color: #800000\">    :param pool_size: see img_pool_layer for details.\n</span><span style=\"color: #008080\">31</span> <span style=\"color: #800000\">    :type pool_size: int\n</span><span style=\"color: #008080\">32</span> <span style=\"color: #800000\">    :param pool_type: see img_pool_layer for details.\n</span><span style=\"color: #008080\">33</span> <span style=\"color: #800000\">    :type pool_type: BasePoolingType\n</span><span style=\"color: #008080\">34</span> <span style=\"color: #800000\">    :param act: see img_conv_layer for details.\n</span><span style=\"color: #008080\">35</span> <span style=\"color: #800000\">    :type act: BaseActivation\n</span><span style=\"color: #008080\">36</span> <span style=\"color: #800000\">    :param groups: see img_conv_layer for details.\n</span><span style=\"color: #008080\">37</span> <span style=\"color: #800000\">    :type groups: int\n</span><span style=\"color: #008080\">38</span> <span style=\"color: #800000\">    :param conv_stride: see img_conv_layer for details.\n</span><span style=\"color: #008080\">39</span> <span style=\"color: #800000\">    :type conv_stride: int\n</span><span style=\"color: #008080\">40</span> <span style=\"color: #800000\">    :param conv_padding: see img_conv_layer for details.\n</span><span style=\"color: #008080\">41</span> <span style=\"color: #800000\">    :type conv_padding: int\n</span><span style=\"color: #008080\">42</span> <span style=\"color: #800000\">    :param bias_attr: see img_conv_layer for details.\n</span><span style=\"color: #008080\">43</span> <span style=\"color: #800000\">    :type bias_attr: ParameterAttribute\n</span><span style=\"color: #008080\">44</span> <span style=\"color: #800000\">    :param num_channel: see img_conv_layer for details.\n</span><span style=\"color: #008080\">45</span> <span style=\"color: #800000\">    :type num_channel: int\n</span><span style=\"color: #008080\">46</span> <span style=\"color: #800000\">    :param param_attr: see img_conv_layer for details.\n</span><span style=\"color: #008080\">47</span> <span style=\"color: #800000\">    :type param_attr: ParameterAttribute\n</span><span style=\"color: #008080\">48</span> <span style=\"color: #800000\">    :param shared_bias: see img_conv_layer for details.\n</span><span style=\"color: #008080\">49</span> <span style=\"color: #800000\">    :type shared_bias: bool\n</span><span style=\"color: #008080\">50</span> <span style=\"color: #800000\">    :param conv_layer_attr: see img_conv_layer for details.\n</span><span style=\"color: #008080\">51</span> <span style=\"color: #800000\">    :type conv_layer_attr: ExtraLayerAttribute\n</span><span style=\"color: #008080\">52</span> <span style=\"color: #800000\">    :param pool_stride: see img_pool_layer for details.\n</span><span style=\"color: #008080\">53</span> <span style=\"color: #800000\">    :type pool_stride: int\n</span><span style=\"color: #008080\">54</span> <span style=\"color: #800000\">    :param pool_padding: see img_pool_layer for details.\n</span><span style=\"color: #008080\">55</span> <span style=\"color: #800000\">    :type pool_padding: int\n</span><span style=\"color: #008080\">56</span> <span style=\"color: #800000\">    :param pool_layer_attr: see img_pool_layer for details.\n</span><span style=\"color: #008080\">57</span> <span style=\"color: #800000\">    :type pool_layer_attr: ExtraLayerAttribute\n</span><span style=\"color: #008080\">58</span> <span style=\"color: #800000\">    :return: layer's output\n</span><span style=\"color: #008080\">59</span> <span style=\"color: #800000\">    :rtype: LayerOutput\n</span><span style=\"color: #008080\">60</span>     <span style=\"color: #800000\">\"\"\"</span>\n<span style=\"color: #008080\">61</span>     _conv_ =<span style=\"color: #000000\"> img_conv_layer(\n</span><span style=\"color: #008080\">62</span>         name=<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">%s_conv</span><span style=\"color: #800000\">\"</span> %<span style=\"color: #000000\"> name,\n</span><span style=\"color: #008080\">63</span>         input=<span style=\"color: #000000\">input,\n</span><span style=\"color: #008080\">64</span>         filter_size=<span style=\"color: #000000\">filter_size,\n</span><span style=\"color: #008080\">65</span>         num_filters=<span style=\"color: #000000\">num_filters,\n</span><span style=\"color: #008080\">66</span>         num_channels=<span style=\"color: #000000\">num_channel,\n</span><span style=\"color: #008080\">67</span>         act=<span style=\"color: #000000\">act,\n</span><span style=\"color: #008080\">68</span>         groups=<span style=\"color: #000000\">groups,\n</span><span style=\"color: #008080\">69</span>         stride=<span style=\"color: #000000\">conv_stride,\n</span><span style=\"color: #008080\">70</span>         padding=<span style=\"color: #000000\">conv_padding,\n</span><span style=\"color: #008080\">71</span>         bias_attr=<span style=\"color: #000000\">bias_attr,\n</span><span style=\"color: #008080\">72</span>         param_attr=<span style=\"color: #000000\">param_attr,\n</span><span style=\"color: #008080\">73</span>         shared_biases=<span style=\"color: #000000\">shared_bias,\n</span><span style=\"color: #008080\">74</span>         layer_attr=<span style=\"color: #000000\">conv_layer_attr)\n</span><span style=\"color: #008080\">75</span>     <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> img_pool_layer(\n</span><span style=\"color: #008080\">76</span>         name=<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">%s_pool</span><span style=\"color: #800000\">\"</span> %<span style=\"color: #000000\"> name,\n</span><span style=\"color: #008080\">77</span>         input=<span style=\"color: #000000\">_conv_,\n</span><span style=\"color: #008080\">78</span>         pool_size=<span style=\"color: #000000\">pool_size,\n</span><span style=\"color: #008080\">79</span>         pool_type=<span style=\"color: #000000\">pool_type,\n</span><span style=\"color: #008080\">80</span>         stride=<span style=\"color: #000000\">pool_stride,\n</span><span style=\"color: #008080\">81</span>         padding=<span style=\"color: #000000\">pool_padding,\n</span><span style=\"color: #008080\">82</span>         layer_attr=pool_layer_attr)</pre>\n</div>\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　所以这个卷积过程就完成了。从上文的计算中我们可以看到，<span style=\"color: #0000ff\">同一层的神经元可以共享卷积核，那么对于高位数据的处理将会变得非常简单</span>。并且使用卷积核后图片的尺寸变小，方便后续计算，并且<span style=\"color: #0000ff\">我们不需要手动去选取特征，只用设计好卷积核的尺寸，数量和滑动的步长就可以让它自己去训练</span>了，省时又省力啊。</span></p>\n<p> </p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　<span style=\"font-size: 16px\"><strong><span style=\"color: #0000ff\">为什么卷积核有效？</span></strong></span></span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　那么问题来了，虽然我们知道了卷积核是如何计算的，但是为什么使用卷积核计算后分类效果要由于普通的神经网络呢？我们仔细来看一下上面计算的结果。通过第一个卷积核计算后的feature_map是一个三维数据，在第三列的绝对值最大，说明原始图片上对应的地方有一条垂直方向的特征，即像素数值变化较大；而通过第二个卷积核计算后，第三列的数值为0，第二行的数值绝对值最大，说明原始图片上对应的地方有一条水平方向的特征。</span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　仔细思考一下，这个时候，我们设计的两个卷积核分别能够提取，或者说检测出原始图片的特定的特征。此时<span style=\"color: #0000ff\">我们其实就可以把卷积核就理解为特征提取器</span>啊！现在就明白了，为什么我们只需要把图片数据灌进去，设计好卷积核的尺寸、数量和滑动的步长就可以让自动提取出图片的某些特征，从而达到分类的效果啊！</span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　<strong><span style=\"color: #0000ff\">注</span></strong>：1.此处的卷积运算是两个卷积核大小的矩阵的内积运算，不是矩阵乘法。即相同位置的数字相乘再相加求和。不要弄混淆了。</span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　　　2.卷积核的公式有很多，这只是最简单的一种。我们所说的卷积核在数字信号处理里也叫滤波器，那滤波器的种类就多了，均值滤波器，高斯滤波器，拉普拉斯滤波器等等，不过，不管是什么滤波器，都只是一种数学运算，无非就是计算更复杂一点。</span></p>\n<p><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>            3.每一层的卷积核大小和个数可以自己定义，不过<span style=\"color: #0000ff\">一般情况下，根据实验得到的经验来看，会在越靠近输入层的卷积层设定少量的卷积核，越往后，卷积层设定的卷积核数目就越多</span>。具体原因大家可以先思考一下，小结里会解释原因。</span></p>\n<p> </p>\n<ul>\n<li><span style='font-size: 16px; font-family: \"comic sans ms\", sans-serif'><strong><span style=\"color: #0000ff\">池化层（Pooling Layer）</span></strong></span></li>\n</ul>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　通过上一层2*2的卷积核操作后，我们将原始图像由4*4的尺寸变为了3*3的一个新的图片。池化层的主要目的是通过降采样的方式，在不影响图像质量的情况下，压缩图片，减少参数。简单来说，假设现在设定池化层采用MaxPooling，大小为2*2，步长为1，取每个窗口最大的数值重新，那么图片的尺寸就会由3*3变为2*2：(3-2)+1=2。从上例来看，会有如下变换：</span><span style=\"color: #0000ff\"><br></span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/853467/201711/853467-20171101174706357-1639782929.png\" alt=\"\" width=\"481\" height=\"375\"></span></p>\n<p> </p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>     通常来说，池化方法一般有一下两种：</span></p>\n<ul>\n<li><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>MaxPooling：取滑动窗口里最大的值</span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>AveragePooling：取滑动窗口内所有值的平均值</span></li>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</ul>\n<p> </p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　 <span style=\"color: #0000ff\">为什么采用Max Pooling？</span></span></p>\n<p><span style=\"color: #000000\">　<span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　从计算方式来看，算是最简单的一种了，取max即可，但是这也引发一个思考，为什么需要Max Pooling，意义在哪里？如果我们只取最大值，那其他的值被舍弃难道就没有影响吗？不会损失这部分信息吗？如果认为这些信息是可损失的，那么是否意味着我们在进行卷积操作后仍然产生了一些不必要的冗余信息呢？</span></span></p>\n<p><span style=\"color: #000000\"><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　其实从上文分析卷积核为什么有效的原因来看，每一个卷积核可以看做一个特征提取器，不同的卷积核负责提取不同的特征，我们例子中设计的第一个卷积核能够提取出“垂直”方向的特征，第二个卷积核能够提取出“水平”方向的特征，那么我们对其进行Max Pooling操作后，提取出的是真正能够识别特征的数值，其余被舍弃的数值，对于我提取特定的特征并没有特别大的帮助。那么在进行后续计算使，减小了feature map的尺寸，从而减少参数，达到减小计算量，缺不损失效果的情况。</span></span></p>\n<p><span style=\"color: #000000\"><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　不过并不是所有情况Max Pooling的效果都很好，有时候有些周边信息也会对某个特定特征的识别产生一定效果，那么这个时候舍弃这部分“不重要”的信息，就不划算了。所以具体情况得具体分析，如果加了Max Pooling后效果反而变差了，不如把卷积后不加Max Pooling的结果与卷积后加了Max Pooling的结果输出对比一下，看看Max Pooling是否对卷积核提取特征起了反效果。</span></span></p>\n<p> </p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>    <span style=\"color: #0000ff\"> Zero Padding</span></span></p>\n<p> <span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>     所以到现在为止，我们的图片由4*4，通过卷积层变为3*3，再通过池化层变化2*2，如果我们再添加层，那么图片岂不是会越变越小？这个时候我们就会引出“<span style=\"color: #0000ff\">Zero Padding</span>”（补零），它可以帮助我们保证每次经过卷积或池化输出后图片的大小不变，如，上述例子我们如果加入Zero Padding，再采用3*3的卷积核，那么变换后的图片尺寸与原图片尺寸相同，如下图所示：</span></p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/853467/201710/853467-20171031215017701-495180034.png\" alt=\"\" width=\"508\" height=\"407\"></p>\n<p><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'> 　　通常情况下，我们希望图片做完卷积操作后保持图片大小不变，所以我们一般会选择尺寸为3*3的卷积核和1的zero padding，或者5*5的卷积核与2的zero padding，这样通过计算后，可以保留图片的原始尺寸。那么加入zero padding后的feature_map尺寸 =( width + 2 * padding_size - filter_size )/stride + 1</span></p>\n<p><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>　　注：这里的width也可换成height，此处是默认正方形的卷积核，weight = height，如果两者不相等，可以分开计算，分别补零。</span></p>\n<p> </p>\n<ul>\n<li><span style='color: #000000; font-size: 15px; font-family: \"comic sans ms\", sans-serif'><strong><span style=\"color: #0000ff\">Flatten层 &amp; Fully Connected Layer</span></strong></span></li>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</ul>\n<p><span style='color: #000080; font-size: 15px; font-family: \"comic sans ms\", sans-serif'><strong>　　</strong><span style=\"color: #000000\">到这一步，其实我们的一个完整的“卷积部分”就算完成了，如果想要叠加层数，一般也是叠加“Conv-MaxPooing\"</span></span><span style='color: #000080; font-size: 15px; font-family: \"comic sans ms\", sans-serif'><span style=\"color: #000000\">,</span></span><span style='color: #000080; font-size: 15px; font-family: \"comic sans ms\", sans-serif'><span style=\"color: #000000\">通过不断的设计卷积核的尺寸，数量，提取更多的特征，最后识别不同类别的物体。做完Max Pooling后，我们就会把这些数据“拍平”，丢到Flatten层，然后把Flatten层的output放到full connected Layer里，采用softmax对其进行分类。</span></span></p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/853467/201711/853467-20171101174758185-1744013824.png\" alt=\"\" width=\"772\" height=\"307\"></p>\n<p><span style=\"color: #0000ff\">　　</span></p>\n<ul>\n<li><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'><strong><span style=\"color: #0000ff; font-size: 16px\">小结</span></strong></span></li>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</ul>\n<p>　　<span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>这一节我们介绍了最基本的卷积神经网络的基本层的定义，计算方式和起的作用。有几个小问题可以供大家思考一下：<span style=\"color: #0000ff\">　</span></span></p>\n<p style=\"margin-left: 30px\"><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>1.卷积核的尺寸必须为正方形吗？可以为长方形吗？如果是长方形应该怎么计算？</span></p>\n<p style=\"margin-left: 30px\"><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>2.卷积核的个数如何确定？每一层的卷积核的个数都是相同的吗？</span> </p>\n<p style=\"margin-left: 30px\"><span style='font-size: 15px; font-family: \"comic sans ms\", sans-serif'>3.步长的向右和向下移动的幅度必须是一样的吗？</span></p>\n<p> </p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　如果对上面的讲解真的弄懂了的话，其实这几个问题并不难回答。下面给出我的想法，可以作为参考：</span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　1.卷积核的尺寸<span style='font-family: \"comic sans ms\", sans-serif'>不一定非得为正方形。长方形也可以，只不过通常情况下为正方形。如果要设置为长方形，那么首先得保证这层的输出形状是整数，不能是小数。如果你的图像是边长为 28 的正方形。那么卷积层的输出就满足 [ (28 - kernel_size)/ stride ] + 1 ，这个数值得是整数才行，否则没有物理意义。譬如，你算得一个边长为 3.6 的 feature map 是没有物理意义的。 pooling 层同理。FC 层的输出形状总是满足整数，其唯一的要求就是整个训练过程中 FC 层的输入得是定长的。如果你的图像不是正方形。那么在制作数据时，可以缩放到统一大小（非正方形），再使用非正方形的 kernel_size 来使得卷积层的输出依然是整数。总之，撇开网络结果设定的好坏不谈，其本质上就是在做算术应用题：如何使得各层的输出是整数。</span><br></span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　2.由经验确定。通常情况下，靠近输入的卷积层，譬如第一层卷积层，会找出一些共性的特征，如手写数字识别中第一层我们设定卷积核个数为5个，一般是找出诸如\"横线\"、“竖线”、“斜线”等共性特征，我们称之为basic feature，经过max pooling后，在第二层卷积层，设定卷积核个数为20个，可以找出一些相对复杂的特征，如“横折”、“左半圆”、“右半圆”等特征，越往后，卷积核设定的数目越多，越能体现label的特征就越细致，就越容易分类出来，打个比方，如果你想分类出“0”的数字，你看到<img src=\"http://images2017.cnblogs.com/blog/853467/201710/853467-20171031231438107-1902818098.png\" alt=\"\" width=\"32\" height=\"34\">这个特征，能推测是什么数字呢？只有越往后，检测识别的特征越多，试过能识别<img src=\"http://images2017.cnblogs.com/blog/853467/201711/853467-20171101085737623-1572944193.png\" alt=\"\" width=\"83\" height=\"29\">这几个特征，那么我就能够确定这个数字是“0”。<br></span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　3.有stride_w和stride_h，后者表示的就是上下步长。如果用stride，则表示stride_h=stride_w=stride。</span></p>\n<p> </p>\n<p> </p>\n<hr>\n<p><em id=\"__mceDel\"><span style=\"color: #0000ff\">　　</span></em><span style='font-size: 16px; font-family: \"comic sans ms\", sans-serif'><strong><span style=\"color: #0000ff\">手写数字识别的CNN网络结构</span></strong></span></p>\n<p><span style='color: #000000; font-family: \"comic sans ms\", sans-serif; font-size: 15px'><span style=\"color: #0000ff\">　<span style=\"color: #000000\">　上面我们了解了卷积神经网络的基本结构后，现在来具体看一下在实际数据---手写数字识别中是如何操作的。上文中我定义了一个最基本的CNN网络。如下(代码详见<a href=\"https://github.com/huxiaoman7/PaddlePaddle_code\" target=\"_blank\">github</a>)</span></span></span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> convolutional_neural_network_org(img):\n</span><span style=\"color: #008080\"> 2</span>     <span style=\"color: #008000\">#</span><span style=\"color: #008000\"> first conv layer</span>\n<span style=\"color: #008080\"> 3</span>     conv_pool_1 =<span style=\"color: #000000\"> paddle.networks.simple_img_conv_pool(\n</span><span style=\"color: #008080\"> 4</span>         input=<span style=\"color: #000000\">img,\n</span><span style=\"color: #008080\"> 5</span>         filter_size=3<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 6</span>         num_filters=20<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 7</span>         num_channel=1<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 8</span>         pool_size=2<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 9</span>         pool_stride=2<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">10</span>         act=<span style=\"color: #000000\">paddle.activation.Relu())\n</span><span style=\"color: #008080\">11</span>     <span style=\"color: #008000\">#</span><span style=\"color: #008000\"> second conv layer</span>\n<span style=\"color: #008080\">12</span>     conv_pool_2 =<span style=\"color: #000000\"> paddle.networks.simple_img_conv_pool(\n</span><span style=\"color: #008080\">13</span>         input=<span style=\"color: #000000\">conv_pool_1,\n</span><span style=\"color: #008080\">14</span>         filter_size=5<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">15</span>         num_filters=50<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">16</span>         num_channel=20<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">17</span>         pool_size=2<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">18</span>         pool_stride=2<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">19</span>         act=<span style=\"color: #000000\">paddle.activation.Relu())\n</span><span style=\"color: #008080\">20</span>     <span style=\"color: #008000\">#</span><span style=\"color: #008000\"> fully-connected layer</span>\n<span style=\"color: #008080\">21</span>     predict =<span style=\"color: #000000\"> paddle.layer.fc(\n</span><span style=\"color: #008080\">22</span>         input=conv_pool_2, size=10, act=<span style=\"color: #000000\">paddle.activation.Softmax())\n</span><span style=\"color: #008080\">23</span>     <span style=\"color: #0000ff\">return</span> predict</pre>\n</div>\n<p> </p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　那么它的网络结构是：</span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　conv1----&gt; conv2----&gt;fully Connected layer</span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　非常简单的网络结构。第一层我们采取的是3*3的正方形卷积核，个数为20个，深度为1，stride为2，pooling尺寸为2*2，激活函数采取的为RELU；第二层只对卷积核的尺寸、个数和深度做了些变化，分别为5*5，50个和20；最后链接一层全连接，设定10个label作为输出，采用Softmax函数作为分类器，输出每个label的概率。</span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　那么这个时候我考虑的问题是，既然上面我们已经了解了卷积核，改变卷积核的大小是否会对我的结果造成影响？增多卷积核的数目能够提高准确率？于是我做了个实验：</span></p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/853467/201710/853467-20171031232805748-157396975.png\" alt=\"\" width=\"688\" height=\"316\"></p>\n<ul>\n<li>　<span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>第一次改进：仅改变第一层与第二层的卷积核数目的大小，其他保持不变。可以看到结果提升了0.06%</span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　第二次改进：保持3*3的卷积核大小，仅改变第二层的卷积核数目，其他保持不变，可以看到结果相较于原始参数提升了0.08%</span></li>\n</ul>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　<span style='font-family: \"comic sans ms\", sans-serif'>由以上结果可以看出，改变卷积核的大小与卷积核的数目会对结果产生一定影响，在目前手写数字识别的项目中，缩小卷积核尺寸，增加卷积核数目都会提高准确率。不过以上实验只是一个小测试，有兴趣的同学可以多做几次实验，看看参数带来的具体影响，下篇文章我们会着重分析参数的影响。</span></span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　这篇文章主要介绍了神经网络的预备知识，卷积神经网络的常见的层及基本的计算过程，<span style=\"color: #3366ff\">看完后希望大家明白以下几个知识点</span>：</span></p>\n<blockquote>\n<ul>\n<li><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>为什么卷积神经网络更适合于图像分类？相比于传统的神经网络优势在哪里？</span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>卷积层中的卷积过程是如何计算的？为什么卷积核是有效的？</span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif'><span style=\"font-size: 15px\">卷积核的个数如何确定？应该选择多大的卷积核对于模型来说才是有效的？尺寸必须为正方形吗？如果是长方形因该怎么做？</span></span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif'><span style=\"font-size: 15px\">步长的大小会对模型的效果产生什么样的影响？垂直方向和水平方向的步长是否得设定为相同的？</span></span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>为什么要采用池化层，Max Pooling有什么好处？</span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif'><span style=\"font-size: 15px\">Zero Padding有什么作用？如果已知一个feature map的尺寸，如何确定zero padding的数目？</span></span></li>\n</ul>\n</blockquote>\n<p>　　</p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>    上面的问题，有些在文章中已经详细讲过，有些大家可以根据文章的内容多思考一下。最后<span style=\"color: #3366ff\">给大家留几个问题思考一下</span>：</span></p>\n<blockquote>\n<ul>\n<li><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>为什么改变卷积核的大小能够提高结果的准确率？卷积核大小对于分类结果是如何影响的？</span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>卷积核的参数是怎么求的？一开始随机定义一个，那么后来是如何训练才能使这个卷积核识别某些特定的特征呢？</span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>1*1的卷积核有意义吗？为什么有些网络层结构里会采用1*1的卷积核？</span></li>\n</ul>\n</blockquote>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　</span></p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>　　<span style=\"color: #3366ff\">下篇文章我们会着重讲解以下几点</span>：</span></p>\n<blockquote>\n<ul>\n<li><span style='font-family: \"comic sans ms\", sans-serif'><span style=\"font-size: 15px\">卷积核的参数如何确定？随机初始化一个数值后，是如何训练得到一个能够识别某些特征的卷积核的？</span></span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif'><span style=\"font-size: 15px\">CNN是如何进行反向传播的？</span></span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif'><span style=\"font-size: 15px\">如何调整CNN里的参数？</span></span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif'><span style=\"font-size: 15px\">如何设计最适合的CNN网络结构？</span></span></li>\n<li><span style='font-family: \"comic sans ms\", sans-serif'><span style=\"font-size: 15px\">能够不用调用框架的api，手写一个CNN，并和paddlepaddle里的实现过程做对比，看看有哪些可以改进的？</span></span></li>\n</ul>\n</blockquote>\n<p> </p>\n<p> </p>\n<p><span style='font-family: \"comic sans ms\", sans-serif; font-size: 15px'>ps：本篇文章是基于个人对CNN的理解来写的，本人能力有限，有些地方可能写的不是很严谨，如有错误或疏漏之处，请留言给我，我一定会仔细核实并修改的^_^！不接受无脑喷哦~此外，文中的图表结构均为自己所做，希望不要被人随意抄袭，可以进行非商业性质的转载，需要转载留言或发邮件即可，希望能够尊重劳动成果，谢谢！有不懂的也请留言给我，我会尽力解答的哈~</span></p>\n<div> </div>\n<p> </p>\n<p>　　</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 09:00</span> <a href=\"http://www.cnblogs.com/charlotte77/\">Charlotte77</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7759802\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7759802);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=257737,cb_entryId=7759802,cb_blogApp=currentBlogApp,cb_blogUserGuid='b268e779-719d-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/1 9:00:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 1706, "image_url": ["https://pic.cnblogs.com/face/853467/20160428085235.png"], "date_pub": "2017-11-01", "article_common": 46}
{"title": "EF框架搭建小总结--CodeFirst模型优先", "url": "http://www.cnblogs.com/txqx/p/7692313.html", "author": "天下！行", "article_desc": "\r\n    前言：之前在下总结编写了一篇 EF框架搭建小总结--ModelFirst模型优先 博文，看到一段时间内该博文的访问量蹭、蹭蹭、蹭蹭蹭...往上涨(实际也不是很多，嘿嘿)，但是还是按捺不住内心的喜悦(蛮有成就感的)，感觉为大家做了一点点小小的贡献，在下也就再接再厉(趁风大，再浪浪)，总结一篇 Code ...\r\n    ", "content": "<div id=\"post_detail\">\r\n\t<div class=\"post\">\r\n\t\t<h2>\r\n\t\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/txqx/p/7692313.html\">EF框架搭建小总结--CodeFirst模型优先</a>\r\n\t\t</h2>\r\n\t\t<div class=\"postText\"><div id=\"cnblogs_post_body\"><p><span style=\"font-size: 16px\"><strong>前言：</strong><span style=\"font-size: 14px\">之前</span></span>在下总结编写了一篇 <a href=\"http://www.cnblogs.com/txqx/p/7685401.html\" target=\"_blank\">EF框架搭建小总结--ModelFirst模型优先</a> 博文，看到一段时间内该博文的访问量蹭、蹭蹭、蹭蹭蹭...往上涨(实际也不是很多，嘿嘿)，但是还是按捺不住内心的喜悦(蛮有成就感的)，感觉为大家做了一点点小小的贡献，在下也就再接再厉(趁风大，再浪浪)，总结一篇  CodeFirst代码优先的博文，若有不当之处，还望大家斧正。</p>\n<p><span style=\"font-size: 16px\"><strong>Code First介绍：</strong></span><span lang=\"en-US\">     Code First<span lang=\"zh-CN\">模式是一种很cool的模式，<span lang=\"zh-CN\">手动创建POCO(全称Plain Old Class Object，也就是最基本的CLR Class，实体类)类，数据层DbContext及映射关系，通过Database.SetInitializer(本次采用dbcontext.Database.CreateIfNotExists方法)生成数据库，自动生成方便快速、更易维护、非常灵活。<span lang=\"zh-CN\"><br></span></span></span></span></p>\n<p><span style=\"font-size: 16px\"><strong><span lang=\"en-US\"><span lang=\"zh-CN\"><span lang=\"zh-CN\"><strong>使用工具： </strong></span></span></span></strong><span style=\"font-size: 15px\" lang=\"en-US\"><span lang=\"zh-CN\"><span lang=\"zh-CN\">win7操作系统，vs2012， sqlserver2008</span></span></span></span></p>\n<p><span style=\"font-size: 16px\"><strong><span lang=\"en-US\"><span lang=\"zh-CN\"><span lang=\"zh-CN\">开始</span></span></span></strong></span></p>\n<p><span style=\"font-size: 14px\"><strong><span lang=\"en-US\"><span lang=\"zh-CN\"><span lang=\"zh-CN\">1.创建新项目</span></span></span></strong></span></p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1223156/201710/1223156-20171019165827927-66972817.png\" alt=\"\"></p>\n<p><span style=\"font-size: 14px\"><strong> 2.创建完项目后，需要引用\"EntityFramework\"程序包，且看如何引入</strong></span></p>\n<p><span style=\"font-size: 14px\">2.1 在【引用】上单击右键，选中【管理NuGet程序包(N)】</span></p>\n<p><span style=\"font-size: 14px\"><img src=\"http://images2017.cnblogs.com/blog/1223156/201710/1223156-20171019162739943-1077564352.png\" alt=\"\"></span></p>\n<p> </p>\n<p><span style=\"font-size: 14px\">2.2 在弹出的窗口上选择【联机】，找到【EntityFramework】程序包，点击安装</span></p>\n<p><span style=\"font-size: 14px\"><img src=\"http://images2017.cnblogs.com/blog/1223156/201710/1223156-20171019164251740-914419990.png\" alt=\"\"></span></p>\n<p><span style=\"font-size: 14px\">2.3 安装后的效果</span></p>\n<p><span style=\"font-size: 14px\"><img src=\"http://images2017.cnblogs.com/blog/1223156/201710/1223156-20171019165453709-766649493.png\" alt=\"\"></span></p>\n<p> </p>\n<p><span style=\"font-size: 14px\"><strong>3 开始上代码</strong></span></p>\n<p> 3.1 创建一个User实体类</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace CodeFirst\n{\n   public class User\n    {\n        public int Id { set; get; }\n        public string Name { set; get; }\n        public string Password { set; get; }\n    }\n}\n</pre>\n</div>\n<p>3.2 创建连接上下文的类，该类的一些说明在代码里已标注</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">using System;\nusing System.Collections.Generic;\nusing System.Data.Entity;// DbContext类需要引入的类库\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace CodeFirst\n{\n    //该类继承于DbContext类，\n    //DbContext是EntityFramework很重要的部分，连接类与数据库的桥梁，是与数据库通信的主要类\n    public class CodeFirstDbContext : DbContext\n\n    {\n          //构造函数\n        public CodeFirstDbContext()\n            : base(\"name = CodeFirstDbContext\")//根据配置文件中链接数据库\n                                               //CodeFirstDbContext会在app.config中进行配置\n        { \n        }\n        public DbSet&lt;User&gt; User { get; set; }\n       \n    \n    }\n}\n</pre>\n</div>\n<p>　　</p>\n<p><span style=\"font-size: 14px\">3.3 在配置文件App.config中添加内容</span></p>\n<p> </p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;configuration&gt;\n  &lt;configSections&gt;\n    &lt;!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --&gt;\n    &lt;section name=\"entityFramework\" type=\"System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" requirePermission=\"false\" /&gt;\n  &lt;/configSections&gt;\n  &lt;startup&gt;\n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.5\" /&gt;\n  &lt;/startup&gt;\n  &lt;entityFramework&gt;\n    &lt;defaultConnectionFactory type=\"System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework\" /&gt;\n    &lt;providers&gt;\n      &lt;provider invariantName=\"System.Data.SqlClient\" type=\"System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer\" /&gt;\n    &lt;/providers&gt;\n  &lt;/entityFramework&gt;\n\n  &lt;!--连接本地sql server数据库需要配置的文件--&gt;\n  &lt;connectionStrings&gt;\n    &lt;add name=\"CodeFirstDbContext\" <span style=\"background-color: #ff6600\">connectionString=\"Data Source=.;Initial Catalog=DatabaseName;</span>Integrated Security=True;\" providerName=\"System.Data.SqlClient\"/&gt;\n  &lt;/connectionStrings&gt;\n  \n&lt;/configuration&gt;\n</pre>\n</div>\n<p> </p>\n<p>　　其中Data Source = . 表示连接的是本地数据库，Initial Catalog=DatabaseName;表示一会创建的数据库名字为DatabaseName</p>\n<p> </p>\n<p> </p>\n<p><span style=\"font-size: 14px\">3.4 在主程序中创建数据库，数据表，并填入字段</span></p>\n<p> </p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:csharp;gutter:true;\">using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace CodeFirst\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            //创建上下文\n            CodeFirstDbContext dbcontext = new CodeFirstDbContext();\n            //创建数据库\n            dbcontext.Database.CreateIfNotExists();\n            //创建表，并将字段加入进去\n            User u = new User();\n            u.Name = \"li\";\n            u.Id = 1;\n            u.Password = \"123456\";\n            //将实体赋予上下文，并添加到表里\n            dbcontext.User.Add(u);\n            //保存\n            dbcontext.SaveChanges();\n            Console.WriteLine(\"成功\");\n            Console.ReadKey();\n\n        }\n    }\n}\n</pre>\n</div>\n<p> </p>\n<p>　　运行主程序后，便会在数据库中成功创建你的数据库，数据表。</p>\n<p> </p>\n<p><strong><span style=\"font-size: 16px\">结果：</span></strong></p>\n<p><strong><span style=\"font-size: 16px\"><img src=\"http://images2017.cnblogs.com/blog/1223156/201711/1223156-20171101103052263-148250061.png\" alt=\"\"></span></strong></p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p><span style=\"font-size: 14px\"> </span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n</div>\r\n\t\t<p class=\"postfoot\">\r\n\t\t\tposted on <span id=\"post-date\">2017-11-01 10:33</span> <a href=\"http://www.cnblogs.com/txqx/\">天下！行</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7692313\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7692313);return false;\">收藏</a>\r\n\t\t</p>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=379102,cb_entryId=7692313,cb_blogApp=currentBlogApp,cb_blogUserGuid='bd2246e6-69e7-43f6-8542-08d49c352df3',cb_entryCreatedDate='2017/11/1 10:33:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n\t</div>", "article_view": 432, "image_url": ["https:"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "[译]ASP.NET Core 2.0 路由引擎", "url": "http://www.cnblogs.com/sanshi/p/7745679.html", "author": "三生石上(FineUI控件)", "article_desc": "问题 ASP.NET Core 2.0的路由引擎是如何工作的？ 答案 创建一个空项目，为Startup类添加MVC服务和请求中间件： 创建一个控制器HomeController，来演示常规路由： 创建一个控制器WorkController，来演示特性路由： 讨论 ASP.NET Core的路由引擎可 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/sanshi/p/7745679.html\">[译]ASP.NET Core 2.0 路由引擎</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h2>问题</h2>\r\n<p>ASP.NET Core 2.0的路由引擎是如何工作的？</p>\r\n<h2>答案</h2>\r\n<p>创建一个空项目，为Startup类添加MVC服务和请求中间件：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public void ConfigureServices(IServiceCollection services)\r\n{\r\n\tservices.AddMvc();\r\n}\r\n\r\npublic void Configure(IApplicationBuilder app, IHostingEnvironment env)\r\n{\r\n\tapp.UseMvc(routes =&gt;\r\n\t{\r\n\t\troutes.MapRoute(\r\n\t\t\tname: \"goto_one\",\r\n\t\t\ttemplate: \"one\",\r\n\t\t\tdefaults: new { controller = \"Home\", action = \"PageOne\" });\r\n\r\n\t\troutes.MapRoute(\r\n\t\t\tname: \"goto_two\",\r\n\t\t\ttemplate: \"two/{id?}\",\r\n\t\t\tdefaults: new { controller = \"Home\", action = \"PageTwo\" });\r\n\r\n\t\troutes.MapRoute(\r\n\t\t\tname: \"default\",\r\n\t\t\ttemplate: \"{controller=Home}/{action=Index}/{id?}\");\r\n\t});\r\n}</pre>\r\n</div>\r\n<p>创建一个控制器HomeController，来演示常规路由：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public class HomeController : Controller\r\n{\r\n\tpublic IActionResult Index()\r\n\t{\r\n\t\treturn Content(\"Home/Index\");\r\n\t}\r\n\r\n\tpublic IActionResult PageOne()\r\n\t{\r\n\t\treturn Content(\"Home/One\");\r\n\t}\r\n\r\n\t[HttpGet]\r\n\tpublic IActionResult PageTwo()\r\n\t{\r\n\t\treturn Content(\"(GET) Home/Two\");\r\n\t}\r\n\r\n\t[HttpPost]\r\n\tpublic IActionResult PageTwo(int id)\r\n\t{\r\n\t\treturn Content($\"(POST) Home/Two: {id}\");\r\n\t}\r\n}</pre>\r\n</div>\r\n<p>创建一个控制器WorkController，来演示特性路由：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">[Route(\"work\")]\r\npublic class WorkController : Controller\r\n{\r\n\tpublic IActionResult Index()\r\n\t{\r\n\t\treturn Content(\"Work/Index\");\r\n\t}\r\n\r\n\t[Route(\"one\")]\r\n\tpublic IActionResult PageOne()\r\n\t{\r\n\t\treturn Content(\"Work/One\");\r\n\t}\r\n\r\n\t[HttpGet(\"two\")]\r\n\tpublic IActionResult PageTwo()\r\n\t{\r\n\t\treturn Content(\"(GET) Work/Two\");\r\n\t}\r\n\r\n\t[HttpPost(\"two/{id?}\")]\r\n\tpublic IActionResult PageTwo(int id)\r\n\t{\r\n\t\treturn Content($\"(POST) Work/Two: {id}\");\r\n\t}\r\n}</pre>\r\n</div>\r\n<h2>讨论</h2>\r\n<p>ASP.NET Core的路由引擎可以将传入的请求映射到控制器和它们的方法中。这是通过向请求管道中添加路由中间件实现的，具体来说是使用IRouteBuilder将URL规则（模板）映射到一个控制器的方法。</p>\r\n<h3>路由模板</h3>\r\n<p>路由模板可以使用字面值和标记（标识路由参数）。在匹配一个路由时，字面值会严格匹配URL中的文本，而标记会被替换掉。<br>为了匹配一个模板，模板中必须包含控制器和方法标记以便定位控制器方法（这是MVC的核心信息）。模板中的其它标记被映射为方法的参数（通过模型绑定实现）。<br>当添加一个路由映射时，可以为标记提供缺省值。当模板中不包含控制器和方法标记时会很有用。模板也可以包含对应于方法参数的可选标记。<br>让我们来看一个示例模板：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">contact/{controller=Home}/{action=Index}/{id?}</pre>\r\n</div>\r\n<p><br>注意如下几点：</p>\r\n<ol>\r\n<li>标记包含中大括号中。这里有三个标记，分别是controller，action和id。</li>\r\n<li>模板中包含一个字面值contact，它会匹配URL中的文本。</li>\r\n<li>已经为controller（Home）和action（Index）提供了默认值。</li>\r\n<li>可选标记通过问号来声明。</li>\r\n\r\n\r\n\r\n</ol>\r\n<p>下面的URL会匹配这个模板：</p>\r\n<ul>\r\n<li>/contact/Home/Index/1: 所有标记都有值。</li>\r\n<li>/contact/Home/Index: 忽略了可选标记。</li>\r\n<li>/contact/Home: 忽略了action标记，将使用默认值Index。</li>\r\n<li>/contact: 忽略了controller和action标记，将分别使用其默认值Home和Index。</li>\r\n\r\n\r\n\r\n</ul>\r\n<h3><br>常规路由</h3>\r\n<p>常规路由为URL路径建立一个约定, 例如给定一个模板:</p>\r\n<ol>\r\n<li>第一个标记映射到控制器</li>\r\n<li>第二个标记映射到方法</li>\r\n<li>第三个标记映射到可选的方法参数id</li>\r\n\r\n\r\n\r\n</ol>\r\n<p>你也可以从模板中省略控制器和方法，只要你为它们提供缺省值就行了。比如下面的路由会映射到地址/one，因为通过defaults提供了所需的控制器和方法标记：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">routes.MapRoute(\r\n       name: \"goto_one\",\r\n       template: \"one\",\r\n       defaults: new { controller = \"Home\", action = \"PageOne\" });</pre>\r\n</div>\r\n<p>注：请将此特定路由添加到通用路由之前，因为路由是按照定义的顺序执行的，一旦某个路由匹配成功，则整个匹配流程就会终结。</p>\r\n<p>由于路由中间件只使用了控制器和方法标记来映射到一个控制器方法，因此同一个控制器中放置多个同名的的方法将会抛出异常。为了解决这个问题，可以使用方法上的IActionConstraint特性（比如HttpGet，HttpPost等特性）：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">[HttpGet(\"two\")]\r\npublic IActionResult PageTwo()\r\n{\r\n\treturn Content(\"(GET) Work/Two\");\r\n}\r\n\r\n[HttpPost(\"two/{id?}\")]\r\npublic IActionResult PageTwo(int id)\r\n{\r\n\treturn Content($\"(POST) Work/Two: {id}\");\r\n}\r\n</pre>\r\n</div>\r\n<p> </p>\r\n<p>====start by sanshi=========================</p>\r\n<p>为了观察控制器中同名方法出现的异常，我们首先需要修改Configure()方法，添加开发时异常处理中间件：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public void Configure(IApplicationBuilder app, IHostingEnvironment env)\r\n{\r\n\tif (env.IsDevelopment())\r\n\t{\r\n\t\tapp.UseDeveloperExceptionPage();\r\n\t}\r\n\r\n\tapp.UseMvc(routes =&gt; ....);\r\n}\r\n</pre>\r\n</div>\r\n<p>修改HomeController：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">public IActionResult PageTwo()\r\n{\r\n\treturn Content(\"(GET) Home/Two\");\r\n}\r\npublic IActionResult PageTwo(int id)\r\n{\r\n\treturn Content($\"(POST) Home/Two: {id}\");\r\n}\r\n</pre>\r\n</div>\r\n<p>看似很正常的重载函数，但是放到控制器中会抛出异常。</p>\r\n<p>在浏览器地址栏敲入：http://localhost:65415/Home/PageTwo，观看到异常页面：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/48817/201710/48817-20171028095901711-773504083.png\" alt=\"\"></p>\r\n<p>　　</p>\r\n<p>====end by sanshi=========================　　</p>\r\n<h3><br>特性路由</h3>\r\n<p>特性路由通过直接为控制器和方法提供路由模板来实现。<br>我们可以使用[Route]或者[HttpGet]（或者其他动词）特性来指定模板。这些模板可以包含字面值和标记（不能包含控制器和方法标记）。<br>运行时，控制器的特性模板和方法的特性模板会被合并到一起，比如，在WorkController中，PageOne方法可以通过/work/one访问：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:csharp;gutter:true;\">[Route(\"work\")]\r\npublic class WorkController : Controller\r\n{\r\n\t[Route(\"one\")]\r\n\tpublic IActionResult PageOne()\r\n\t{\r\n\t\treturn Content(\"Work/One\");\r\n\t}\r\n}</pre>\r\n</div>\r\n<h2> </h2>\r\n<h2><a href=\"https://files.cnblogs.com/files/sanshi/Routing.zip\" target=\"_blank\">源代码下载</a></h2>\r\n<p> </p>\r\n<p>原文：<a href=\"https://tahirnaushad.com/2017/08/20/asp-net-core-mvc-routing/\" target=\"_blank\">https://tahirnaushad.com/2017/08/20/asp-net-core-mvc-routing/</a></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 10:33</span> <a href=\"http://www.cnblogs.com/sanshi/\">三生石上(FineUI控件)</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7745679\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7745679);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=52411,cb_entryId=7745679,cb_blogApp=currentBlogApp,cb_blogUserGuid='289f0a2c-88f9-dd11-9e4d-001cf0cd104b',cb_entryCreatedDate='2017/11/1 10:33:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 354, "image_url": ["https://pic.cnblogs.com/face/48817/20151109122200.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "由移动端级联选择器所引发的对于数据结构的思考", "url": "http://www.cnblogs.com/nzbin/p/7754447.html", "author": "nzbin", "article_desc": "GitHub：https://github.com/nzbin/Framework7-CityPicker Demo：https://nzbin.github.io/Framework7-CityPicker/ 前言 最近在做移动端项目的时候遇到了省市区选择的功能。以往做项目时都是省市区分开的下拉框 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/nzbin/p/7754447.html\">由移动端级联选择器所引发的对于数据结构的思考</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><blockquote>\r\n<p>GitHub：<a href=\"https://github.com/nzbin/Framework7-CityPicker\" target=\"_blank\">https://github.com/nzbin/Framework7-CityPicker</a></p>\r\n<p>Demo：<a href=\"https://nzbin.github.io/Framework7-CityPicker/\" target=\"_blank\">https://nzbin.github.io/Framework7-CityPicker/</a></p>\r\n</blockquote>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/999445/201710/999445-20171031212033279-415490372.gif\" alt=\"\"></p>\r\n<h2>前言</h2>\r\n<p>最近在做移动端项目的时候遇到了省市区选择的功能。以往做项目时都是省市区分开的下拉框样式。这次希望实现效果图要求的级联选择器。我是 Framework7 框架的忠实粉丝，庆幸的是 Framework7 已经有模拟 iOS 选择框效果的 Picker 组件。在开发之前我先搜索了现有的一些选择器插件，整体而言都能满足需求但都不完美，比如滑动不流畅、显示有 Bug 等等。</p>\r\n<h2>Picker 级联选择器</h2>\r\n<p>基于 Framework7 制作级联选择器比较简单，关键是生成省市区数组以及省市区之间的联动。</p>\r\n<p>以下是 CityPicker 的基本参数设置：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">var</span> pickerLocation =<span style=\"color: #000000;\"> myApp.picker({\r\n    input: </span>'#location',<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">选择器</span>\r\n    rotateEffect: <span style=\"color: #0000ff;\">true</span>,<span style=\"color: #008000;\">//设置</span><span style=\"color: #008000;\">旋转效果</span>\r\n    toolbarTemplate: '',<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">自定义按钮</span>\r\n<span style=\"color: #000000;\">    cols: [{\r\n            cssClass: </span>'f-s-14',<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">添加自定义类</span>\r\n            width: 100,<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">列宽</span>\r\n            textAlign: 'left',<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">对齐方式</span>\r\n            values: province,<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">省数组</span>\r\n            onChange: <span style=\"color: #0000ff;\">function</span>(picker, province) {<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">联动方法</span>\r\n<span style=\"color: #000000;\">\r\n            }\r\n        },\r\n        {\r\n            cssClass: </span>'f-s-14',<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">添加自定义类</span>\r\n            width: 100,<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">列宽</span>\r\n            textAlign: 'center',<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">对齐方式</span>\r\n            values: city,<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">市数组</span>\r\n            onChange: <span style=\"color: #0000ff;\">function</span>(picker, city) {<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">联动方法</span>\r\n<span style=\"color: #000000;\">\r\n            }\r\n        },\r\n        {\r\n            cssClass: </span>'f-s-14',<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">添加自定义类</span>\r\n            width: 100,<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">列宽</span>\r\n            textAlign: 'right',<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">对齐方式</span>\r\n            values: area,<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">区数组</span>\r\n<span style=\"color: #000000;\">        }\r\n    ]\r\n});</span></pre>\r\n</div>\r\n<p>其中省市区的格式都是基本数组，所以必须循环省市区数据生成相应的数组或者数据本身具有可以直接获取数组的结构。</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>province = ['北京','天津','河北','山东'<span style=\"color: #000000;\">,...]\r\ncity </span>= ['济南','青岛','淄博','滨州'<span style=\"color: #000000;\">,...]\r\narea </span>= ['滨城区','惠民县','阳信县','博兴县',...]</pre>\r\n</div>\r\n<h2>省市区数据结构</h2>\r\n<p>没有想到一个简单的问题，最后竟然扯到了数据结构。经过尝试和思考，最终出现了三种数据结构，而这些东西应该都不是新鲜事。鉴于学识有限，我只能浅尝辄止的对比三者的异同，以及给出自己循环数据的方法。</p>\r\n<h3>1.无子父级关系的数组</h3>\r\n<p>去年做项目时省市区数据并没有从接口读取，而是保存到一个 JS 文件中。以下是后台从数据库导出的原始省市区数据片段（2016 年的数据，应该比较全，我删除了香港、澳门及台湾）。</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('63e92cac-0e40-473c-9c96-6cd041f2bea2')\"><img id=\"code_img_closed_63e92cac-0e40-473c-9c96-6cd041f2bea2\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_63e92cac-0e40-473c-9c96-6cd041f2bea2\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('63e92cac-0e40-473c-9c96-6cd041f2bea2',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_63e92cac-0e40-473c-9c96-6cd041f2bea2\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">[\r\n    {\r\n      </span>\"region_id\": 11<span style=\"color: #000000;\">,\r\n      </span>\"region_name\": \"北京市\"<span style=\"color: #000000;\">,\r\n      </span>\"region_sort\": 1<span style=\"color: #000000;\">,\r\n      </span>\"region_remark\": \"直辖市\"<span style=\"color: #000000;\">,\r\n      </span>\"pinyin\": \"beijingshi\"<span style=\"color: #000000;\">,\r\n      </span>\"py\": \"bjs\"<span style=\"color: #000000;\">,\r\n      </span>\"area_code\": \"110000\"<span style=\"color: #000000;\">,\r\n      </span>\"parent_id\": 1<span style=\"color: #000000;\">,\r\n      </span>\"level\": 1<span style=\"color: #000000;\">\r\n    },\r\n    {\r\n      </span>\"region_id\": 12<span style=\"color: #000000;\">,\r\n      </span>\"region_name\": \"天津市\"<span style=\"color: #000000;\">,\r\n      </span>\"region_sort\": 2<span style=\"color: #000000;\">,\r\n      </span>\"region_remark\": \"直辖市\"<span style=\"color: #000000;\">,\r\n      </span>\"pinyin\": \"tianjinshi\"<span style=\"color: #000000;\">,\r\n      </span>\"py\": \"tjs\"<span style=\"color: #000000;\">,\r\n      </span>\"area_code\": \"120000\"<span style=\"color: #000000;\">,\r\n      </span>\"parent_id\": 1<span style=\"color: #000000;\">,\r\n      </span>\"level\": 1<span style=\"color: #000000;\">\r\n    },\r\n    {\r\n      </span>\"region_id\": 13<span style=\"color: #000000;\">,\r\n      </span>\"region_name\": \"河北省\"<span style=\"color: #000000;\">,\r\n      </span>\"region_sort\": 3<span style=\"color: #000000;\">,\r\n      </span>\"region_remark\": \"省份\"<span style=\"color: #000000;\">,\r\n      </span>\"pinyin\": \"hebeisheng\"<span style=\"color: #000000;\">,\r\n      </span>\"py\": \"hbs\"<span style=\"color: #000000;\">,\r\n      </span>\"area_code\": \"130000\"<span style=\"color: #000000;\">,\r\n      </span>\"parent_id\": 1<span style=\"color: #000000;\">,\r\n      </span>\"level\": 1<span style=\"color: #000000;\">\r\n    },\r\n    ...\r\n    {\r\n      </span>\"region_id\": 101<span style=\"color: #000000;\">,\r\n      </span>\"region_name\": \"北京市\"<span style=\"color: #000000;\">,\r\n      </span>\"region_sort\": 1<span style=\"color: #000000;\">,\r\n      </span>\"region_remark\": <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">,\r\n      </span>\"pinyin\": \"beijingshi\"<span style=\"color: #000000;\">,\r\n      </span>\"py\": \"bjs\"<span style=\"color: #000000;\">,\r\n      </span>\"area_code\": \"110100\"<span style=\"color: #000000;\">,\r\n      </span>\"parent_id\": 11<span style=\"color: #000000;\">,\r\n      </span>\"level\": 2<span style=\"color: #000000;\">\r\n    },\r\n    {\r\n      </span>\"region_id\": 102<span style=\"color: #000000;\">,\r\n      </span>\"region_name\": \"天津市\"<span style=\"color: #000000;\">,\r\n      </span>\"region_sort\": 2<span style=\"color: #000000;\">,\r\n      </span>\"region_remark\": <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">,\r\n      </span>\"pinyin\": \"tianjinshi\"<span style=\"color: #000000;\">,\r\n      </span>\"py\": \"tjs\"<span style=\"color: #000000;\">,\r\n      </span>\"area_code\": \"120100\"<span style=\"color: #000000;\">,\r\n      </span>\"parent_id\": 12<span style=\"color: #000000;\">,\r\n      </span>\"level\": 2<span style=\"color: #000000;\">\r\n    },\r\n    {\r\n      </span>\"region_id\": 105<span style=\"color: #000000;\">,\r\n      </span>\"region_name\": \"邯郸市\"<span style=\"color: #000000;\">,\r\n      </span>\"region_sort\": 5<span style=\"color: #000000;\">,\r\n      </span>\"region_remark\": <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">,\r\n      </span>\"pinyin\": \"handanshi\"<span style=\"color: #000000;\">,\r\n      </span>\"py\": \"hds\"<span style=\"color: #000000;\">,\r\n      </span>\"area_code\": \"130400\"<span style=\"color: #000000;\">,\r\n      </span>\"parent_id\": 13<span style=\"color: #000000;\">,\r\n      </span>\"level\": 2<span style=\"color: #000000;\">\r\n    },\r\n    ...\r\n  }\r\n]</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<p> 这个数据并没有明确的子父级关系，只能通过 parent_id 查找对应的省市。循环方式如下：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n * [getProvince 获取省]\r\n * @param  {[Object]} regions [省市区数据]\r\n * @return {[Array]}          [省数组]\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> getProvince(regions) {\r\n\r\n    $.each(regions, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">() {\r\n        </span><span style=\"color: #0000ff;\">if</span> (<span style=\"color: #0000ff;\">this</span>.level === 1<span style=\"color: #000000;\">) {\r\n            province.push(</span><span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">.region_name);\r\n        }\r\n    });\r\n\r\n    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> province;\r\n}\r\n\r\n</span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n * [getCity 获取市]\r\n * @param  {[Object]} regions      [省市区数据]\r\n * @param  {[String]} provinceName [省名]\r\n * @return {[Array]}               [市数组]\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> getCity(regions, provinceName) {\r\n\r\n    </span><span style=\"color: #0000ff;\">var</span> province_id = 0<span style=\"color: #000000;\">,\r\n        cityArr </span>=<span style=\"color: #000000;\"> [];\r\n\r\n    $.each(regions, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">() {\r\n        </span><span style=\"color: #0000ff;\">if</span> (<span style=\"color: #0000ff;\">this</span>.level === 1 &amp;&amp; <span style=\"color: #0000ff;\">this</span>.region_name ===<span style=\"color: #000000;\"> provinceName) {\r\n            province_id </span>= <span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">.region_id;\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n        }\r\n    });\r\n    $.each(regions, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">() {\r\n        </span><span style=\"color: #0000ff;\">if</span> (<span style=\"color: #0000ff;\">this</span>.level === 2 &amp;&amp; <span style=\"color: #0000ff;\">this</span>.parent_id ===<span style=\"color: #000000;\"> province_id) {\r\n            cityArr.push(</span><span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">.region_name)\r\n        }\r\n    });\r\n\r\n    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> cityArr;\r\n}\r\n\r\n</span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n * [getArea 获取区]\r\n * @param  {[Object]} regions      [省市区数据]\r\n * @param  {[String]} provinceName [省名]\r\n * @param  {[String]} cityName     [市名]\r\n * @return {[Array]}               [区数组]\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> getArea(regions, provinceName, cityName) {\r\n\r\n    </span><span style=\"color: #0000ff;\">var</span> province_id = 0<span style=\"color: #000000;\">,\r\n        city_id </span>= 0<span style=\"color: #000000;\">,\r\n        areaArr </span>=<span style=\"color: #000000;\"> [];\r\n\r\n    $.each(regions, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">() {\r\n        </span><span style=\"color: #0000ff;\">if</span> (<span style=\"color: #0000ff;\">this</span>.level === 1 &amp;&amp; <span style=\"color: #0000ff;\">this</span>.region_name ===<span style=\"color: #000000;\"> provinceName) {\r\n            province_id </span>= <span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">.region_id;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">if</span> (<span style=\"color: #0000ff;\">this</span>.level === 2 &amp;&amp; <span style=\"color: #0000ff;\">this</span>.region_name === cityName &amp;&amp; <span style=\"color: #0000ff;\">this</span>.parent_id ===<span style=\"color: #000000;\"> province_id) {\r\n            city_id </span>= <span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">.region_id;\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n        }\r\n    });\r\n    $.each(regions, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">() {\r\n        </span><span style=\"color: #0000ff;\">if</span> (<span style=\"color: #0000ff;\">this</span>.level === 3 &amp;&amp; <span style=\"color: #0000ff;\">this</span>.parent_id ===<span style=\"color: #000000;\"> city_id) {\r\n            areaArr.push(</span><span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">.region_name)\r\n        }\r\n    });\r\n\r\n    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> areaArr;\r\n}</span></pre>\r\n</div>\r\n<p>因为数据量不大，我使用了 jQuery 原生的 $.each 循环，而在平时的工作中，我更倾向于使用 JS 原生的 for 循环。</p>\r\n<h3>2.有子父级关系的数组</h3>\r\n<p>在之前做项目的时候，非常希望能够将第一种省市区结构转化成比较常用的具有子父级关系的结构数组。但那时不会用 Nodejs，也没有其它比较好的生成文件的方法，所以就一直使用第一种循环思路。</p>\r\n<p>最终经过一阵折腾，成功用 Nodejs 实现了对原有数据结构的重新映射。</p>\r\n<p>现在我使用 Nodejs 对省市区结构做了如下调整，因为本文的讨论重点是级联选择器以及数据结构，所以就不去讨论如何使用 Nodejs 生成文件了。</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('4115d5eb-73af-40e9-82f6-7d544e264009')\"><img id=\"code_img_closed_4115d5eb-73af-40e9-82f6-7d544e264009\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_4115d5eb-73af-40e9-82f6-7d544e264009\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('4115d5eb-73af-40e9-82f6-7d544e264009',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_4115d5eb-73af-40e9-82f6-7d544e264009\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">[\r\n  {\r\n    </span>\"provinceName\": \"北京市\"<span style=\"color: #000000;\">,\r\n    </span>\"provinceId\": 11<span style=\"color: #000000;\">,\r\n    </span>\"cities\"<span style=\"color: #000000;\">: [\r\n      {\r\n        </span>\"cityName\": \"北京市\"<span style=\"color: #000000;\">,\r\n        </span>\"cityId\": 101<span style=\"color: #000000;\">,\r\n        </span>\"areas\"<span style=\"color: #000000;\">: [\r\n          {\r\n            </span>\"areaName\": \"东城区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1001<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"西城区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1002<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"崇文区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1003<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"宣武区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1004<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"朝阳区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1005<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"丰台区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1006<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"石景山区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1007<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"海淀区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1008<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"门头沟区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1009<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"房山区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1010<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"通州区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1011<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"顺义区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1012<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"昌平区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1013<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"大兴区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1014<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"怀柔区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1015<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"平谷区\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1016<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"密云县\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1017<span style=\"color: #000000;\">\r\n          },\r\n          {\r\n            </span>\"areaName\": \"延庆县\"<span style=\"color: #000000;\">,\r\n            </span>\"areaId\": 1018<span style=\"color: #000000;\">\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n  ...\r\n]</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<p> 循环方式如下：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n * [getProvince 获取省]\r\n * @param  {[Object]} regions [省市区数据]\r\n * @return {[Array]}          [省数组]\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> getProvince(<span style=\"color: #000000;\">regions</span>) {\r\n\r\n    </span><span style=\"color: #0000ff;\">var</span> provinceArr =<span style=\"color: #000000;\"> [];\r\n\r\n    $.each(regions, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">() {\r\n        provinceArr.push(</span><span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">.provinceName);\r\n    });\r\n\r\n    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> provinceArr;\r\n}\r\n\r\n</span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n * [getCity 获取市]\r\n * @param  {[Object]} regions      [省市区数据]\r\n * @param  {[String]} provinceName [省名]\r\n * @return {[Array]}               [市数组]\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> getCity(<span style=\"color: #000000;\">regions</span>, provinceName) {\r\n\r\n    </span><span style=\"color: #0000ff;\">var</span> cityArr =<span style=\"color: #000000;\"> [];\r\n\r\n    $.each(regions, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(i, province) {\r\n        </span><span style=\"color: #0000ff;\">if</span> (province.provinceName ===<span style=\"color: #000000;\"> provinceName) {\r\n            $.each(province.cities, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(j, city) {\r\n                cityArr.push(city.cityName);\r\n            });\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n        }\r\n    });\r\n\r\n    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> cityArr;\r\n}\r\n\r\n</span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n * [getArea 获取区]\r\n * @param  {[Object]} regions      [省市区数据]\r\n * @param  {[String]} provinceName [省名]\r\n * @param  {[String]} cityName     [市名]\r\n * @return {[Array]}               [区数组]\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> getArea(<span style=\"color: #000000;\">regions</span>, provinceName, cityName) {\r\n\r\n    </span><span style=\"color: #0000ff;\">var</span> areaArr =<span style=\"color: #000000;\"> [];\r\n\r\n    $.each(regions, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(i, province) {\r\n        </span><span style=\"color: #0000ff;\">if</span> (province.provinceName ===<span style=\"color: #000000;\"> provinceName) {\r\n            $.each(province.cities, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(j, city) {\r\n                </span><span style=\"color: #0000ff;\">if</span> (city.cityName ===<span style=\"color: #000000;\"> cityName) {\r\n                    $.each(city.areas, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(k, area) {\r\n                        areaArr.push(area.areaName);\r\n                    });\r\n                    </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n                }\r\n            });\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n        }\r\n    });\r\n\r\n    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> areaArr;\r\n}</span></pre>\r\n</div>\r\n<p>经过简单测试，这种数据结构确实优于第一种，但是两者循环时间的差距也仅在毫秒之间，所以实际感受并不深刻。</p>\r\n<h3>3.有子父级关系的对象</h3>\r\n<p>第二种数据结构是省市区数据常用的数据类型，但是想要获得选中省市所对应的 ID 不是很方便，需要重新循环一次。</p>\r\n<p>最后尝试将省市区名称作为键值的对象类型。</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('aa1f5907-ddfd-42c6-8859-2430a7ff4f20')\"><img id=\"code_img_closed_aa1f5907-ddfd-42c6-8859-2430a7ff4f20\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_aa1f5907-ddfd-42c6-8859-2430a7ff4f20\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('aa1f5907-ddfd-42c6-8859-2430a7ff4f20',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_aa1f5907-ddfd-42c6-8859-2430a7ff4f20\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #000000;\">{\r\n  </span>\"北京市\"<span style=\"color: #000000;\">: {\r\n    </span>\"id\": 11<span style=\"color: #000000;\">,\r\n    </span>\"cities\"<span style=\"color: #000000;\">: {\r\n      </span>\"北京市\"<span style=\"color: #000000;\">: {\r\n        </span>\"id\": 101<span style=\"color: #000000;\">,\r\n        </span>\"areas\"<span style=\"color: #000000;\">: {\r\n          </span>\"东城区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1001<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"西城区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1002<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"崇文区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1003<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"宣武区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1004<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"朝阳区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1005<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"丰台区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1006<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"石景山区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1007<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"海淀区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1008<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"门头沟区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1009<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"房山区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1010<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"通州区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1011<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"顺义区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1012<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"昌平区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1013<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"大兴区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1014<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"怀柔区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1015<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"平谷区\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1016<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"密云县\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1017<span style=\"color: #000000;\">\r\n          },\r\n          </span>\"延庆县\"<span style=\"color: #000000;\">: {\r\n            </span>\"id\": 1018<span style=\"color: #000000;\">\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  ...\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<p> 这样的变化使循环变得简单了，只用一层循环就可以：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n * [getProvince 获取省]\r\n * @param  {[Object]} regions [省市区数据]\r\n * @return {[Array]}          [省数组]\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> getProvince(regions) {\r\n\r\n    </span><span style=\"color: #0000ff;\">var</span> provinceArr =<span style=\"color: #000000;\"> [];\r\n\r\n    $.each(regions, </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(province) {\r\n        provinceArr.push(province);\r\n    });\r\n\r\n    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> provinceArr;\r\n}\r\n\r\n</span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n * [getCity 获取市]\r\n * @param  {[Object]} regions      [省市区数据]\r\n * @param  {[String]} provinceName [省名]\r\n * @return {[Array]}               [市数组]\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> getCity(regions, provinceName) {\r\n\r\n    </span><span style=\"color: #0000ff;\">var</span> cityArr =<span style=\"color: #000000;\"> [];\r\n\r\n    $.each(regions[provinceName][</span>'cities'], <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(city) {\r\n        cityArr.push(city);\r\n    });\r\n\r\n    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> cityArr;\r\n}\r\n\r\n</span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n * [getArea 获取区]\r\n * @param  {[Object]} regions      [省市区数据]\r\n * @param  {[String]} provinceName [省名]\r\n * @param  {[String]} cityName     [市名]\r\n * @return {[Array]}               [区数组]\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> getArea(regions, provinceName, cityName) {\r\n\r\n    </span><span style=\"color: #0000ff;\">var</span> areaArr =<span style=\"color: #000000;\"> [];\r\n\r\n    $.each(regions[provinceName][</span>'cities'][cityName]['areas'], <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(area) {\r\n        areaArr.push(area);\r\n    });\r\n\r\n    </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> areaArr;\r\n}</span></pre>\r\n</div>\r\n<p>这种数据结构和第二种差不多，但是循环对象只能用 for in 形式，而 for in 是最不稳定的循环方式，所以这种数据结构会不会存在潜在的危险？虽然目前的数据量并不需要担心，但作为程序员，还是应该时刻把效率和性能放在第一位。</p>\r\n<p>下图显示了三种文件的大小，都是未压缩的 JSON 格式。很显然，第三种数据结构最轻量，而第一种数据因为有多余的键值，所以尺寸非常庞大。</p>\r\n<p> <img src=\"http://images2017.cnblogs.com/blog/999445/201710/999445-20171031183242996-1723717952.png\" alt=\"\"></p>\r\n<h2>结论与思考</h2>\r\n<p>第二种数据结构和第三种数据结构差别不大，但是第三种数据结构可以更简单的获取省市 ID 。也许其中还有很多我所不知道的细枝末节，但我能力有限，无法深入展开讨论，只能从表面探索其中的异同。</p>\r\n<p>整体而言，三种数据结构都有循环，所以第一级联动时或多或少会有性能的损耗。我突然在想有没有第四种数据结构，在对应的 key 值上有现成的数组，这样就不必再去循环了，答案也许是肯定的。</p>\r\n<p>以下是省市区选择器的完整配置，联动效果需要使用上面提到的循环方法。所有的演示文件以及省市区 JSON 文件都上传到了 <a href=\"https://github.com/nzbin/Framework7-CityPicker\" target=\"_blank\">GitHub</a> 。</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('7bdeaa70-a725-4b59-aea8-c5210c621ddc')\"><img id=\"code_img_closed_7bdeaa70-a725-4b59-aea8-c5210c621ddc\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_7bdeaa70-a725-4b59-aea8-c5210c621ddc\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('7bdeaa70-a725-4b59-aea8-c5210c621ddc',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_7bdeaa70-a725-4b59-aea8-c5210c621ddc\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 初始化 Framework7</span>\r\n<span style=\"color: #0000ff;\">var</span> myApp = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Framework7();\r\n\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 初始化省市区</span>\r\n<span style=\"color: #0000ff;\">var</span> province =<span style=\"color: #000000;\"> getProvince(regions),\r\n    city </span>= getCity(regions, '北京市'<span style=\"color: #000000;\">),\r\n    area </span>= getArea(regions, '北京市', '北京市'<span style=\"color: #000000;\">);\r\n\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 保存 picker 选择的省</span>\r\n<span style=\"color: #0000ff;\">var</span> provinceSelect = ''<span style=\"color: #000000;\">;\r\n\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 省市区联动 / Framework7 picker</span>\r\n<span style=\"color: #0000ff;\">var</span> pickerLocation =<span style=\"color: #000000;\"> myApp.picker({\r\n    input: </span>'#location'<span style=\"color: #000000;\">,\r\n    rotateEffect: </span><span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">,\r\n    toolbarTemplate: </span>'<span style=\"color: #000000;\">&lt;div class=\"toolbar\"&gt;\\\r\n                        &lt;div class=\"toolbar-inner\"&gt;\\\r\n                            &lt;div class=\"left\"&gt;\\\r\n                                &lt;a href=\"#\" class=\"link close-picker\"&gt;取消&lt;/a&gt;\\\r\n                            &lt;/div&gt;\\\r\n                            &lt;div class=\"right\"&gt;\\\r\n                                &lt;a href=\"#\" class=\"link close-picker\"&gt;完成&lt;/a&gt;\\\r\n                            &lt;/div&gt;\\\r\n                        &lt;/div&gt;\\\r\n                    &lt;/div&gt;</span>'<span style=\"color: #000000;\">,\r\n    cols: [{\r\n            cssClass: </span>'f-s-14'<span style=\"color: #000000;\">,\r\n            width: </span>'33.33%'<span style=\"color: #000000;\">,\r\n            textAlign: </span>'left'<span style=\"color: #000000;\">,\r\n            values: province,\r\n            onChange: </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(picker, province) {\r\n                </span><span style=\"color: #0000ff;\">if</span> (picker.cols[1<span style=\"color: #000000;\">].replaceValues) {\r\n                    provinceSelect </span>=<span style=\"color: #000000;\"> province;\r\n                    city </span>=<span style=\"color: #000000;\"> getCity(regions, province);\r\n                    area </span>= getArea(regions, province, city[0<span style=\"color: #000000;\">]);\r\n                    picker.cols[</span>1<span style=\"color: #000000;\">].replaceValues(city);\r\n                    picker.cols[</span>2<span style=\"color: #000000;\">].replaceValues(area);\r\n                }\r\n            }\r\n        },\r\n        {\r\n            cssClass: </span>'f-s-14'<span style=\"color: #000000;\">,\r\n            width: </span>'33.33%'<span style=\"color: #000000;\">,\r\n            textAlign: </span>'center'<span style=\"color: #000000;\">,\r\n            values: city,\r\n            onChange: </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(picker, city) {\r\n                </span><span style=\"color: #0000ff;\">if</span> (picker.cols[2<span style=\"color: #000000;\">].replaceValues) {\r\n                    area </span>=<span style=\"color: #000000;\"> getArea(regions, provinceSelect, city);\r\n                    picker.cols[</span>2<span style=\"color: #000000;\">].replaceValues(area);\r\n                }\r\n            }\r\n        },\r\n        {\r\n            cssClass: </span>'f-s-14'<span style=\"color: #000000;\">,\r\n            width: </span>'33.33%'<span style=\"color: #000000;\">,\r\n            textAlign: </span>'right'<span style=\"color: #000000;\">,\r\n            values: area,\r\n        }\r\n    ]\r\n});</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<p>很遗憾，CityPicker 并不是一个插件，只是对 Framework7 Picker 组件的具体应用。如果有需要的话，我也会考虑把它封装成一个插件。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 23:59</span> <a href=\"http://www.cnblogs.com/nzbin/\">nzbin</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7754447\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7754447);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=296510,cb_entryId=7754447,cb_blogApp=currentBlogApp,cb_blogUserGuid='63f734bd-c453-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/31 23:59:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 211, "image_url": ["https://pic.cnblogs.com/face/999445/20160808203745.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "javascript 之作用域链-07", "url": "http://www.cnblogs.com/CandyManPing/p/7764664.html", "author": "风吹De麦浪", "article_desc": "复习作用域 上一节我们说到作用域：是指变量可以访问的范围，他规定了如何查找变量，以及确定当前执行代码对变量的访问权限；也说到静态作用域即词法作用域，是在编译阶段决定变量的引用（由程序定义的位置决定，和代码执行顺序无关，用嵌套的方式解析）。 疑问 如上代码，在执行run函数时，在run作用域中有nam ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/CandyManPing/p/7764664.html\">javascript 之作用域链-07</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h1>复习作用域</h1>\r\n<p>上一节我们说到作用域：是指变量可以访问的范围，他规定了如何查找变量，以及确定当前执行代码对变量的访问权限；也说到静态作用域即词法作用域，是在编译阶段决定变量的引用（由程序定义的位置决定，和代码执行顺序无关，用嵌套的方式解析）。</p>\r\n<h1>疑问</h1>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\">1</span>     <span style=\"color: #0000ff;\">var</span> x=10<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">2</span>     <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> run(){\r\n</span><span style=\"color: #008080;\">3</span>         <span style=\"color: #0000ff;\">var</span> name='Joel'<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\">4</span>         console.log(x+name);<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">10Joel  这里做了隐适转换 当有+时有一个为string 那么会当做字符拼接来处理</span>\r\n<span style=\"color: #008080;\">5</span> <span style=\"color: #000000;\">    }\r\n</span><span style=\"color: #008080;\">6</span>     run();</pre>\r\n</div>\r\n<p>如上代码，在执行run函数时，在run作用域中有name变量，但是并没有变量x，那么为什么不会报错，变量x又是怎么访问的呢？可能有些人理解是去父级函数作用域中寻找变量，其实这样理解作用域存在歧义（如果理解为是在调用函数的父级函数，那么肯定是错的  如下代码），上一节我们说过javascript的作用域是静态作用域，即<span style=\"color: #ff0000;\"><strong>应该关心代码定义的位置而不是调用的位置</strong></span> （词法作用域）；</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span>     <span style=\"color: #0000ff;\">var</span> x=10<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\"> 2</span>     <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> fn(){\r\n</span><span style=\"color: #008080;\"> 3</span> <span style=\"color: #000000;\">        console.log(x);\r\n</span><span style=\"color: #008080;\"> 4</span> <span style=\"color: #000000;\">    }\r\n</span><span style=\"color: #008080;\"> 5</span>     <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> show(f){\r\n</span><span style=\"color: #008080;\"> 6</span>         <span style=\"color: #0000ff;\">var</span> x=20<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\"> 7</span>         (<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(){\r\n</span><span style=\"color: #008080;\"> 8</span> <span style=\"color: #000000;\">            f()\r\n</span><span style=\"color: #008080;\"> 9</span> <span style=\"color: #000000;\">        }());\r\n</span><span style=\"color: #008080;\">10</span> <span style=\"color: #000000;\">    }\r\n</span><span style=\"color: #008080;\">11</span>     show(fn);<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">10 并不是20</span></pre>\r\n</div>\r\n<h1>引出作用域链</h1>\r\n<p>通过分析作用域的变量解析来理解作用域链</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span>  <span style=\"color: #0000ff;\">var</span> a=10<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\"> 2</span>     <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> run(){\r\n</span><span style=\"color: #008080;\"> 3</span>         <span style=\"color: #0000ff;\">var</span> name='Joel'<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\"> 4</span>         <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> say(){\r\n</span><span style=\"color: #008080;\"> 5</span>             <span style=\"color: #0000ff;\">var</span> content='hello'<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\"> 6</span>             console.log(content+name+','+<span style=\"color: #000000;\">a);\r\n</span><span style=\"color: #008080;\"> 7</span> <span style=\"color: #000000;\">        }\r\n</span><span style=\"color: #008080;\"> 8</span> <span style=\"color: #000000;\">        say();\r\n</span><span style=\"color: #008080;\"> 9</span> <span style=\"color: #000000;\">    }\r\n</span><span style=\"color: #008080;\">10</span>     run();<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">helloJoel,10</span></pre>\r\n</div>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/825196/201711/825196-20171101000818091-2095888431.png\" alt=\"\"></p>\r\n<p>通过上一篇我们知道js作用域有全局作用域，函数作用域，所以上面代码作用域如下：</p>\r\n<p>全局作用域：存在变量a、run函数引用，当然还存在其他函数、属性（内置的就不讨论了）；</p>\r\n<p>run函数作用域：存在变量 name 、say函数引用；</p>\r\n<p>say函数作用域：存在变量content；</p>\r\n<p>当代码执行到 console.log(content+name+','+a); 首先在say函数作用域中寻找变量content、name、a，如果找到则停止，没有找到就到上一个作用域中寻找，以此类推一直到window 全局作用域，如变量a 在当前say 作用域中没有，就到run作用域中寻找，还没找到就到全局作用域中寻找，如果还找不到就报错 is not defined，因为全局作用域是最外层作用域 ；</p>\r\n<p>继续看下面代码，我们在say函数中定义了变量name 之后，name值不在是run作用域中的值，因为在say作用域中找到了变量name 就不会继续寻找了</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008080;\"> 1</span> &lt;script&gt;\r\n<span style=\"color: #008080;\"> 2</span>     <span style=\"color: #0000ff;\">var</span> a=10<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\"> 3</span>     <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> run(){\r\n</span><span style=\"color: #008080;\"> 4</span>         <span style=\"color: #0000ff;\">var</span> name='Joel'<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\"> 5</span>         <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> say(){\r\n</span><span style=\"color: #008080;\"> 6</span>             <span style=\"color: #0000ff;\">var</span> content='hello',name=' Word'<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008080;\"> 7</span> \r\n<span style=\"color: #008080;\"> 8</span>             console.log(content+name+','+<span style=\"color: #000000;\">a);\r\n</span><span style=\"color: #008080;\"> 9</span> <span style=\"color: #000000;\">        }\r\n</span><span style=\"color: #008080;\">10</span> <span style=\"color: #000000;\">        say();\r\n</span><span style=\"color: #008080;\">11</span> <span style=\"color: #000000;\">    }\r\n</span><span style=\"color: #008080;\">12</span>     run();<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">hello Word,10</span>\r\n<span style=\"color: #008080;\">13</span> &lt;/script&gt;</pre>\r\n</div>\r\n<p><strong>这样一步一步的寻找变量的过程我们叫做标识符解析或者你可以理解为变量解析，那么提供这个线路或者这样寻找变量的机制我们叫做作用域链；</strong></p>\r\n<p>我们来总结一下这个过程：</p>\r\n<p>第一步，在当前作用域查找变量，如果有则获取并停止。如果没有则继续向上一个作用域寻找；</p>\r\n<p>第二步，如果当前作用域是全局作用域，则说明变量未定义，结束；否则继续；</p>\r\n<p>第三步，（不是全局作用域，那就是函数作用域）继续第一步；</p>\r\n<p>那么作用域链到底是什么呢？</p>\r\n<p>其实作用域链本质是一个指向变量对象的指针链表，它只引用但不实际包含变量对象的值；</p>\r\n<p>如上代码作用域链结构类似这样：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/825196/201711/825196-20171101012109107-1708437867.png\" alt=\"\"></p>\r\n<p>这篇只是引出作用域链，下一篇正式开始说执行环境，会涉及到变量对象、活动对象、作用域链等内容从而深入作用域链的创建过程。</p>\r\n<p>之所以要先写执行环境，是因为完整的作用域链是在执行环境中构建的。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 02:54</span> <a href=\"http://www.cnblogs.com/CandyManPing/\">风吹De麦浪</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7764664\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7764664);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=249941,cb_entryId=7764664,cb_blogApp=currentBlogApp,cb_blogUserGuid='53875310-0277-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/1 2:54:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 195, "image_url": ["https://pic.cnblogs.com/face/825196/20151020161955.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "Docker 如何支持多种日志方案？- 每天5分钟玩转 Docker 容器技术（88）", "url": "http://www.cnblogs.com/CloudMan6/p/7762369.html", "author": "CloudMan", "article_desc": "本节讨论 Docker 的 logging driver 机制和类型。 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div class=\"post\">\r\n\t<div class=\"postTitle\">\r\n\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/CloudMan6/p/7762369.html\">Docker 如何支持多种日志方案？- 每天5分钟玩转 Docker 容器技术（88）</a>\r\n\t</div>\r\n\t<div id=\"cnblogs_post_body\"><p><span style='color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; background-color: #fafafa'>将容器日志发送到 STDOUT 和 STDERR 是 Docker 的默认日志行为。实际上，Docker 提供了多种日志机制帮助用户从运行的容器中提取日志信息。这些机制被称作 logging driver。</span> </p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>Docker 的默认 logging driver 是<span class=\"Apple-converted-space\"> </span><code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'>json-file</code>。</p>\n<pre><span style=\"background-color: #c0c0c0\"># docker info |grep 'Logging Driver'</span><br><span style=\"background-color: #c0c0c0\">Logging Driver: json-file</span></pre>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>如果容器在启动时没有特别指明，就会使用这个默认的 logging driver。</p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'><code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">json-file</span></code><span class=\"Apple-converted-space\"> </span>会将容器的日志保存在 json 文件中，Docker 负责格式化其内容并输出到 STDOUT 和 STDERR。</p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>我们可以在 Host 的容器目录中找到这个文件，器路径为<span class=\"Apple-converted-space\"> </span><code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">/var/lib/docker/containers/&lt;contariner ID&gt;/&lt;contariner ID&gt;-json.log</span></code></p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>比如我们可以查看前面 httpd 容器 json 格式的日志文件。</p>\n<p style=\"white-space: normal\"><img style=\"float: none\" title=\"https://image.ipaiban.com/upload-ueditor-image-20171031-1509439261125030420.png\" src=\"https://image.ipaiban.com/upload-ueditor-image-20171031-1509439261125030420.png\" alt=\"\"></p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>可以看到 5 条日志记录。</p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>除了<span class=\"Apple-converted-space\"> </span><code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">json-file</span></code>，Docker 还支持多种 logging driver。完整列表可访问官方文档<span class=\"Apple-converted-space\"> </span><a style=\"cursor: pointer; color: #526fff\" href=\"https://docs.docker.com/engine/admin/logging/overview/#supported-logging-drivers\">https://docs.docker.com/engine/admin/logging/overview/#supported-logging-drivers</a></p>\n<p> <img style=\"float: none\" title=\"https://image.ipaiban.com/upload-ueditor-image-20171031-1509439261232024465.png\" src=\"https://image.ipaiban.com/upload-ueditor-image-20171031-1509439261232024465.png\" alt=\"\"><br>\n</p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>\n    <code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">none</span></code><span class=\"Apple-converted-space\"> </span>是 disable 容器日志功能。\n</p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>\n    <code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">syslog</span></code><span class=\"Apple-converted-space\"> </span>和<span class=\"Apple-converted-space\"> </span><code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">journald</span></code><span class=\"Apple-converted-space\"> </span>是 Linux 上的两种日志管理服务。\n</p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>\n    <code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">awslogs</span></code>、<code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">splunk</span></code><span class=\"Apple-converted-space\"> </span>和<span class=\"Apple-converted-space\"> </span><code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">gcplogs</span></code><span class=\"Apple-converted-space\"> </span>是第三方日志托管服务。\n</p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>\n    <code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">gelf</span></code><span class=\"Apple-converted-space\"> </span>和<span class=\"Apple-converted-space\"> </span><code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">fluentd</span></code><span class=\"Apple-converted-space\"> </span>是两种开源的日志管理方案，我们会在后面分别讨论。\n</p>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>\n    容器启动时可以通过<span class=\"Apple-converted-space\"> </span><code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">--log-driver</span></code><span class=\"Apple-converted-space\"> </span>指定使用的 logging driver。如果要设置 Docker 默认的 logging driver，需要修改 Docker daemon 的启动脚本，指定<span class=\"Apple-converted-space\"> </span><code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">--log-driver</span></code><span class=\"Apple-converted-space\"> </span>参数，比如：\n</p>\n<pre><span style=\"background-color: #c0c0c0\">ExecStart=/usr/bin/dockerd -H fd:// --log-driver=syslog --log-opt ......</span></pre>\n<p style='margin-top: 0px; margin-bottom: 15px; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal; background-color: #fafafa'>每种 logging driver 都有自己的<span class=\"Apple-converted-space\"> </span><code style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace; font-size: 12.96px; padding: 2px 4px; color: #000000; background: #eaeaeb'><span style=\"background-color: #d8d8d8\">--log-opt</span></code>，使用时请参考官方文档。</p>\n<p style='margin-top: 0px; margin-bottom: 1.5em; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal'> 下一节我们开始学习 ELK。<br>\n</p>\n<p style='margin-top: 0px; margin-bottom: 1.5em; line-height: 1.6; color: #383a42; font-family: system-ui, \"Lucida Grande\", \"Segoe UI\", Ubuntu, Cantarell, sans-serif; font-size: 14.4px; white-space: normal'>\n    <span style='color: #232323; font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; background-color: #ffffff; font-size: 24px'><strong>书籍：</strong></span><br style='color: #232323; font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; font-size: 14px; white-space: normal; background-color: #ffffff'><span style='color: #232323; font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; background-color: #ffffff'>1.《每天5分钟玩转Docker容器技术》</span><br style='color: #232323; font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; font-size: 14px; white-space: normal; background-color: #ffffff'><span style='color: #232323; font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; background-color: #ffffff'><a style=\"color: #56b6e9\" href=\"https://item.jd.com/16936307278.html\" target=\"_blank\">https://item.jd.com/16936307278.html</a></span><br style='color: #232323; font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; font-size: 14px; white-space: normal; background-color: #ffffff'><br style='color: #232323; font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; font-size: 14px; white-space: normal; background-color: #ffffff'><span style='color: #232323; font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; background-color: #ffffff'>2.《每天5分钟玩转OpenStack》</span><br style='color: #232323; font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; font-size: 14px; white-space: normal; background-color: #ffffff'><span style='color: #232323; font-family: \"PingFang SC\", \"Helvetica Neue\", Helvetica, Arial, sans-serif; background-color: #ffffff'><a style=\"color: #56b6e9\" href=\"https://item.jd.com/12086376.html\" target=\"_blank\">https://item.jd.com/12086376.html</a></span>\n</p>\n<p>\n    <img style=\"white-space: normal; float: none\" title=\"https://image.ipaiban.com/upload-ueditor-image-20171010-1507627732322012171.png\" src=\"https://image.ipaiban.com/upload-ueditor-image-20171010-1507627732322012171.png\" alt=\"\">\n</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t<div class=\"postDesc\">posted on <span id=\"post-date\">2017-11-01 07:30</span> <a href=\"http://www.cnblogs.com/CloudMan6/\">CloudMan</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7762369\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7762369);return false;\">收藏</a></div>\r\n</div>\r\n<script type=\"text/javascript\">var allowComments=true,cb_blogId=267676,cb_entryId=7762369,cb_blogApp=currentBlogApp,cb_blogUserGuid='80611f09-3d14-e511-b908-9dcfd8948a71',cb_entryCreatedDate='2017/11/1 7:30:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\r\n</div>", "article_view": 272, "image_url": ["https://pic.cnblogs.com/face/775365/20160228114235.png"], "date_pub": "2017-11-01", "article_common": 3}
{"title": "spark的sparkUI如何解读？", "url": "http://www.cnblogs.com/yjf512/p/7764687.html", "author": "轩脉刃", "article_desc": "spark的sparkUI如何解读？ 以spark2.1.4来做例子 Job schedule mode 进入之后默认是进入spark job 页面 这个说明有很详细的解释，spark有两种操作算子：转换算子（transformation）和执行算子（Action）。当执行到行为算子的时候，就出发了 ...", "content": "<div id=\"post_detail\">\r\n<div class=\"post\" id=\"post\">\r\n    <a name=\"top\"></a>\r\n    <h2><a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/yjf512/p/7764687.html\">spark的sparkUI如何解读？</a></h2>\r\n    <small>2017-11-01 07:44 by 轩脉刃, <span id=\"post_view_count\">...</span> 阅读, <span id=\"post_comment_count\">...</span> 评论, <a href=\"#\" onclick=\"AddToWz(7764687);return false;\">收藏</a>,  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7764687\" rel=\"nofollow\">编辑</a></small>\r\n    <div class=\"entry\">\r\n        <div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>spark的sparkUI如何解读？</p>\n<p>以spark2.1.4来做例子</p>\n<h1 id=\"job---schedule-mode\">Job - schedule mode</h1>\n<p>进入之后默认是进入spark job 页面<br>\n<img src=\"http://images2017.cnblogs.com/blog/136188/201711/136188-20171101074231451-242406055.png\"></p>\n<p>这个说明有很详细的解释，spark有两种操作算子：转换算子（transformation）和执行算子（Action）。当执行到行为算子的时候，就出发了一个Job作业，比如count()和saveAsTextFile()。</p>\n<p>sparkJob页面头部有几个，最重要的是Schedule mode，表示的是Job的调度模型。如果多个线程调用多个并行的job，这些job就会被分配调用，这里就有个调度模型，一般是FIFO模型，先进先出模型。但是在spark0.8之后，就支持了一种FAIR模型，FAIR模型是一种公平模型，相当于每个任务轮换使用资源等，这样能使的小job能很快执行，而不用等大job完成才执行了。</p>\n<h1 id=\"job---event-timeline\">Job - Event Timeline</h1>\n<p><img src=\"http://images2017.cnblogs.com/blog/136188/201711/136188-20171101074242779-1062993761.png\"></p>\n<p>这个就是用来表示调度job何时启动，何时结束，并且excutor何时加入。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/136188/201711/136188-20171101074258623-773179491.png\"></p>\n<p>我们可以很方便看到哪些job已经运行完成，使用了多少excutor，哪些正在运行。</p>\n<p>点击进入每个job，我们就可以看到每个job的detail</p>\n<h1 id=\"details-for-job\">Details for Job</h1>\n<p>在这个页面我们能看到job的详情。一个job会被分为一个或者多个stage</p>\n<p>这里也有event timeline，告诉我们这个job中每个stage执行时间。</p>\n<p>这里多了一个DAG可视化的图</p>\n<h2 id=\"dag\">DAG</h2>\n<p>DAG图是有向无环图的意思。spark中使用有向无环图来显示流程。</p>\n<p>DAG也是一种调度模型，在spark的作业调度中，有很多作业存在依赖关系，所以有的作业可以并行执行，有的作业不能并行执行。把这些作业的内部转向关系描绘清楚，就是一个DAG图。使用DAG图，就能很清晰看到我们的作业（RDD）哪些先执行，哪些后执行，哪些是并行执行的。</p>\n<p>当调用了一个行为算子的时候，前面的所有转换算子也会一并提交给DAG调度器，DAG调度器把这些算子操作分为不同的stage，这个就是stage的由来。而DAG在画stage的时候也会产生出一个DAG图，就是这里的图了。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/136188/201711/136188-20171101074313232-2068273247.png\"></p>\n<p>点击每个stage，我们就能看到这个stage执行的任务（Task）了。</p>\n<h1 id=\"details-for-stage\">Details for Stage</h1>\n<h2 id=\"标题\">标题</h2>\n<p><img src=\"http://images2017.cnblogs.com/blog/136188/201711/136188-20171101074325420-1255955837.png\"></p>\n<p>标题代表这是第几号stage，第几次尝试。</p>\n<h2 id=\"show-additional-metrics\">Show Additional Metrics</h2>\n<h3 id=\"scheduler-delay\">Scheduler Delay</h3>\n<p>调度延迟时间，包含把任务从调度器输送给excutor，并且把任务的结果从excutor返回给调度器。如果调度时间比较久，则考虑降低任务的数量，并且降低任务结果大小</p>\n<h3 id=\"task-deserialization-time\">Task Deserialization Time</h3>\n<p>反序列化excutor的任务，也包含读取广播任务的时间</p>\n<h3 id=\"shuffle-read-blocked-time\">Shuffle Read Blocked Time</h3>\n<p>任务shuffle时间，从远端机器读取shuffle数据的时间</p>\n<h3 id=\"shuffle-remote-reads\">Shuffle Remote Reads</h3>\n<p>从远端机器读取shuffle数据的时间</p>\n<h3 id=\"getting-result-time\">Getting Result Time</h3>\n<p>从worker中获取结果的时间</p>\n<p>// 这里应该还有一些其它的各种指标，等以后看代码的时候再补充。</p>\n<p>在用图形表示完之后还有一个summary的时间统计，告诉你每个阶段的时间，所有任务的分布图。</p>\n<h1 id=\"aggregated-metrics-by-executor\">Aggregated Metrics by Executor</h1>\n<p>这个矩阵告诉我们每个excutor的执行情况。</p>\n<h1 id=\"tasks\">Tasks</h1>\n<p>告知每个任务的执行情况。</p>\n<h1 id=\"environment\">Environment</h1>\n<p>显示所有的环境变量</p>\n<h1 id=\"excutors\">Excutors</h1>\n<p>显示每个excutor的统计情况</p>\n<h1 id=\"参考文章\">参考文章</h1>\n<p><a href=\"http://www.csdn.net/article/2015-07-08/2825162\" class=\"uri\">http://www.csdn.net/article/2015-07-08/2825162</a><br>\n<a href=\"https://jaceklaskowski.gitbooks.io/mastering-apache-spark/content/spark-webui-StagePage.html\" class=\"uri\">https://jaceklaskowski.gitbooks.io/mastering-apache-spark/content/spark-webui-StagePage.html</a></p>\n</div><div id=\"MySignature\"></div>\r\n        <div class=\"clear\"></div>\r\n        <div id=\"blog_post_info_block\">\r\n        <div id=\"blog_post_info\">\r\n        </div>\r\n        <div class=\"clear\"></div>\r\n        <div id=\"post_next_prev\"></div>\r\n    </div>\r\n</div>\r\n    <ul class=\"postmetadata\">\r\n        <li class=\"icon_cat\" id=\"BlogPostCategory\">\r\n        <li class=\"icon_bullet\" id=\"EntryTag\">\r\n    </ul>\r\n</div>\r\n<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=71277,cb_entryId=7764687,cb_blogApp=currentBlogApp,cb_blogUserGuid='ae63dcae-086a-df11-ba8f-001cf0cd104b',cb_entryCreatedDate='2017/11/1 7:44:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n<script type=\"text/javascript\">\r\n    var m = window.__blog.postRendered;\r\n    if (m) { m(__$(\"post\")); }\r\n</script>\r\n<script type=\"text/javascript\">\r\n    var m = window.__blog.postRenderPosts;\r\n    if (m) { m(); }\r\n</script>\r\n</div>", "article_view": 153, "image_url": ["https://pic.cnblogs.com/face/u136188.png?id=12132730"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "基于HTML5 Canvas的工控SCADA模拟飞机飞行", "url": "http://www.cnblogs.com/xhload3d/p/7760978.html", "author": "xhload3d", "article_desc": "你想开飞机吗？我小时候也有一个梦想，就是当飞行员，今天我们就来体验一下开飞机，我猜你跟我一样会晕机！昨天看到一篇文章说是学习如何开飞机的，然后我就想，如果我也可以开飞机那就好玩了，每个人小时候都想做飞行员！中国飞行员太难当了，再说也不轻易让你开飞机！后来我就想如果能用 HT 开飞机那就是真的有趣了，... ...", "content": "<div id=\"post_detail\">\r\n<div class=\"post\">\r\n\t<div class=\"postTitle\">\r\n\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/xhload3d/p/7760978.html\">基于HTML5 Canvas的工控SCADA模拟飞机飞行</a>\r\n\t</div>\r\n\t\r\n\t<div class=\"postText\">\r\n\t\t<div id=\"cnblogs_post_body\"><p>昨天看到一篇文章说是学习如何开飞机的，然后我就想，如果我也可以开飞机那就好玩了，每个人小时候都想做飞行员！中国飞行员太难当了，再说也不轻易让你开飞机！后来我就想如果能用 HT 开飞机那就是真的有趣了，哈哈，这个实现的效果还是很不错的，可以让你满足一下开飞机的虚荣心<img src=\"http://static.blog.csdn.net/xheditor/xheditor_emot/default/titter.gif\" alt=\"偷笑\"></p>\n<p>Demo 地址： <a href=\"http://hightopo.com/guide/guide/plugin/obj/examples/example_path.html\" target=\"_blank\">http://hightopo.com/guide/guide/plugin/obj/examples/example_path.html</a></p>\n<p>来看下具体实现的效果：</p>\n<p><img src=\"http://img.blog.csdn.net/20171031093015235?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGhsb2FkM2Q=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center\" alt=\"\"></p>\n<p>这个例子基本上完全模拟了飞机的飞行模式，包括起飞跑道，包括飞机的移动路径，螺旋桨的旋转，机尾的指示灯等部分。</p>\n<p>首先，最重要的是我们的飞机模型，前面有文章写到过，HT 内部封装了一个方法 ht.Default.loadObj 来加载 OBJ 文件：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> ht.Default.loadObj('obj/plane.obj', 'obj/plane.mtl'<span style=\"color: #000000\">, {                    \n</span><span style=\"color: #008080\"> 2</span>     center: <span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 3</span>     r3: [0, -Math.PI/2, 0], //<span style=\"color: #000000\"> make plane face right\n</span><span style=\"color: #008080\"> 4</span>     s3: [0.15, 0.15, 0.15], <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> make plane smaller</span>\n<span style=\"color: #008080\"> 5</span>     finishFunc: <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(modelMap, array, rawS3){\n</span><span style=\"color: #008080\"> 6</span>         <span style=\"color: #0000ff\">if</span><span style=\"color: #000000\">(modelMap){                            \n</span><span style=\"color: #008080\"> 7</span>             modelMap.propeller.r3 = {<span style=\"color: #008000\">//</span><span style=\"color: #008000\">propeller 螺旋桨</span>\n<span style=\"color: #008080\"> 8</span>             func: <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(data){\n</span><span style=\"color: #008080\"> 9</span>                 <span style=\"color: #0000ff\">return</span> [data.a('angle'), 0, 0<span style=\"color: #000000\">]; \n</span><span style=\"color: #008080\">10</span> <span style=\"color: #000000\">            }\n</span><span style=\"color: #008080\">11</span> <span style=\"color: #000000\">        };                             \n</span><span style=\"color: #008080\">12</span>         <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> make propeller a litter bigger</span>\n<span style=\"color: #008080\">13</span>         modelMap.propeller.s3 = [1, 1.2, 1.2<span style=\"color: #000000\">]; \n</span><span style=\"color: #008080\">14</span>         modelMap.propeller.color = 'yellow'<span style=\"color: #000000\">;\n</span><span style=\"color: #008080\">15</span> <span style=\"color: #000000\">    } \n</span><span style=\"color: #008080\">16</span> });</pre>\n</div>\n<p>这里面的 modelMap.propeller 是 OBJ 文件中定义好的 modelMap 对象中的 propeller 对象，你可以试着打印 modelMap 看看输出结果。</p>\n<p>这个方法里的 finishFunc(modelMap, array, rawS3) 用于加载后的回调处理，具体查阅 <a href=\"http://hightopo.com/guide/guide/plugin/obj/ht-obj-guide.html#ref_loadobj\">HT for Web OBJ 手册</a>，我们还添加了一个在 OBJ 模型中没有的飞机尾部的“红色闪烁指示灯”，这里用到的是组合模型 array（所有材质组成的数组，里面有至少一个模型），我们在 array中加入一个新的球模型：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> add a sphere model as an indicator light 指示灯</span>\n<span style=\"color: #008080\"> 2</span> <span style=\"color: #000000\">array.push({\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #000000\">    shape3d: ht.Default.createSmoothSphereModel(),\n</span><span style=\"color: #008080\"> 4</span>     t3: [-40, 10, 0<span style=\"color: #000000\">],\n</span><span style=\"color: #008080\"> 5</span>     s3: [6, 6, 6<span style=\"color: #000000\">],\n</span><span style=\"color: #008080\"> 6</span> <span style=\"color: #000000\">    color: {\n</span><span style=\"color: #008080\"> 7</span>         func: <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(data){\n</span><span style=\"color: #008080\"> 8</span>             <span style=\"color: #0000ff\">return</span> data.a('light') ? 'red': 'black'<span style=\"color: #000000\">;\n</span><span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">11</span> });</pre>\n</div>\n<p>这里的 shape3d 是 HT 封装的一个属性名，通过 setShape3dModel(name, model) 函数注册的或者是通过 getShape3dModel(name) 函数返回的注册过的 3D 模型，如何注册 3D 模型可查阅 <a href=\"http://hightopo.com/guide/guide/plugin/modeling/ht-modeling-guide.html#ref_register\">HT for Web 建模手册</a>。</p>\n<p>color 属性名对应了一个对象，这边的定义是这样的，color 直接通过 data.getAttr('a') 获取 data.setAttr(‘a’, value) 中的值，这样做有两个好处，一是可以不污染 HT 的常用属性操作，所以 HT 专门定义了这个 attr 属性类型，是 HT 预留给用户存储业务数据的；二是这样也很方便数据绑定，我们可以通过在需要更改属性的地方调用 setAttr 方法，非常方便。</p>\n<p>接着我们通过 ht.Default.setShape3dModel(name, model) 来将我们刚刚组合好的模型 array 注册成我们要的“plane”模型：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> ht.Default.setShape3dModel('plane', array);</pre>\n</div>\n<p>注册好模型后肯定是要调用这个模型，我们可以通过 shape3d 属性来调用这个模型，并且在这个模型中自定义上面代码中出现过的 light 属性和 angle 属性：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> plane = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> ht.Node();\n</span><span style=\"color: #008080\"> 2</span> plane.s3(200, 200, 200<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #000000\">plane.s3(rawS3);\n</span><span style=\"color: #008080\"> 4</span> <span style=\"color: #000000\">plane.s({\n</span><span style=\"color: #008080\"> 5</span>     'shape3d': 'plane'<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 6</span>     'shape3d.scaleable': <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 7</span>     'wf.visible': <span style=\"color: #0000ff\">true</span>,<span style=\"color: #008000\">//</span><span style=\"color: #008000\">线框是否可见</span>\n<span style=\"color: #008080\"> 8</span>     'wf.color': 'white'<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 9</span>     'wf.short': <span style=\"color: #0000ff\">true</span> <span style=\"color: #008000\">//</span><span style=\"color: #008000\">是否显示封闭的线框，true为不封闭的短线框</span>\n<span style=\"color: #008080\">10</span> <span style=\"color: #000000\">});\n</span><span style=\"color: #008080\">11</span> <span style=\"color: #000000\">plane.a({\n</span><span style=\"color: #008080\">12</span>     'angle': 0<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\">13</span>     'light': <span style=\"color: #0000ff\">false</span>\n<span style=\"color: #008080\">14</span> });</pre>\n</div>\n<p>因为飞机还有螺旋桨、指示灯两个功能，我们还得对这两个模型做动画效果，可查阅 <a href=\"http://hightopo.com/guide/guide/plugin/animation/ht-animation-guide.html\">HT for Web 动画手册</a>，通过用户在 form 表单上选择的结果来决定飞机飞行持续时间、看飞机的视角、飞机沿着“航线”飞行所要旋转的角度、机尾指示灯的“闪烁”功能等等，最后别忘了飞机停止飞行时，如果要让飞机继续飞行，就得回调这个动画，并且设置灯不再闪烁，别忘了要启动动画：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> params =<span style=\"color: #000000\"> {\n</span><span style=\"color: #008080\"> 2</span>     delay: 1500<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 3</span>     duration: 20000<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 4</span>     easing: <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(t){ \n</span><span style=\"color: #008080\"> 5</span>         <span style=\"color: #0000ff\">return</span> (t *= 2) &lt; 1 ? 0.5 * t * t : 0.5 * (1 - (--t) * (t - 2<span style=\"color: #000000\">));\n</span><span style=\"color: #008080\"> 6</span> <span style=\"color: #000000\">    },\n</span><span style=\"color: #008080\"> 7</span>     action: <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(v, t){\n</span><span style=\"color: #008080\"> 8</span>         <span style=\"color: #0000ff\">var</span> length =<span style=\"color: #000000\"> g3d.getLineLength(polyline),\n</span><span style=\"color: #008080\"> 9</span>         offset = g3d.getLineOffset(polyline, length*<span style=\"color: #000000\">v),\n</span><span style=\"color: #008080\">10</span>         point =<span style=\"color: #000000\"> offset.point,\n</span><span style=\"color: #008080\">11</span>         px =<span style=\"color: #000000\"> point.x,\n</span><span style=\"color: #008080\">12</span>         py =<span style=\"color: #000000\"> point.y,\n</span><span style=\"color: #008080\">13</span>         pz =<span style=\"color: #000000\"> point.z,\n</span><span style=\"color: #008080\">14</span>         tangent =<span style=\"color: #000000\"> offset.tangent,\n</span><span style=\"color: #008080\">15</span>         tx =<span style=\"color: #000000\"> tangent.x,\n</span><span style=\"color: #008080\">16</span>         ty =<span style=\"color: #000000\"> tangent.y,\n</span><span style=\"color: #008080\">17</span>         tz =<span style=\"color: #000000\"> tangent.z;\n</span><span style=\"color: #008080\">18</span> <span style=\"color: #000000\">        plane.p3(px, py, pz);\n</span><span style=\"color: #008080\">19</span>         plane.lookAt([px + tx, py + ty, pz + tz], 'right'<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">20</span>                         \n<span style=\"color: #008080\">21</span>         <span style=\"color: #0000ff\">var</span> camera = formPane.v('Camera'<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">22</span>         <span style=\"color: #0000ff\">if</span>(camera === 'Look At'<span style=\"color: #000000\">){\n</span><span style=\"color: #008080\">23</span> <span style=\"color: #000000\">            g3d.setCenter(px, py, pz);\n</span><span style=\"color: #008080\">24</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">25</span>         <span style=\"color: #0000ff\">else</span> <span style=\"color: #0000ff\">if</span>(camera === 'First Person'<span style=\"color: #000000\">){                            \n</span><span style=\"color: #008080\">26</span>             g3d.setEye(px - tx * 400, py - ty * 400 + 30, pz - tz * 400<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">27</span> <span style=\"color: #000000\">            g3d.setCenter(px, py, pz);                            \n</span><span style=\"color: #008080\">28</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">29</span>                         \n<span style=\"color: #008080\">30</span>         plane.a('angle', v*Math.PI*120<span style=\"color: #000000\">);                        \n</span><span style=\"color: #008080\">31</span>         <span style=\"color: #0000ff\">if</span>(<span style=\"color: #0000ff\">this</span>.duration * t % 1000 &gt; 500<span style=\"color: #000000\">){\n</span><span style=\"color: #008080\">32</span>             plane.a('light', <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">33</span>         }<span style=\"color: #0000ff\">else</span><span style=\"color: #000000\">{\n</span><span style=\"color: #008080\">34</span>             plane.a('light', <span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">35</span> <span style=\"color: #000000\">        }                        \n</span><span style=\"color: #008080\">36</span> <span style=\"color: #000000\">    },\n</span><span style=\"color: #008080\">37</span>     finishFunc: <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(){\n</span><span style=\"color: #008080\">38</span>         animation =<span style=\"color: #000000\"> ht.Default.startAnim(params);\n</span><span style=\"color: #008080\">39</span>         plane.a('light', <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">40</span> <span style=\"color: #000000\">    }                  \n</span><span style=\"color: #008080\">41</span> <span style=\"color: #000000\">};                               \n</span><span style=\"color: #008080\">42</span>                 \n<span style=\"color: #008080\">43</span> animation = ht.Default.startAnim(params);</pre>\n</div>\n<p>其实最让我们好奇的是描绘的路径跟飞机本身的飞行并没有关系，还有那么多左拐右拐的，要如何做才能做到呢？</p>\n<p>接下来我们来描绘路径，首先这个路径是由 ht.Polyline 作为基础来描绘的：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> polyline = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> ht.Polyline();   \n</span><span style=\"color: #008080\"> 2</span> polyline.setThickness(2<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 3</span> <span style=\"color: #000000\">polyline.s({\n</span><span style=\"color: #008080\"> 4</span>     'shape.border.pattern': [16, 16<span style=\"color: #000000\">],\n</span><span style=\"color: #008080\"> 5</span>     'shape.border.color': 'red'<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 6</span>     'shape.border.gradient.color': 'yellow'<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 7</span>     'shape3d.resolution': 300<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 8</span>     '3d.selectable': <span style=\"color: #0000ff\">false</span>\n<span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">});\n</span><span style=\"color: #008080\">10</span> dataModel.add(polyline);</pre>\n</div>\n<p>上面的代码只是向 datamodel 数据模型中添加了一个 polyline 管线而已，不会显示任何东西，要显示“航道”首先就要设置航道所在的点，我们先设置航道的初始点：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> points = [{ x: 0, y: 0, e: 0<span style=\"color: #000000\"> }];\n</span><span style=\"color: #008080\">2</span> segments = [1];</pre>\n</div>\n<p>这个 points 和 segments 是 <a href=\"http://hightopo.com/guide/guide/core/shape/ht-shape-guide.html\">HT for Web Shape 手册</a>中定义的，points 是 ht.List 类型数组的定点信息，顶点为 { x: 100, y: 200 } 格式的对象；segments 是 ht.List 类型的线段数组信息，代表 points 数组中的顶点按数组顺序的连接方式。</p>\n<p>图中“航道”左侧的多个圆形轨道也是通过设置 points 和 segments 来设置的：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #0000ff\">for</span>(<span style=\"color: #0000ff\">var</span> k=0; k&lt;count+1; k++<span style=\"color: #000000\">){\n</span><span style=\"color: #008080\">2</span>     <span style=\"color: #0000ff\">var</span> angle = k * Math.PI * 2 * round /<span style=\"color: #000000\"> count;\n</span><span style=\"color: #008080\">3</span> <span style=\"color: #000000\">    points.push({\n</span><span style=\"color: #008080\">4</span>         x: cx + radius *<span style=\"color: #000000\"> Math.cos(angle),\n</span><span style=\"color: #008080\">5</span>         y: cy + radius *<span style=\"color: #000000\"> Math.sin(angle),\n</span><span style=\"color: #008080\">6</span>         e: k * height /<span style=\"color: #000000\"> count\n</span><span style=\"color: #008080\">7</span> <span style=\"color: #000000\">    }); \n</span><span style=\"color: #008080\">8</span>     segments.push(2<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\">9</span> }</pre>\n</div>\n<p>接下来几个拐点也是这种方法来实现的，这里就不赘述了，如果你还没看手册的话，这里标明一点，segments 只能取值 1~5，1 代表一个新路径的起点；2 代表从上次最后点连接到该点；3 占用两个点信息，第一个点作为曲线控制点，第二个点作为曲线结束点；4 占用3个点信息，第一和第二个点作为曲线控制点，第三个点作为曲线结束点；5 不占用点信息，代表本次绘制路径结束，并闭合到路径的起始点：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> points.push({ x: cx+radius, y: 0, e: height/2 });\n<span style=\"color: #008080\"> 2</span> points.push({ x: 0, y: 0, e: height/2 });\n<span style=\"color: #008080\"> 3</span> segments.push(3<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 4</span>      \n<span style=\"color: #008080\"> 5</span> points.push({ x: radius, y: -radius, e: height/2*0.7 });\n<span style=\"color: #008080\"> 6</span> points.push({ x: radius*2, y: radius, e: height/2*0.3 });\n<span style=\"color: #008080\"> 7</span> points.push({ x: radius*3, y: 0, e: 0<span style=\"color: #000000\"> });\n</span><span style=\"color: #008080\"> 8</span> segments.push(4<span style=\"color: #000000\">);   \n</span><span style=\"color: #008080\"> 9</span> \n<span style=\"color: #008080\">10</span> points.push({ x: 0, y: 0, e: 0<span style=\"color: #000000\"> });\n</span><span style=\"color: #008080\">11</span> segments.push(2);  </pre>\n</div>\n<p>我们已经把路径上的点都添加进“航道”中了，接下来要把点都设置到管道上去才会显示在界面上：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\">1</span> <span style=\"color: #000000\">polyline.setPoints(points);\n</span><span style=\"color: #008080\">2</span> polyline.setSegments(segments);  </pre>\n</div>\n<p>“跑道”就比较简单了，只是一个 Node 节点然后设置基础效果而已，没什么特别的：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> runway = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> ht.Node();\n</span><span style=\"color: #008080\"> 2</span> runway.s3(-cx+radius*3, 1, 200<span style=\"color: #000000\">);\n</span><span style=\"color: #008080\"> 3</span> runway.p3(cx+runway.getWidth()/2, -22, 0);\n<span style=\"color: #008080\"> 4</span> <span style=\"color: #000000\">runway.s({\n</span><span style=\"color: #008080\"> 5</span>     'all.color': '#FAFAFA'<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 6</span>     'all.transparent': <span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 7</span>     'all.reverse.cull': <span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 8</span>     'all.opacity': 0.8<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 9</span>     '3d.selectable': <span style=\"color: #0000ff\">false</span>\n<span style=\"color: #008080\">10</span> <span style=\"color: #000000\">});\n</span><span style=\"color: #008080\">11</span> dataModel.add(runway);</pre>\n</div>\n<p>最后，在界面上添加一个 formPane 表单面板，定义好之后可以直接添加到 body 上，这样就不会跟 graph3dView 有显示的联系了。</p>\n<p>formPane 可以用 formPane.addRow 方法动态添加行，这个方法中可以直接对动态变化的数据进行交互，例如本例中的是否有动画 Animation，我们利用 checkBox 来记录选中或者非选中的状态：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #000000\">{\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #000000\">    checkBox: {\n</span><span style=\"color: #008080\"> 3</span>         label: 'Animation'<span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 4</span>         selected: <span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">,\n</span><span style=\"color: #008080\"> 5</span>         onValueChanged: <span style=\"color: #0000ff\">function</span><span style=\"color: #000000\">(){\n</span><span style=\"color: #008080\"> 6</span>             <span style=\"color: #0000ff\">if</span>(<span style=\"color: #0000ff\">this</span><span style=\"color: #000000\">.isSelected()){\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #000000\">                animation.resume();\n</span><span style=\"color: #008080\"> 8</span>             }<span style=\"color: #0000ff\">else</span><span style=\"color: #000000\">{\n</span><span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">                animation.pause();\n</span><span style=\"color: #008080\">10</span> <span style=\"color: #000000\">            }                               \n</span><span style=\"color: #008080\">11</span> <span style=\"color: #000000\">        }\n</span><span style=\"color: #008080\">12</span> <span style=\"color: #000000\">    }\n</span><span style=\"color: #008080\">13</span> }</pre>\n</div>\n<p>也可以通过设置“id”来记录动态改变的值，然后 formPane就会通过调用 formPane.v(id) 来获取当前值。</p>\n<p>至此，整个 Demo 的解释到此为止，如果还有不懂的可以先查阅我们官网 <a href=\"http://hightopo.com/\">HT for Web</a>，之后还有不懂的可以私信我，但还是希望你们能仔细阅读，不然很浪费我们双方的时间，谢谢~</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t</div>\r\n\t\r\n\t<div class=\"postfoot\">\r\n\t\tposted on <span id=\"post-date\">2017-11-01 07:58</span> <a href=\"http://www.cnblogs.com/xhload3d/\">xhload3d</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7760978\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7760978);return false;\">收藏</a>\r\n\t</div>\r\n</div>\r\n<script type=\"text/javascript\">var allowComments=true,cb_blogId=171723,cb_entryId=7760978,cb_blogApp=currentBlogApp,cb_blogUserGuid='99a30dc7-3165-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/11/1 7:58:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\r\n</div>", "article_view": 541, "image_url": ["https://pic.cnblogs.com/face/591709/20140223000109.png"], "date_pub": "2017-11-01", "article_common": 4}
{"title": "java基础解析系列(九)---String不可变性分析", "url": "http://www.cnblogs.com/-new/p/7763527.html", "author": "jiajun_geek", "article_desc": "java基础解析系列(九) String不可变性分析 目录 \"java基础解析系列(一) String、StringBuffer、StringBuilder\" \"java基础解析系列(二) Integer缓存及装箱拆箱\" \"java基础解析系列(三) HashMap原理\" \"java基础解析系列(四 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/-new/p/7763527.html\">java基础解析系列(九)---String不可变性分析</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"java基础解析系列九---string不可变性分析\">java基础解析系列(九)---String不可变性分析</h1>\n<h2 id=\"目录\">目录</h2>\n<ul>\n<li><a href=\"http://www.cnblogs.com/-new/p/7417915.html\">java基础解析系列(一)---String、StringBuffer、StringBuilder</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7469763.html\">java基础解析系列(二)---Integer缓存及装箱拆箱</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7472455.html\">java基础解析系列(三)---HashMap原理</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7484680.html\">java基础解析系列(四)---LinkedHashMap的原理及LRU算法的实现</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7496323.html\">java基础解析系列(五)---HashMap并发下的问题以及HashTable和CurrentHashMap的区别</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7588250.html\">java基础解析系列(六)---注解原理及使用</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7604420.html\">java基础解析系列(七)---ThreadLocal原理分析</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7638302.html\">java基础解析系列(八)--fail-fast机制及CopyOnWriteArrayList的原理</a></li>\n<li><a href=\"http://www.cnblogs.com/-new/p/7396648.html\">这是我的博客目录，欢迎阅读</a></li>\n</ul>\n<h2 id=\"什么是不可变\">什么是不可变</h2>\n<ul>\n<li>一个对象，在它创建完成之后，不能再改变它的状态，那么这个对象就是不可变的。不能改变状态的意思是，不能改变对象内的成员变量，包括基本数据类型的值不能改变，引用类型的变量不能指向其他的对象，引用类型指向的对象的状态也不能改变</li>\n</ul>\n<h2 id=\"先看一个例子\">先看一个例子</h2>\n<pre><code>public static void main(String[] args) throws Exception {\n        String s=new String(\"jia\");\n        String s2=s.concat(\"jun\");\n        System.out.println(s);\n        StringBuffer sb=new StringBuffer(\"jia\");\n        sb.append(\"jun\");\n        System.out.println(sb);\n    }\n输出jia和jiajun</code></pre>\n<ul>\n<li>对字符串s的操作并没有改变他，而对StringBuffer sb进行apped，输出的时候却改变了，这就说明了String一个不可变性。</li>\n</ul>\n<h2 id=\"也许你会说这是可变的\">也许你会说这是可变的</h2>\n<pre><code>public static void main(String[] args) {\n        String s1=\"jiajun\";\n        String s2=s1;\n        s1=\"666\";\n        System.out.println(s1);\n    }\n输出：666\n</code></pre>\n<ul>\n<li>实际上，\"jiajun\"字符串并没有改变，可以通过一个例子来证明</li>\n</ul>\n<pre><code>        String s3=\"jiajun\";\n        System.out.println(s2==s3);\n        输出：true</code></pre>\n<ul>\n<li>为什么会这样，因为实际上\"jiajun\"字符串存放在了常量池，此时s2和s3都指向了这个这个字符串，所以可以证明这个字符串是不改变的并存在的</li>\n<li>之所以会输出666，是因为此时s1指向的字符串是另一个了</li>\n<li>其实最本质的是这个改变是改变s1的引用</li>\n</ul>\n<h2 id=\"也许你会说这是可变的-1\">也许你会说这是可变的</h2>\n<pre><code>public static void main(String[] args) {\n        String s1=\"jiajun\";\n        s1=s1.replace(\"j\",\"J\");\n        System.out.println(s1);\n        s1=s1.toLowerCase();\n        System.out.println(s1);\n    }\n    JiaJun\n    jiajun</code></pre>\n<ul>\n<li>实际上jiajun字符串还是没有改变的，看一下方法的源码</li>\n</ul>\n<pre><code>2047    public String More ...replace(char oldChar, char newChar) {\n2048        if (oldChar != newChar) {\n                ...\n2069                return new String(0, len, buf);\n2070            }\n2071        }\n2072        return this;\n2073    }</code></pre>\n<ul>\n<li>可以看到返回的时候是创建一个新的字符串</li>\n<li>实际上String的一些方法substring， replace， replaceAll， toLowerCase，返回的时候是创建一个新的String</li>\n</ul>\n<h2 id=\"分析源码\">分析源码</h2>\n<pre><code>111 public final class String\n112     implements java.io.Serializable, Comparable&lt;String&gt;, CharSequence {\n    \nThe value is used for character storage.\n113 \n114     private final char value[];\n\n    \nCache the hash code for the string\n116 \n117     private int hash; // Default to 0\n118 \n    \n  private static final long serialVersionUID = -6849794470754667710L;\n\n136 \n137     public String() {\n138         this.value = new char[0];\n139     }\n151     public String(String original) {\n152         this.value = original.value;\n153         this.hash = original.hash;\n154     }\n1913    public String substring(int beginIndex) {\n1914        if (beginIndex &lt; 0) {\n1915            throw new StringIndexOutOfBoundsException(beginIndex);\n1916        }\n1917        int subLen = value.length - beginIndex;\n1918        if (subLen &lt; 0) {\n1919            throw new StringIndexOutOfBoundsException(subLen);\n1920        }\n1921        return (beginIndex == 0) ? this : new String(value, beginIndex, subLen);\n1922    }</code></pre>\n<ul>\n<li>111行可以看到，String类是用final修饰的，说明这个类是无法被继承的</li>\n<li>114行可以String类里面维护一个value的char数组，这个数组是用final修饰的，说明这个value不能指向别的数组，但是并不说明这个value数组的内容不可变，而这个value是用private修饰的，说明只有在类里面可以修改访问他，在外部不能改变他，这是关键</li>\n<li>从1913行可以看到substring方法实际上返回的数组是新创建的数组</li>\n</ul>\n<h2 id=\"怎么实现不可变\">怎么实现不可变</h2>\n<ul>\n<li>String里面维护的value数组是用private final修饰的，无法改变引用，也无法访问这个数组修改数组的值，最关键的是private</li>\n<li>对Sting的操作，并没有修改数组的值，而是创建新的String</li>\n<li>类用final修饰，方法无法被子类重写，避免被其他人破坏</li>\n</ul>\n<h2 id=\"不可变的好处\">不可变的好处</h2>\n<ul>\n<li>节省空间，大量使用相同的字符串，同时指向常量池的字符串就行，如果字符串是可变的话，那么常量池就没意义了</li>\n</ul>\n<pre><code>String s1=\"jiajun\";\n        String s2=\"jiajun\";\n        System.out.println(s1==s2);</code></pre>\n<ul>\n<li><p>线程安全，出现线程安全的是在对共享变量写的时候，而因为不可变，所以Strig是线程安全的</p></li>\n<li><p>最重要的是安全，如果当一个String已经传给别人了，这个时候如果是可变，那么可以在后面进行修改，那么这是麻烦并不安全的。而且在hashmap中，如果作为key的String s1是可变的，那么这样是很危险的，比如说可能出现两个同样的键。</p></li>\n</ul>\n<h2 id=\"真的不可变吗\">真的不可变吗</h2>\n<pre><code>public static void main(String[] args) throws Exception {\n        String s1=\"jiajun\";\n        Field field=String.class.getDeclaredField(\"value\");\n        field.setAccessible(true);\n        char [] value=(char[])field.get(s1);\n        value[0]='Jiajun';</code></pre>\n<ul>\n<li>实际上，通过反射可以修改value数组</li>\n</ul>\n<h2 id=\"为什么设置为不可变\">为什么设置为不可变</h2>\n<ul>\n<li>调用其他方法，比如调用一些系统级操作之前，可能会有一系列校验，如果是可变类的话，可能在你校验过后，其内部的值被改变了，可能引起严重的系统崩溃问题</li>\n<li>当你在传参的时候，使用不可变类不需要去考虑谁可能会修改其内部的值</li>\n</ul>\n<h3 id=\"我觉得分享是一种精神分享是我的乐趣所在不是说我觉得我讲得一定是对的我讲得可能很多是不对的但是我希望我讲的东西是我人生的体验和思考是给很多人反思也许给你一秒钟半秒钟哪怕说一句话有点道理引发自己内心的感触这就是我最大的价值这是我喜欢的一句话也是我写博客的初衷\">我觉得分享是一种精神，分享是我的乐趣所在，不是说我觉得我讲得一定是对的，我讲得可能很多是不对的，但是我希望我讲的东西是我人生的体验和思考，是给很多人反思，也许给你一秒钟、半秒钟，哪怕说一句话有点道理，引发自己内心的感触，这就是我最大的价值。（这是我喜欢的一句话，也是我写博客的初衷）</h3>\n<blockquote>\n<p>作者：jiajun 出处： <a href=\"http://www.cnblogs.com/-new/\" class=\"uri\">http://www.cnblogs.com/-new/</a><br>\n本文版权归作者和博客园共有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。如果觉得还有帮助的话，可以点一下右下角的【推荐】，希望能够持续的为大家带来好的技术文章！想跟我一起进步么？那就【关注】我吧。</p>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-11-01 08:41</span> <a href=\"http://www.cnblogs.com/-new/\">jiajun_geek</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7763527\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7763527);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=269387,cb_entryId=7763527,cb_blogApp=currentBlogApp,cb_blogUserGuid='334d29a8-70df-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/11/1 8:41:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 200, "image_url": ["https://pic.cnblogs.com/face/900751/20161023114041.png"], "date_pub": "2017-11-01", "article_common": 0}
{"title": "使用sklearn进行数据挖掘-房价预测(4)—数据预处理", "url": "http://www.cnblogs.com/wxshi/p/7764518.html", "author": "Wanna_Go", "article_desc": "\r\n    在使用机器算法之前，我们先把数据做下预处理，先把特征和标签拆分出来 数据清洗 大多数机器学习算法是不能在有缺失值的数据集上面运行的，而本数据集特征 是存在数据缺失现象的，所以就需要想办法处理，有以下几个思路： 1.将存在缺失数据的样本去除掉 2.将存在缺失数据的特征去除掉 3.将缺失值用统一的值替换 ...\r\n    ", "content": "<div id=\"post_detail\">\r\n\t<div class=\"post\">\r\n\t\t<h2>\r\n\t\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/wxshi/p/7764518.html\">使用sklearn进行数据挖掘-房价预测(4)—数据预处理</a>\r\n\t\t</h2>\r\n\t\t<div class=\"postText\"><div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>在使用机器算法之前，我们先把数据做下预处理，先把特征和标签拆分出来</p>\n<pre><code>housing = strat_train_set.drop(\"median_house_value\",axis=1) #原始数据集并未发生改变\nhousing_labels=strat_train_set[\"median_house_value\"].copy()</code></pre>\n<h3 id=\"数据清洗\">数据清洗</h3>\n<p>大多数机器学习算法是不能在有缺失值的数据集上面运行的，而本数据集特征<code>total_bedrooms</code>是存在数据缺失现象的，所以就需要想办法处理，有以下几个思路：</p>\n<ul>\n<li>1.将存在缺失数据的样本去除掉</li>\n<li>2.将存在缺失数据的特征去除掉</li>\n<li>3.将缺失值用统一的值替换，如：均值、中值等</li>\n</ul>\n<p>上面对应的操作：</p>\n<pre><code>housing.dropna(subset=[\"total_bedrooms\"]) # 1.删除样本\nhousing.drop(\"total_bedrooms\", axis=1) # 2.删除特征，注意参数的用法和1不一样\nmedian = housing[\"total_bedrooms\"].median()\nhousing[\"total_bedrooms\"].fillna(median) # 3. 中值填充</code></pre>\n<p>如果采用的是方法3那么就需要将替换的值保存起来，在后续的工作中需要将它应用到测试集，以及可能添加的新数据。上面这个操作是使用pandas，sklearn提供了<code>Imputer</code>,同样能够很好解决缺失值问题，下面其用法</p>\n<pre><code>from sklearn.preprocessing import Imputer\nimputer = Imputer(strategy=\"median\")\nhousing_num = housing.drop(\"ocean_proximity\", axis=1) #去除非数值类特征\nimputer.fit(housing_num)</code></pre>\n<p>imputer提供了以下几种填充策略</p>\n<ul>\n<li>If \"mean\", then replace missing values using the mean along the axis.</li>\n<li>If \"median\", then replace missing values using the median along the axis.</li>\n<li>If \"most_frequent\", then replace missing using the most frequent value along the axis.</li>\n</ul>\n<p>通过<code>statistics_</code> 查看填充的数值</p>\n<pre><code>&gt;&gt;imputer.statistics_\narray([-118.51      ,   34.26      ,   29.        , ...,    5.23228423,\n          0.20303137,    2.8176527 ])</code></pre>\n<p>再看一看pandas计算出来的中值</p>\n<pre><code>&gt;&gt;housing_num.median().values\narray([-118.51      ,   34.26      ,   29.        , ...,    5.23228423,\n          0.20303137,    2.8176527 ])</code></pre>\n<p>接下来就需要将计算得到的数值应用到数据集中</p>\n<pre><code>X = imputer.transform(housing_num) \n&gt;&gt;type(X)\nnumpy.ndarray</code></pre>\n<p>最终得到的是结果是array类型，如果想转为pandas类型</p>\n<pre><code>housing_tr = pd.DataFrame(X, columns=housing_num.columns)</code></pre>\n<p>上面我们把<code>ocean_proximity</code>这一特征去掉，所以这些操作是处理数值类型的特征，那么非数值类型的该如何处理呢？</p>\n<h3 id=\"处理标签类特征\">处理标签类特征</h3>\n<p>决策树、贝叶斯等分类器能够处理标签类特征，但很多算法是不能处理这类特征，需要转换为数值类型，sklearn提供了<code>LabelEncoder</code>特征转换方法</p>\n<pre><code>from sklearn.preprocessing import LabelEncoder\nencoder = LabelEncoder()\nhousing_cat = housing[\"ocean_proximity\"]\nhousing_cat_encoded = encoder.fit_transform(housing_cat)\n&gt;&gt;housing_cat_encoded \n array([0, 0, 4, ..., 1, 0, 3], dtype=int64)</code></pre>\n<p>上面是输出编码的结果，那么对应的0、1...是指的什么呢？</p>\n<pre><code>&gt;&gt;encoder.clases_\narray(['&lt;1H OCEAN', 'INLAND', 'ISLAND', 'NEAR BAY', 'NEAR OCEAN'], dtype=object)</code></pre>\n<p>通过类别号可以表示类别，还有一种方法能够表示类别---<code>one hot</code>,该特征取的值位置为1，其余为0；当然sklearn也提供了实现方法<code>OneHotEncoder</code></p>\n<pre><code>from sklearn.preprocessing import OneHotEncoder\nencoder = OneHotEncoder()\nhousing_cat_1hot = encoder.fit_transform(housing_cat_encoded.reshape(-1,1))#返回的为稀疏矩阵\n&gt;&gt;housing_cat_1hot.toarray()\narray([[ 1.,  0.,  0.,  0.,  0.],\n       [ 1.,  0.,  0.,  0.,  0.],\n       [ 0.,  0.,  0.,  0.,  1.],\n       ..., \n       [ 0.,  1.,  0.,  0.,  0.],\n       [ 1.,  0.,  0.,  0.,  0.],\n       [ 0.,  0.,  0.,  1.,  0.]])</code></pre>\n<p><strong>note:</strong><code>housing_cat_encoded</code>返回的为1D 数组，fit_transform需要传入的为一个2D数组，需要先转为列向量。<br>\n可以将上面<code>encoder</code>和<code>one hot</code>过程合并为一个</p>\n<pre><code>from sklearn.preprocessing import LabelBinarizer\nencoder = LabelBinarizer()\nhousing_cat_1hot=encoder.fit_transform(housing_cat)\n&gt;&gt;housing_cat_1hot #numpy array\narray([[1, 0, 0, 0, 0],\n       [1, 0, 0, 0, 0],\n       [0, 0, 0, 0, 1],\n       ..., \n       [0, 1, 0, 0, 0],\n       [1, 0, 0, 0, 0],\n       [0, 0, 0, 1, 0]])</code></pre>\n<h3 id=\"自定义处理方法\">自定义处理方法</h3>\n<p>尽管sklearn提供了强大的数据处理功能，有些时候我们需要根据自己的需求自定义一些数据预处理方法，并且让我们这些操作有着sklearnAPI相似的用法，我们所需要做的就是继承<code>BaseEstimator</code>类，并覆写三个方法<code>fit</code>，<code>transform</code>和<code>fit_transform</code>，第三个方法是前两个的整合，如果不想覆写<code>fit_transform</code>,可以继承<code>TransformerMixin</code>(从类名称就可以看出其作用)这个类</p>\n<pre><code>from sklearn.base import BaseEstimator, TransformerMixin\nrooms_ix, bedrooms_ix, population_ix, household_ix = 3, 4, 5, 6\nclass CombinedAttributesAdder(BaseEstimator, TransformerMixin):\n    def __init__(self, add_bedrooms_per_room = True): # no *args or **kargs\n                self.add_bedrooms_per_room = add_bedrooms_per_room\n    def fit(self, X, y=None):\n        return self # nothing else to do\n    def transform(self, X, y=None):\n        rooms_per_household = X[:, rooms_ix] / X[:, household_ix]\n        population_per_household = X[:, population_ix] / X[:, household_ix]\n        if self.add_bedrooms_per_room:\n            bedrooms_per_room = X[:, bedrooms_ix] / X[:, rooms_ix]\n            return np.c_[X, rooms_per_household, population_per_household,bedrooms_per_room]\n        else:\n            return np.c_[X, rooms_per_household, population_per_household]\n</code></pre>\n<p>使用方法</p>\n<pre><code>attr_adder = CombinedAttributesAdder(add_bedrooms_per_room=False)\nhousing_extra_attribs = attr_adder.transform(housing.values) </code></pre>\n<p>上面定义的类的功能是为原数据集添加新的特征，<code>X[:,3]</code>表示的是第4列所有数据，<code>np.c_</code>表示的是拼接数组。<br>\n<strong>另外</strong>sklearn是不能直接处理<code>DataFrames</code>的，那么我们需要自定义一个处理的方法将之转化为numpy类型</p>\n<pre><code>class DataFrameSelector(BaseEstimator,TransformerMixin):\n    def __init__(self,attribute_names): #可以为列表\n        self.attribute_names = attribute_names\n    def fit(self,X,y=None):\n        return self\n    def transform(self,X):\n        return X[self.attribute_names].values #返回的为numpy array</code></pre>\n<h3 id=\"特征缩放\">特征缩放</h3>\n<p>机器学习算法在缩放尺度不一样的数据效果比较差，比就如房价数据集<code>total_bedrooms</code>的取值范围为1~6445，而<code>median_income</code>的范围是0.5~15，所以需要对特征进行缩放。<br>\n<strong>note:</strong>通常情况下Target特征不需缩放<br>\n有两种缩放数据的方法</p>\n<ul>\n<li><p>min-max方式,对应的方法为</p>\n<pre><code>MinMaxScaler(self, feature_range=(0, 1), copy=True)</code></pre></li>\n<li><p>standardization 标准化数据,对应的方法为</p>\n<pre><code>StandardScaler(self, copy=True, with_mean=True, with_std=True)</code></pre></li>\n</ul>\n<h3 id=\"特征处理流程\">特征处理流程</h3>\n<p>目前在数据预处理阶段，我们需要对缺失值进行处理、特征组合和特征缩放。每一步的执行都有着先后顺序，sklearn提供了<code>Pipeline</code>帮助顺序完成转换。</p>\n<pre><code>num_attribs = list(housing_num)#返回的为列名[col1,col2,....]\ncat_attribs = [\"ocean_proximity\"]\n\nnum_pipeline = Pipeline([ #数值类型\n        ('selector', DataFrameSelector(num_attribs)),\n        ('imputer', Imputer(strategy=\"median\")),\n        ('attribs_adder', CombinedAttributesAdder()),\n        ('std_scaler', StandardScaler()),\n    ])\n\ncat_pipeline = Pipeline([ #标签类型\n        ('selector', DataFrameSelector(cat_attribs)),\n        ('cat_encoder', CategoricalEncoder(encoding=\"onehot-dense\")),\n    ])</code></pre>\n<p>上面定义的为分别处理数值类型和标签类型的转换流程，<code>housing_num</code>为<code>DataFrame</code>类型，<code>list(DataFrame)</code>的结果会是什么？返回的为列名字，不管你们信不信，反正我是信了。pandas真是太强大了。上面着两个流程还可以再整合一起</p>\n<pre><code>from sklearn.pipeline import FeatureUnion\nfull_pipeline = FeatureUnion(transformer_list=[\n        (\"num_pipeline\", num_pipeline),\n        (\"cat_pipeline\", cat_pipeline),\n    ])\nhousing_prepared = full_pipeline.fit_transform(housing)#最终的结果</code></pre>\n<p>今天就到这里把，工作了一天好困、眼疼，先发出去，明天再看看有没有什么错误。</p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n</div>\r\n\t\t<p class=\"postfoot\">\r\n\t\t\tposted on <span id=\"post-date\">2017-10-31 23:55</span> <a href=\"http://www.cnblogs.com/wxshi/\">Wanna_Go</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7764518\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7764518);return false;\">收藏</a>\r\n\t\t</p>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=303448,cb_entryId=7764518,cb_blogApp=currentBlogApp,cb_blogUserGuid='e2e7eaad-6e80-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/10/31 23:55:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n\t</div>", "article_view": 158, "image_url": ["https:"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "Appium python自动化测试系列之页面滑动原理讲解（十）", "url": "http://www.cnblogs.com/Mushishi_xu/p/7764381.html", "author": "Mushishi_xu", "article_desc": "10.1.1 页面滑动原理分析 在页面滑动查找章节我们就讲了滑动的知识点，只是不知道大家是否有认真练习以及去理解，如果你认真练习、理解了那么我相信这一章节的东西不用看也能够完成，下面我们还是简单分析一下。 所谓的页面滑动在我们实际操作手机的过程中就是不断的从屏幕的下面滑到上面，或者右边滑到左边，反之 ...", "content": "<div id=\"post_detail\">\r\n\t<div class=\"post\">\r\n\t\t<h2>\r\n\t\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/Mushishi_xu/p/7764381.html\">Appium python自动化测试系列之页面滑动原理讲解（十）</a>\r\n\t\t</h2>\r\n\t\t<div id=\"cnblogs_post_body\"><h4>10.1.1 页面滑动原理分析</h4>\n<p>　　在页面滑动查找章节我们就讲了滑动的知识点，只是不知道大家是否有认真练习以及去理解，如果你认真练习、理解了那么我相信这一章节的东西不用看也能够完成，下面我们还是简单分析一下。</p>\n<p>　　所谓的页面滑动在我们实际操作手机的过程中就是不断的从屏幕的下面滑到上面，或者右边滑到左边，反之亦然。其实在做自动化滑动的时候我们遵循的也是这个道理，我们只需要按着一个点然后在屏幕上拖动到另外一个点就行，这就实现了一个简单的滑动。还不懂？回去看第六章的滑动定位吧。</p>\n<h3>10.2 常见页面滑动方式实战10.2.1 滑动实战</h3>\n<p>　　前面没动也没问题，我们这里从基础的讲一下。首先我们应该很高心appium将滑动的操作封装成了一个函数swipe函数，我们看官方api：</p>\n<p>swipe(self, start_x, start_y, end_x, end_y, duration=None) ，这句话我相信大家能够看懂，如果看不是很理解，没事，我们看官方给出的例子：</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:python;gutter:true;\">Swipe from one point to another point, for an optional duration.\n    从A点滑动至B点，滑动时间为毫秒\n    :Args:\n     - start_x - x-coordinate at which to start\n     - start_y - y-coordinate at which to start\n     - end_x - x-coordinate at which to stop\n     - end_y - y-coordinate at which to stop\n     - duration - (optional) time to take the swipe, in ms.\n      \n    :Usage:\n        driver.swipe(100, 100, 100, 400)\n用法 driver.swipe(x1,y1,x2,y2,500)\n</pre>\n</div>\n<p> </p>\n<p>从官方的例子中我相信大家能够明白了吧。说得通俗易懂就是，我们整个屏幕是一个坐标系，x轴加上y轴的各一个标志就形成了一个坐标点，那么你要滑动屏幕，你总得告诉appium从哪个点（start_x，start_y）到哪个点（end_x，end_y），那么剩下的是不是就是要告诉appium你整个滑动操作要持续的时间呢（毫秒计算）？到这里是不是so easy！</p>\n<h3>10.3 滑动函数的封装实战</h3>\n<h4>10.3.1 如何设计滑动封装</h4>\n<p>　　看到这里可能有人说我啰嗦，当然你有一定基础，然后有这个思想了那么你可以跳过，其实我每次看书的时候无论该知识点我是否掌握，我都会看一遍，毕竟每个人的思考不一样，说不定会有一些不一样的收获，事实也是如此。</p>\n<p>　　整个app操作中的滑动无非就是上下左右的滑动，那么变化的也就是x，y的值不一样，水平滑动就是x轴变化，y轴不变化，垂直滑动就是y轴变化，x轴不变化，那么我们回头来看一下我们第六章的代码：</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:python;gutter:true;\">def getSize(self):\n    x = self.driver.get_window_size()['width']\n    y = self.driver.get_window_size()['height']\n    return (x,y)\n      \n      \n  #向左滑动\n  def swipeLeft(self,t):\n    l=self.getSize()\n    x1=int(l[0]*0.9)\n    y1=int(l[1]*0.5)\n    x2=int(l[0]*0.1)\n    self.driver.swipe(x1,y1,x2,y1,t)\n              \n  #向右滑动\n  def swipeRight(self,t):\n    l=self.getSize()\n    x1=int(l[0]*0.25)\n    y1=int(l[1]*0.5)\n    x2=int(l[0]*0.75)\n    self.driver.swipe(x1,y1,x2,y1,t)\n              \n  #向上滑动\n  def swipeUp(self,t):\n    l=self.getSize()\n    x1=int(l[0]*0.5)\n    y1=int(l[1]*0.8)\n    y2=int(l[1]*0.4)\n    self.driver.swipe(x1,y1,x1,y2,t)\n    time.sleep(5)\n      \n  #向下滑动\n  def swipeDown(self,t):\n    l=self.getSize()\n    x1=int(l[0]*0.5)\n    y1=int(l[1]*0.25)\n    y2=int(l[1]*0.75)\n    self.driver.swipe(x1,y1,x1,y2,t)\n</pre>\n</div>\n<p> </p>\n<p>再次回来看的时候收获不太一样呢？看到这里你是不是该思考一个问题了呢？这个滑动能够实现我一些app里面的验证码功能吗？</p>\n<p>这个知识点我在这里面就不仔细讲了，能否实现下来去实践一下，即使不行那么最后的解决方案也是类似的。哈哈，答案又说漏了。实践去，不然你真的只会纸上谈兵了。</p>\n<h3>10.4 解锁九宫格</h3>\n<h4>10.4.1 解锁思想</h4>\n<p>在这个课程之前讲一个题外话，其实自动化的目的是为了提高工作效率，不是为了显示咱会写代码，所以能减少工作的时候就减少，好比这个解锁九宫格如果在你工作中遇见app中有，那么不去设置就好。哈哈，题外话。</p>\n<p>首先讲解锁这个之前需要了解一个问题，我们这个解锁解的是app里面的密码锁，不是你设置手机的密码，切记切记。手机的密码暂时appium还不提供方法去解决，so，等待你去努力。</p>\n<p>首先我们看一下下面一张图片：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/617745/201711/617745-20171101155920373-729353310.png\" alt=\"\"></p>\n<p> </p>\n<p>你看到图片中的定位你能找到方法去操作吗？我们的9个点就在一个view里面，他们是一个整体，分不开。怎么去实现？思考一下。</p>\n<h4>10.4.2 九宫格解锁语法</h4>\n<p>不知道看见上面的那幅图的思考结果是什么，首先我们来看一下我们经常用到的解锁方式以及语法。</p>\n<p>首先我们第一个需要了解的是TouchAction。其实TouchAction的原理是将一系列的动作放在一个链条中，好比我们解锁九宫格的时候一样，我们是在这个链条中执行了很多不操作，然后将这个链条传递给服务器，然后服务器再去挨个解析这一些动作，最后挨个执行。</p>\n<p>知道了TouchAction之后那么我们在解锁之前是不是需要做第一个动作呢？就是去点（用到press），只有点了开始点之后我们再将我们的动作移动到下一个点(move_to)，然后依次类推，当我们将所有的点都执行完毕之后就需要松开我们的点(release)，然后进行提交(perform)，这是不是就是一个完整的解锁流程呢？那我们如何将上面的流程转换成代码呢？看下面：</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:python;gutter:true;\">TouchAction(self.driver).press().move_to().move_to().release().perfrom()\n</pre>\n</div>\n<p> </p>\n<p>这是我们整个流程的代码，但是如果你这样去执行肯定回报错，为什么呢？因为我都不知道你要点啥，从哪里移动到哪里，能不报错么？</p>\n<p>首先press()时需要指定一个对象，对吧。那么这里看press()的语法：</p>\n<p>press(WebElement e):这里你需要传入一个WebElement元素，但是像我们上面的图片无法获取到WebElement元素怎么办，那么我们就需要通过下面这种坐标的方式来进行。</p>\n<p>press(int x,int y):这里你需要传入需要点击元素的坐标位置。</p>\n<p>move_to(WebElement e):同样的传入一个WebElement元素，当无法获取WebElement元素时，同样用坐标去操作</p>\n<p>move_to(int x,int y).</p>\n<p>那么最后我们上面的解锁代码就成了下面这个样子：</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:python;gutter:true;\">TouchAction(self.driver).press(x=228,y=647).move_to(x=228,y=647).wait(100).move_to(x=812,y=647).wait(100).move_to(x=812,y=940).wait(100).mov\ne_to(x=812,y=1241).release().perform()\n</pre>\n</div>\n<p> </p>\n<h4>​10.4.3 九宫格解锁实战</h4>\n<p>通过上面的学习我相信大家一定觉得能够完全搞定上面的问题了，但是去动手了的人都知道结果了，上面执行后肯定回报错，知道为什么吗？往上照了资料但是一样却实际要报错，为什么呢？首先来看我的代码：</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:python;gutter:true;\">from appium.webdriver.common.touch_action import TouchAction\nTouchAction(self.driver).press(x=217,y=600).move_to(x=0,y=150).wait(1000).move_to(x=0,y=150).wait(1000).move_to(x=113,y=0).move_to(x=113,y=0).release().perform()\n</pre>\n</div>\n<p> </p>\n<p>是不是发现有不一样的地方呢？这里一定要记住的是move_to()函数里面的坐标位置是在上一个目标位置的基础上进行坐标位置的变化。初始坐标位置为：press(x=217,y=600),第一个move_to(x=0 ,y=150)，表示在（x=217，y=600）这个位置上向下移动150分辨率，也就是连接第二个点。而第二个move_to(x=0,y=150)，意思也差不多，因为，这个时候我还没有release（）也就是没有松开手，所以第三个点还是以（x=217，y=900）为起点，依次类推那么最后的结果就是我们上面的代码。哈哈，是不是顿时有被网上一些资料忽悠呢？但是你也不要觉得很厉害，你思考过一个问题没？每个手机的分辨率不一样，那么这样的操作在测试兼容性的时候是不是就有问题了呢？那思考一下该怎么解决吧。</p>\n<p>备注：可能看到这里的小伙伴会疑惑，为什么不用开始讲的定位直接使用element来进行定位操作呢？因为我们选择操作的对象是qq，在qq中整个九宫格页面他是一个view，他没有将每一个空格都拆分成一个element，所以那种方法不行，但是相对而言那会简单，只需要将我们的坐标更换成element的元素信息即可。提醒一下，最好是开始定位整个九宫格view，这个时候是一个数组，那么每一个元素只需通过index去访问就好，那样操作最快，下去动手操作一下吧。</p>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t<p class=\"postfoot\">\r\n\t\t\tposted on <span id=\"post-date\">2017-10-31 23:14</span> <a href=\"http://www.cnblogs.com/Mushishi_xu/\">Mushishi_xu</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7764381\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7764381);return false;\">收藏</a>\r\n\t\t</p>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=180609,cb_entryId=7764381,cb_blogApp=currentBlogApp,cb_blogUserGuid='e3caa2f2-77b5-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/10/31 23:14:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n\t</div>", "article_view": 116, "image_url": ["https://pic.cnblogs.com/face/617745/20150922180526.png"], "date_pub": "2017-10-31", "article_common": 1}
{"title": "脱壳第三讲,UPX压缩壳,以及补充壳知识", "url": "http://www.cnblogs.com/iBinary/p/7764483.html", "author": "iBinary", "article_desc": "脱壳第三讲,UPX压缩壳,以及补充壳知识 一丶什么是压缩壳.以及壳的原理 在理解什么是压缩壳的时候,我们先了解一下什么是壳 1.什么是壳 壳可以简单理解为就是在自己的PE文件中包含了代码.而有不影响我们的PE文件的执行. 2.什么是压缩壳 压缩壳指的是让我们的PE文件变小. 3.压缩壳原理 首先可以 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/iBinary/p/7764483.html\">脱壳第三讲,UPX压缩壳,以及补充壳知识</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h1>　　　　　　　　　　　脱壳第三讲,UPX压缩壳,以及补充壳知识</h1>\n<h2>一丶什么是压缩壳.以及壳的原理</h2>\n<p>在理解什么是压缩壳的时候,我们先了解一下什么是壳</p>\n<h3>1.什么是壳</h3>\n<p>　　壳可以简单理解为就是在自己的PE文件中包含了代码.而有不影响我们的PE文件的执行.</p>\n<h3>2.什么是压缩壳</h3>\n<p>　　压缩壳指的是让我们的PE文件变小.</p>\n<h3>3.压缩壳原理</h3>\n<p><img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031225316591-1696939120.png\" alt=\"\"></p>\n<p>首先可以看到,我们的PE文件</p>\n<p>一个PE头,两个节数据,其中节和节之间还有对齐值.而上图是我们的一个正常壳映射到内存中的示意图.</p>\n<h3>4.压缩壳的思路</h3>\n<p><img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031225626748-1437822251.png\" alt=\"\"></p>\n<p>从上图可以看出, 我们的PE文件,压缩一下变成了一个新的PE文件,其中我们的PE文件,压缩的数据是节里面的数据</p>\n<p>也就是说,压缩壳的原理就是压缩PE文件中节的数据.然后产生新的PE,这个新的PE我们成为带壳的PE</p>\n<p> 而我们运行带壳PE的时候,这时候壳中的解压缩代码开始执行,从而把我们以前压缩数据的节重新映射到内存.</p>\n<h3>5.压缩壳方法1(PE的生成)</h3>\n<p> <img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031225948591-1255335936.png\" alt=\"\"></p>\n<p>此时观察方法1我们会发现,我们新的PE, 解压缩的代码在压缩数据(节)的上面,那么这个时候则会面临一个问题</p>\n<p>如果我们解压缩的时候,那么压缩数据的地址应该在我们解压缩代码的哪里,那么此时我们一边解压缩,一边压缩数据会覆盖解压缩代码,此时我们不知道是先解压完成,还是先覆盖完成</p>\n<p>解决方法:</p>\n<p>　　首先我们知道原PE的节的个数以及大小,那么此时我们生成的新的带壳PE,则会获得大小.然后在其带壳PE的下面申请怎么大小的节用来占位置即可.</p>\n<p>那么此时我们解压的数据,则会写到我们占位置的地方.</p>\n<p> </p>\n<p>如果不懂可以看下图理解</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031230426185-739480095.png\" alt=\"\"></p>\n<p> </p>\n<p> 此时Shell(中文翻译为壳)代表的就是解压缩的代码</p>\n<p>这个图是映射到内存中的带壳PE分布图.</p>\n<p>很简单,解压缩代码执行,然后解压的代码正好在我们占地方的位置.</p>\n<h3>二丶脱壳步骤,以及手脱UPX壳</h3>\n<p>首先我们知道压缩壳了,压缩壳就是缩小PE文件</p>\n<p>那么在壳的世界 还有加密壳.  原理是一样的,只不过 </p>\n<p>压缩壳:　用来压缩数据，减小ＰＥ体积</p>\n<p>加密壳：用来防住你们我们他们等等逆向人员的　＾＿＾</p>\n<h3>1.脱壳步骤：</h3>\n<p>１．查找OEP(入口点 )</p>\n<p>　　 方法: 经验,这个主要看经验</p>\n<p>　　 不过这个经验也好分辨.</p>\n<p> 2.脱壳手法</p>\n<p>  　2.1 ESP 定律</p>\n<p>      2.2 API</p>\n<p>      2.3 单步跟踪(步过循环,只向下跳转)</p>\n<p>3. 经过上面步骤开始脱壳</p>\n<p>　　手工DMP内存(把内存拷贝下来)</p>\n<p>       然后修复PE (一般加密壳汇编PE中的导入表给抹掉)</p>\n<p>首先ESP定律,在壳的第一讲已经讲解过了</p>\n<p>这里我们说下怎么查看入口点,以及脱壳手法的API 跟踪,和单步跟踪.</p>\n<h3>2.识别入口点</h3>\n<p>如果要识别入口点,这里只简单说下,因为比如 VC++6.0  VSXXX  VB...等等入口点都是不一样的</p>\n<p>这里直说一下VC和VS入口点的识别方法.</p>\n<p>首先随便打开一个没有加壳的程序(VC++6.0的)OD打开查看.</p>\n<p>1.VC6.0的识别</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031231530279-196779325.png\" alt=\"\"></p>\n<p>往下拖动一下</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031231551685-119112498.png\" alt=\"\"></p>\n<p>可以看出,VC6.0的入口点会固定的调用这三个API</p>\n<p>只需要记住即可.看下VS的识别方法</p>\n<h3><sup>2.VS系列识别方法</sup></h3>\n<p><img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031232418357-1564861789.png\" alt=\"\"></p>\n<p>不知道还是电脑原因还是编译器原因,编译的程序不能在XP下使用OD打开,所以只能用IDA说下了</p>\n<p>如果OD能打开,那么则是一个Call 然后下方紧接着跟着一个JMP跳转</p>\n<p>那么它的入口点特征则是调用以上的API</p>\n<h3>3.使用API定位脱壳</h3>\n<p>因为ESP定律已经说过了,这里使用API进行脱壳.</p>\n<p>思路:</p>\n<p>　　因为我们知道入口点的特征,比如VC6.0的,它会调用API,那么我们API下段点即可.肯定会过去的.</p>\n<p>首先我们脱一个VC6.0的upx压缩壳.</p>\n<p>首先我们知道入口点会调用的API</p>\n<p>那么我们下断点即可.</p>\n<p>(注意,这里使用UPX随便压缩了一个VC的程序,UPX可以官网下载,VC程序也可以自己编写一个)</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031232922248-1281315030.png\" alt=\"\"></p>\n<p>F9以下,看看能不能断下来.</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031233231810-637147263.png\" alt=\"\"></p>\n<p>断下来了,只不过是断在里面了,然后我们执行到返回  CTRL + F9 即可看到我们的熟悉的特征</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031233325216-1994969802.png\" alt=\"\"></p>\n<p>确实使我们的入口点位置</p>\n<p>那么此时移动汇编代码到入口点,也就是一开始的地方,(因为此时程序已经执行的API可能数据已经破坏了,所以我们在入口点位置下段点,重新运行则可以断在入口点)</p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031233610357-1589795334.png\" alt=\"\"></p>\n<p>此时重新运行程序,当我们的EIP 位置是4014EC的地方我们则可以DMP内存了.</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1197364/201710/1197364-20171031234248435-1962653786.png\" alt=\"\"></p>\n<p>保存一份即可.</p>\n<h3>3.使用单步方法定位入口点.</h3>\n<p>这个就比较简单了,我们遇到循环,不看直接往下单步走,直到走到一个远跳即可.</p>\n<p>比如我模拟一下OD</p>\n<p>地址:     汇编代码</p>\n<p>1　　　add eax,eax</p>\n<p>2          mov eax,eax</p>\n<p>3          jnz   1 　　 　　　　EIP = 3</p>\n<p>4　　  mov edx,edx</p>\n<p>5         jmp  00401000</p>\n<p> 此时EIP = 3,那么会跳转到1,那么这个时候我们在4地址下段点即可,不看它的循环,一直到5地址,有个远跳,即可.</p>\n<p>关于DMP内存和上面一样,不说了.</p>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 23:43</span> <a href=\"http://www.cnblogs.com/iBinary/\">iBinary</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7764483\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7764483);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=366270,cb_entryId=7764483,cb_blogApp=currentBlogApp,cb_blogUserGuid='d3a60764-ac96-4054-1664-08d49c352df3',cb_entryCreatedDate='2017/10/31 23:43:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 178, "image_url": ["https://pic.cnblogs.com/face/1197364/20170810214841.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "UWP 磁贴设置", "url": "http://www.cnblogs.com/MzwCat/p/7763825.html", "author": "5只猫", "article_desc": "一：需求 一款好看好用的应用，对于UWP来说，动态的磁贴必不可少。 二：TileUpdateManager类 和TileUpdater类 如果需要更改或更新应用的磁贴，那么首先需要获得TileUpdater对象，顾名思义，TileUpdater就是磁贴的更新器。 通过TileUpdateManage ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/MzwCat/p/7763825.html\">UWP 磁贴设置</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><span style=\"font-size: 18px\"><strong>一：需求</strong></span></p>\n<p><span style=\"font-size: 16px\">一款好看好用的应用，对于UWP来说，动态的磁贴必不可少。</span></p>\n<p><span style=\"font-size: 18px\"><strong>二：TileUpdateManager类 和TileUpdater类</strong></span></p>\n<p><span style=\"font-size: 16px\">如果需要更改或更新应用的磁贴，那么首先需要获得TileUpdater对象，顾名思义，TileUpdater就是磁贴的更新器。</span></p>\n<p><span style=\"font-size: 16px\">通过TileUpdateManager类得到TileUpdater对象</span></p>\n<div class=\"cnblogs_code\">\n<pre>TileUpdater tileUpdater = TileUpdateManager.CreateTileUpdaterForApplication();</pre>\n</div>\n<p><span style=\"font-size: 18px\"><strong>三：TileUpdater 磁贴更新器类</strong></span></p>\n<p>    <span style=\"font-size: 16px\"><strong>3.1 清空应用的磁贴 </strong></span></p>\n<p>    <span style=\"font-size: 16px\">TileUpdater 有一个clear()方法用于清空当前应用的磁贴的内容，恢复为默认模式，默认就是一个软件的logo。该方法可以用于软件内点击按钮关闭动态磁贴的功能。</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\">删除所有更新并将平铺导致以显示其默认内容（如应用程序清单所声明）。</span>\n<span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span> Clear();</pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre>tileUpdater.Clear();</pre>\n</div>\n<p>　<span style=\"font-size: 16px\"><strong>3.2  更新磁贴</strong></span></p>\n<p>　<span style=\"font-size: 16px\">TileUpdater 有一个Update() 方法，用于更新磁贴，可以说是比较关键的方法了。先来看看方法的定义。</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 将内容或外观的更改应用于图块。\n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> notification:\n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 为平铺的内容提供新的 XML 定义的对象。</span>\n<span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span> Update(TileNotification notification);</pre>\n</div>\n<p><span style=\"font-size: 16px\">参数需要提供一个 TileNotification 对象。查看TileNotification类的构造函数可以发现</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">public</span> TileNotification(XmlDocument content);</pre>\n</div>\n<pre><span style=\"font-size: 16px\">TileNotification类的构造函数需要传递进一个XmlDocument对象。</span></pre>\n<p><span style=\"font-size: 16px\">  实际上磁贴的模板就是一个xml的文件。TileNotification 对象就是用来放要更新的磁贴的模板。 </span></p>\n<p><span style=\"font-size: 18px\"><strong>四：磁铁模板</strong></span></p>\n<p><span style=\"font-size: 16px\">磁贴的模板可以用微软预定的磁贴模板，或者自己定义模板。</span></p>\n<p>　<span style=\"font-size: 16px\"><strong>4.1获取微软预设的磁贴模板</strong></span></p>\n<div class=\"cnblogs_code\">\n<pre>XmlDocument xml = TileUpdateManager.GetTemplateContent(TileTemplateType.TileSquare150x150Block);</pre>\n</div>\n<pre><span style=\"font-size: 16px\">TileTemplateType里有很多微软预设的磁贴的模板，主要是根据不同的磁贴大小，微软自己预设的磁贴。</span><br><br><span style=\"font-size: 16px\"><strong>4.2 创建自适应磁贴模板</strong></span><br><span style=\"font-size: 16px\">自适应磁贴是win10一项新的功能，允许我们针对不同的磁贴大小设定模板。</span><br><br><span style=\"font-size: 16px\">既然磁贴的模板是xml格式的，那么它就是标记性语言。你可以像xaml那样，或者用类的方式定义。<br>请安装名为 <a href=\"https://www.nuget.org/packages/Microsoft.Toolkit.Uwp.Notifications/\" data-linktype=\"external\">Microsoft.Toolkit.Uwp.Notifications</a> 的 NuGet 程序包（搜索“notifications uwp”）</span><br><br><span style=\"font-size: 16px\">xml格式：</span></pre>\n<div class=\"cnblogs_code\">\n<pre>&lt;tile&gt;\n  &lt;visual&gt;\n\n    &lt;binding template=<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">TileSmall</span><span style=\"color: #800000\">\"</span>&gt;\n      &lt;text&gt;Small&lt;/text&gt;\n    &lt;/binding&gt;\n\n    &lt;binding template=<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">TileMedium</span><span style=\"color: #800000\">\"</span>&gt;\n      &lt;text&gt;Medium&lt;/text&gt;\n    &lt;/binding&gt;\n\n    &lt;binding template=<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">TileWide</span><span style=\"color: #800000\">\"</span>&gt;\n      &lt;text&gt;Wide&lt;/text&gt;\n    &lt;/binding&gt;\n\n    &lt;binding template=<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">TileLarge</span><span style=\"color: #800000\">\"</span>&gt;\n      &lt;text&gt;Large&lt;/text&gt;\n    &lt;/binding&gt;\n\n  &lt;/visual&gt;\n&lt;/tile&gt;</pre>\n</div>\n<p> </p>\n<p><span style=\"font-size: 16px\"> c#格式</span></p>\n<div class=\"cnblogs_code\">\n<pre>TileContent content = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileContent()\n{\n    Visual </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileVisual()\n    {\n        TileSmall </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileBinding()\n        {\n            Content </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileBindingContentAdaptive()\n            {\n                Children </span>=<span style=\"color: #000000\">\n                {\n                    </span><span style=\"color: #0000ff\">new</span> AdaptiveText() { Text = <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Small</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> }\n                }\n            }\n        },\n\n        TileMedium </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileBinding()\n        {\n            Content </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileBindingContentAdaptive()\n            {\n                Children </span>=<span style=\"color: #000000\">\n                {\n                    </span><span style=\"color: #0000ff\">new</span> AdaptiveText() { Text = <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Medium</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> }\n                }\n            }\n        },\n\n        TileWide </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileBinding()\n        {\n            Content </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileBindingContentAdaptive()\n            {\n                Children </span>=<span style=\"color: #000000\">\n                {\n                    </span><span style=\"color: #0000ff\">new</span> AdaptiveText() { Text = <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Wide</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> }\n                }\n            }\n        },\n\n        TileLarge </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileBinding()\n        {\n            Content </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileBindingContentAdaptive()\n            {\n                Children </span>=<span style=\"color: #000000\">\n                {\n                    </span><span style=\"color: #0000ff\">new</span> AdaptiveText() { Text = <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Large</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> }\n                }\n            }\n        }\n    }\n};</span></pre>\n</div>\n<p> </p>\n<p><span style=\"font-size: 16px\">这个自适应的磁贴也仅仅是针对四种状体的磁贴定义的。因为微软的磁贴也只能有（小，中，宽，大）四种形态。分别对应（TileSmall，TileMedium ，TileWide，TileLarge）。在每种状态里，添加你需要内容即可。你可以添加PeekImage，BackgroundImage，AdaptiveText等。</span></p>\n<p><span style=\"font-size: 16px\"> </span></p>\n<p><span style=\"font-size: 16px\"> </span></p>\n<p><span style=\"font-size: 16px\"> </span></p>\n<p><span style=\"font-size: 16px\">如果你用的是c#写的磁贴模板，有一个TileContent.Getxml() 方法用于将c#代码转化成xml。</span></p>\n<p><span style=\"font-size: 16px\">这样你再创建一个TileNotification对象，通过TileUpdater.update()就可以更新磁贴了。</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">var</span> xmlDocument=<span style=\"color: #000000\"> content.GetXml();\n\nTileNotification tileNotification </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> TileNotification(xmlDocument);<br>\nTileUpdater tileUpdater </span>=<span style=\"color: #000000\"> TileUpdateManager.CreateTileUpdaterForApplication();\ntileUpdater.Update(tileNotification);</span></pre>\n</div>\n<p> </p>\n<p><span style=\"font-size: 16px\">微软开发者文档地址：https://docs.microsoft.com/zh-cn/windows/uwp/controls-and-patterns/tiles-and-notifications-create-adaptive-tiles</span></p>\n<p><span style=\"font-size: 16px\"> </span></p>\n<p><span style=\"font-size: 16px\"> </span></p>\n<p><span style=\"font-size: 16px\"> </span></p>\n<p><span style=\"font-size: 16px\">-------some words-------</span></p>\n<p><span style=\"font-size: 16px\">1.Notification 通知</span></p>\n<p><span style=\"font-size: 16px\">2..tile 磁贴</span></p>\n<p><span style=\"font-size: 16px\">---------the  end----------</span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 21:27</span> <a href=\"http://www.cnblogs.com/MzwCat/\">5只猫</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7763825\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7763825);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=318523,cb_entryId=7763825,cb_blogApp=currentBlogApp,cb_blogUserGuid='5f77e004-5f1f-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/31 21:27:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 124, "image_url": ["https://pic.cnblogs.com/face/961655/20160521222726.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "服务端事件EventSource揭秘", "url": "http://www.cnblogs.com/accordion/p/7764460.html", "author": "royalrover", "article_desc": "服务端推 服务端推，指的是由服务器主动的向客户端发送消息（响应）。在应用层的HTTP协议实现中，“请求 响应”是一个round trip，它的起点来自客户端，因此在应用层之上无法实现简易的服务端推功能。当前解决服务端推送的方案有这几个： 1. 客户端长轮询 2. websocket双向连接 3. i ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/accordion/p/7764460.html\">服务端事件EventSource揭秘</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h2 id=\"服务端推\">服务端推</h2>\n<p>服务端推，指的是由服务器主动的向客户端发送消息（响应）。在应用层的HTTP协议实现中，“请求-响应”是一个round trip，它的起点来自客户端，因此在应用层之上无法实现简易的服务端推功能。当前解决服务端推送的方案有这几个：</p>\n<ol>\n<li>客户端长轮询</li>\n<li>websocket双向连接</li>\n<li>iframe永久帧</li>\n</ol>\n<p>长轮训虽然可以避免短轮训造成的服务端过载，但在服务端返回数据后仍需要客户端主动发起下一个长轮训请求，等待服务端响应，这样仍需要底层的连接建立而且服务端处理逻辑需要相应处理，不符合逻辑上的流程简单的服务端推送；</p>\n<p>websocket连接相对而言功能最强大，但是它对服务器的版本有要求，在可以使用websocket协议的服务器上尽量采用此种方式；</p>\n<p>iframe永久帧则是在在页面嵌入一个专用来接受数据的iframe页面，该页面由服务器输出相关信息，如<strong><script>parent.utils.exec(&quot;response&quot;)</script></strong>，服务器不停的向iframe中写入类似的script标签和数据，实现另一种形式的服务端推送。不过永久帧的技术会导致主页面的加载条始终处于“loading”状态，体验很差。</p>\n<p>HTML5规范中提供了服务端事件EventSource，浏览器在实现了该规范的前提下创建一个EventSource连接后，便可收到服务端的发送的消息，这些消息需要遵循一定的格式，对于前端开发人员而言，只需在浏览器中侦听对应的事件皆可。</p>\n<p>相比较上文中提到的3中实现方式，EventSource流的实现方式对客户端开发人员而言非常简单，兼容性上出了IE系的浏览器（IE、Edge）外其他都良好；对于服务端，它可以兼容老的浏览器，无需upgrade为其他协议，在简单的服务端推送的场景下可以满足需求。在浏览器与服务端需要强交互的场景下，websocket仍是不二的选择。</p>\n<h2 id=\"eventsource规范简析\">EventSource规范简析</h2>\n<h3 id=\"浏览器端\">浏览器端</h3>\n<p>浏览器端，需要创建一个EventSource对象，并且传入一个服务端的接口URI作为参数。</p>\n<pre><code>var evtSource = new EventSource('http://localhost:9111/es');</code></pre>\n<p>其中，'<a href=\"http://localhost:9111/es'%E4%B8%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%90%90%E5%87%BA%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8E%A5%E5%8F%A3%E3%80%82%E7%9B%AE%E5%89%8D%EF%BC%8CEventSource%E5%9C%A8%E5%A4%A7%E5%A4%9A%E6%95%B0%E6%B5%8F%E8%A7%88%E5%99%A8%E7%AB%AF%E4%B8%8D%E6%94%AF%E6%8C%81\" class=\"uri\">http://localhost:9111/es'为服务端吐出数据的接口。目前，EventSource在大多数浏览器端不支持</a><br>\n跨域，因此它不是一种跨域的解决方案。</p>\n<p>默认EventSource对象通过侦听“message”事件获取服务端传来的消息，“open”事件则在http连接建立后触发，”error“事件会在通信错误（连接中断、服务端返回数据失败）的情况下触发。同时，EventSource规范允许服务端指定自定义事件，客户端侦听该事件即可。</p>\n<pre><code>evtSource.addEventListener('message',function(e){\n    console.log(e.data);\n});\nevtSource.addEventListener('error',function(e){\n    console.log(e);\n})</code></pre>\n<h3 id=\"服务端\">服务端</h3>\n<p>事件流的对应MIME格式为<strong>text/event-stream</strong>，而且其基于HTTP长连接。针对HTTP1.1规范默认采用长连接，针对HTTP1.0的服务器需要特殊设置。</p>\n<p>服务端返回数据需要特殊的格式，它分为四种消息类型：</p>\n<pre><code>event, data, id, retry</code></pre>\n<p>其中，event指定自定义消息的名称，如<strong>event: customMessage\\n</strong>;</p>\n<p>data指定具体的消息体，可以是对象或者字符串，如<strong>data: <code>JSON.stringify(jsonObj)\\n\\n</code></strong>,在消息体后面有两个换行符\\n，代表当前消息体发送完毕，一个换行符标识当前消息并未结束，浏览器需要等待后面数据的到来后再触发事件；</p>\n<p>id为当前消息的标识符，可以不设置。一旦设置则在浏览器端的eventSource对象中就会有体现(假设服务端返回<strong>id: 369\\n</strong>)，<code>eventSource.lastEventId == 369</code>。该字段使用场景不大;</p>\n<p>retry设置当前http连接失败后，重新连接的间隔。EventSource规范规定，客户端在http连接失败后默认进行重新连接，重连间隔为3s，通过设置retry字段可指定重连间隔;</p>\n<p>每个字段都有名称，紧接着有个”:“。当出现一个没有名称的字段而只有”:“时，这就会被服务端理解为”注释“，并不会被发送至浏览器端，如<em>: commision</em>。</p>\n<p>由于EventSource是基于HTTP连接之上的，因此在一段没有数据的时期会出现超时问题。<strong>服务器默认HTTP超时时间为2分钟，在node端可以通过response.connection.setTimeou(0)设置为默认的2min超时</strong>， 因此需要服务端做心跳保活，否则客户端在连接超时的情况下出现<strong>net::ERR_INCOMPLETE_CHUNKED_ENCODING</strong>错误。通过阅读相关规范，发现注释行可以用来防止连接超时,服务器可以定期发送一条消息注释行,以保持连接不断。</p>\n<p>下面提供koa的服务端代码：</p>\n<pre><code>var fs = require('fs');\nvar path = require('path');\nvar PassThrough = require('stream').PassThrough;\nvar Readable = require('stream').Readable;\nvar koa = require('koa');\nvar Router = require('koa-router');\nvar app = new koa();\nvar router = new Router();\n\nfunction RR(){\n    Readable.call(this,arguments);\n}\nRR.prototype = new Readable();\nRR.prototype._read = function(data){\n}\n\nrouter.get('/',function(ctx,next){\n    ctx.set('content-type','text/html');\n    ctx.body = fs.readFileSync(path.join(process.cwd(),'eventServer.html'));\n});\n\nconst sse = (stream,event, data) =&gt; {\n    return stream.push(`event:${ event }\\ndata: ${ JSON.stringify(data) }\\n\\n`)\n//    return stream.write(`event:${ event }\\ndata: ${ JSON.stringify(data) }\\n\\n`);\n}\nrouter.get('/es',function(ctx,next){\n    var stream = new RR()//PassThrough();\n    ctx.set({\n        'Content-Type':'text/event-stream',\n        'Cache-Control':'no-cache',\n        Connection: 'keep-alive'\n    });\n    sse(stream,'test',{a: \"yango\",b: \"tango\"});\n    ctx.body = stream;\n    setInterval(()=&gt;{\n        sse(stream,'test',{a: \"yango\",b: Date.now()});\n    },3000); \n});\n\napp.use(router.routes());\napp.listen(9111,function(){\n    console.log('listening port 9111');\n});</code></pre>\n<p>此处需要注意的是koa-router的返回值必须是一个Stream（Readable），这是由于koa的特殊性造成的。如果context.body不是Stream是一个字符串或者Buffer实例，会直接在node原生中调用res.end(buffer),结束了HTTP响应：</p>\n<pre><code>koa lib/application.js\n\n// responses\nif (Buffer.isBuffer(body)) return res.end(body);\nif ('string' == typeof body) return res.end(body);\nif (body instanceof Stream) return body.pipe(res);</code></pre>\n<p>因此造成了服务端事件流无法正确响应。而返回Stream类型的方式有几种，如通过扩展stream模块的Readable可读流返回或者直接采用PassThrough流返回，亦可通过through2模块或者Transform对象实现，归根到底保证可以从该stream对象中pipe出数据至http.ServerResponse对象中。</p>\n<p>附页面代码</p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div&gt;\n        hello world\n    &lt;/div&gt;\n    &lt;p id=\"info\"&gt;&lt;/p&gt;\n    &lt;script&gt;\n        var infoShow = document.querySelector('#info');\n        var se = new EventSource('http://localhost:9111/es');\n        se.addEventListener('test',function(e){\n            infoShow.textContent += e.data+'\\n';\n        });\n        se.addEventListener('error',function(e){\n            console.log(e);\n        })\n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;</code></pre>\n<h2 id=\"参考资料\">参考资料</h2>\n<p><a href=\"https://developer.mozilla.org/zh-CN/docs/Server-sent_events/Using_server-sent_events\">使用服务器发送事件</a><br>\n<a href=\"https://stackoverflow.com/questions/8761025/why-is-eventsource-connection-closed-every-30-60-sec-when-no-data-transported-w\">EventSource超时</a></p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 23:36</span> <a href=\"http://www.cnblogs.com/accordion/\">royalrover</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7764460\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7764460);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=204605,cb_entryId=7764460,cb_blogApp=currentBlogApp,cb_blogUserGuid='dbd8d399-136a-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/10/31 23:36:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 194, "image_url": ["https://pic.cnblogs.com/face/691726/20160605131234.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "Web性能测试工具之ab入门篇", "url": "http://www.cnblogs.com/lovesoo/p/7762796.html", "author": "lovesoo", "article_desc": "ab全称Apache Bench，是apache附带的一个小工具，它可以同时模拟多个并发请求，测试apache等Web服务器的最大负载压力。 本文通过一个简单的示例，介绍了使用ab进行web页面性能测试、查看结果方法及运行参数详解。 运行环境为Windows 10系统。 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/lovesoo/p/7762796.html\">Web性能测试工具之ab入门篇</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h1>1. ab简介</h1>\r\n<div>ab全称Apache Bench，是apache附带的一个小工具，它可以同时模拟多个并发请求，测试apache等Web服务器的最大负载压力。</div>\r\n<div>本文通过一个简单的示例，介绍了使用ab进行web页面性能测试、查看结果方法及运行参数详解。</div>\r\n<div>运行环境为Windows 10系统。</div>\r\n<h1>2. ab下载</h1>\r\n<div>Apache官网：<a href=\"http://httpd.apache.org/download.cgi\" target=\"_blank\">http://httpd.apache.org/download.cgi</a></div>\r\n<h2>2.1 Windows系统</h2>\r\n<div>对于windows系统，可访问页面<a href=\"https://www.apachelounge.com/download/\" target=\"_blank\">https://www.apachelounge.com/download/</a>下载相应版本的zip包，我们下载的版本是：httpd-2.4.29-Win64-VC15.zip</div>\r\n<div><img src=\"http://images2017.cnblogs.com/blog/445074/201710/445074-20171031232944185-233482869.png\" alt=\"\">\r\n<p> </p>\r\n</div>\r\n<div>也可以下载我提取出来的ab.exe，解压即可使用：<a href=\"https://files.cnblogs.com/files/lovesoo/ab.zip\">https://files.cnblogs.com/files/lovesoo/ab.zip</a></div>\r\n<h2>2.2 linux系统</h2>\r\n<div>使用如下命令安装Apache</div>\r\n<div>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">yum</span> <span style=\"color: #0000ff;\">install</span> httpd</pre>\r\n</div>\r\n</div>\r\n<h1>3. ab运行</h1>\r\n<div>使用cmd/shell进入到Apache24\\bin目录下，运行ab即可</div>\r\n<div><img src=\"http://note.youdao.com/yws/public/resource/6198d73bf23289361757538ca7f02a97/xmlnote/121C298EE35744C8AF79B53360FB5018/11331\" alt=\"\" data-media-type=\"image\" data-original=\"http://note.youdao.com/yws/public/resource/6198d73bf23289361757538ca7f02a97/xmlnote/121C298EE35744C8AF79B53360FB5018/11331\"></div>\r\n<div> </div>\r\n<h1>4. 使用ab进行性能测试</h1>\r\n<div> </div>\r\n<div>最常用两种运行命令如下：</div>\r\n<div>\r\n<div class=\"cnblogs_code\">\r\n<pre>ab -n <span style=\"color: #800080;\">10</span> -c <span style=\"color: #800080;\">10</span> http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">www.cnblogs.com</span>\r\n# -n 总共10次请求，-<span style=\"color: #000000;\">c 模拟10个并发用户，即10个并发请求博客园首页，共请求10次\r\n \r\nab </span>-t <span style=\"color: #800080;\">10</span> -c <span style=\"color: #800080;\">10</span> http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">www.cnblogs.com</span>\r\n# -t 是测试执行时间，-c 模拟10个并发用户，即10个并发请求博客园首页，持续10秒</pre>\r\n</div>\r\n</div>\r\n<h1>5. 测试结果</h1>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/445074/201711/445074-20171101000852279-64223399.png\" alt=\"\"></p>\r\n<p> </p>\r\n<h1>6. 结果解析</h1>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\">Server Software:\r\nServer Hostname:        www.cnblogs.com\r\nServer Port:            </span><span style=\"color: #800080;\">80</span><span style=\"color: #000000;\">\r\n\r\nDocument Path:          </span>/<span style=\"color: #000000;\">\r\nDocument Length:        </span><span style=\"color: #800080;\">147</span><span style=\"color: #000000;\"> bytes    #HTTP响应数据的正文长度\r\n\r\nConcurrency Level:      </span><span style=\"color: #800080;\">10</span><span style=\"color: #000000;\">    #并发数\r\nTime taken </span><span style=\"color: #0000ff;\">for</span> tests:   <span style=\"color: #800080;\">10.183</span><span style=\"color: #000000;\"> seconds    #测试执行时间\r\nComplete requests:      </span><span style=\"color: #800080;\">169</span><span style=\"color: #000000;\">    #完成请求数\r\nFailed requests:        </span><span style=\"color: #800080;\">0</span><span style=\"color: #000000;\">    #失败请求数\r\nNon</span>-2xx responses:      <span style=\"color: #800080;\">169</span><span style=\"color: #000000;\">\r\nTotal transferred:      </span><span style=\"color: #800080;\">65403</span><span style=\"color: #000000;\"> bytes    #网络总传输量\r\nHTML transferred:       </span><span style=\"color: #800080;\">24843</span><span style=\"color: #000000;\"> bytes    #HTML内容传输量\r\nRequests per second:    </span><span style=\"color: #800080;\">16.60</span> [#/<span style=\"color: #000000;\">sec] (mean)    #每秒请求数\r\nTime per request:       </span><span style=\"color: #800080;\">602.545</span> [ms] (mean)    #用户平均请求等待时间，计算公式：测试执行总时间/（总请求数/<span style=\"color: #000000;\">并发用户数）\r\nTime per request:       </span><span style=\"color: #800080;\">60.254</span> [ms] (mean, across all concurrent requests)    #服务器平均请求等待时间，计算公式：测试执行总时间/<span style=\"color: #000000;\">总请求数\r\nTransfer rate:          </span><span style=\"color: #800080;\">6.27</span> [Kbytes/<span style=\"color: #000000;\">sec] received    #平均传输速率\r\n\r\nConnection Times (ms)    #响应时间小、中、大值\r\n              min  mean[</span>+/-<span style=\"color: #000000;\">sd] median   max\r\nConnect:        </span><span style=\"color: #800080;\">2</span>   <span style=\"color: #800080;\">40</span> <span style=\"color: #800080;\">325.5</span>      <span style=\"color: #800080;\">3</span>    <span style=\"color: #800080;\">3006</span><span style=\"color: #000000;\">\r\nProcessing:    </span><span style=\"color: #800080;\">41</span>  <span style=\"color: #800080;\">382</span> <span style=\"color: #800080;\">928.1</span>     <span style=\"color: #800080;\">63</span>    <span style=\"color: #800080;\">3072</span><span style=\"color: #000000;\">\r\nWaiting:       </span><span style=\"color: #800080;\">41</span>  <span style=\"color: #800080;\">376</span> <span style=\"color: #800080;\">922.1</span>     <span style=\"color: #800080;\">58</span>    <span style=\"color: #800080;\">3063</span><span style=\"color: #000000;\">\r\nTotal:         </span><span style=\"color: #800080;\">43</span>  <span style=\"color: #800080;\">422</span> <span style=\"color: #800080;\">971.5</span>     <span style=\"color: #800080;\">68</span>    <span style=\"color: #800080;\">3075</span><span style=\"color: #000000;\">\r\n\r\nPercentage of the requests served within a certain </span><span style=\"color: #0000ff;\">time</span> (ms)    #一定时间内请求完成的百分比，如50%用户完成的响应时间在68ms内, <span style=\"color: #800080;\">66</span>%用户完成的响应时间在73ms内，<span style=\"color: #800080;\">100</span>%<span style=\"color: #000000;\">用户在3075ms内完成\r\n  </span><span style=\"color: #800080;\">50</span>%     <span style=\"color: #800080;\">68</span>\r\n  <span style=\"color: #800080;\">66</span>%     <span style=\"color: #800080;\">73</span>\r\n  <span style=\"color: #800080;\">75</span>%     <span style=\"color: #800080;\">81</span>\r\n  <span style=\"color: #800080;\">80</span>%     <span style=\"color: #800080;\">85</span>\r\n  <span style=\"color: #800080;\">90</span>%   <span style=\"color: #800080;\">3060</span>\r\n  <span style=\"color: #800080;\">95</span>%   <span style=\"color: #800080;\">3066</span>\r\n  <span style=\"color: #800080;\">98</span>%   <span style=\"color: #800080;\">3069</span>\r\n  <span style=\"color: #800080;\">99</span>%   <span style=\"color: #800080;\">3075</span>\r\n <span style=\"color: #800080;\">100</span>%   <span style=\"color: #800080;\">3075</span> (longest request)</pre>\r\n</div>\r\n<h1>7. ab运行参数详解</h1>\r\n<div>官方帮助文档如下：</div>\r\n<div>\r\n<div class=\"cnblogs_code\">\r\n<pre>Usage: ab [options] [http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">]hostname[:port]/path</span>\r\n<span style=\"color: #000000;\">Options are:\r\n</span>-<span style=\"color: #000000;\">n requests Number of requests to perform\r\n</span>-c concurrency Number of multiple requests to <span style=\"color: #0000ff;\">make</span> at a <span style=\"color: #0000ff;\">time</span>\r\n-<span style=\"color: #000000;\">t timelimit Seconds to max. to spend on benchmarking\r\nThis implies </span>-n <span style=\"color: #800080;\">50000</span>\r\n-s timeout Seconds to max. <span style=\"color: #0000ff;\">wait</span> <span style=\"color: #0000ff;\">for</span><span style=\"color: #000000;\"> each response\r\nDefault is </span><span style=\"color: #800080;\">30</span><span style=\"color: #000000;\"> seconds\r\n</span>-b windowsize Size of TCP send/receive buffer, <span style=\"color: #0000ff;\">in</span><span style=\"color: #000000;\"> bytes\r\n</span>-<span style=\"color: #000000;\">B address Address to bind to when making outgoing connections\r\n</span>-p postfile File containing data to POST. Remember also to set -<span style=\"color: #000000;\">T\r\n</span>-u putfile File containing data to PUT. Remember also to set -<span style=\"color: #000000;\">T\r\n</span>-T content-type Content-type header to use <span style=\"color: #0000ff;\">for</span> POST/<span style=\"color: #000000;\">PUT data, eg.\r\n</span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">application/x-www-form-urlencoded</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">\r\nDefault is </span><span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">text/plain</span><span style=\"color: #800000;\">'</span>\r\n-v verbosity How much troubleshooting <span style=\"color: #0000ff;\">info</span><span style=\"color: #000000;\"> to print\r\n</span>-<span style=\"color: #0000ff;\">w</span> Print out results <span style=\"color: #0000ff;\">in</span><span style=\"color: #000000;\"> HTML tables\r\n</span>-<span style=\"color: #000000;\">i Use HEAD instead of GET\r\n</span>-<span style=\"color: #000000;\">x attributes String to insert as table attributes\r\n</span>-y attributes String to insert as <span style=\"color: #0000ff;\">tr</span><span style=\"color: #000000;\"> attributes\r\n</span>-<span style=\"color: #000000;\">z attributes String to insert as td or th attributes\r\n</span>-C attribute Add cookie, eg. <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">Apache=1234</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">. (repeatable)\r\n</span>-H attribute Add Arbitrary header line, eg. <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">Accept-Encoding: gzip</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">\r\nInserted after all normal header lines. (repeatable)\r\n</span>-<span style=\"color: #000000;\">A attribute Add Basic WWW Authentication, the attributes\r\nare a colon separated username and password.\r\n</span>-<span style=\"color: #000000;\">P attribute Add Basic Proxy Authentication, the attributes\r\nare a colon separated username and password.\r\n</span>-<span style=\"color: #000000;\">X proxy:port Proxyserver and port number to use\r\n</span>-<span style=\"color: #000000;\">V Print version number and exit\r\n</span>-<span style=\"color: #000000;\">k Use HTTP KeepAlive feature\r\n</span>-<span style=\"color: #000000;\">d Do not show percentiles served table.\r\n</span>-<span style=\"color: #000000;\">S Do not show confidence estimators and warnings.\r\n</span>-q Do not show progress when doing <span style=\"color: #0000ff;\">more</span> than <span style=\"color: #800080;\">150</span><span style=\"color: #000000;\"> requests\r\n</span>-l Accept variable document length (use this <span style=\"color: #0000ff;\">for</span><span style=\"color: #000000;\"> dynamic pages)\r\n</span>-g filename Output collected data to gnuplot format <span style=\"color: #0000ff;\">file</span><span style=\"color: #000000;\">.\r\n</span>-e filename Output CSV <span style=\"color: #0000ff;\">file</span><span style=\"color: #000000;\"> with percentages served\r\n</span>-r Don<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">t exit on socket receive errors.</span>\r\n-<span style=\"color: #000000;\">m method Method name\r\n</span>-h Display usage information (this message)</pre>\r\n</div>\r\n</div>\r\n<div> </div>\r\n<div>中文翻译如下：</div>\r\n<div>\r\n<div class=\"cnblogs_code\">\r\n<pre>-n 即requests，用于指定压力测试/<span style=\"color: #000000;\">总请求数。\r\n</span>-<span style=\"color: #000000;\">c 即concurrency，用于指定压力测试的并发数。\r\n</span>-<span style=\"color: #000000;\">t 即timelimit，测试执行最大秒数，它可以让测试限制在一个固定的总时间以内，默认值为50000。\r\n</span>-<span style=\"color: #000000;\">s 即timeout，请求最大等待时长，默认30s\r\n</span>-b 即windowsize，TCP发送/<span style=\"color: #000000;\">接收的缓冲大小(单位：字节)。\r\n</span>-p 即postfile，发送POST请求时需要上传的文件，文件格式如<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">p1=1&amp;p2=2</span><span style=\"color: #800000;\">\"</span>。使用方法是 -p <span style=\"color: #800080;\">123</span>.txt 。 （配合-<span style=\"color: #000000;\">T）\r\n</span>-u 即putfile，发送PUT请求时需要上传的文件。（配合-<span style=\"color: #000000;\">T）\r\n</span>-T 即content-type，用于设置Content-Type请求头信息，如 -T <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">application/x-www-form-urlencoded”，默认值为text/plain。（配合-p）</span>\r\n-v 即verbosity，设置显示信息的详细程度 – 4或更大值会显示头信息， 3或更大值可以显示响应代码(<span style=\"color: #800080;\">404</span><span style=\"color: #000000;\">, 200等), 2或更大值可以显示警告和其他信息。\r\n</span>-<span style=\"color: #0000ff;\">w</span><span style=\"color: #000000;\"> 以HTML表格形式打印结果。\r\n</span>-<span style=\"color: #000000;\">i 使用HEAD请求代替GET请求。\r\n</span>-<span style=\"color: #000000;\">x 插入字符串作为table标签的属性。\r\n</span>-<span style=\"color: #000000;\">y 插入字符串作为tr标签的属性。\r\n</span>-<span style=\"color: #000000;\">z 插入字符串作为td标签的属性。\r\n</span>-C 添加cookie信息，例如：<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Apache=1234</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">。此参数可以重复，用逗号分割。提示：可以借助session实现原理传递 JSESSIONID参数， 实现保持会话的功能，如</span>-C <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">c1=1234,c2=2,c3=3, JSESSIONID=FF056CD16DA9D71CB131C1D56F0319F8</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">。\r\n</span>-H 添加任意的请求头，例如：<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Accept-Encoding: gzip</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">，请求头将会添加在现有的多个请求头之后(可以重复该参数选项以添加多个)。\r\n</span>-<span style=\"color: #000000;\">A 添加一个基本的网络认证信息，用户名和密码之间用英文冒号隔开。\r\n</span>-P 添加一个基本的代理认证信息，用户名和密码之间用英文冒号隔开。如-P proxy-auth-<span style=\"color: #000000;\">username:password\r\n</span>-X 指定使用的代理服务器和端口号，例如:<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">126.10.10.3:88</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">。\r\n</span>-<span style=\"color: #000000;\">V 显示版本号并退出。\r\n</span>-<span style=\"color: #000000;\">k 使用HTTP的KeepAlive特性。\r\n</span>-<span style=\"color: #000000;\">d 不显示百分比。\r\n</span>-<span style=\"color: #000000;\">S 不显示预估和警告信息。\r\n</span>-<span style=\"color: #000000;\">q 超过150个请求后不显示进度\r\n</span>-<span style=\"color: #000000;\">l 接受可变文档长度（用于动态页面）\r\n</span>-<span style=\"color: #000000;\">g filename 输出结果信息到gnuplot格式的文件中。\r\n</span>-<span style=\"color: #000000;\">e filename 输出结果信息到CSV格式的文件中。\r\n</span>-<span style=\"color: #000000;\">r 指定接收到错误信息时不退出程序。\r\n</span>-<span style=\"color: #000000;\">m method 方法名\r\n</span>-h 帮助</pre>\r\n</div>\r\n</div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 23:43</span> <a href=\"http://www.cnblogs.com/lovesoo/\">lovesoo</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7762796\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7762796);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=127424,cb_entryId=7762796,cb_blogApp=currentBlogApp,cb_blogUserGuid='30de04d9-e9f7-e111-aa3f-842b2b196315',cb_entryCreatedDate='2017/10/31 23:43:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 362, "image_url": ["https://pic.cnblogs.com/face/445074/20171023190913.png"], "date_pub": "2017-10-31", "article_common": 4}
{"title": "Charles从入门到放弃", "url": "http://www.cnblogs.com/zqzjs/p/7763406.html", "author": "leslie·Zhao", "article_desc": "Charles版本:4.0.2 一、开始 连接方式 方法一：电脑和手机连接同一个wifi 方法二：电脑使用网线连接网络，手机通过USB连接电脑 二、过滤网络请求 1.简单过滤 在Sequence模式下，就可以看到Filter，输入要过滤的关键字即可。 2.长期特定的网络封包 路径：Proxy Rec ...", "content": "<div id=\"post_detail\">\r\n\t<div class=\"post\">\r\n\t\t<h2>\r\n\t\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/zqzjs/p/7763406.html\">Charles从入门到放弃</a>\r\n\t\t</h2>\r\n\t\t<div class=\"postbody\">\r\n\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><blockquote>\n<p>Charles版本:4.0.2</p>\n</blockquote>\n<h2 id=\"一开始\">一、开始</h2>\n<hr>\n<p>连接方式</p>\n<ul>\n<li>方法一：电脑和手机连接同一个wifi</li>\n<li>方法二：电脑使用网线连接网络，手机通过USB连接电脑</li>\n</ul>\n<h2 id=\"二过滤网络请求\">二、过滤网络请求</h2>\n<hr>\n<h3 id=\"简单过滤\">1.简单过滤</h3>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031195642732-1111174727.png\" width=\"500\" height=\"400\"></p>\n<p>在Sequence模式下，就可以看到Filter，输入要过滤的关键字即可。</p>\n<h3 id=\"长期特定的网络封包\">2.长期特定的网络封包</h3>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031195723951-627252784.png\" width=\"500\" height=\"400\"></p>\n<p>路径：Proxy-&gt;Recording Settings-&gt;Include→Add</p>\n<p>在编辑框中填入要封的网络请求</p>\n<h3 id=\"关注特定的网络请求\">3.关注特定的网络请求</h3>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031195800560-631913134.png\" height=\"400\"></p>\n<p>在想要特定关注的网络请求那行，右键勾选\"Focus\"即可</p>\n<h2 id=\"三抓取手机网络包\">三、抓取手机网络包</h2>\n<hr>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031195843388-17102909.png\" width=\"500\" height=\"400\"></p>\n<p>前提：手机，电脑连结的是通一个wifi网络</p>\n<p>在菜单栏上选择 Proxy-&gt;Proxy Settings，填入代理端口 8888，并勾上 “Enable transparent HTTP proxying” 即完成了代理</p>\n<p>查看电脑IP地址</p>\n<p>在手机wifi网络中添加代理，输入电脑IP和charles的端口号 8888</p>\n<h3 id=\"抓https包\">抓HTTPS包</h3>\n<p>1.Mac安装SSL证书<br>\n<img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031195940029-1961501455.png\" height=\"500\"></p>\n<p>在Help→SSL Proxying→Install....</p>\n<p>选择后，就会出现证书下载，下载成功后会电脑”钥匙串访问“中看见(这里我已经安装并信任过了)，然后双击下载的证书，勾选信任即可。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031195959060-820654922.png\" width=\"500\" height=\"400\"></p>\n<p>2.手机安装SSL证书<br>\n<img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200649841-802705353.png\" height=\"400\"></p>\n<p>在SSL Proxying中勾选Install ...Mobile Device 会弹出一个框，用手机(处于代理状态下)登陆指定的url下载证书即可。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200026310-185324849.png\"></p>\n<p>这时候你抓https的时候还是发现不行，乱码加unknown（如下图）</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200037185-885857105.png\" height=\"400\"></p>\n<p>这时候我们还需要一步操作，就是将想要抓的https加入到SSL代理中，这样才能被Charles识别并解析</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200056451-593041837.png\" height=\"400\"></p>\n<p>选择我们要抓的请求，右键选择\"Enable SSL Proxying\"</p>\n<p>这时我们发现不再乱码和unknown了</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200121920-1435217047.png\" height=\"400\"></p>\n<h2 id=\"四网络限速\">四、网络限速</h2>\n<hr>\n<p>开发中常备限速，通常对于Chrome我们可以使用浏览器中的\"Network中Online修改\"，下拉还有3G等设置。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200150216-270391068.png\"></p>\n<p>但是通过代理我们可以做的更全更多</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200206716-160178505.png\" height=\"400\"></p>\n<p>在\"Proxy→Throttle Settings\"中，我们可以给所有的网络限速，也可以通过勾选\"Only for selected hosts\"限制指定的请求速度</p>\n<h2 id=\"五修改网络请求内容\">五、修改网络请求内容</h2>\n<hr>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200230529-466627556.png\" height=\"400\"></p>\n<p>选中一条网络请求，然后右键选择\"Compose\"，就会出现上图下半部分的框，可以修改几乎任何你可以想到的请求参数，点击\"Execute\"执行即可</p>\n<h2 id=\"六修改服务器返回的内容\">六、修改服务器返回的内容</h2>\n<hr>\n<p>1.Map Remote(Tools→Map Remote Settings)</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200906966-1386597355.png\" height=\"400\"></p>\n<p>将网络响应定向至另外一个网络服务，从而达到修改返回内容的目的</p>\n<p>2.Map Local(Tools-&gt;Map Local Settings)</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200919091-1562549870.png\" height=\"400\"></p>\n<p>将网络响应定向至本地文件，从而达到修改返回内容的目的</p>\n<p>3.Breakpoints替换返回内容（右键-&gt;Breakpoints）</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031200922966-1103069459.png\" height=\"400\"></p>\n<p>通过名称也可以看的出来，这个类似于一种断点的功能，代理会在发送请求的时候拦截并断点网络请求，这就为我们修改网络信息提供了便利。</p>\n<p>可以编辑请求的参数和返回的参数。</p>\n<h2 id=\"七反向代理\">七、反向代理</h2>\n<hr>\n<p>反向代理(Proxy→Reverse Proxies Settings)也是一个常用的功能，特别是对于本地开发且需要域名的情况下</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/743207/201710/743207-20171031201018373-1471785415.png\" height=\"400\"></p>\n<p>这个截图的意思是 将本地 57689端口映射到www.os.com域名的80端口</p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<p class=\"postfoot\">\r\n\t\t\tposted on <span id=\"post-date\">2017-10-31 21:45</span> <a href=\"http://www.cnblogs.com/zqzjs/\">leslie·Zhao</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7763406\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7763406);return false;\">收藏</a>\r\n\t\t</p>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=222631,cb_entryId=7763406,cb_blogApp=currentBlogApp,cb_blogUserGuid='7fd69ea2-f7df-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/10/31 21:45:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n\t</div>", "article_view": 199, "image_url": ["https://pic.cnblogs.com/face/743207/20150411111212.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "产品经理职责", "url": "http://www.cnblogs.com/hxqcom/p/7764152.html", "author": "超越自我，挑战无极限", "article_desc": "做为一名新进产品经理，你可能都或多或少对这个职位产生某种迷惑。到底什么是产品经理？这个职位的主要职责是什么？在IT产业的不同领域，甚至在同一领域的不同公司，这个职位的定义似乎都有不同。本文尝试根据自己产品经理经验，给出产品经理的主要职责。 虽然在不同的公司，产品经理的角色和职责互有差异，但是有一些关 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/hxqcom/p/7764152.html\">产品经理职责</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><span style='color: #000000; font-family: \"Microsoft YaHei\"; font-size: 15px'>        做为一名新进产品经理，你可能都或多或少对这个职位产生某种迷惑。到底什么是产品经理？这个职位的主要职责是什么？在IT产业的不同领域，甚至在同一领域的不同公司，这个职位的定义似乎都有不同。本文尝试根据自己产品经理经验，给出产品经理的主要职责。 虽然在不同的公司，产品经理的角色和职责互有差异，但是有一些关键职责是任何一个产品经理都应承担的。现将产品经理的职责整理如下：</span></p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/561186/201710/561186-20171031221200841-285347688.png\" alt=\"\"></p>\n<p> </p>\n<p><img src=\"http://images2017.cnblogs.com/blog/561186/201710/561186-20171031221905685-2143395633.png\" alt=\"\"></p>\n<p> </p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/561186/201710/561186-20171031221939029-1002672610.png\" alt=\"\"></p>\n<p> </p>\n<p> </p>\n<p><img src=\"http://images2017.cnblogs.com/blog/561186/201710/561186-20171031222008545-1071529129.png\" alt=\"\"></p>\n<p> </p>\n<p> </p>\n<p><img src=\"http://images2017.cnblogs.com/blog/561186/201710/561186-20171031222040982-1890010598.png\" alt=\"\"></p>\n<p> </p>\n<p> </p>\n<p><img src=\"http://images2017.cnblogs.com/blog/561186/201710/561186-20171031222130076-357148452.png\" alt=\"\"></p>\n<p> </p>\n<p> </p>\n<p><img src=\"http://images2017.cnblogs.com/blog/561186/201710/561186-20171031222139685-179293163.png\" alt=\"\"></p>\n<p> </p>\n<p> 希望这篇文章有助于你了解产品经理的职责，以及他们在公司中密切合作的部门，并祝你成长为一名优秀的产品经理。 </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 22:26</span> <a href=\"http://www.cnblogs.com/hxqcom/\">超越自我，挑战无极限</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7764152\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7764152);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=389895,cb_entryId=7764152,cb_blogApp=currentBlogApp,cb_blogUserGuid='8f278394-c00c-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/10/31 22:26:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 373, "image_url": ["https://pic.cnblogs.com/face/561186/20160429163551.png"], "date_pub": "2017-10-31", "article_common": 1}
{"title": "co源码分析及其实践", "url": "http://www.cnblogs.com/maskown/p/7763921.html", "author": "MaskOwn", "article_desc": "本文始发于 \"我的个人博客\" ，如需转载请注明出处。 为了更好的阅读体验，可以直接进去我的个人博客看。 前言 知识储备 阅读本文需要对 和`Promise`有一个基本的了解。 这里我简单地介绍一下两者的用法。 Generator 关于Generator的用法，推荐MDN上面的解释 \"function ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/maskown/p/7763921.html\">co源码分析及其实践</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><blockquote>\n<p>本文始发于<a href=\"https://vars.coding.me/articles/co%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E5%8F%8A%E5%85%B6%E5%AE%9E%E8%B7%B5.html\" title=\"MaskOwn\">我的个人博客</a>，如需转载请注明出处。<br>\n为了更好的阅读体验，可以直接进去我的个人博客看。</p>\n</blockquote>\n<h2 id=\"前言\">前言</h2>\n<h3 id=\"知识储备\">知识储备</h3>\n<p>阅读本文需要对<code>Generator</code>和<code>Promise</code>有一个基本的了解。</p>\n<p>这里我简单地介绍一下两者的用法。</p>\n<h4 id=\"generator\">Generator</h4>\n<p>关于Generator的用法，推荐MDN上面的解释<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/function*\">function *函数</a>，里面非常详细。</p>\n<p><strong>用一句话总结就是，<code>generator函数</code>是回调地狱的一种解决方案，它跟<code>promise</code>类似，但是却可以以同步的方式来书写代码，而避免了promise的链式调用。</strong></p>\n<p>它的执行过程在于调用<code>生成器函数（generator function）</code>后，会返回一个<code>iterator（迭代）对象</code>，即<code>Generator对象</code>，但是它并不会立刻执行里面的代码。</p>\n<p>它有几个方法，<code>next()</code>, <code>throw()</code>和<code>return()</code>。调用next()方法后，它会<em>找到第一个yield关键字（直到找到程序底部或者return语句）</em>，每次程序运行到yield关键字时，程序便会<em>暂停</em>，保存当前环境里面的变量的值，然后可以跳出当前运行环境去执行yield后面的代码，再把结果返回回来。</p>\n<p>返回的结果是一个对象，类似于<code>{value: '', done: false}</code>, value表示本次yield后面执行之后返回的结果。如果是Promise实例，则是返回resolved后的值。done表示迭代器是否执行完毕，若为<code>true</code>，则表示当前生成器函数已经产生了最后输出的值，即生成器函数已经返回。</p>\n<p>下面是一个简单的例子：</p>\n<pre class=\"$xslt\"><code>const gen = function *() {\n  let index = 0;\n  while(index &lt; 3)\n    yield index++;\n  return 'All done.'\n};\n\nconst g = gen();\nconsole.log(g.constructor); // output: GeneratorFunction {}\nconsole.log(g.next()); // output: { value: 0, done: false }\nconsole.log(g.next()); // output: { value: 1, done: false }\nconsole.log(g.next()); // output: { value: 2, done: false }\nconsole.log(g.next()); // output: { value: 'All done.', done: true }\nconsole.log(g.next()); // output: { value: undefined, done: true }</code></pre>\n<h4 id=\"promise\">Promise</h4>\n<p>关于<code>Promise</code>的用法，可以查阅我之前写过的一篇文章<a href=\"https://vars.coding.me/articles/ES6%E4%B8%AD%E7%9A%84Promise%E7%94%A8%E6%B3%95.html\">《关于ES6中Promise的用法》</a>，写得比较详细。</p>\n<p><em>Promise对象用于一个异步操作的最终完成（或失败）及其结果值的表示(简单点说就是处理异步请求）</em>。Promise核心就在于里面<em>状态的变换</em>，是<code>rejected</code>、<code>resolved</code>还是<code>pending</code>，还有就是原型链上的<code>then()</code>方法，它可以传递本次状态转换后返回的值。</p>\n<h3 id=\"进入主题\">进入主题</h3>\n<p>由于实际需要，这几天学习了<code>koa2.x</code>框架，但是它已经不推荐使用generator函数了，推荐用<code>async/await</code>组合。</p>\n<p>koa2.x的最新用法：</p>\n<blockquote>\n<p>async/await(node v7.6+):</p>\n</blockquote>\n<pre><code>const Koa = require('koa');\nconst app = new Koa();\n\napp.use(async (ctx, next) =&gt; {\n  const start = Date.now();\n  await next();\n  const ms = Date.now() - start;\n  console.log(`${ctx.method} ${ctx.url} - ${ms}ms`);\n});</code></pre>\n<blockquote>\n<p>common 用法:</p>\n</blockquote>\n<pre><code>const Koa = require('koa');\nconst app = new Koa();\n\n// response\napp.use(ctx =&gt; {\n  ctx.body = 'Hello Koa';\n});\n\napp.listen(3000);</code></pre>\n<p>由于本地的Node版本是<code>v6.11.5</code>，而使用async/await则需要Node版本<code>v7.6</code>以上，所以我想有没有什么模块能够把koa2.x版本的语法<em>兼容koa1.x的语法</em>。koa1.x语法的关键在于<code>generator/yield</code>组合。通过yield可以很方便地暂停程序的执行，并改变执行环境。</p>\n<p>这时候我找到了<code>TJ大神写的co模块</code>，它可以让异步流程同步化，还有<code>koa-convert</code>模块等等，这里着重介绍co模块。</p>\n<p>co在koa2.x里面的用法如下：</p>\n<pre><code>const Koa = require('koa');\nconst app = new Koa();\nconst co = require('co');\n\n// response\napp.use(co.wrap(function *(ctx, next) {\n  yield next();\n  // yield someAyncOperation;\n  //  ... \n  ctx.body = 'co';\n}));\n\napp.listen(3000);</code></pre>\n<p><strong>co模块不仅可以配合koa框架充当中间件的转换函数使用，还支持批量执行generator函数，这样就无需手动调用多次next()来获取结果了。</strong></p>\n<p>它支持的参数有<code>函数、promise、generator、数组和对象</code>。</p>\n<pre class=\"$xslt\"><code>// co的源码\nreturn onRejected(new TypeError('You may only yield a function, promise, generator, array, or object, '\n        + 'but the following object was passed: \"' + String(ret.value) + '\"'));</code></pre>\n<p>下面举一个co传递进来一个generator函数的例子：</p>\n<pre class=\"$xslt\"><code>// 这里模拟一个generator函数调用\nconst co = require('co');\n\nco(gen).then(data =&gt; {\n  // output: then: ALL Done.\n  console.log('then: ' + data);\n});\n\nfunction *gen() {\n  let data1 = yield pro1();\n  // output: pro1 had resolved, data1 = I am promise1\n  console.log('pro1 had resolved, data1 = ' + data1);\n\n  let data2 = yield pro2();\n  // output: pro2 had resolved, data2 = I am promise2\n  console.log('pro2 had resolved, data2 = ' + data2);\n\n  return 'ALL Done.'\n}\n\nfunction pro1() {\n  return new Promise((resolve, reject) =&gt; {\n    setTimeout(resolve, 2000, 'I am promise1');\n  });\n}\n\nfunction pro2() {\n  return new Promise((resolve, reject) =&gt; {\n    setTimeout(resolve, 1000, 'I am promise2');\n  });\n}</code></pre>\n<p>我觉得co()函数很神奇，里面究竟经过了什么样的转换？抱着一颗好奇心，读了一下co的源码。</p>\n<h2 id=\"co源码分析\">co源码分析</h2>\n<h3 id=\"主要脉络\">主要脉络</h3>\n<p><strong>co函数调用后，返回一个Promise实例</strong>。</p>\n<p>co的思想就是将一个传递进来的参数进行<em>合法化</em>，再通过转换成Promise实例返回出去。如果参数<code>fn是generator函数</code>的话，里面还可以<em>自动进行遍历</em>，执行generator函数里面的yield关键字后面的内容，并返回结果，也就是不断地调用<code>fn().next()</code>方法，再通过传递返回的Promise实例<code>resolved</code>后的值，从而达到<em>同步执行generator函数</em>的效果。</p>\n<p>这里要注意，<strong>co里面最主要的是要理解Promise实例和Generator对象，它们是co函数里面的程序自动遍历执行的关键</strong>。</p>\n<p>下面解释一下co模块里面的最重要的两部分，<em>一个是generator函数的自动调用，另外一个是参数的Promise化</em>。</p>\n<p>第一，generator函数的自动调用(中文部分是我的解释)：</p>\n<pre class=\"$xslt\"><code>function co(gen) {\n  // 保存当前的执行环境\n  var ctx = this;\n  // 切割出函数调用时传递的参数\n  var args = slice.call(arguments, 1)\n\n  // we wrap everything in a promise to avoid promise chaining,\n  // which leads to memory leak errors.\n  // see https://github.com/tj/co/issues/180\n  \n  // 返回一个Promise实例\n  return new Promise(function(resolve, reject) {\n    // 如果gen是一个函数，则返回一个新的gen函数的副本，\n    // 里面绑定了this的指向，即ctx\n    if (typeof gen === 'function') gen = gen.apply(ctx, args);\n    \n    // 如果gen不存在或者gen.next不是一个函数\n    // 就说明gen已经调用完成,\n    // 那么直接可以resolve(gen)，返回Promise\n    if (!gen || typeof gen.next !== 'function') return resolve(gen);\n\n    // 首次调用gen.next()函数，假如存在的话\n    onFulfilled();\n\n    /**\n     * @param {Mixed} res\n     * @return {Promise}\n     * @api private\n     */\n\n    function onFulfilled(res) {\n      var ret;\n      try {\n        // 尝试着获取下一个yield后面代码执行后返回的值\n        ret = gen.next(res);\n      } catch (e) {\n        return reject(e);\n      }\n      // 处理结果\n      next(ret);\n    }\n\n    /**\n     * @param {Error} err\n     * @return {Promise}\n     * @api private\n     */\n\n    function onRejected(err) {\n      var ret;\n      try {\n        // 尝试抛出错误\n        ret = gen.throw(err);\n      } catch (e) {\n        return reject(e);\n      }\n      // 处理结果\n      next(ret);\n    }\n\n    /**\n     * Get the next value in the generator,\n     * return a promise.\n     *\n     * @param {Object} ret\n     * @return {Promise}\n     * @api private\n     */\n\n    // 这个next()函数是最为关键的一部分，\n    // 里面几乎包含了generator自动调用实现的核心\n    function next(ret) {\n      // 如果ret.done === true, \n      // 证明generator函数已经执行完毕\n      // 即已经返回了值\n      if (ret.done) return resolve(ret.value);\n      \n      // 把ret.value转换成Promise对象继续调用\n      var value = toPromise.call(ctx, ret.value);\n      \n      // 如果存在，则把控制权交给onFulfilled和onRejected，\n      // 实现递归调用\n      if (value &amp;&amp; isPromise(value)) return value.then(onFulfilled, onRejected);\n      \n      // 否则最后直接抛出错误\n      return onRejected(new TypeError('You may only yield a function, promise, generator, array, or object, '\n        + 'but the following object was passed: \"' + String(ret.value) + '\"'));\n    }\n  });\n}</code></pre>\n<p>对于以上代码中的<code>onFulfilled</code>和<code>onRejected</code>，我们可以把它们看成是co模块对于<code>resolve</code>和<code>reject</code>封装的加强版。</p>\n<p>第二，参数Promise化，我们来看一下co中的toPromise的实现：</p>\n<pre class=\"$xslt\"><code>function toPromise(obj) {\n  if (!obj) return obj;\n  if (isPromise(obj)) return obj;\n  if (isGeneratorFunction(obj) || isGenerator(obj)) return co.call(this, obj);\n  if ('function' == typeof obj) return thunkToPromise.call(this, obj);\n  if (Array.isArray(obj)) return arrayToPromise.call(this, obj);\n  if (isObject(obj)) return objectToPromise.call(this, obj);\n  return obj;\n}</code></pre>\n<p><em>toPromise的本质上就是通过判定参数的类型，然后再通过转移控制权给不同的参数处理函数，从而获取到期望返回的值。</em></p>\n<p>关于参数的类型的判断，看一下源码就能理解了，比较简单。</p>\n<p>我们着重来分析一下objectToPromise的实现：</p>\n<pre class=\"$xslt\"><code>function objectToPromise(obj){\n  // 获取一个和传入的对象一样构造器的对象\n  var results = new obj.constructor();\n  \n  // 获取对象的所有可以遍历的key\n  var keys = Object.keys(obj);\n  var promises = [];\n  for (var i = 0; i &lt; keys.length; i++) {\n    var key = keys[i];\n    \n    // 对于数组的每一个项都调用一次toPromise方法，变成Promise对象\n    var promise = toPromise.call(this, obj[key]);\n    \n    // 如果里面是Promise对象的话，则取出e里面resolved后的值\n    if (promise &amp;&amp; isPromise(promise)) defer(promise, key);\n    else results[key] = obj[key];\n  }\n  \n  // 并行，按顺序返回结果，返回一个数组\n  return Promise.all(promises).then(function () {\n    return results;\n  });\n\n  // 根据key来获取Promise实例resolved后的结果，\n  // 从而push进结果数组results中\n  function defer(promise, key) {\n    // predefine the key in the result\n    results[key] = undefined;\n    promises.push(promise.then(function (res) {\n      results[key] = res;\n    }));\n  }\n}</code></pre>\n<p>上面理解的关键就在于把<em>key遍历</em>，如果<code>key</code>对应的<code>value</code>也是<code>Promise</code>对象的话，那么调用<code>defer()</code>方法来获取<code>resolved</code>后的值。</p>\n<h2 id=\"编写自己的generator函数运行器\">编写自己的generator函数运行器</h2>\n<p>通过以上的简单介绍，我们就可以尝试来写一个属于自己的<em>generator函数运行器</em>了，目标功能是能够自动运行<code>function*</code>函数，并且里面的<code>yield子句</code>后面跟着的都是<code>Promise实例</code>。</p>\n<p>具体代码(<code>my-co.js</code>)如下：</p>\n<pre class=\"$xslt\"><code>// my-co.js\nmodule.exports = my-co;\n\nlet my-co = function (gen) {\n  // gen是一个具有Promise的生成器函数\n  const g = gen(); // 迭代器\n  \n  // 首次调用next\n  next();\n\n  function next(val) {\n    let ret = g.next(val); // 调用ret\n    if (ret.done) {\n      return ret.value;\n    }\n\n    if (ret &amp;&amp; 'function' === typeof ret.value.then) {\n      ret.value.then( (data) =&gt; {\n        // 继续循环下去\n        return next(data); // promise resolved\n      });\n    }\n  }\n};</code></pre>\n<p>这样我们就可以在<code>test.js</code>文件中调用了:</p>\n<pre class=\"$xslt\"><code>// test.js\nconst myCo = require('./my-co');\nconst fs = require('fs');\n\nlet gen = function *() {\n  let data1 = yield pro1();\n  console.log('data1: ' + data1);\n\n  let data2 = yield pro2();\n  console.log('data2: ' + data2);\n\n  let data3 = yield pro3();\n  console.log('data3: ' + data3);\n\n  let data4 = yield pro4(data1 + '\\n' + data2 + '\\n' + data3);\n  console.log('data4: ' + data4);\n\n  return 'All done.'\n};\n\n// 调用myCo\nmyCo(gen);\n\n// 延迟两秒resolve\nfunction pro1() {\n  return new Promise((resolve, reject) =&gt; {\n    setTimeout(resolve, 2000, 'promise1 resolved');\n  });\n}\n\n// 延迟一秒resolve\nfunction pro2() {\n  return new Promise((resolve, reject) =&gt; {\n    setTimeout(resolve, 1000, 'promise2 resolved');\n  });\n}\n\n// 写入Hello World到./1.txt文件中\nfunction pro3() {\n  return new Promise((resolve, reject) =&gt; {\n    fs.appendFile('./1.txt', 'Hello World\\n', function(err) {\n      resolve('write-1 success');\n    });\n  });\n}\n\n// 写入content到./1.txt文件中\nfunction pro4(content) {\n  return new Promise((resolve, reject) =&gt; {\n    fs.appendFile('./1.txt', content, function(err) {\n      resolve('write-2 success');\n    });\n  });\n}\n</code></pre>\n<p>控制台输出结果：</p>\n<pre class=\"$xslt\"><code>// output\ndata1: promise1 resolved\ndata2: promise2 resolved\ndata3: write-1 success\ndata4: write-2 success</code></pre>\n<p><code>./1.txt</code>文件内容：</p>\n<pre class=\"$xslt\"><code>Hello World\npromise1 resolved\npromise2 resolved\nwrite-1 success</code></pre>\n<p>由上可知，运行的结果符合我们的期望。</p>\n<p>虽然这个运行器很简单，后面只支持Promise实例，并且也不支持多种参数，但是却引导出了一个思路，促使我们思考怎么去展示我们的代码，还有就是很有效地避免了<em>多重then</em>，以<strong>同步的方式来书写异步代码</strong>。Promise解决的是<code>回调地狱</code>的问题（<code>callback hell</code>）,而Generator解决的是代码的书写方式。孰优孰劣，全在于个人意愿。</p>\n<h2 id=\"总结\">总结</h2>\n<p>以上分析了co部分源码的精髓，讲到了co函数里面generator函数自动遍历执行的机制，还讲到了co里面最为关键的<code>objectToPromise()</code>方法。</p>\n<p>在文章的后面我们编写了一个属于自己的generator函数遍历器，其中主要的是next()方法，<em>它可以检测我们yield后面Promise操作是否完成</em>。如果generator的状态<code>done</code>还没有置为<code>true</code>，那么继续调用<code>next(val)</code>方法，并把上一次<code>yield</code>操作获取到的值传递下去。</p>\n<p>有时候在引用别人的模块出现问题时，如果在网上找不到自己期望的答案，那么我们可以根据自己的能力来选择性地分析一下作者的源码，<strong>看源码是一种很好的成长方式</strong>。</p>\n<p>坦白说，这是我第一次深入分析模块的源码，co模块的源码包括注释和空行只有<code>230多行</code>左右，所以这是一个很好的切入点。里面代码虽少，但是理解却不易。</p>\n<p><em>如果以上所述有什么问题，欢迎反馈。</em></p>\n<p>感谢支持。</p>\n<h2 id=\"参考链接\">参考链接</h2>\n<ol>\n<li><p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise\">MDN - Promise解释</a></p></li>\n<li><p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Generator\">MDN - Generator对象的用法</a></p></li>\n<li><p><a href=\"https://github.com/tj/co/blob/master/index.js\">TJ - co的源码及其用法</a></p></li>\n</ol>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 21:48</span> <a href=\"http://www.cnblogs.com/maskown/\">MaskOwn</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7763921\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7763921);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=389559,cb_entryId=7763921,cb_blogApp=currentBlogApp,cb_blogUserGuid='070783ec-e458-4fd5-ed52-08d4ef52ecb5',cb_entryCreatedDate='2017/10/31 21:48:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 100, "image_url": ["https://pic.cnblogs.com/face/1245964/20171020200958.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "Python多进程应用", "url": "http://www.cnblogs.com/deeper/p/7760463.html", "author": "Winter_Ding", "article_desc": "在我之前的一篇博文中详细介绍了Python多线程的应用： 进程，线程，GIL，Python多线程，生产者消费者模型都是什么鬼 但是由于GIL的存在，使得python多线程没有充分利用CPU的多核，为了利用多核，我可以采用多进程； 1. 父进程与子进程 wiki上对于父进程与子进程的定义： a）Par ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/deeper/p/7760463.html\">Python多进程应用</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>在我之前的一篇博文中详细介绍了Python多线程的应用：</p>\n<h4><strong> <a id=\"cb_post_title_url\" class=\"postTitle2\" title=\"进程，线程，GIL，Python多线程，生产者消费者模型都是什么鬼\" href=\"http://www.cnblogs.com/deeper/p/7730203.html\" target=\"_blank\">进程，线程，GIL，Python多线程，生产者消费者模型都是什么鬼</a></strong></h4>\n<p>但是由于GIL的存在，使得python多线程没有充分利用CPU的多核，为了利用多核，我可以采用多进程；</p>\n<h2>1. 父进程与子进程</h2>\n<p>wiki上对于父进程与子进程的定义：</p>\n<p id=\"firstHeading\" class=\"firstHeading\" lang=\"en\">a）Parent process</p>\n<p class=\"firstHeading\" lang=\"en\">In <a title=\"Unix-like\" href=\"https://en.wikipedia.org/wiki/Unix-like\">Unix-like</a> <a title=\"Operating system\" href=\"https://en.wikipedia.org/wiki/Operating_system\">operating systems</a>, every process except <span class=\"nowrap\"><a title=\"Linux startup process\" href=\"https://en.wikipedia.org/wiki/Linux_startup_process\">process 0</a> (the swapper) is created when another process executes the <a class=\"mw-redirect\" title=\"Fork (operating system)\" href=\"https://en.wikipedia.org/wiki/Fork_(operating_system)\">fork()</a> <a title=\"System call\" href=\"https://en.wikipedia.org/wiki/System_call\">system call</a>. The process that invoked fork is the <em>parent process</em> and the newly created process is the <em>child process</em>. Every process (except process 0) has one parent process, but can have many child processes.</span></p>\n<p>In the <a title=\"Linux kernel\" href=\"https://en.wikipedia.org/wiki/Linux_kernel\">Linux kernel</a>, in which there is a very slim difference between processes and <a class=\"mw-redirect\" title=\"POSIX threads\" href=\"https://en.wikipedia.org/wiki/POSIX_threads\">POSIX threads</a>, there are two kinds of parent processes, namely real parent and parent. Parent is the process that receives the <em>SIGCHLD</em> signal on child's termination, whereas real parent is the thread that actually created this child process in a multithreaded environment. For a normal process, both these two values are same, but for a POSIX thread which acts as a process, these two values may be different.<sup id=\"cite_ref-1\" class=\"reference\"><a href=\"https://en.wikipedia.org/wiki/Parent_process#cite_note-1\">[1]</a></sup></p>\n<p>b）Child process</p>\n<p>A child process in computing is a <a title=\"Process (computing)\" href=\"https://en.wikipedia.org/wiki/Process_(computing)\">process</a> created by another process (the <a title=\"Parent process\" href=\"https://en.wikipedia.org/wiki/Parent_process\">parent process</a>). This technique pertains to <a title=\"Computer multitasking\" href=\"https://en.wikipedia.org/wiki/Computer_multitasking\">multitasking operating systems</a>, and is sometimes called a <strong>subprocess</strong> or traditionally a <strong>subtask</strong>.</p>\n<p>There are two major procedures for creating a child process: the <a title=\"Fork (system call)\" href=\"https://en.wikipedia.org/wiki/Fork_(system_call)\">fork system call</a> (preferred in <a title=\"Unix-like\" href=\"https://en.wikipedia.org/wiki/Unix-like\">Unix-like</a> systems and the <a title=\"POSIX\" href=\"https://en.wikipedia.org/wiki/POSIX\">POSIX</a> standard) and the <a title=\"Spawn (computing)\" href=\"https://en.wikipedia.org/wiki/Spawn_(computing)\">spawn</a> (preferred in the <a title=\"Ntoskrnl.exe\" href=\"https://en.wikipedia.org/wiki/Ntoskrnl.exe\">modern (NT) kernel</a> of <a title=\"Microsoft Windows\" href=\"https://en.wikipedia.org/wiki/Microsoft_Windows\">Microsoft Windows</a>, as well as in some historical operating systems).</p>\n<p>即，Unix/Linux操作系统提供了一个<code>fork()</code>系统调用，用于创建子进程；fork()非常特殊。普通的函数调用，调用一次，返回一次，但是<strong><code>fork()</code>调用一次，返回两次，因为操作系统自动把当前进程（称为父进程）复制了一份（称为子进程），然后，分别在父进程和子进程内返回。对于返回值，子进程永远返回<code>0</code>，而父进程返回子进程的ID。这样做的理由是，一个父进程可以fork出很多子进程，所以，父进程要记下每个子进程的ID；</strong></p>\n<p>python的os模块，就含有fork函数：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">#</span><span style=\"color: #008000\">!/bin/env python</span><span style=\"color: #008000\">\n#</span><span style=\"color: #008000\">coding:utf-8</span>\n\n<span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> os\n</span><span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> time\n\n</span><span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">Process %s start...</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> os.getpid())\npid </span>=<span style=\"color: #000000\"> os.fork()\n</span><span style=\"color: #0000ff\">if</span> pid ==<span style=\"color: #000000\"> 0:\n    </span><span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">i am child process %s and my parent is %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (os.getpid(), os.getppid()))\n</span><span style=\"color: #0000ff\">else</span><span style=\"color: #000000\">:\n    </span><span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">i %s just created a child process %s</span><span style=\"color: #800000\">'</span> % (os.getpid(), pid))</pre>\n</div>\n<p>运行结果：</p>\n<div class=\"cnblogs_code\">\n<pre>Process 3522<span style=\"color: #000000\"> start...\ni </span>3522 just created a child process 3523<span style=\"color: #000000\">\ni am child process </span>3523 <span style=\"color: #0000ff\">and</span> my parent <span style=\"color: #0000ff\">is</span> 3522</pre>\n</div>\n<p>因为fork()调用一次，返回两次，所以得到上面的结果；这里注意：<strong>由于Windows没有<code>fork</code>调用，上面的代码在Windows上无法运行；</strong>有了<code>fork</code>调用，一个进程在接到新任务时就可以复制出一个子进程来处理新任务，常见的Apache服务器就是由父进程监听端口，每当有新的http请求时，就fork出子进程来处理新的http请求。</p>\n<h2>2. multiprocessing</h2>\n<p>上面说到windows没有fork调用，那么如何在windows上实现多进程呢？</p>\n<p>通过multiprocess模块，由于Python是跨平台的，自然也应该提供一个跨平台的多进程支持。<strong><code>multiprocessing</code>模块就是跨平台版本的多进程模块</strong>。</p>\n<p>python中两个常用来处理进程的模块分别是subprocess和multiprocessing，其中subprocess通常用于执行外部程序，比如一些第三方应用程序，而不是Python程序。如果需要实现调用外部程序的功能，python的<a href=\"https://pypi.python.org/pypi/psutil/1.2.1\" target=\"_blank\">psutil模块</a>是更好的选择，它不仅支持subprocess提供的功能，而且还能对当前主机或者启动的外部程序进行监控，比如获取网络、cpu、内存等信息使用情况，在做一些自动化运维工作时支持的更加全面。multiprocessing是python的多进程模块，主要通过启动python进程，调用target回调函数来处理任务。</p>\n<p>注意：multiprocessing的方法与threading的方法类似，所以我们这里只给出示例代码，而不做详细介绍；</p>\n<h3>1）multiprocessing基本使用</h3>\n<p>与threading类似，也是有两种方式</p>\n<p>a）直接调用</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">from</span> multiprocessing <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> Process, freeze_support\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> os\n</span><span style=\"color: #008080\"> 3</span> \n<span style=\"color: #008080\"> 4</span> processes =<span style=\"color: #000000\"> []\n</span><span style=\"color: #008080\"> 5</span> \n<span style=\"color: #008080\"> 6</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> run(item):\n</span><span style=\"color: #008080\"> 7</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">-</span><span style=\"color: #800000\">'</span>*50<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 8</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">child process %s id: %s</span><span style=\"color: #800000\">'</span>%<span style=\"color: #000000\">(item, os.getpid()))\n</span><span style=\"color: #008080\"> 9</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">child process %s parent id: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (item, os.getppid()))\n</span><span style=\"color: #008080\">10</span> \n<span style=\"color: #008080\">11</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> main():\n</span><span style=\"color: #008080\">12</span>     <span style=\"color: #008000\">#</span><span style=\"color: #008000\">打印主进程进程号</span>\n<span style=\"color: #008080\">13</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">main process id: </span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">, os.getpid())\n</span><span style=\"color: #008080\">14</span>     <span style=\"color: #008000\">#</span><span style=\"color: #008000\">创建多个子进程</span>\n<span style=\"color: #008080\">15</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span> range(2<span style=\"color: #000000\">):\n</span><span style=\"color: #008080\">16</span>         p = Process(target=run, args=<span style=\"color: #000000\">(item, ))\n</span><span style=\"color: #008080\">17</span> <span style=\"color: #000000\">        processes.append(p)\n</span><span style=\"color: #008080\">18</span>         <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">child process %s name: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (item, p.name))\n</span><span style=\"color: #008080\">19</span>         <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">child process %s id: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (item, p.pid))\n</span><span style=\"color: #008080\">20</span> \n<span style=\"color: #008080\">21</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> processes:\n</span><span style=\"color: #008080\">22</span> <span style=\"color: #000000\">        item.start()\n</span><span style=\"color: #008080\">23</span> \n<span style=\"color: #008080\">24</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> processes:\n</span><span style=\"color: #008080\">25</span> <span style=\"color: #000000\">        item.join()\n</span><span style=\"color: #008080\">26</span> \n<span style=\"color: #008080\">27</span> <span style=\"color: #0000ff\">if</span> <span style=\"color: #800080\">__name__</span> == <span style=\"color: #800000\">'</span><span style=\"color: #800000\">__main__</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\">28</span> <span style=\"color: #000000\">    main()\n</span><span style=\"color: #008080\">29</span>     freeze_support()</pre>\n</div>\n<p>b）面向对象方式调用</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">from</span> multiprocessing <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> Process, freeze_support\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> os\n</span><span style=\"color: #008080\"> 3</span> \n<span style=\"color: #008080\"> 4</span> processes =<span style=\"color: #000000\"> []\n</span><span style=\"color: #008080\"> 5</span> \n<span style=\"color: #008080\"> 6</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> MyProcess(Process):\n</span><span style=\"color: #008080\"> 7</span>     <span style=\"color: #0000ff\">def</span> <span style=\"color: #800080\">__init__</span><span style=\"color: #000000\">(self, func, item):\n</span><span style=\"color: #008080\"> 8</span>         super(MyProcess, self).<span style=\"color: #800080\">__init__</span><span style=\"color: #000000\">()\n</span><span style=\"color: #008080\"> 9</span>         self.<span style=\"color: #800080\">__func</span> =<span style=\"color: #000000\"> func\n</span><span style=\"color: #008080\">10</span>         self.<span style=\"color: #800080\">__item</span> =<span style=\"color: #000000\"> item\n</span><span style=\"color: #008080\">11</span> \n<span style=\"color: #008080\">12</span>     <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> run(self):\n</span><span style=\"color: #008080\">13</span>         self.<span style=\"color: #800080\">__func</span>(self.<span style=\"color: #800080\">__item</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">14</span> \n<span style=\"color: #008080\">15</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> proc(item):\n</span><span style=\"color: #008080\">16</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">-</span><span style=\"color: #800000\">'</span>*50<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">17</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">child process %s id: %s</span><span style=\"color: #800000\">'</span>%<span style=\"color: #000000\">(item, os.getpid()))\n</span><span style=\"color: #008080\">18</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">child process %s parent id: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (item, os.getppid()))\n</span><span style=\"color: #008080\">19</span> \n<span style=\"color: #008080\">20</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> main():\n</span><span style=\"color: #008080\">21</span>     <span style=\"color: #008000\">#</span><span style=\"color: #008000\">打印主进程进程号</span>\n<span style=\"color: #008080\">22</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">main process id: </span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">, os.getpid())\n</span><span style=\"color: #008080\">23</span>     <span style=\"color: #008000\">#</span><span style=\"color: #008000\">创建多个子进程</span>\n<span style=\"color: #008080\">24</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span> range(2<span style=\"color: #000000\">):\n</span><span style=\"color: #008080\">25</span>         p =<span style=\"color: #000000\"> MyProcess(proc, item)\n</span><span style=\"color: #008080\">26</span> <span style=\"color: #000000\">        processes.append(p)\n</span><span style=\"color: #008080\">27</span>         <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">child process %s name: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (item, p.name))\n</span><span style=\"color: #008080\">28</span>         <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">child process %s id: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (item, p.pid))\n</span><span style=\"color: #008080\">29</span> \n<span style=\"color: #008080\">30</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> processes:\n</span><span style=\"color: #008080\">31</span> <span style=\"color: #000000\">        item.start()\n</span><span style=\"color: #008080\">32</span> \n<span style=\"color: #008080\">33</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> processes:\n</span><span style=\"color: #008080\">34</span> <span style=\"color: #000000\">        item.join()\n</span><span style=\"color: #008080\">35</span> \n<span style=\"color: #008080\">36</span> <span style=\"color: #0000ff\">if</span> <span style=\"color: #800080\">__name__</span> == <span style=\"color: #800000\">'</span><span style=\"color: #800000\">__main__</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\">37</span> <span style=\"color: #000000\">    main()\n</span><span style=\"color: #008080\">38</span>     freeze_support()</pre>\n</div>\n<p>注：2.7中，if __name__ == '__main__'的代码块中必须加上freeze_support()，python3好像不需要了</p>\n<p>结果：</p>\n<div class=\"cnblogs_code\">\n<pre>main process id:  10972<span style=\"color: #000000\">\nchild process 0 name: MyProcess</span>-1<span style=\"color: #000000\">\nchild process 0 id: None\nchild process </span>1 name: MyProcess-2<span style=\"color: #000000\">\nchild process </span>1<span style=\"color: #000000\"> id: None\n</span>--------------------------------------------------<span style=\"color: #000000\">\nchild process 0 id: </span>10636<span style=\"color: #000000\">\nchild process 0 parent id: </span>10972\n--------------------------------------------------<span style=\"color: #000000\">\nchild process </span>1 id: 8076<span style=\"color: #000000\">\nchild process </span>1 parent id: 10972</pre>\n</div>\n<h3>2）daemon属性设置</h3>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">from</span> multiprocessing <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> Process\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> time\n</span><span style=\"color: #008080\"> 3</span> \n<span style=\"color: #008080\"> 4</span> processes =<span style=\"color: #000000\"> []\n</span><span style=\"color: #008080\"> 5</span> \n<span style=\"color: #008080\"> 6</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> run(item):\n</span><span style=\"color: #008080\"> 7</span>     time.sleep(1<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 8</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">item: </span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">, item)\n</span><span style=\"color: #008080\"> 9</span> \n<span style=\"color: #008080\">10</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> main():\n</span><span style=\"color: #008080\">11</span>     <span style=\"color: #008000\">#</span><span style=\"color: #008000\">创建多个子进程</span>\n<span style=\"color: #008080\">12</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span> range(2<span style=\"color: #000000\">):\n</span><span style=\"color: #008080\">13</span>         p = Process(target=run, args=<span style=\"color: #000000\">(item, ))\n</span><span style=\"color: #008080\">14</span> <span style=\"color: #000000\">        processes.append(p)\n</span><span style=\"color: #008080\">15</span>         p.daemon =<span style=\"color: #000000\"> True\n</span><span style=\"color: #008080\">16</span> \n<span style=\"color: #008080\">17</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> processes:\n</span><span style=\"color: #008080\">18</span> <span style=\"color: #000000\">        item.start()\n</span><span style=\"color: #008080\">19</span> \n<span style=\"color: #008080\">20</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">all done</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">21</span> \n<span style=\"color: #008080\">22</span> <span style=\"color: #0000ff\">if</span> <span style=\"color: #800080\">__name__</span> == <span style=\"color: #800000\">'</span><span style=\"color: #800000\">__main__</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\">23</span>     main()</pre>\n</div>\n<p>结果：</p>\n<div class=\"cnblogs_code\">\n<pre>all done</pre>\n</div>\n<p>注意daemon和threading的方式不同，这里是直接设置属性，而不是调用方法；另外要在start前设置daemon；</p>\n<h3>3）进程同步</h3>\n<p>既然进程之间不共享数据，为什么还有进程同步问题呢？如果多个进程打开同一个文件，在同一个屏幕输出呢？这些还是需要进程同步的，通过Lock</p>\n<h3>4）Semaphore</h3>\n<p>同threading.Semaphore()用法相同，只是创建的Semaphore需要作为参数传入子进程，因为进程间不共享资源</p>\n<h3>5）Event</h3>\n<p>同threading.Event()用法相同，只是创建的Event需要作为参数传入子进程</p>\n<h3>6）进程间通讯</h3>\n<p>因为进程之间不共享资源，我们先看一个例子证明一下：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">from</span> multiprocessing <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> Process\n</span><span style=\"color: #008080\"> 2</span> \n<span style=\"color: #008080\"> 3</span> processes =<span style=\"color: #000000\"> []\n</span><span style=\"color: #008080\"> 4</span> data_list =<span style=\"color: #000000\"> []\n</span><span style=\"color: #008080\"> 5</span> \n<span style=\"color: #008080\"> 6</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> run(lst, item):\n</span><span style=\"color: #008080\"> 7</span> <span style=\"color: #000000\">    lst.append(item)\n</span><span style=\"color: #008080\"> 8</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">%s : %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> (item, lst))\n</span><span style=\"color: #008080\"> 9</span> \n<span style=\"color: #008080\">10</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> main():\n</span><span style=\"color: #008080\">11</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span> range(4<span style=\"color: #000000\">):\n</span><span style=\"color: #008080\">12</span>         p = Process(target=run, args=<span style=\"color: #000000\">(data_list, item))\n</span><span style=\"color: #008080\">13</span> <span style=\"color: #000000\">        processes.append(p)\n</span><span style=\"color: #008080\">14</span> \n<span style=\"color: #008080\">15</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> processes:\n</span><span style=\"color: #008080\">16</span> <span style=\"color: #000000\">        item.start()\n</span><span style=\"color: #008080\">17</span> \n<span style=\"color: #008080\">18</span>     <span style=\"color: #0000ff\">for</span> item <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> processes:\n</span><span style=\"color: #008080\">19</span> <span style=\"color: #000000\">        item.join()\n</span><span style=\"color: #008080\">20</span> \n<span style=\"color: #008080\">21</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">final lst: </span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">, data_list)\n</span><span style=\"color: #008080\">22</span> \n<span style=\"color: #008080\">23</span> <span style=\"color: #0000ff\">if</span> <span style=\"color: #800080\">__name__</span> == <span style=\"color: #800000\">'</span><span style=\"color: #800000\">__main__</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\">24</span>     main()</pre>\n</div>\n<p>结果：</p>\n<div class=\"cnblogs_code\">\n<pre>1 : [1<span style=\"color: #000000\">]\n</span>2 : [2<span style=\"color: #000000\">]\n0 : [0]\n</span>3 : [3<span style=\"color: #000000\">]\nfinal lst:  []</span></pre>\n</div>\n<p>所以必须通过第三方实现进程间通讯，下面介绍3种方法</p>\n<p><strong>a）Queue</strong></p>\n<p>用法与queue.Queue在多线程中的应用相同，只是创建的queue要作为参数传入子进程</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">from</span> multiprocessing <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> Process, Queue\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> time\n</span><span style=\"color: #008080\"> 3</span> \n<span style=\"color: #008080\"> 4</span> q = Queue(10<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 5</span> \n<span style=\"color: #008080\"> 6</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> put(q):\n</span><span style=\"color: #008080\"> 7</span>     <span style=\"color: #0000ff\">for</span> i <span style=\"color: #0000ff\">in</span> range(3<span style=\"color: #000000\">):\n</span><span style=\"color: #008080\"> 8</span> <span style=\"color: #000000\">        q.put(i)\n</span><span style=\"color: #008080\"> 9</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">queue size after put: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> q.qsize())\n</span><span style=\"color: #008080\">10</span> \n<span style=\"color: #008080\">11</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> get(q):\n</span><span style=\"color: #008080\">12</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">queue size before get: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> q.qsize())\n</span><span style=\"color: #008080\">13</span>     <span style=\"color: #0000ff\">while</span> <span style=\"color: #0000ff\">not</span><span style=\"color: #000000\"> q.empty():\n</span><span style=\"color: #008080\">14</span>         <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">queue get: </span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">, q.get())\n</span><span style=\"color: #008080\">15</span> \n<span style=\"color: #008080\">16</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> main():\n</span><span style=\"color: #008080\">17</span>     p_put = Process(target=put, args=<span style=\"color: #000000\">(q,))\n</span><span style=\"color: #008080\">18</span>     p_get = Process(target=get, args=<span style=\"color: #000000\">(q,))\n</span><span style=\"color: #008080\">19</span> <span style=\"color: #000000\">    p_put.start()\n</span><span style=\"color: #008080\">20</span>     time.sleep(1<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">21</span> <span style=\"color: #000000\">    p_get.start()\n</span><span style=\"color: #008080\">22</span> <span style=\"color: #000000\">    p_get.join()\n</span><span style=\"color: #008080\">23</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">all done</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">24</span> \n<span style=\"color: #008080\">25</span> <span style=\"color: #0000ff\">if</span> <span style=\"color: #800080\">__name__</span> == <span style=\"color: #800000\">'</span><span style=\"color: #800000\">__main__</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\">26</span>     main()</pre>\n</div>\n<p>结果：</p>\n<div class=\"cnblogs_code\">\n<pre>queue size after put: 3<span style=\"color: #000000\">\nqueue size before get: </span>3<span style=\"color: #000000\">\nqueue get:  0\nqueue get:  </span>1<span style=\"color: #000000\">\nqueue get:  </span>2<span style=\"color: #000000\">\nall done</span></pre>\n</div>\n<p>b）Pipe</p>\n<div>Pipe方法返回(conn1, conn2)代表一个管道的两个端。Pipe方法有duplex参数，如果duplex参数为True(默认值)，那么这个管道是全双工模式，也就是说conn1和conn2均可收发。duplex为False，conn1只负责接受消息，conn2只负责发送消息。</div>\n<div>send和recv方法分别是发送和接受消息的方法。例如，在全双工模式下，可以调用conn1.send发送消息，conn1.recv接收消息。如果没有消息可接收，recv方法会一直阻塞。如果管道已经被关闭，那么recv方法会抛出EOFError。</div>\n<div>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> multiprocessing\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> time\n</span><span style=\"color: #008080\"> 3</span> \n<span style=\"color: #008080\"> 4</span> pipe =<span style=\"color: #000000\"> multiprocessing.Pipe()\n</span><span style=\"color: #008080\"> 5</span> \n<span style=\"color: #008080\"> 6</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> send(pipe):\n</span><span style=\"color: #008080\"> 7</span>     <span style=\"color: #0000ff\">for</span> i <span style=\"color: #0000ff\">in</span> range(5<span style=\"color: #000000\">):\n</span><span style=\"color: #008080\"> 8</span>         <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">send: %s</span><span style=\"color: #800000\">\"</span> %<span style=\"color: #000000\"> (i,))\n</span><span style=\"color: #008080\"> 9</span> <span style=\"color: #000000\">        pipe.send(i)\n</span><span style=\"color: #008080\">10</span>         time.sleep(0.2<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">11</span> \n<span style=\"color: #008080\">12</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> recv_1(pipe):\n</span><span style=\"color: #008080\">13</span>     <span style=\"color: #0000ff\">while</span><span style=\"color: #000000\"> True:\n</span><span style=\"color: #008080\">14</span>         <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">rev_1:</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">, pipe.recv())\n</span><span style=\"color: #008080\">15</span>         time.sleep(1<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">16</span> \n<span style=\"color: #008080\">17</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> recv_2(pipe):\n</span><span style=\"color: #008080\">18</span>     <span style=\"color: #0000ff\">while</span><span style=\"color: #000000\"> True:\n</span><span style=\"color: #008080\">19</span>         <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">rev_2:</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">, pipe.recv())\n</span><span style=\"color: #008080\">20</span>         time.sleep(1<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\">21</span> \n<span style=\"color: #008080\">22</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> main():\n</span><span style=\"color: #008080\">23</span>     p_send = multiprocessing.Process(target=send, args=<span style=\"color: #000000\">(pipe[0],))\n</span><span style=\"color: #008080\">24</span>     p_recv_1 = multiprocessing.Process(target=recv_1, args=(pipe[1<span style=\"color: #000000\">],))\n</span><span style=\"color: #008080\">25</span>     p_recv_2 = multiprocessing.Process(target=recv_2, args=(pipe[1<span style=\"color: #000000\">],))\n</span><span style=\"color: #008080\">26</span> \n<span style=\"color: #008080\">27</span> <span style=\"color: #000000\">    p_send.start()\n</span><span style=\"color: #008080\">28</span> <span style=\"color: #000000\">    p_recv_1.start()\n</span><span style=\"color: #008080\">29</span> <span style=\"color: #000000\">    p_recv_2.start()\n</span><span style=\"color: #008080\">30</span> \n<span style=\"color: #008080\">31</span> <span style=\"color: #000000\">    p_send.join()\n</span><span style=\"color: #008080\">32</span> <span style=\"color: #000000\">    p_recv_1.join()\n</span><span style=\"color: #008080\">33</span> <span style=\"color: #000000\">    p_recv_2.join()\n</span><span style=\"color: #008080\">34</span> \n<span style=\"color: #008080\">35</span> <span style=\"color: #0000ff\">if</span> <span style=\"color: #800080\">__name__</span> == <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">__main__</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\">36</span>     main()</pre>\n</div>\n</div>\n<div>\n<p>结果：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">send: 0\nrev_1: 0\nsend: </span>1<span style=\"color: #000000\">\nrev_2: </span>1<span style=\"color: #000000\">\nsend: </span>2<span style=\"color: #000000\">\nsend: </span>3<span style=\"color: #000000\">\nsend: </span>4<span style=\"color: #000000\">\nrev_1: </span>2<span style=\"color: #000000\">\nrev_2: </span>3<span style=\"color: #000000\">\nrev_1: </span>4</pre>\n</div>\n<p><strong>c）Manager</strong></p>\n<p><strong>相当相当给力，上面的Queue，Pipe仅仅可以传递数据，而不能做到数据共享（不同进程修改同一份数据），但是Manger可以做到数据共享</strong></p>\n<p>看一下官方文档：</p>\n<p>A manager object returned by <code class=\"xref py py-func docutils literal\"><span class=\"pre\">Manager()</span></code> controls a server process which holds Python objects and allows other processes to manipulate them using proxies.</p>\n<p>A manager returned by <code class=\"xref py py-func docutils literal\"><span class=\"pre\">Manager()</span></code> will support types <code class=\"xref py py-class docutils literal\"><span class=\"pre\">list</span></code>, <a class=\"reference internal\" title=\"dict\" href=\"https://docs.python.org/2/library/stdtypes.html#dict\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">dict</span></code></a>, <a class=\"reference internal\" title=\"multiprocessing.managers.Namespace\" href=\"https://docs.python.org/2/library/multiprocessing.html#multiprocessing.managers.Namespace\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">Namespace</span></code></a>, <a class=\"reference internal\" title=\"multiprocessing.Lock\" href=\"https://docs.python.org/2/library/multiprocessing.html#multiprocessing.Lock\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">Lock</span></code></a>, <a class=\"reference internal\" title=\"multiprocessing.RLock\" href=\"https://docs.python.org/2/library/multiprocessing.html#multiprocessing.RLock\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">RLock</span></code></a>, <a class=\"reference internal\" title=\"multiprocessing.Semaphore\" href=\"https://docs.python.org/2/library/multiprocessing.html#multiprocessing.Semaphore\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">Semaphore</span></code></a>, <a class=\"reference internal\" title=\"multiprocessing.BoundedSemaphore\" href=\"https://docs.python.org/2/library/multiprocessing.html#multiprocessing.BoundedSemaphore\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">BoundedSemaphore</span></code></a>, <a class=\"reference internal\" title=\"multiprocessing.Condition\" href=\"https://docs.python.org/2/library/multiprocessing.html#multiprocessing.Condition\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">Condition</span></code></a>, <a class=\"reference internal\" title=\"multiprocessing.Event\" href=\"https://docs.python.org/2/library/multiprocessing.html#multiprocessing.Event\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">Event</span></code></a>, <a class=\"reference internal\" title=\"multiprocessing.Queue\" href=\"https://docs.python.org/2/library/multiprocessing.html#multiprocessing.Queue\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">Queue</span></code></a>, <a class=\"reference internal\" title=\"multiprocessing.Value\" href=\"https://docs.python.org/2/library/multiprocessing.html#multiprocessing.Value\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">Value</span></code></a> and <a class=\"reference internal\" title=\"multiprocessing.Array\" href=\"https://docs.python.org/2/library/multiprocessing.html#multiprocessing.Array\"><code class=\"xref py py-class docutils literal\"><span class=\"pre\">Array</span></code></a>.</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">from</span> multiprocessing <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> Process, Manager\n\n</span><span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> run(d, l):\n    d[</span><span style=\"color: #800000\">'</span><span style=\"color: #800000\">name</span><span style=\"color: #800000\">'</span>] = <span style=\"color: #800000\">'</span><span style=\"color: #800000\">winter</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">\n    l.reverse()\n\n\n</span><span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> main():\n    p </span>= Process(target=run, args=<span style=\"color: #000000\">(d, l, ))\n    p.start()\n    p.join()\n\n    </span><span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">final dict: </span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">, d)\n    </span><span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">final list: </span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">, l)\n\n</span><span style=\"color: #0000ff\">if</span> <span style=\"color: #800080\">__name__</span> == <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">__main__</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:\n    mgmt </span>=<span style=\"color: #000000\"> Manager()\n    d </span>=<span style=\"color: #000000\"> mgmt.dict()\n    l </span>= mgmt.list(range(10<span style=\"color: #000000\">))\n    main()</span></pre>\n</div>\n<p>注意:mgmt = Manger()必须放在if __name__ == \"__main__\"的代码块中，不然报freeze_support()的错误</p>\n<p>而且，注意这里：</p>\n<p>Server process managers are more flexible than using shared memory objects because they can be made to support arbitrary object types. Also, <strong>a single manager can be shared by processes on different computers over a network</strong>. They are, however, slower than using shared memory.</p>\n<p>还可以在不同主机之间共享数据；</p>\n<h3>7）进程池Pool</h3>\n<p>如果要启动大量的子进程，可以用进程池pool批量创建子进程：Pool可以提供指定数量的进程，供用户调用，当有新的请求提交到pool中时，如果池还没有满，那么就会创建一个新的进程用来执行该请求；但如果池中的进程数已经达到规定最大值，那么该请求就会等待，直到池中有进程结束，才会创建新的进程来执行。</p>\n<p>有两种方法：阻塞方法Pool.apply()和非阻塞方法Pool.apply_async()</p>\n<p>a）阻塞方法Pool.apply()</p>\n<p>结果：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">start: winter\nend: winter\nstart: elly\nend: elly\nstart: james\nend: james\nstart: yule\nend: yule\nall done...</span></pre>\n</div>\n<p>发现，阻塞方式下，进程是一个一个执行的，还是串行，所以apply用的少；</p>\n<p>注意两点：</p>\n<p>1. 进程池执行子进程不需要start；</p>\n<p>2. 调用<code>join()</code>之前必须先调用<code>close()</code>，调用<code>close()</code>之后就不能继续添加新的<code>Process</code>了；</p>\n<p><strong>b）非阻塞方法Pool.apply_async()</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> multiprocessing\n</span><span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> time\n\n</span><span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> func(name):\n    </span><span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">start: %s</span><span style=\"color: #800000\">\"</span> %<span style=\"color: #000000\"> name)\n    time.sleep(</span>2<span style=\"color: #000000\">)\n    </span><span style=\"color: #0000ff\">return</span> <span style=\"color: #800000\">'</span><span style=\"color: #800000\">end: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> name\n\n</span><span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> func_exp(msg):\n    </span><span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">callback: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> msg)\n\n</span><span style=\"color: #0000ff\">if</span> <span style=\"color: #800080\">__name__</span> == <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">__main__</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:\n    name_list </span>= [<span style=\"color: #800000\">'</span><span style=\"color: #800000\">winter</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">elly</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">james</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">yule</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">]\n    res_list </span>=<span style=\"color: #000000\"> []\n    </span><span style=\"color: #008000\">#</span><span style=\"color: #008000\"> 创建一个进程总数为3的进程池</span>\n    pool =<span style=\"color: #000000\"> multiprocessing.Pool()\n    </span><span style=\"color: #0000ff\">for</span> member <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> name_list:\n        </span><span style=\"color: #008000\">#</span><span style=\"color: #008000\"> 创建子进程，并执行，不需要start</span>\n        res = pool.apply_async(func, (member,), callback=<span style=\"color: #000000\">func_exp)\n        </span><span style=\"color: #008000\">#</span><span style=\"color: #008000\">注意这里是append了res，不是res.get()，不然又要阻塞了</span>\n<span style=\"color: #000000\">        res_list.append(res)\n    </span><span style=\"color: #0000ff\">for</span> res_mem <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> res_list:\n        </span><span style=\"color: #0000ff\">print</span><span style=\"color: #000000\">(res_mem.get())\n    pool.close()\n    </span><span style=\"color: #008000\">#</span><span style=\"color: #008000\"> 调用join之前，先调用close函数，否则会出错。执行完close后不会有新的进程加入到pool</span>\n<span style=\"color: #000000\">    pool.join()\n    </span><span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">all done...</span><span style=\"color: #800000\">\"</span>)</pre>\n</div>\n<p>结果：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">start: winter\nstart: elly\nstart: james\nstart: yule\ncallback: end: winter\nend: winter\ncallback: end: elly\nend: elly\ncallback: end: james\nend: james\ncallback: end: yule\nend: yule\nall done...</span></pre>\n</div>\n<p>结果分析：</p>\n<p><strong>1. 可以看到非阻塞情况下，充分利用了多核，实现了并行；</strong></p>\n<p><strong>2. apply_async方法含有callback参数，可以用于回调</strong></p>\n<p><strong>3.为什么apply方法是阻塞的呢？到底阻塞在了哪里呢？同时apply_async方法做了什么改进呢？</strong></p>\n<p><strong>查看apply方法源码：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">def</span> apply(self, func, args=(), kwds=<span style=\"color: #000000\">{}):\n    </span><span style=\"color: #800000\">'''</span><span style=\"color: #800000\">\n    Equivalent of `func(*args, **kwds)`.\n    </span><span style=\"color: #800000\">'''</span>\n    <span style=\"color: #0000ff\">assert</span> self._state ==<span style=\"color: #000000\"> RUN\n    </span><span style=\"color: #0000ff\">return</span> self.apply_async(func, args, kwds).get()</pre>\n</div>\n<p><strong>apply方法最终执行了self.apply_async(func, args, kwds).get()，同样调用了apply_async()方法，只是对结果执行了get()方法；阻塞就是阻塞在了这里；</strong></p>\n<p><strong>那我修改一下apply_async()的代码是不是可以让apply_async()可以变成阻塞的呢？试一下</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008080\"> 1</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> multiprocessing\n</span><span style=\"color: #008080\"> 2</span> <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> time\n</span><span style=\"color: #008080\"> 3</span> \n<span style=\"color: #008080\"> 4</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> func(name):\n</span><span style=\"color: #008080\"> 5</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">start: %s</span><span style=\"color: #800000\">\"</span> %<span style=\"color: #000000\"> name)\n</span><span style=\"color: #008080\"> 6</span>     time.sleep(2<span style=\"color: #000000\">)\n</span><span style=\"color: #008080\"> 7</span>     <span style=\"color: #0000ff\">return</span> <span style=\"color: #800000\">'</span><span style=\"color: #800000\">end: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> name\n</span><span style=\"color: #008080\"> 8</span> \n<span style=\"color: #008080\"> 9</span> <span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> func_exp(msg):\n</span><span style=\"color: #008080\">10</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">callback: %s</span><span style=\"color: #800000\">'</span> %<span style=\"color: #000000\"> msg)\n</span><span style=\"color: #008080\">11</span> \n<span style=\"color: #008080\">12</span> <span style=\"color: #0000ff\">if</span> <span style=\"color: #800080\">__name__</span> == <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">__main__</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:\n</span><span style=\"color: #008080\">13</span>     name_list = [<span style=\"color: #800000\">'</span><span style=\"color: #800000\">winter</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">elly</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">james</span><span style=\"color: #800000\">'</span>, <span style=\"color: #800000\">'</span><span style=\"color: #800000\">yule</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">]\n</span><span style=\"color: #008080\">14</span>     <span style=\"color: #008000\">#</span><span style=\"color: #008000\"> 创建一个进程总数为3的进程池</span>\n<span style=\"color: #008080\">15</span>     pool =<span style=\"color: #000000\"> multiprocessing.Pool()\n</span><span style=\"color: #008080\">16</span>     <span style=\"color: #0000ff\">for</span> member <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> name_list:\n</span><span style=\"color: #008080\">17</span>         <span style=\"color: #008000\">#</span><span style=\"color: #008000\"> 创建子进程，并执行，不需要start</span>\n<span style=\"color: #008080\">18</span>         res = pool.apply_async(func, (member,), callback=<span style=\"color: #000000\">func_exp)\n</span><span style=\"color: #008080\">19</span>         <span style=\"color: #ff0000\">print(res.get())\n</span><span style=\"color: #008080\">20</span> <span style=\"color: #000000\">    pool.close()\n</span><span style=\"color: #008080\">21</span>     <span style=\"color: #008000\">#</span><span style=\"color: #008000\"> 调用join之前，先调用close函数，否则会出错。执行完close后不会有新的进程加入到pool</span>\n<span style=\"color: #008080\">22</span> <span style=\"color: #000000\">    pool.join()\n</span><span style=\"color: #008080\">23</span>     <span style=\"color: #0000ff\">print</span>(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">all done...</span><span style=\"color: #800000\">\"</span>)</pre>\n</div>\n<p><strong>注意红色部分是我修改的编码，结果果然变成了阻塞状态：</strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">start: winter\ncallback: end: winter\nend: winter\nstart: elly\ncallback: end: elly\nend: elly\nstart: james\ncallback: end: james\nend: james\nstart: yule\ncallback: end: yule\nend: yule\nall done...</span></pre>\n</div>\n<p><strong>c）进程池该设置多少个进程数？</strong></p>\n<p><strong>既然多进程可以利用多核，那么是不是创建越多的进程越好呢？不是的，因为进程的切换成本高，所以数量太多的进程来回切换反而会降低效率！</strong></p>\n<p>进程数是一个经验值，和系统的硬件资源有很大关系；最优的进程数需要通过不断调整得出；</p>\n<p>Pool创建时，进程池的进程数默认大小为CPU的逻辑CPU数目（内核线程数）；</p>\n<p>经验上来说：</p>\n<div>\n<div>进程数与CPU核数比例1:1比较好，对于支持多线程的模型，线程数一般推荐的至少是1:1.5，这样可以留一部分线程来做IO。Python的多进程一般要么是做纯计算，要么是协程模型（没有IO等待时间，或者等待时间很少），要么在进程内再使用多线程（非常不推荐，需要了解fork机制），这样每个核一个进程一般足够了，进程切换的开销略大，数量太多的话来回切换反而会降低效率。不过有种情况例外，如果磁盘IO比较多，一般即使是协程，磁盘IO也是同步的，这时候多增加一些进程数也许有帮助。</div>\n</div>\n<p> </p>\n</div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 22:29</span> <a href=\"http://www.cnblogs.com/deeper/\">Winter_Ding</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7760463\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7760463);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=296444,cb_entryId=7760463,cb_blogApp=currentBlogApp,cb_blogUserGuid='e100495d-d753-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/31 22:29:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 194, "image_url": ["https://pic.cnblogs.com/face/999584/20170915123449.png"], "date_pub": "2017-10-31", "article_common": 1}
{"title": "使用fabric解决百度BMR的spark集群各节点的部署问题", "url": "http://www.cnblogs.com/kwongtai/p/7763278.html", "author": "kwongtai", "article_desc": "在自动部署服务器方面，如果使用fabric和socket.gethostbyname()解决百度BMR的spark集群各节点的部署问题。 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/kwongtai/p/7763278.html\">使用fabric解决百度BMR的spark集群各节点的部署问题</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"前言\">前言</h1>\n<blockquote>\n<p>和小伙伴的一起参加的人工智能比赛进入了决赛之后的一段时间里面，一直在构思将数据预处理过程和深度学习这个阶段合并起来。然而在合并这两部分代码的时候，遇到了一些问题，为此还特意写了脚本文件进行处理。现在比赛过去，我觉得应该把这部分的东西写出来，看看是否有其他朋友会遇到这方面问题，希望对他们有帮助。如有不对之处，请大家指正，谢谢！</p>\n</blockquote>\n<h1 id=\"比赛遇到的集群各节点的部署痛点\">比赛遇到的集群各节点的部署痛点</h1>\n<h2 id=\"一个前提\">一个前提</h2>\n<p>在初赛的时候，为了快捷提供数据接口给后面的深度学习模型建立使用，我们将数据预处理独立出来，使用了最为简单的Python操作。在此，考虑到的是，我们的代码需要移植到评委所用的电脑当中进行验证，可能存在没有import某些库的情况，最后导致程序运行失败。</p>\n<h2 id=\"麻烦之处\">麻烦之处</h2>\n<p>在进入到决赛后，由于这两块的结合在一起的迫切需求，我们不得不又重新import我们库。然而在这块当中，如果我们只在Master节点，问题很简单，直接将库打包好，写个脚本就完事了。而在百度的BMR的spark集群里面，因为Slaves节点不能访问网络（如下图），因而我们要登录了Master节点之后，然后通过Master内网ssh到Slaves上，进而才能打开我们的脚本部署好我们的程序运行环境。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1065122/201710/1065122-20171031192810123-936576639.png\"></p>\n<h2 id=\"提出\">提出</h2>\n<p>这样子来说，我们有没有一个很好的办法，能通过Master上运行一个脚本，达到了整个集群的所有节点都自动部署我们的程序运行环境呢？经过阅读书籍《spark最佳实践》，了解到了Python的第三方库fabric。</p>\n<h1 id=\"fabric\">fabric</h1>\n<p>首先请允许介绍一下fabric，具体使用方法可以查阅官方API Doc，在此我介绍一下我将使用到某一小部分。</p>\n<h2 id=\"执行本地任务\">执行本地任务</h2>\n<p>fabric提供了一个<code>local(\"shell\")</code>的接口，shell就是Linux上的shell命令。例如</p>\n<pre><code>from fabric.api import local\n \nlocal('ls /root/') #ls root文件夹下的文件列表</code></pre>\n<h2 id=\"执行远程任务\">执行远程任务</h2>\n<p>fabric的强大之处，不是它在本地做到执行命令，本地执行的事儿可以用原生shell来解决，而是能在远程的服务器上执行命令，哪怕远程的服务器上没有安装fabric。它是通过ssh方式实现的，因而我们需要定义一下三个参数：</p>\n<pre><code>env.hosts = ['ipaddress1', 'ipaddress2']\nenv.user = 'root'\nenv.password = 'fuckyou.'</code></pre>\n<p>通过设置ip，用户名以及用户名密码，我们可以使用<code>run(\"shell\")</code>，达到在远程服务器上执行我们所需要执行的任务。例如</p>\n<pre><code>from fabric.api import run, env\n \nenv.hosts = ['ipaddress1', 'ipaddress2']\nenv.user = 'root'\nenv.password = 'fuckyou.'\n \nrun('ls /root/') #ls root文件夹下的文件列表\n</code></pre>\n<h2 id=\"打开某一个文件夹\">打开某一个文件夹</h2>\n<p>有时候我们需要精准地打开某一个文件夹，之后执行该文件下的某一个脚本或者文件。这是，我们得使用以下两个接口：</p>\n<h3 id=\"本地\">本地</h3>\n<pre><code>with lcd('/root/local/'):\n        local('cat local.txt') # cat 本地'/root/local/'下的local.txt文件</code></pre>\n<h3 id=\"远程\">远程</h3>\n<pre><code>with cd('/root/distance/'):\n        run('cat distance.txt') # cat 远程'/root/distance/'下的distance.txt文件</code></pre>\n<h2 id=\"执行fabric任务\">执行fabric任务</h2>\n<p>我们可以通过命令行</p>\n<pre><code>fab --fabfile=filename.py job_func\n# filename.py为使用fabric写的Python文件 \n# job_func 为带有fabric的函数，即主要执行的函数\n# 以上两个名称都是可以自取，下面的介绍当中，我的为job.py 与 job</code></pre>\n<h1 id=\"socket\">socket</h1>\n<p>为什么会用到socket呢？在上一篇文章当中，我提及到在百度BMR的集群中，他们设置集群Slaves都是通过slaves的hostname的，而不是通过ip。而因为在使用fabric设置环境中的hosts的时候需要用到ip，那我们得通过hostname，进而找到ip。</p>\n<p>你或许有疑问，为什么不直接设定Slaves的IP呢？但是百度BMR每次创建spark集群，它提供的内网IP都是不断在变动的，呈现出IP末端递增。</p>\n<p>综上，还是使用hostname获取IP</p>\n<h2 id=\"gethostbyname接口\">gethostbyname接口</h2>\n<p>我们可以用过<code>gethostbyname('hostname')</code>接口，传入hostname，然后得到一个IPV4的ip地址。</p>\n<h1 id=\"使用fabric编写各节点自动部署脚本\">使用fabric编写各节点自动部署脚本</h1>\n<h2 id=\"获取slaves的hostname\">获取Slaves的hostname</h2>\n<p>和上一篇文章说道的一样，我们Slaves的hostname是藏在了百度BMR的这里：</p>\n<pre><code>'/opt/bmr/hadoop/etc/hadoop/slaves'</code></pre>\n<h2 id=\"将hostname转化为ip设置fabric的env参数\">将hostname转化为ip，设置fabric的env参数</h2>\n<pre><code>host_list = []\nf = open(path, 'r')\nslaves_name = f.read().split('\\n')\nfor i in range(1, slaves_name.__len__()-1):\n    temp_name = slaves_name[i]\n    temp_ip = socket.gethostbyname(temp_name)\n    ip_port = temp_ip + \":22\"\n    host_list.append(ip_port)\n    del temp_name\n    del temp_ip\n    del ip_port\nenv.user = 'root'\nenv.password = '*gdut728'\nenv.hosts = host_list</code></pre>\n<h2 id=\"编写需要自动部署的job\">编写需要自动部署的job</h2>\n<p>在这里，我要自动部署的是：<br>\n1 下载Python第三方库jieba<br>\n2 在本地解压下载好的jieba压缩包<br>\n3 在本地，进入到解压好的文件夹中，安装jieba<br>\n4 将下载好的压缩包传送到Slaves节点上<br>\n5 在远程端，解压下载好的jieba压缩包<br>\n6 在远程端，进入到解压好的文件夹中，安装jieba</p>\n<p>将上面步骤转化为代码，即</p>\n<pre><code>def job():\n    local_command = \"wget https://pypi.python.org/packages/71/46/c6f9179f73b818d5827202ad1c4a94e371a29473b7f043b736b4dab6b8cd/jieba-0.39.zip#md5=ca00c0c82bf5b8935e9c4dd52671a5a9\"\n    local(local_command)\n\n    jieba_unzip = \"unzip jieba-0.39.zip\"\n    jieba_path = \"/root/jieba-0.39/\"\n    jieba_install = \"python setup.py install\"\n\n    local(jieba_unzip)\n    with lcd(jieba_path):\n        local(\"ls\")\n        local(jieba_install)\n\n    with lcd('/root/'):\n        put(\"jieba-0.39.zip\", '/root')\n\n    run(jieba_unzip)\n    with cd(jieba_path):\n        run(\"ls\")\n        run(jieba_install)</code></pre>\n<h1 id=\"结言\">结言</h1>\n<p>最后，在我上篇文章提到的shell脚本中，最前面加上</p>\n<pre><code>yum -y install fabric &amp;&amp; fab --fabfile=job.py job </code></pre>\n<p>输入<code>./start-hadoop-spark.sh</code>，即可无忧无虑地部署好我要使用的程序运行环境。因为懒，因为麻烦，于是用Python外加shell写了自动部署的脚本。在这个过程中，学习到不少知识，也遇到不少麻烦，写下文章，希望可以减轻大家配置的烦恼~</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1065122/201710/1065122-20171031193446685-111771285.png\"></p>\n<p>结果如下：<br>\nMaster：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1065122/201710/1065122-20171031193517466-146773725.png\"></p>\n<p>Slaves1：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1065122/201710/1065122-20171031193530951-1123012041.png\"></p>\n<p>Slaves2：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1065122/201710/1065122-20171031193500435-403011323.png\"></p>\n<h1 id=\"参照\">参照</h1>\n<p>Fabric 中文文档 <a href=\"http://fabric-chs.readthedocs.io/zh_CN/chs/\" class=\"uri\">http://fabric-chs.readthedocs.io/zh_CN/chs/</a><br>\nPython远程部署利器Fabric详解 <a href=\"http://python.jobbole.com/87241/\" class=\"uri\">http://python.jobbole.com/87241/</a><br>\nsocket.gethostbyname() <a href=\"https://docs.python.org/2/library/socket.html#socket.gethostbyname\" class=\"uri\">https://docs.python.org/2/library/socket.html#socket.gethostbyname</a></p>\n<p>文章出自kwongtai'blog[<a href=\"http://www.cnblogs.com/kwongtai\" class=\"uri\">http://www.cnblogs.com/kwongtai</a>]，转载请标明出处！</p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 19:42</span> <a href=\"http://www.cnblogs.com/kwongtai/\">kwongtai</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7763278\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7763278);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=317503,cb_entryId=7763278,cb_blogApp=currentBlogApp,cb_blogUserGuid='7621a686-71ac-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/10/31 19:42:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 83, "image_url": ["https://pic.cnblogs.com/face/1065122/20170724120053.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "26.Linux-网卡驱动(详解)", "url": "http://www.cnblogs.com/lifexy/p/7763352.html", "author": "LifeYx", "article_desc": "1.描述 网卡的驱动其实很简单,它还是与硬件相关,主要是负责收发网络的数据包,它将上层协议传递下来的数据包以特定的媒介访问控制方式进行发送， 并将接收到的数据包传递给上层协议。 网卡设备与字符设备和块设备不同， 网络设备并不对应于/dev目录下的文件,不过会存放在/sys/class/net目录下  ...", "content": "<div id=\"post_detail\">\r\n<div class=\"post\">\r\n\t\t\t<div class=\"postTitle\">\r\n\t\t\t\t<a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/lifexy/p/7763352.html\">26.Linux-网卡驱动(详解)</a>\r\n\t\t\t</div>\r\n\t\r\n\t<div class=\"postText\">\r\n\t\t<div id=\"cnblogs_post_body\"><p><span style=\"font-size: 18px;\"><strong><span style=\"background-color: #fefef5; color: #008000;\">1.描述</span></strong></span></p>\r\n<p><span style=\"font-size: 15px;\">网卡的驱动其实很简单,它还是与硬件相关,主要是负责收发网络的数据包,它将上层协议传递下来的数据包以特定的媒介访问控制方式进行发送， 并将接收到的数据包传递给上层协议。</span></p>\r\n<p><span style=\"font-size: 15px;\">网卡设备与字符设备和块设备不同， 网络设备并不对应于/dev目录下的文件,不过会存放在<span style=\"color: #0000ff; background-color: #ebfdfe;\">/sys/class/net目录下</span></span></p>\r\n<p><span style=\"font-size: 15px;\">如下图所示,我们通过<span style=\"color: #0000ff; background-color: #ebfdfe;\">ls /sys/class/net/</span> 命令,可以看到有两个网卡:</span></p>\r\n<p><span style=\"font-size: 15px;\"> <img src=\"http://images2017.cnblogs.com/blog/1182576/201710/1182576-20171031190815232-756178769.png\" alt=\"\" width=\"534\" height=\"220\"></span></p>\r\n<p> </p>\r\n<p><span style=\"font-size: 18px; color: #008000; background-color: #fefef5;\"><strong>2.Linux</strong><strong>系统对网络设备驱动定义了4</strong><strong>个层次， </strong><strong>这4</strong><strong>个层次有到下分为:</strong></span></p>\r\n<p><span style=\"font-size: 15px;\"><strong>1)</strong><strong>网络协议接口层:</strong></span></p>\r\n<p><span style=\"font-size: 15px;\">实现统一的数据包收发的协议,该层主要负责调用dev_queue_xmit()函数发送数据， netif_rx()函数接收数据</span></p>\r\n<p><span style=\"font-size: 15px;\"><strong>2)</strong><strong>网络设备接口层:</strong></span></p>\r\n<p><span style=\"font-size: 15px;\">通过net_device结构体来描述一个具体的网络设备的信息,实现不同的硬件的统一</span></p>\r\n<p><span style=\"font-size: 15px;\"><strong>3)</strong><strong>设备驱动功能层：</strong></span></p>\r\n<p><span style=\"font-size: 15px;\">用来负责驱动网络设备硬件来完成各个功能, 它通过hard_start_xmit() 函数启动发送操作， 并通过网络设备上的中断触发接收操作,</span></p>\r\n<p><span style=\"font-size: 15px;\"><strong>4)</strong><strong>网络设备与媒介层：</strong></span></p>\r\n<p><span style=\"font-size: 15px;\">用来负责完成数据包发送和接收的物理实体, 设备驱动功能层的函数都在这物理上驱动的</span></p>\r\n<p><span style=\"font-size: 15px;\"><strong>层次结构如下图所示:</strong></span></p>\r\n<p><span style=\"font-size: 15px;\"> <img src=\"http://images2017.cnblogs.com/blog/1182576/201710/1182576-20171031190853498-1599050801.png\" alt=\"\" width=\"398\" height=\"284\"></span></p>\r\n<p><span style=\"font-size: 18px; background-color: #fefeea; color: #008000;\"><strong>3.网卡驱动初始化</strong></span></p>\r\n<p><span style=\"font-size: 15px;\">而我们的网卡驱动程序,只需要编写网络设备接口层,填充net_device数据结构的内容并将net_device注册入内核,设置硬件相关操作,使能中断处理等</span></p>\r\n<p><span style=\"font-size: 15px; color: #0000ff; background-color: #ebfdfe;\"><strong>3.1其中net_device</strong><strong>结构体的重要成员,</strong><strong>整理后如下所示:</strong></span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">struct</span><span style=\"color: #000000;\"> net_device\r\n{\r\n       </span><span style=\"color: #0000ff;\">char</span>               name[IFNAMSIZ];              <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">网卡设备名称</span><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>              mem_end;             <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">该设备的内存结束地址</span><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>              mem_start;            <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">该设备的内存起始地址</span><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>              base_addr;            <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">该设备的内存I/O基地址</span><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">int</span>          irq;                       <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">该设备的中断号</span>\r\n<span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">char</span>        if_port;                  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">多端口设备使用的端口类型</span><span style=\"color: #000000;\">\r\n　　　　unsigned </span><span style=\"color: #0000ff;\">char</span>        dma;                     <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">该设备的DMA通道</span><br><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>              state;                    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">网络设备和网络适配器的状态信息</span>\r\n\r\n             \r\n\r\n<span style=\"color: #0000ff;\">      struct</span> net_device_stats* (*get_stats)(<span style=\"color: #0000ff;\">struct</span> net_device *dev); <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取流量的统计信息<br>　　　　　　　　　　　　　　　　　　　　　　　　//运行ifconfig便会调用该成员函数,并返回一个net_device_stats结构体获取信息</span>\r\n\r\n      <span style=\"color: #0000ff;\">struct</span> net_device_stats  stats;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">用来保存统计信息的net_device_stats结构体</span>\r\n<span style=\"color: #000000;\">\r\n \r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>              features;        <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">接口特征,     </span><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">int</span>          flags; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">flags指网络接口标志,以IFF_(Interface Flags)开头\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">当flags =IFF_UP（ 当设备被激活并可以开始发送数据包时， 内核设置该标志）、 IFF_AUTOMEDIA（设置设备可在多种媒介间切换）、<br>IFF_BROADCAST（ 允许广播）、IFF_DEBUG（ 调试模式， 可用于控制printk调用的详细程度） 、 IFF_LOOPBACK（ 回环）、<br>IFF_MULTICAST（ 允许组播） 、 IFF_NOARP（ 接口不能执行ARP,点对点接口就不需要运行 ARP） 和IFF_POINTOPOINT（ 接口连接到点到点链路） 等。</span>\r\n<span style=\"color: #000000;\">\r\n \r\n       unsigned        mtu;        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">最大传输单元,也叫最大数据包</span>\r\n<span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">short</span>  type;   　　<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">接口的硬件类型</span>\r\n<span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">short</span>   hard_header_len;     <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">硬件帧头长度,一般被赋为ETH_HLEN,即14</span>\r\n<span style=\"color: #000000;\">\r\n \r\n　　　　unsigned </span><span style=\"color: #0000ff;\">char</span>   dev_addr[MAX_ADDR_LEN];      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">存放设备的MAC地址</span>\r\n<span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>              last_rx;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">接收数据包的时间戳,调用netif_rx()后赋上jiffies即可</span>\r\n<span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>              trans_start;     <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">发送数据包的时间戳,当要发送的时候赋上jiffies即可</span>\r\n<span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">char</span>        dev_addr[MAX_ADDR_LEN];                <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">MAC地址</span>\r\n\r\n \r\n       <span style=\"color: #0000ff;\">int</span>                 (*hard_start_xmit) (<span style=\"color: #0000ff;\">struct</span> sk_buff *skb, <span style=\"color: #0000ff;\">struct</span> net_device *<span style=\"color: #000000;\">dev);\r\n                                   </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">数据包发送函数, sk_buff就是用来收发数据包的结构体</span>\r\n\r\n\r\n　　　　<span style=\"color: #0000ff;\">void</span>  (*tx_timeout) (<span style=\"color: #0000ff;\">struct</span> net_device *dev); <span style=\"color: #008000;\">//发包</span><span style=\"color: #008000;\">超时处理函数</span>\r\n　　　　... ...<span style=\"color: #000000;\">\r\n}</span></pre>\r\n</div>\r\n<p> </p>\r\n<p><span style=\"font-size: 15px;\">上面讲到的统计信息net_device_stats结构体,其中重要成员如下所示:</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">struct</span><span style=\"color: #000000;\"> net_device_stats\r\n{\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>       rx_packets;          　　<span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">收到的数据包数</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>       tx_packets;          　　<span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">发送的数据包数    </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>       rx_bytes;               <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">收到的字节数,可以通过sk_buff结构体的成员len来获取</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>       tx_bytes;               <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">发送的字节数,可以通过sk_buff结构体的成员len来获取</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>       rx_errors;              <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">收到的错误数据包数</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       unsigned </span><span style=\"color: #0000ff;\">long</span>       tx_errors;              <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">发送的错误数据包数</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       ... ...\r\n}</span></pre>\r\n</div>\r\n<p> </p>\r\n<p> </p>\r\n<p><strong><span style=\"font-size: 15px; color: #0000ff; background-color: #ebfdfe;\">3.2 所以init函数,初始化网卡步骤如下所示:</span></strong></p>\r\n<p> </p>\r\n<ul>\r\n<li><span style=\"font-family: 'Microsoft YaHei'; font-size: 14px;\">1)使用alloc_netdev()来分配一个net_device结构体 </span></li>\r\n<li><span style=\"font-family: 'Microsoft YaHei'; font-size: 14px;\">2)设置网卡硬件相关的寄存器</span></li>\r\n<li><span style=\"font-family: 'Microsoft YaHei'; font-size: 14px;\">3)设置net_device结构体的成员</span></li>\r\n<li><span style=\"font-family: 'Microsoft YaHei'; font-size: 14px;\">4)使用register_netdev()来注册net_device结构体</span></li>\r\n</ul>\r\n<p> </p>\r\n<p><span style=\"font-size: 18px; background-color: #fefeea; color: #008000;\"><strong>4.网卡驱动发包过程</strong></span></p>\r\n<p><span style=\"font-size: 15px;\">在内核中,当上层要发送一个数据包时, 就会调用网络设备层里net_device数据结构的成员hard_start_xmit()将数据包发送出去。</span></p>\r\n<p><span style=\"font-size: 15px;\">hard_start_xmit()发包函数需要我们自己构建,该函数原型如下所示:</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">int</span>    (*hard_start_xmit) (<span style=\"color: #0000ff;\">struct</span> sk_buff *skb, <span style=\"color: #0000ff;\">struct</span> net_device *dev);</pre>\r\n</div>\r\n<p> </p>\r\n<p><span style=\"font-size: 15px;\">在这个函数中需要涉及到sk_buff结构体,含义为(socket buffer)套接字缓冲区,用来网络各个层次之间传递数据.</span></p>\r\n<p><span style=\"color: #0000ff; background-color: #ebfdfe;\"><strong><span style=\"font-size: 15px;\">4.1 sk_buff结构体是一个双向链表,其中重要成员如下所示:</span></strong></span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">struct</span><span style=\"color: #000000;\"> sk_buff {\r\n       </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\"> These two members must be first. </span><span style=\"color: #008000;\">*/</span>\r\n       <span style=\"color: #0000ff;\">struct</span> sk_buff        *next;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">指向下一个sk_buff结构体</span>\r\n       <span style=\"color: #0000ff;\">struct</span> sk_buff        *prev;     <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">指向前一个sk_buff结构体</span><span style=\"color: #000000;\">\r\n　　　　... ...\r\n       unsigned </span><span style=\"color: #0000ff;\">int</span>          len,   　　　　　　<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">数据包的总长度,包括线性数据和非线性数据</span><span style=\"color: #000000;\">\r\n                            data_len,        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">非线性的数据长度</span><span style=\"color: #000000;\">\r\n                            mac_len;         </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">mac包头长度</span>\r\n<span style=\"color: #000000;\">\r\n　　　　__u32    　　　　  priority;          </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">该sk_buff结构体的优先级   </span>\r\n<span style=\"color: #000000;\">\r\n　　　　__be16  　　 　　 protocol;           </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">存放上层的协议类型,可以通过eth_type_trans()来获取</span><span style=\"color: #000000;\">\r\n       ... ...\r\n\r\n      sk_buff_data_t              transport_header;  　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">传输层头部的偏移值</span><span style=\"color: #000000;\">\r\n      sk_buff_data_t              network_header;   　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">网络层头部的偏移值</span><span style=\"color: #000000;\">\r\n      sk_buff_data_t              mac_header;          </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">MAC数据链路层头部的偏移值</span>\r\n<span style=\"color: #000000;\">\r\n　　　 sk_buff_data_t              tail;                    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">指向缓冲区的数据包末尾</span><span style=\"color: #000000;\">\r\n      sk_buff_data_t              end;                     </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">指向缓冲区的末尾</span><span style=\"color: #000000;\">\r\n      unsigned </span><span style=\"color: #0000ff;\">char</span>        　　　　*head,                   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">指向缓冲区的协议头开始位置</span>\r\n                                  *data;                   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">指向缓冲区的数据包开始位置</span><span style=\"color: #000000;\">\r\n       ... ...\r\n}</span></pre>\r\n</div>\r\n<p> </p>\r\n<p><span style=\"font-size: 15px;\">其中sk_buff结构体的空间,如下图所示:</span></p>\r\n<p><span style=\"font-size: 15px;\"> <img src=\"http://images2017.cnblogs.com/blog/1182576/201710/1182576-20171031190937701-249952599.png\" alt=\"\" width=\"435\" height=\"282\"></span></p>\r\n<p><span style=\"font-size: 15px;\">其中sk_buff-&gt; data数据包格式如下图所示:</span></p>\r\n<p><span style=\"font-size: 15px;\"> <img src=\"http://images2017.cnblogs.com/blog/1182576/201710/1182576-20171031190949216-296868542.png\" alt=\"\" width=\"424\" height=\"212\"></span></p>\r\n<p> </p>\r\n<p><span style=\"color: #0000ff; background-color: #ebfdfe;\"><strong><span style=\"font-size: 15px;\">4.2 所以,hard_start_xmit()发包函数处理步骤如下所示:</span></strong></span></p>\r\n<ul>\r\n<li><span style=\"font-size: 15px; font-family: 'Microsoft YaHei';\">1)把数据包发出去之前,需要使用netif_stop_queue()来停止上层传下来的数据包,</span></li>\r\n<li><span style=\"font-size: 15px; font-family: 'Microsoft YaHei';\">2)设置寄存器,通过网络设备硬件,来发送数据</span></li>\r\n<li><span style=\"font-size: 15px; font-family: 'Microsoft YaHei';\">2)当数据包发出去后, 再调用dev_kfree_skb()函数来释放sk_buff,该函数原型如下:</span></li>\r\n</ul>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">void</span> dev_kfree_skb(<span style=\"color: #0000ff;\">struct</span> sk_buff *skb);           </pre>\r\n</div>\r\n<p> </p>\r\n<ul>\r\n<li><span style=\"font-size: 15px; font-family: 'Microsoft YaHei';\">3)当数据包发出成功,就会进入TX中断函数,然后更新统计信息,调用netif_wake_queue()来唤醒,启动上层继续发包下来.</span></li>\r\n<li><span style=\"font-size: 15px; font-family: 'Microsoft YaHei';\">4)若数据包发出去超时,一直进不到TX中断函数,就会调用net_device结构体的(*tx_timeout)超时成员函数,在该函数中更新统计信息, 调用netif_wake_queue()来唤醒</span></li>\r\n</ul>\r\n<p><span style=\"font-size: 15px;\"> </span></p>\r\n<p><span style=\"font-size: 15px;\">其中netif_wake_queue()和netif_stop_queue()函数原型如下所示:</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">void</span> netif_wake_queue(<span style=\"color: #0000ff;\">struct</span> net_device *dev);  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">唤醒被阻塞的上层,启动继续向网络设备驱动层发送数据包</span>\r\n\r\n<span style=\"color: #0000ff;\">void</span> netif_stop_queue(<span style=\"color: #0000ff;\">struct</span> net_device *dev); <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">阻止上层向网络设备驱动层发送数据包</span></pre>\r\n</div>\r\n<p> </p>\r\n<p> </p>\r\n<p><span style=\"font-size: 18px; color: #008000; background-color: #fefeea;\"> <strong>5.网卡驱动收包过程</strong></span></p>\r\n<p><span style=\"font-size: 15px;\">而接收数据包主要是通过中断函数处理,来判断中断类型,如果等于ISQ_RECEIVER_EVENT,表示为接收中断,然后进入接收数据函数,通过netif_rx()将数据上交给上层</span></p>\r\n<p><span style=\"font-size: 15px;\">例如下图所示,参考的内核中自带的网卡驱动:/drivers/net/cs89x0.c</span></p>\r\n<p><span style=\"font-size: 15px;\"> <img src=\"http://images2017.cnblogs.com/blog/1182576/201710/1182576-20171031191008685-1205858101.png\" alt=\"\" width=\"471\" height=\"324\"></span></p>\r\n<p><span style=\"font-size: 15px;\">如上图所示,通过获取的status标志来判断是什么中断,如果是接收中断,就进入net_rx()</span></p>\r\n<p><span style=\"color: #0000ff; background-color: #ebfdfe;\"><strong><span style=\"font-size: 15px;\">4.1 其中net_rx()收包函数处理步骤如下所示:</span></strong></span></p>\r\n<ul>\r\n<li><span style=\"font-size: 15px; font-family: 'Microsoft YaHei';\">1)使用dev_alloc_skb()来构造一个新的sk_buff</span></li>\r\n<li><span style=\"font-size: 15px; font-family: 'Microsoft YaHei';\">2)使用skb_reserve(rx_skb, 2); 将sk_buff缓冲区里的数据包先后位移2字节,来腾出sk_buff缓冲区里的头部空间</span></li>\r\n<li><span style=\"font-size: 15px; font-family: 'Microsoft YaHei';\">3)读取网络设备硬件上接收到的数据</span></li>\r\n<li><span style=\"font-size: 15px;\"><span style=\"font-family: 'Microsoft YaHei';\">4)使用memcpy()将数据复制到新的sk_buff里的data成员指向的地址处,可以使用<span style=\"color: #0000ff;\">skb_put()</span>来动态扩大sk_buff结构体里中的数据区</span></span></li>\r\n<li><span style=\"font-family: 'Microsoft YaHei';\">5)使用eth_type_trans()来获取上层协议,将返回值赋给sk_buff的protocol成员里</span></li>\r\n<li><span style=\"font-family: 'Microsoft YaHei';\">6)然后更新统计信息,最后使用netif_rx( )来将sk_fuffer传递给上层协议中</span></li>\r\n</ul>\r\n<p><span style=\"font-size: 15px;\"><span style=\"font-size: 14px;\">其中<span style=\"color: #0000ff;\">skb_put()</span>函数原型如下所示:</span></span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"font-size: 14px;\"><span style=\"color: #0000ff;\">static</span> inline unsigned <span style=\"color: #0000ff;\">char</span> *skb_put(<span style=\"color: #0000ff;\">struct</span> sk_buff *skb, unsigned <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> len);\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">len:将数据区向下扩大len字节</span></span></pre>\r\n</div>\r\n<p> </p>\r\n<p><span style=\"font-size: 14px;\">使用<span style=\"color: #0000ff;\">skb_put()</span>函数后,其中sk_buff缓冲区变化如下图:</span></p>\r\n<p><span style=\"font-size: 15px;\"> <img src=\"http://images2017.cnblogs.com/blog/1182576/201710/1182576-20171031191040904-388639517.png\" alt=\"\" width=\"406\" height=\"210\"></span></p>\r\n<p><span style=\"font-size: 15px;\"> </span></p>\r\n<p><span style=\"color: #008000; background-color: #fefeea; font-size: 18px;\"><strong>6.写虚拟网卡驱动</strong></span></p>\r\n<p><span style=\"font-size: 15px;\">本节便开始来写一个简单的虚拟网卡驱动,也就是说不需要硬件相关操作,所以就没有中断函数,我们通过linux的ping命令来实现发包,然后在发包函数中伪造一个收的ping包函数,实现能ping通任何ip地址</span></p>\r\n<p><span style=\"color: #0000ff; background-color: #ebfdfe;\"><strong><span style=\"font-size: 15px;\">在init初始函数中:</span></strong></span></p>\r\n<ul>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">1)使用alloc_netdev()来分配一个net_device结构体</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">2)设置net_device结构体的成员</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">3)使用register_netdev()来注册net_device结构体</span></li>\r\n</ul>\r\n<p><span style=\"color: #0000ff; background-color: #ebfdfe;\"><strong><span style=\"font-size: 15px;\">在发包函数中:</span></strong></span></p>\r\n<ul>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">1)使用netif_stop_queue()来阻止上层向网络设备驱动层发送数据包</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">2)调用收包函数,并代入发送的sk_buff缓冲区, 里面来伪造一个收的ping包函数</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">3)使用dev_kfree_skb()函数来释放发送的sk_buff缓存区</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">4)更新发送的统计信息</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">5)使用netif_wake_queue()来唤醒被阻塞的上层,</span></li>\r\n</ul>\r\n<p><span style=\"color: #0000ff; background-color: #ebfdfe;\"><strong><span style=\"font-size: 15px;\">在收包函数中:</span></strong></span></p>\r\n<p><span style=\"font-size: 15px;\">首先修改发送的sk_buff里数据包的数据,使它变为一个接收的sk_buff,其中数据包结构如下图所示:</span></p>\r\n<p><span style=\"font-size: 15px;\"> <img src=\"http://images2017.cnblogs.com/blog/1182576/201710/1182576-20171031191106623-1661659162.png\" alt=\"\" width=\"412\" height=\"201\"></span></p>\r\n<ul>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">1)需要对调上图的ethhdr结构体 ”源/目的”MAC地址</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">2)需要对调上图的iphdr结构体”源/目的” IP地址</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">3)使用ip_fast_csum()来重新获取iphdr结构体的校验码</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">4)设置上图数据包的数据类型,之前是发送ping包0x08,需要改为0x00,表示接收ping包</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">5)使用dev_alloc_skb()来构造一个新的sk_buff</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">6)使用skb_reserve(rx_skb, 2);将sk_buff缓冲区里的数据包先后位移2字节,来腾出sk_buff缓冲区里的头部空间</span></li>\r\n<li><span style=\"font-size: 14px; font-family: 'Microsoft YaHei';\">7)使用memcpy()将之前修改好的sk_buff-&gt;data复制到新的sk_buff里的data成员指向的地址处:</span></li>\r\n</ul>\r\n<div class=\"cnblogs_code\">\r\n<pre>memcpy(skb_put(rx_skb, skb-&gt;len), skb-&gt;data, skb-&gt;<span style=\"color: #000000;\">len);\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> skb_put():来动态扩大sk_buff结构体里中的数据区，避免溢出</span></pre>\r\n</div>\r\n<ul>\r\n<li><span style=\"font-size: 14px;\">8)设置新的sk_buff 其它成员</span></li>\r\n<li><span style=\"font-size: 14px;\">9)使用eth_type_trans()来获取上层协议,将返回值赋给sk_buff的protocol成员里</span></li>\r\n<li><span style=\"font-size: 14px;\">10)然后更新接收统计信息,最后使用netif_rx( )来将sk_fuffer传递给上层协议中</span></li>\r\n</ul>\r\n<p> </p>\r\n<p><span style=\"color: #008000; background-color: #fefeea; font-size: 18px;\"><strong>7.驱动具体代码如下:</strong></span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre>#include &lt;linux/module.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/errno.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/netdevice.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/etherdevice.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/kernel.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/types.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/fcntl.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/interrupt.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/ioport.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/<span style=\"color: #0000ff;\">in</span>.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/skbuff.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/slab.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/spinlock.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/<span style=\"color: #0000ff;\">string</span>.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/init.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/bitops.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/delay.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;linux/ip.h&gt;<span style=\"color: #000000;\"> \r\n\r\n#include </span>&lt;asm/system.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;asm/io.h&gt;<span style=\"color: #000000;\">\r\n#include </span>&lt;asm/irq.h&gt;\r\n\r\n\r\n<span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">struct</span> net_device    *<span style=\"color: #000000;\">virt_net;\r\n\r\n\r\n</span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> virt_rs_packet(<span style=\"color: #0000ff;\">struct</span> sk_buff *skb, <span style=\"color: #0000ff;\">struct</span> net_device *<span style=\"color: #000000;\">dev)\r\n{\r\n       unsigned </span><span style=\"color: #0000ff;\">char</span> *<span style=\"color: #000000;\">type;\r\n       </span><span style=\"color: #0000ff;\">struct</span> iphdr *<span style=\"color: #000000;\">ih;\r\n       __be32 </span>*saddr, *<span style=\"color: #000000;\">daddr, tmp;\r\n       unsigned </span><span style=\"color: #0000ff;\">char</span><span style=\"color: #000000;\"> tmp_dev_addr[ETH_ALEN];\r\n       </span><span style=\"color: #0000ff;\">struct</span> ethhdr *<span style=\"color: #000000;\">ethhdr;\r\n       </span><span style=\"color: #0000ff;\">struct</span> sk_buff *<span style=\"color: #000000;\">rx_skb;\r\n\r\n    </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">1) 对调ethhdr结构体 \"源/目的\"MAC地址</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       ethhdr </span>= (<span style=\"color: #0000ff;\">struct</span> ethhdr *)skb-&gt;<span style=\"color: #000000;\">data;\r\n       memcpy(tmp_dev_addr, ethhdr</span>-&gt;<span style=\"color: #000000;\">h_dest, ETH_ALEN);\r\n       memcpy(ethhdr</span>-&gt;h_dest, ethhdr-&gt;<span style=\"color: #000000;\">h_source, ETH_ALEN);\r\n       memcpy(ethhdr</span>-&gt;<span style=\"color: #000000;\">h_source, tmp_dev_addr, ETH_ALEN);\r\n<br>\r\n     </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">2)对调 iphdr结构体\"源/目的\" IP地址</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       ih </span>= (<span style=\"color: #0000ff;\">struct</span> iphdr *)(skb-&gt;data + <span style=\"color: #0000ff;\">sizeof</span>(<span style=\"color: #0000ff;\">struct</span><span style=\"color: #000000;\"> ethhdr));\r\n       saddr </span>= &amp;ih-&gt;<span style=\"color: #000000;\">saddr;\r\n       daddr </span>= &amp;ih-&gt;<span style=\"color: #000000;\">daddr;<br>\r\n       tmp </span>= *<span style=\"color: #000000;\">saddr;\r\n       </span>*saddr = *<span style=\"color: #000000;\">daddr;\r\n       </span>*daddr =<span style=\"color: #000000;\"> tmp;\r\n\r\n   \r\n\r\n    </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">3)使用ip_fast_csum()来重新获取iphdr结构体的校验码</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n        ih</span>-&gt;check = <span style=\"color: #800080;\">0</span><span style=\"color: #000000;\">;               \r\n        ih</span>-&gt;check = ip_fast_csum((unsigned <span style=\"color: #0000ff;\">char</span> *)ih,ih-&gt;<span style=\"color: #000000;\">ihl);\r\n\r\n\r\n    </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">4)设置数据类型</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       type </span>= skb-&gt;data + <span style=\"color: #0000ff;\">sizeof</span>(<span style=\"color: #0000ff;\">struct</span> ethhdr) + <span style=\"color: #0000ff;\">sizeof</span>(<span style=\"color: #0000ff;\">struct</span><span style=\"color: #000000;\"> iphdr);\r\n       </span>*type = <span style=\"color: #800080;\">0</span>;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">之前是发送ping包0x08,需要改为0x00,表示接收ping包</span>\r\n\r\n\r\n    <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">5)使用dev_alloc_skb()来构造一个新的sk_buff   </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       rx_skb </span>= dev_alloc_skb(skb-&gt;len + <span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">);\r\n   \r\n    </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">6)使用skb_reserve()来腾出2字节头部空间  </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       skb_reserve(rx_skb, </span><span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">);\r\n\r\n   \r\n    </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">7)使用memcpy()将之前修改好的sk_buff-&gt;data复制到新的sk_buff里</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    memcpy(skb_put(rx_skb, skb</span>-&gt;len), skb-&gt;data, skb-&gt;len); <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> skb_put():来动态扩大sk_buff结构体里中的数据区，避免溢出</span>\r\n\r\n    <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">8)设置新的sk_buff 其它成员</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    rx_skb</span>-&gt;dev =<span style=\"color: #000000;\"> dev;\r\n    rx_skb</span>-&gt;ip_summed = CHECKSUM_UNNECESSARY; <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\"> don't check it </span><span style=\"color: #008000;\">*/</span>\r\n\r\n\r\n    <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">9)使用eth_type_trans()来获取上层协议 </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    rx_skb</span>-&gt;protocol =<span style=\"color: #000000;\"> eth_type_trans(rx_skb, dev);\r\n\r\n \r\n    </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">10) 更新接收统计信息,并使用netif_rx( )来 传递sk_fuffer收包 </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n       dev</span>-&gt;stats.rx_packets++<span style=\"color: #000000;\">;                     \r\n       dev</span>-&gt;stats.rx_bytes += skb-&gt;<span style=\"color: #000000;\">len;\r\n       dev</span>-&gt;last_rx= jiffies;                       <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">收包时间戳</span>\r\n<span style=\"color: #000000;\">\r\n       netif_rx(rx_skb);\r\n\r\n}\r\n<br>\r\n</span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">int</span> virt_send_packet(<span style=\"color: #0000ff;\">struct</span> sk_buff *skb, <span style=\"color: #0000ff;\">struct</span> net_device *<span style=\"color: #000000;\">dev)\r\n{\r\n  </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">1)使用netif_stop_queue()来阻止上层向网络设备驱动层发送数据包</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    netif_stop_queue(dev);\r\n \r\n   </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">期间设置硬件发送数据包</span>\r\n\r\n  <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">2)调用收包函数,里面来伪造一个收的ping包函数</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    virt_rs_packet(skb,dev);\r\n \r\n </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">3)使用dev_kfree_skb()函数来释放发送的sk_buff缓存区</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n     dev_kfree_skb(skb);\r\n\r\n </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">4)更新发送的统计信息</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    dev</span>-&gt;stats.tx_packets++;            <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">成功发送一个包</span><span style=\"color: #000000;\">\r\n    dev</span>-&gt;stats.tx_bytes+=skb-&gt;len;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">成功发送len长字节</span><span style=\"color: #000000;\">\r\n    dev</span>-&gt;trans_start = jiffies;            <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">发送时间戳</span>\r\n\r\n<span style=\"color: #008000;\"> /*</span><span style=\"color: #008000;\">5)使用netif_wake_queue()来唤醒被阻塞的上层</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    netif_wake_queue(dev); \r\n\r\n    </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #800080;\">0</span><span style=\"color: #000000;\">;\r\n}\r\n\r\n \r\n</span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">int</span> virt_net_init(<span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\">)\r\n{\r\n    </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">1)使用alloc_netdev()来分配一个net_device结构体</span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    virt_net</span>= alloc_netdev(<span style=\"color: #0000ff;\">sizeof</span>(<span style=\"color: #0000ff;\">struct</span> net_device), <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">virt_eth0</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, ether_setup);\r\n\r\n    </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">2)设置net_device结构体的成员 </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    virt_net</span>-&gt;hard_start_xmit      =<span style=\"color: #000000;\"> virt_send_packet;\r\n\r\n    virt_net</span>-&gt;dev_addr[<span style=\"color: #800080;\">0</span>] = <span style=\"color: #800080;\">0x08</span><span style=\"color: #000000;\">;　　　　 \r\n    virt_net</span>-&gt;dev_addr[<span style=\"color: #800080;\">1</span>] = <span style=\"color: #800080;\">0x89</span><span style=\"color: #000000;\">;\r\n    virt_net</span>-&gt;dev_addr[<span style=\"color: #800080;\">2</span>] = <span style=\"color: #800080;\">0x89</span><span style=\"color: #000000;\">;\r\n    virt_net</span>-&gt;dev_addr[<span style=\"color: #800080;\">3</span>] = <span style=\"color: #800080;\">0x89</span><span style=\"color: #000000;\">;\r\n    virt_net</span>-&gt;dev_addr[<span style=\"color: #800080;\">4</span>] = <span style=\"color: #800080;\">0x89</span><span style=\"color: #000000;\">;\r\n    virt_net</span>-&gt;dev_addr[<span style=\"color: #800080;\">5</span>] = <span style=\"color: #800080;\">0x89</span><span style=\"color: #000000;\">;\r\n\r\n    virt_net</span>-&gt;flags           |=<span style=\"color: #000000;\"> IFF_NOARP;\r\n    virt_net</span>-&gt;features        |=<span style=\"color: #000000;\"> NETIF_F_NO_CSUM;\r\n\r\n\r\n   </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">3)使用register_netdev()来注册net_device结构体 </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    register_netdev(virt_net);<br>\r\n    </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #800080;\">0</span><span style=\"color: #000000;\">;\r\n}\r\n\r\n</span><span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> virt_net_exit(<span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\">)\r\n{\r\n    unregister_netdev(virt_net);\r\n    free_netdev(virt_net);   \r\n}\r\n\r\nmodule_init(virt_net_init);\r\nmodule_exit(virt_net_exit);\r\n\r\nMODULE_LICENSE(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">GPL</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\nMODULE_AUTHOR(</span><span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">by:zhang</span><span style=\"color: #800000;\">\"</span>);</pre>\r\n</div>\r\n<p><span style=\"font-size: 18px; color: #008000; background-color: #fefeea;\"><strong>8.测试运行</strong></span></p>\r\n<p><span style=\"font-size: 15px;\"><span style=\"color: #0000ff;\">挂载驱动,</span>如下图所示,可以看到net类下就有了这个网卡设备</span></p>\r\n<p><span style=\"font-size: 15px;\"> <img src=\"http://images2017.cnblogs.com/blog/1182576/201710/1182576-20171031191142623-1185832566.png\" alt=\"\" width=\"687\" height=\"81\"></span></p>\r\n<p><span style=\"font-size: 15px;\"><span style=\"color: #0000ff;\">开始试验,</span>首先设置这个网卡设备的ip,然后去ping一下其它的ip,如下图所示:</span></p>\r\n<p><span style=\"font-size: 15px;\"> <span style=\"background-color: #ebfdfe; color: #0000ff;\"><img src=\"http://images2017.cnblogs.com/blog/1182576/201710/1182576-20171031191155154-1353223217.png\" alt=\"\" width=\"540\" height=\"134\"></span></span></p>\r\n<p><span style=\"font-size: 15px;\">上图的ping,之所以成功,是因为我们在发包函数中,伪造了一个来收包,通过netif_rx()来将收包上传给上层</span></p>\r\n<p><span style=\"font-size: 15px;\">使用ifconfig,可以看到这个网卡设备的统计信息共收发了6个包,以及收发的总数据</span></p>\r\n<p><span style=\"font-size: 15px;\"><img src=\"http://images2017.cnblogs.com/blog/1182576/201710/1182576-20171031191207373-1423144563.png\" alt=\"\" width=\"711\" height=\"133\"></span></p>\r\n<p> </p>\r\n<p> </p>\r\n<p> </p>\r\n<p><span style=\"font-size: 15px; color: #ff0000;\">下节便开始学习如何移植DM9000C网卡驱动</span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t</div>\r\n\t\r\n\t<div class=\"postfoot\">\r\n\t\tposted on <span id=\"post-date\">2017-10-31 19:53</span> <a href=\"http://www.cnblogs.com/lifexy/\">LifeYx</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7763352\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7763352);return false;\">收藏</a>\r\n\t</div>\r\n</div>\r\n<script type=\"text/javascript\">var allowComments=true,cb_blogId=361204,cb_entryId=7763352,cb_blogApp=currentBlogApp,cb_blogUserGuid='4aabc34d-ac8b-4b11-3a78-08d4a8d9e085',cb_entryCreatedDate='2017/10/31 19:53:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\r\n</div>", "article_view": 107, "image_url": ["https://pic.cnblogs.com/face/1182576/20170915085942.png"], "date_pub": "2017-10-31", "article_common": 2}
{"title": "Go语言中slice使用注意事项", "url": "http://www.cnblogs.com/licodeblog/p/7756466.html", "author": "lidea", "article_desc": "Go语言中slice操作存在一些陷阱，本文介绍了操作slice时的注意事项，重点介绍了在使用append内置函数操作slice时的陷阱。 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/licodeblog/p/7756466.html\">Go语言中slice使用注意事项</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p></p>\n<div>Go 语言中的slice类型可以理解为是数组array类型的描述符，包含了三个因素：</div>\n<ol>\n<li>指向底层数组的指针 </li>\n<li>slice目前使用到的底层数组的元素个数，即长度</li>\n<li>底层数组的最大长度，即容量</li>\n</ol>\n<div>因此当我们定义一个切片变量，s := make([]int, 5, 10)，即为指向了一个最大长度为10的底层数组，目前切片s使用到的长度为5。 </div>\n<div> </div>\n<div> <span style=\"font-size: 16px\">基于slice的定义，在使用slice时，有以下几点注意事项：</span></div>\n<div> </div>\n<div>\n<div><span style=\"font-size: 16px\">1.对slice进行切分操作</span></div>\n<div>对slice进行切分操作会生成一个新的slice变量，新slice和原来的slice指向同一个底层数组，只不过指向的起始位置可能不同，长度及容量可能也不相同。</div>\n<ul>\n<li>当从左边界有截断时，会改变新切片容量大小</li>\n<li>左边界默认0，最小为0；右边界默认slice的长度，最大为slice的容量</li>\n<li>当然，因为指向同一个底层数组，对新slice的操作会影响到原来的slice</li>\n</ul>\n<div>示例代码 <a href=\"https://play.golang.org/p/3GO0cIbZ9u\">https://play.golang.org/p/3GO0cIbZ9u</a>   </div>\n<div> </div>\n<div>\n<div><span style=\"font-size: 16px\">2.slice的赋值及函数间传递</span></div>\n<div>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:go;gutter:true;\">a := []int{1, 2, 3, 4, 5}\nb := a</pre>\n</div>\n</div>\n<div>示例代码 <a href=\"https://play.golang.org/p/lcjiulu-X2\">https://play.golang.org/p/lcjiulu-X2</a></div>\n<div>如上所示，则a, b指向同一个底层数组，且长度及容量因素相同，对b进行的操作会影响到a。 </div>\n<div> </div>\n<div>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:go;gutter:true;\">func main() {\n    a := []int{1, 2, 3, 4, 5}\n    modifySlice(a)\n    //[10 2 3 4 5]\n    fmt.Println(a)\n}\n\nfunc modifySlice(s []int) {\n    s[0] = 10\n}\n</pre>\n</div>\n<p></p>\n<div>示例代码 <a href=\"https://play.golang.org/p/ioOXLoAz3W\">https://play.golang.org/p/ioOXLoAz3W</a></div>\n<div>如上所示，将slice作为参数在函数间传递的时候是值传递，产生了一个新的slice，只不过新的slice仍然指向原来的底层数组，所以通过新的slice也能改变原来的slice的值 </div>\n<div> </div>\n<div>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:go;gutter:true;\">func main() {\n    a := []int{1, 2, 3, 4, 5}\n    modifySlice(a)\n    //[1 2 3 4 5]\n    fmt.Println(a)\n}\n\nfunc modifySlice(s []int) {\n    s = []int{10, 20, 30, 40, 50}\n}\n</pre>\n</div>\n<p> 示例代码 <a href=\"https://play.golang.org/p/LbFovzP-Rj\">https://play.golang.org/p/LbFovzP-Rj</a></p>\n<p>但是，如上所示，在调用函数的内部，将s整体赋值一个新的slice，并不会改变a的值，因为modifySlice函数内对s重新的整体赋值，让s指向了一个新的底层数组，而不是传递进来之前的a指向的那个数组，之后s的任何操作都不会影响到a了。</p>\n<p> </p>\n<p></p>\n<div><span style=\"font-size: 16px\">3.slice的append操作</span></div>\n<div>append操作最容易踩坑，下面详细说明一下。</div>\n<div>append函数定义:   func append(s []T, x ...T) []T</div>\n<div>Append基本原则：对于一个slice变量，若slice容量足够，append直接在原来的底层数组上追加元素到slice上；如果容量不足，append操作会生成一个新的更大容量的底层数组。 </div>\n<div> </div>\n<div>\n<div>第一种情况：</div>\n<div class=\"en-code\">\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:go;gutter:true;\">func main() {\n    a := make([]int, 2, 4)\n\n    //通常append操作都是将返回值赋值给自己,\n    //此处为了方便说明,没有这样做\n    b := append(a, 1)\n    //改变b的前2个元素值 会影响到a\n    b[0] = 99\n\n    //a: [99 0]    &amp;a[0]: 0x10410020  len: 2  cap: 4\n    fmt.Println(\"a:\", a, \" &amp;a[0]:\", &amp;a[0], \" len:\", len(a), \" cap:\", cap(a))\n    //b: [99 0 1]  &amp;b[0]: 0x10410020  len: 3  cap: 4\n    fmt.Println(\"b:\", b, \" &amp;b[0]:\", &amp;b[0], \" len:\", len(b), \" cap:\", cap(b))\n}</pre>\n</div>\n</div>\n<div>示例代码 <a href=\"https://play.golang.org/p/rQQy4u0vCq\">https://play.golang.org/p/rQQy4u0vCq</a></div>\n<div>如上所示，对a进行append操作，若append后的新slice的实际元素个数没有超出原来指向的底层数组的容量，所以仍然使用原来的底层数组:a, b的第一个值的地址一样, 改变b的前2个元素也会影响到a。其实这时候a,b指向的同一个底层数组的第3位(索引2)已经变成了数值1，但是对slice而言，除了底层数组，还有长度，容量两个因素，这时候a的长度仍然是2，所以输出的a的值没有变化。 </div>\n<div> </div>\n<div> 第二种情况：</div>\n<div>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:go;gutter:true;\">func main() {\n\n    a := make([]int, 2, 4)\n\n    //通常append操作都是将返回值赋值给自己,\n    //此处为了方便说明,没有这样做\n    b := append(a, 1, 2, 3)\n    //改变b的前2个元素值 不会影响到a\n    b[0] = 99\n\n    //a: [0 0]         &amp;a[0]: 0x10410020  len: 2  cap: 4\n    fmt.Println(\"a:\", a, \" &amp;a[0]:\", &amp;a[0], \" len:\", len(a), \" cap:\", cap(a))\n    //b: [99 0 1 2 3]  &amp;b[0]: 0x10454000  len: 5  cap: 8\n    fmt.Println(\"b:\", b, \" &amp;b[0]:\", &amp;b[0], \" len:\", len(b), \" cap:\", cap(b))\n}\n</pre>\n</div>\n<p></p>\n<div>示例代码 <a href=\"https://play.golang.org/p/e-gvTVx4vZ\">https://play.golang.org/p/e-gvTVx4vZ</a></div>\n<div>如上所示，若append后的新slice即b的实际元素个数已经超出了原来的a指向的底层数组的容量，那么就会分配给b一个新的底层数组，可以看到，a，b第一个元素的地址已经不同，改变b的前两个元素值也不会影响到a，同时容量也发生了变化。</div>\n<div> </div>\n<div> 第三种情况：</div>\n<div>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:go;gutter:true;\">func main() {\n    a := make([]int, 2, 4)\n    a[0] = 10\n    a[1] = 20\n    //a: [10 20]  &amp;a[0]: 0x10410020  len: 2  cap: 4\n    fmt.Println(\"a:\", a, \" &amp;a[0]:\", &amp;a[0], \" len:\", len(a), \" cap:\", cap(a))\n\n    //进行append操作\n    b := append(a[:1], 1)\n\n    //a: [10 1]   &amp;a[0]: 0x10410020  len: 2  cap: 4\n    fmt.Println(\"a:\", a, \" &amp;a[0]:\", &amp;a[0], \" len:\", len(a), \" cap:\", cap(a))\n    \n    //b: [10 1]   &amp;b[0]: 0x10410020  len: 2  cap: 4\n    fmt.Println(\"b:\", b, \" &amp;b[0]:\", &amp;b[0], \" len:\", len(b), \" cap:\", cap(b))\n}\n</pre>\n</div>\n<p></p>\n<div>示例代码 <a href=\"https://play.golang.org/p/Efb42G5Wt9\">https://play.golang.org/p/Efb42G5Wt9</a></div>\n<div>如上所示，若append后的b的实际元素个数没有超过原来的a指向的底层数组的容量，那么a，b指向同一个底层数组。</div>\n<div>注意此时append的操作对象是：对a进行切分之后的切片，只取了a的第一个值，相当于一个新切片，长度为1，和a指向同一个底层数组，我们称这个切分后的新切片为c吧，那么就相当于b其实是基于c切片进行append的，直接在长度1之后追加元素，所以append之后a的第二个元素变成了1。【所以切分操作和append操作放一起的时候，一定要小心】 </div>\n<div> </div>\n<div> 第四种情况：</div>\n<div>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:go;gutter:true;\">func main() {\n\n    a := make([]int, 2, 4)\n    a[0] = 10\n    a[1] = 20\n    //a: [10 20]       &amp;a[0]: 0x10410020  len: 2  cap: 4\n    fmt.Println(\"a:\", a, \" &amp;a[0]:\", &amp;a[0], \" len:\", len(a), \" cap:\", cap(a))\n\n    //进行append操作\n    //append是在第一个元素后开始追加，所以要超过容量，至少要追加4个，而不是之前例子的3个\n    b := append(a[:1], 1, 2, 3, 4)\n\n    //a: [10 20]       &amp;a[0]: 0x10410020  len: 2  cap: 4\n    fmt.Println(\"a:\", a, \" &amp;a[0]:\", &amp;a[0], \" len:\", len(a), \" cap:\", cap(a))\n    \n    //b: [10 1 2 3 4]  &amp;b[0]: 0x10454020  len: 5  cap: 8\n    fmt.Println(\"b:\", b, \" &amp;b[0]:\", &amp;b[0], \" len:\", len(b), \" cap:\", cap(b))\n}\n</pre>\n</div>\n<p></p>\n<div>示例代码 <a href=\"https://play.golang.org/p/wzNbO9vDJ0\">https://play.golang.org/p/wzNbO9vDJ0</a></div>\n<div>如上所示，这种情况主要用来与第三种情况对比，如果append的元素数较多，超过了原来的容量，直接采用了新的底层数组，也就不会影响到a了。 </div>\n<div> </div>\n<div> 上述的四种情况所用例子都比较简单，所以比较容易看清。要小心如果在函数间传递slice，调用函数采用append进行操作，可能会改变原来的值的，如下所示：</div>\n<div>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:go;gutter:true;\">func main() {\n\n    a := make([]int, 2, 4)\n    a[0] = 10\n    a[1] = 20\n    //a: [10 20]  &amp;a[0]: 0x10410020  len: 2  cap: 4\n    fmt.Println(\"a:\", a, \" &amp;a[0]:\", &amp;a[0], \" len:\", len(a), \" cap:\", cap(a))\n\n    testAppend(a[:1])\n\n    //a: [10 1]   &amp;a[0]: 0x10410020  len: 2  cap: 4\n    fmt.Println(\"a:\", a, \" &amp;a[0]:\", &amp;a[0], \" len:\", len(a), \" cap:\", cap(a))\n\n}\n\nfunc testAppend(s []int) {\n    //进行append操作\n    s = append(s, 1)\n    //s: [10 1]  &amp;s[0]: 0x10410020  len: 2  cap: 4\n    fmt.Println(\"s:\", s, \" &amp;s[0]:\", &amp;s[0], \" len:\", len(s), \" cap:\", cap(s))\n}\n</pre>\n</div>\n<p> 示例代码 <a href=\"https://play.golang.org/p/mvUZkmBW8u\">https://play.golang.org/p/mvUZkmBW8u</a></p>\n<p> </p>\n<p> 参考资料 <a href=\"https://blog.golang.org/go-slices-usage-and-internals\">https://blog.golang.org/go-slices-usage-and-internals</a></p>\n</div>\n</div>\n</div>\n</div>\n<div> </div>\n</div>\n</div>\n</div>\n</div>\n</div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 20:00</span> <a href=\"http://www.cnblogs.com/licodeblog/\">lidea</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7756466\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7756466);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=376988,cb_entryId=7756466,cb_blogApp=currentBlogApp,cb_blogUserGuid='b6665fd6-0338-4a04-97c4-08d49c352df3',cb_entryCreatedDate='2017/10/31 20:00:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 101, "image_url": ["https://pic.cnblogs.com/face/1227488/20170827221919.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "Akka（34）： Http：Unmarshalling，from Json", "url": "http://www.cnblogs.com/tiger-xc/p/7763466.html", "author": "雪川大虫", "article_desc": "Unmarshalling是Akka-http内把网上可传输格式的数据转变成程序高级结构话数据的过程，比如把Json数据转换成某个自定义类型的实例。按具体流程来说就是先把Json转换成可传输格式数据如：MessageEntity,HttpRequest,HttpReponse等，然后再转换成程序高级 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/tiger-xc/p/7763466.html\">Akka（34）： Http：Unmarshalling，from Json</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><span style=\"font-size: 14px; font-family: 宋体\">  Unmarshalling是Akka-http内把网上可传输格式的数据转变成程序高级结构话数据的过程，比如把Json数据转换成某个自定义类型的实例。按具体流程来说就是先把Json转换成可传输格式数据如：MessageEntity,HttpRequest,HttpReponse等，然后再转换成程序高级结构数据如classXX实例。Unmarshalling对一个A类实例到B类实例的转换是通过Unmarshaller[A,B]来实现的：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\">trait Unmarshaller[-<span style=\"color: #000000\">A, B] extends akka.http.javadsl.unmarshalling.Unmarshaller[A, B] {...}\n</span><span style=\"color: #0000ff\">object</span><span style=\"color: #000000\"> Unmarshaller\n  extends GenericUnmarshallers\n  with PredefinedFromEntityUnmarshallers\n  with PredefinedFromStringUnmarshallers {\n\n  </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> format: OFF\n\n  </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">#unmarshaller-creation</span>\n  <span style=\"color: #008000\">/*</span><span style=\"color: #008000\">*\n   * Creates an `Unmarshaller` from the given function.\n   </span><span style=\"color: #008000\">*/</span><span style=\"color: #000000\">\n  def apply[A, B](f: ExecutionContext ⇒ A ⇒ Future[B]): Unmarshaller[A, B] </span>=<span style=\"color: #000000\">\n    withMaterializer(ec </span>=&gt; _ =&gt;<span style=\"color: #000000\"> f(ec))\n...}</span></span></pre>\n</div>\n<p><span style=\"font-size: 14px; font-family: 宋体\">从Unmarshaller的构建函数apply可以估计它的作用应该与函数A=&gt;Future[B]很相似。A代表网上可传输类型如MessageEntity、HttpRequest，B代表某种程序高级数据类型。因为A到B的转换是non-blocking的，所以可以立即返回Future类型结果。Akka-http按被转换对象类型分类命名了下面这些类型别名：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\">type FromEntityUnmarshaller[T] =<span style=\"color: #000000\"> Unmarshaller[HttpEntity, T]\ntype FromMessageUnmarshaller[T] </span>=<span style=\"color: #000000\"> Unmarshaller[HttpMessage, T]\ntype FromResponseUnmarshaller[T] </span>=<span style=\"color: #000000\"> Unmarshaller[HttpResponse, T]\ntype FromRequestUnmarshaller[T] </span>=<span style=\"color: #000000\"> Unmarshaller[HttpRequest, T]\ntype FromByteStringUnmarshaller[T] </span>=<span style=\"color: #000000\"> Unmarshaller[ByteString, T]\ntype FromStringUnmarshaller[T] </span>=<span style=\"color: #000000\"> Unmarshaller[String, T]\ntype FromStrictFormFieldUnmarshaller[T] </span>= Unmarshaller[StrictForm.Field, T]</span></pre>\n</div>\n<p><span style=\"font-size: 14px; font-family: 宋体\">Akka-http对以下类型提供了自动的Unmarshalling转换： </span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\"><span style=\"color: #000000\">PredefinedFromStringUnmarshallers\nByte\nShort\nInt\nLong\nFloat\nDouble\nBoolean\nPredefinedFromEntityUnmarshallers\nArray[Byte]\nByteString\nArray[Char]\nString\nakka.http.scaladsl.model.FormData\nGenericUnmarshallers\nUnmarshaller[T, T] (identity unmarshaller)\nUnmarshaller[Option[A], B], </span><span style=\"color: #0000ff\">if</span> an Unmarshaller[A, B] <span style=\"color: #0000ff\">is</span><span style=\"color: #000000\"> available\nUnmarshaller[A, Option[B]], </span><span style=\"color: #0000ff\">if</span> an Unmarshaller[A, B] <span style=\"color: #0000ff\">is</span> available</span></pre>\n</div>\n<p><span style=\"font-size: 14px; font-family: 宋体\">也就是说Akka-http提供了这些U类型的Unmarshaller[U,B]隐式实例。Akka-http也提供了工具类型Unmarshal：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\"><span style=\"color: #0000ff\">object</span><span style=\"color: #000000\"> Unmarshal {\n  def apply[T](value: T): Unmarshal[T] </span>= <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> Unmarshal(value)\n}\n\n</span><span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Unmarshal[A](val value: A) {\n  </span><span style=\"color: #008000\">/*</span><span style=\"color: #008000\">*\n   * Unmarshals the value to the given Type using the in-scope Unmarshaller.\n   *\n   * Uses the default materializer [[ExecutionContext]] if no implicit execution context is provided.\n   * If you expect the marshalling to be heavy, it is suggested to provide a specialized context for those operations.\n   </span><span style=\"color: #008000\">*/</span><span style=\"color: #000000\">\n  def to[B](</span><span style=\"color: #0000ff\">implicit</span> um: Unmarshaller[A, B], ec: ExecutionContext = <span style=\"color: #0000ff\">null</span>, mat: Materializer): Future[B] =<span style=\"color: #000000\"> {\n    val context: ExecutionContext </span>= <span style=\"color: #0000ff\">if</span> (ec == <span style=\"color: #0000ff\">null</span>) mat.executionContext <span style=\"color: #0000ff\">else</span><span style=\"color: #000000\"> ec\n\n    um(value)(context, mat)\n  }\n}</span></span></pre>\n</div>\n<p><span style=\"font-size: 14px; font-family: 宋体\">我们可以通过Unmarshal.to[B]把Unmarshal[A]转换成Future[B]。注意：这一步只包括了从网上可传输类型到程序类型转换这一过程，不包括具体实现时的Json转换。下面是一些Unmarshal的用例：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\"><span style=\"color: #000000\">import akka.actor._\nimport akka.stream._\nimport akka.http.scaladsl.unmarshalling.Unmarshal\nimport akka.http.scaladsl.model._\nimport akka.http.scaladsl.server.Directives._\n\n</span><span style=\"color: #0000ff\">object</span><span style=\"color: #000000\"> Unmarshalling {\n  </span><span style=\"color: #0000ff\">implicit</span> val httpSys = ActorSystem(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">httpSystem</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)\n  </span><span style=\"color: #0000ff\">implicit</span> val httpMat =<span style=\"color: #000000\"> ActorMaterializer()\n  </span><span style=\"color: #0000ff\">implicit</span> val httpEC =<span style=\"color: #000000\"> httpSys.dispatcher\n\n  val futInt </span>= Unmarshal(<span style=\"color: #800080\">43</span><span style=\"color: #000000\">).to[Int]\n  val futBoolean </span>= Unmarshal(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">0</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">).to[Boolean]\n  val futString </span>= Unmarshal(HttpEntity(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Hello</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)).to[String]\n  val futHello </span>= Unmarshal(HttpRequest(method = HttpMethods.GET, entity = HttpEntity(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">hello</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)))\n\n}</span></span></pre>\n</div>\n<p><span style=\"font-family: 宋体; font-size: 14px\">以上都是已知类型之间转换，可能没什么实际用途，不像marshalling：中间层Marshalling有实际转换的需要。Unmarshalling可以直接进行Json到自定义类型之间的转换，如：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\"> val route = (path(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">User</span><span style=\"color: #800000\">\"</span>) &amp; post) { entity(<span style=\"color: #0000ff\">as</span>[User]){ user =&gt;<span style=\"color: #000000\">\n    complete(Future(s</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">inserting user: $user</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n  }} </span>~<span style=\"color: #000000\">\n    (path(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Item</span><span style=\"color: #800000\">\"</span>/IntNumber) &amp; put) { id =&gt; entity(<span style=\"color: #0000ff\">as</span>[Item]){ item =&gt;<span style=\"color: #000000\">\n      complete(Future(s</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">update item $id: $item</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n    }}</span></span></pre>\n</div>\n<p><span style=\"font-family: 宋体; font-size: 14px\">以上是通过Directive as[???]实现的：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\"> <span style=\"color: #008000\">/*</span><span style=\"color: #008000\">*\n   * Returns the in-scope [[FromRequestUnmarshaller]] for the given type.\n   *\n   * @group marshalling\n   </span><span style=\"color: #008000\">*/</span><span style=\"color: #000000\">\n  def </span><span style=\"color: #0000ff\">as</span>[T](<span style=\"color: #0000ff\">implicit</span> um: FromRequestUnmarshaller[T]) = um</span></pre>\n</div>\n<p><span style=\"font-size: 14px; font-family: 宋体\">这需要把FromRequestUmarshaller[T]放在可视域内，FromRequestUmarshaller[T]实际是Unmarshaller[T,B]的别名： </span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\">type FromRequestUnmarshaller[T] = Unmarshaller[HttpRequest, T]</span></pre>\n</div>\n<p><span style=\"font-family: 宋体; font-size: 14px\">在上篇讨论我们介绍了Akka-http的Marshalling是type-class模式的。其中关键可以参考上篇讨论。现在我们需要这些Unmarshaller的隐式实例：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\"><span style=\"color: #000000\">trait Formats extends SprayJsonSupport with DefaultJsonProtocol\n</span><span style=\"color: #0000ff\">object</span><span style=\"color: #000000\"> Converters extends Formats {\n  </span><span style=\"color: #0000ff\">case</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> User(id: Int, name: String)\n  </span><span style=\"color: #0000ff\">case</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Item(id: Int, name: String, price: Double)\n  </span><span style=\"color: #0000ff\">implicit</span> val itemFormat =<span style=\"color: #000000\"> jsonFormat3(Item.apply)\n  </span><span style=\"color: #0000ff\">implicit</span> val userFormat =<span style=\"color: #000000\"> jsonFormat2(User.apply)\n}\n\n</span><span style=\"color: #0000ff\">object</span></span><span style=\"color: #000000\"><span style=\"font-size: 14px\"> Unmarshalling {\n  import Converters._</span>\n...</span></pre>\n</div>\n<p><span style=\"font-family: 宋体; font-size: 14px\">如果使用Json4s的实现方式，我们需要如下提供这些隐式实例：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\"><span style=\"color: #000000\">trait JsonCodec extends Json4sSupport {\n  import org.json4s.DefaultFormats\n  import org.json4s.ext.JodaTimeSerializers\n  </span><span style=\"color: #0000ff\">implicit</span> val serilizer =<span style=\"color: #000000\"> jackson.Serialization\n  </span><span style=\"color: #0000ff\">implicit</span> val formats = DefaultFormats ++<span style=\"color: #000000\"> JodaTimeSerializers.all\n}\n</span><span style=\"color: #0000ff\">object</span> JsConverters extends JsonCodec</span></pre>\n</div>\n<p><span style=\"font-family: 宋体; font-size: 14px\">Json4s的具体用例如下：</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\"><span style=\"color: #000000\">  import scala.collection.mutable._\n  </span><span style=\"color: #0000ff\">case</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> User(id: Int, name: String)\n  </span><span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Item(id: Int, name: String, price: Double)\n  </span><span style=\"color: #0000ff\">object</span><span style=\"color: #000000\"> AnyPic {\n    val area </span>= <span style=\"color: #800080\">10</span><span style=\"color: #000000\">\n    val title </span>= <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">a picture</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n    val data </span>= ArrayBuffer[Byte](<span style=\"color: #800080\">1</span>,<span style=\"color: #800080\">2</span>,<span style=\"color: #800080\">3</span><span style=\"color: #000000\">)\n  }\n\n  val route </span>= (path(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">User</span><span style=\"color: #800000\">\"</span>) &amp; post) { entity(<span style=\"color: #0000ff\">as</span>[User]){ user =&gt;<span style=\"color: #000000\">\n    complete(Future(s</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">inserting user: $user</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n  }} </span>~<span style=\"color: #000000\">\n    (path(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Item</span><span style=\"color: #800000\">\"</span>/IntNumber) &amp; put) { id =&gt; entity(<span style=\"color: #0000ff\">as</span>[Item]){ item =&gt;<span style=\"color: #000000\">\n      complete(Future(s</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">update item $id: $item</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n    }} </span>~<span style=\"color: #000000\">\n    (path(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Picture</span><span style=\"color: #800000\">\"</span>) &amp; put) { entity(<span style=\"color: #0000ff\">as</span>[AnyPic.type]){ pic =&gt;<span style=\"color: #000000\">\n      complete(Future(s</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">insert picture: $pic</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n    }}</span></span></pre>\n</div>\n<p><span style=\"font-family: SimSun; font-size: 14px\">从功能上和表达灵活性来讲，Json4s的实现方式要占优。</span></p>\n<p><span style=\"font-family: 宋体; font-size: 14px\">下面就是本次讨论的示范源代码：</span></p>\n<p><span style=\"font-family: SimSun; font-size: medium\">Unmarshalling</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\"><span style=\"color: #000000\">import akka.actor._\nimport akka.stream._\nimport akka.http.scaladsl.unmarshalling.Unmarshal\nimport akka.http.scaladsl.model._\nimport akka.http.scaladsl.server.Directives._\nimport scala.concurrent._\nimport akka.http.scaladsl.marshallers.sprayjson._\nimport spray.json._\n\ntrait Formats extends SprayJsonSupport with DefaultJsonProtocol\n</span><span style=\"color: #0000ff\">object</span><span style=\"color: #000000\"> Converters extends Formats {\n  </span><span style=\"color: #0000ff\">case</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> User(id: Int, name: String)\n  </span><span style=\"color: #0000ff\">case</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Item(id: Int, name: String, price: Double)\n  </span><span style=\"color: #0000ff\">implicit</span> val itemFormat =<span style=\"color: #000000\"> jsonFormat3(Item.apply)\n  </span><span style=\"color: #0000ff\">implicit</span> val userFormat =<span style=\"color: #000000\"> jsonFormat2(User.apply)\n}\n\n</span><span style=\"color: #0000ff\">object</span><span style=\"color: #000000\"> Unmarshalling {\n  import Converters._\n  </span><span style=\"color: #0000ff\">implicit</span> val httpSys = ActorSystem(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">httpSystem</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)\n  </span><span style=\"color: #0000ff\">implicit</span> val httpMat =<span style=\"color: #000000\"> ActorMaterializer()\n  </span><span style=\"color: #0000ff\">implicit</span> val httpEC =<span style=\"color: #000000\"> httpSys.dispatcher\n\n  val futInt </span>= Unmarshal(<span style=\"color: #800080\">43</span><span style=\"color: #000000\">).to[Int]\n  val futBoolean </span>= Unmarshal(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">0</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">).to[Boolean]\n  val futString </span>= Unmarshal(HttpEntity(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Hello</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)).to[String]\n  val futHello </span>= Unmarshal(HttpRequest(method = HttpMethods.GET, entity = HttpEntity(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">hello</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)))\n\n  val route </span>= (path(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">User</span><span style=\"color: #800000\">\"</span>) &amp; post) { entity(<span style=\"color: #0000ff\">as</span>[User]){ user =&gt;<span style=\"color: #000000\">\n    complete(Future(s</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">inserting user: $user</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n  }} </span>~<span style=\"color: #000000\">\n    (path(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Item</span><span style=\"color: #800000\">\"</span>/IntNumber) &amp; put) { id =&gt; entity(<span style=\"color: #0000ff\">as</span>[Item]){ item =&gt;<span style=\"color: #000000\">\n      complete(Future(s</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">update item $id: $item</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n    }}\n\n}</span></span></pre>\n</div>\n<p><span style=\"font-family: SimSun; font-size: medium\">Json4sUnmarshalling</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"font-size: 14px\"><span style=\"color: #000000\">import akka.actor._\nimport akka.stream._\nimport akka.http.scaladsl.server.Directives._\nimport de.heikoseeberger.akkahttpjson4s.Json4sSupport\nimport org.json4s.jackson\nimport scala.concurrent._\ntrait JsonCodec extends Json4sSupport {\n  import org.json4s.DefaultFormats\n  import org.json4s.ext.JodaTimeSerializers\n  </span><span style=\"color: #0000ff\">implicit</span> val serilizer =<span style=\"color: #000000\"> jackson.Serialization\n  </span><span style=\"color: #0000ff\">implicit</span> val formats = DefaultFormats ++<span style=\"color: #000000\"> JodaTimeSerializers.all\n}\n</span><span style=\"color: #0000ff\">object</span><span style=\"color: #000000\"> JsConverters extends JsonCodec\n\n\n</span><span style=\"color: #0000ff\">object</span><span style=\"color: #000000\"> Json4sUnmarshalling {\n  import JsConverters._\n  </span><span style=\"color: #0000ff\">implicit</span> val httpSys = ActorSystem(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">httpSystem</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)\n  </span><span style=\"color: #0000ff\">implicit</span> val httpMat =<span style=\"color: #000000\"> ActorMaterializer()\n  </span><span style=\"color: #0000ff\">implicit</span> val httpEC =<span style=\"color: #000000\"> httpSys.dispatcher\n\n  import scala.collection.mutable._\n  </span><span style=\"color: #0000ff\">case</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> User(id: Int, name: String)\n  </span><span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Item(id: Int, name: String, price: Double)\n  </span><span style=\"color: #0000ff\">object</span><span style=\"color: #000000\"> AnyPic {\n    val area </span>= <span style=\"color: #800080\">10</span><span style=\"color: #000000\">\n    val title </span>= <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">a picture</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">\n    val data </span>= ArrayBuffer[Byte](<span style=\"color: #800080\">1</span>,<span style=\"color: #800080\">2</span>,<span style=\"color: #800080\">3</span><span style=\"color: #000000\">)\n  }\n\n  val route </span>= (path(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">User</span><span style=\"color: #800000\">\"</span>) &amp; post) { entity(<span style=\"color: #0000ff\">as</span>[User]){ user =&gt;<span style=\"color: #000000\">\n    complete(Future(s</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">inserting user: $user</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n  }} </span>~<span style=\"color: #000000\">\n    (path(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Item</span><span style=\"color: #800000\">\"</span>/IntNumber) &amp; put) { id =&gt; entity(<span style=\"color: #0000ff\">as</span>[Item]){ item =&gt;<span style=\"color: #000000\">\n      complete(Future(s</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">update item $id: $item</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n    }} </span>~<span style=\"color: #000000\">\n    (path(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Picture</span><span style=\"color: #800000\">\"</span>) &amp; put) { entity(<span style=\"color: #0000ff\">as</span>[AnyPic.type]){ pic =&gt;<span style=\"color: #000000\">\n      complete(Future(s</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">insert picture: $pic</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n    }}\n}</span></span></pre>\n</div>\n<p> </p>\n<p> </p>\n<p> </p>\n<p><span style=\"font-family: SimSun; font-size: medium\"> </span></p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<pre name=\"code\" class=\"html\"></pre>\n<p><span class=\"Apple-style-span\" style=\"font-family: SimSun\"> </span></p>\n<p><span class=\"Apple-style-span\" style=\"font-family: SimSun\"> </span></p>\n<p><span style=\"font-family: SimSun; font-size: medium\"> </span></p>\n<p><span style=\"font-family: SimSun; font-size: medium\"> </span></p>\n<p><span style=\"font-family: SimSun; font-size: medium\"> </span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 20:33</span> <a href=\"http://www.cnblogs.com/tiger-xc/\">雪川大虫</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7763466\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7763466);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=217117,cb_entryId=7763466,cb_blogApp=currentBlogApp,cb_blogUserGuid='144b0696-0bc4-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/10/31 20:33:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 40, "image_url": ["https://pic.cnblogs.com/face/728183/20150309120303.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "abapGit分支策略", "url": "http://www.cnblogs.com/hhelibeb/p/7754487.html", "author": "氢氦", "article_desc": "各位ABAP公民们、特别是使用abapGit的各位，你们好。 我的团队和我将向大家分享我公司内引入abapGit后产生的某些开发问题。我所在的公司是一家创作SAP第三方软件的公司，目前主要使用ABAP和UI5。 本文专门针对ABAP方面。 首先，我们爱abapGit，相信你们中的很多也是一样...  ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/hhelibeb/p/7754487.html\">abapGit分支策略</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>各位ABAP公民们、特别是使用abapGit的各位，你们好。</p>\r\n<p>我的团队和我将向大家分享我公司内引入<a href=\"https://github.com/larshp/abapGit\" target=\"_blank\">abapGit</a>后产生的某些开发问题。我所在的<a href=\"https://www.gk-software.com/\" target=\"_blank\">公司</a>是一家创作SAP第三方软件的公司，目前主要使用ABAP和UI5。</p>\r\n<p>本文专门针对ABAP方面。</p>\r\n<p> </p>\r\n<p>首先，我们爱abapGit，相信你们中的很多也是一样...</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/994049/201710/994049-20171030165004949-1421615688.png\" alt=\"\"></p>\r\n<p><em><a href=\"https://github.com/larshp/abapGit\" rel=\"noopener\" target=\"_blank\">GitHub repository</a></em></p>\r\n<p>我们的git仓库使用GitLab托管在本地，有着各种用户友好的特性。</p>\r\n<p>我们至少每天push一次我们的commit，生成版本（可以说是一个额外的备份层）。</p>\r\n<p>通过使用GitLabs的代码审查功能，也使代码审查变得容易了许多。</p>\r\n<p>我们最近评估了使用<a href=\"https://betterexplained.com/articles/a-visual-guide-to-version-control/#Branching\" target=\"_blank\">分支</a>的可能性，得出的结论是：我们不能在现有的基础设施之上使用它。</p>\r\n<p>本文的剩余部分将探究如何使用abapGit实现分支。</p>\r\n<p> </p>\r\n<p>本文链接：<a id=\"Editor_Edit_hlEntryLink\" title=\"view: abapGit分支策略\" href=\"http://www.cnblogs.com/hhelibeb/p/7754487.html\" target=\"_blank\">http://www.cnblogs.com/hhelibeb/p/7754487.html</a></p>\r\n<p>英文原文：<a href=\"https://blogs.sap.com/2017/09/21/abapgit-branching-strategy-discussion/\" target=\"_blank\">abapGit Branching Strategy Discussion</a></p>\r\n<h2>场景1：无分支</h2>\r\n<p>这就是我们现在的工作方式。所有开发者在相同的SAP系统和代码基础（code base）上工作，所有人都push代码到主“分支”上。</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/994049/201710/994049-20171031143652761-1458526094.png\" alt=\"\"></p>\r\n<h3>优势</h3>\r\n<ul>\r\n<li>更好的代码版本控制</li>\r\n<li>易于进行代码审查</li>\r\n</ul>\r\n<h3>劣势</h3>\r\n<ul>\r\n<li>分支是不可能的，开发者同时在同样的代码基础上修改对象\r\n<ul>\r\n<li>切换分支时，会改变每个开发者的代码基础，虽然他们也许会以为自己还在他们的分支上</li>\r\n</ul>\r\n</li>\r\n<li>代码会因为其他人的问题commit出错\r\n<ul>\r\n<li>甲修改了对象A，乙后来也修改了它 <br>甲在不知道乙修改过A的情况下进行了commit</li>\r\n<li>是的，进行最后一个修改的人可以在abapGit工作台上面看到这个，但是，你仍然有可能没看到它。</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<h2>场景2：使用分支</h2>\r\n<p>无法马上使用分支的根本原因，在于，所有开发者使用同样的代码基础。开发者没有隔离他们同事的代码修改行为。</p>\r\n<p>所以，实现真正分支的第一步就是，分割每个开发者的开发环境。这意味着，每个开发者要有他自己的SAP系统来进行开发。</p>\r\n<p>这带给我们第一个整体的不利条件：</p>\r\n<ul>\r\n<li>开发者数量的增加带来的高昂的维护费用。</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<h3>Local VMs</h3>\r\n<p>我们的第一个想法是，为什么不在开发者的机器上虚拟化运行SAP系统呢？</p>\r\n<p>开发者在进行一项任务时，可以push到他们的分支当中，直到它们创建一个merge request。</p>\r\n<p>主开发系统（DEV）只从主分支拉取，主分支只包含被批准的merge request。</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/994049/201710/994049-20171031152226683-1621274369.png\" alt=\"\"></p>\r\n<h4>优势</h4>\r\n<ul>\r\n<li>连接到你的SAP系统时，不需要网络接口</li>\r\n<li>你可以在不连接公司网络的情况下开发\r\n<ul>\r\n<li>只需要在push代码到git仓库的时候才需要连接公司网络</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</li>\r\n<li>在SSD上面运行SAP系统真的快极了</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<h4>劣势</h4>\r\n<ul>\r\n<li>高维护开销\r\n<ul>\r\n<li>管理员对机器的控制比较难</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</li>\r\n<li>开发者需要知道怎样开启/关闭他们的虚拟机/SAP系统\r\n<ul>\r\n<li>甚至可能需要他们自己定时备份虚拟机　　　　</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<p> </p>\r\n<p>某些总体问题也打击了我们：</p>\r\n<h4>升级开发者的SAP系统</h4>\r\n<ul>\r\n<li>如何给系统打补丁（支持包，notes，系统级补丁）？</li>\r\n<li>当需要获取定制数据、主数据和业务数据来开发新特性、重现bug并且修复时，要怎样获取它们？</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<h4>升级主开发SAP系统</h4>\r\n<ul>\r\n<li>如何处理abapGit不能序列化的开发对象？</li>\r\n<li>当需要获取定制数据、主数据和业务数据来开发新特性、重现bug并且修复时，主开发系统要怎样获取它们？</li>\r\n<li>从主分支拉取代码后，要如何处理开发对象以把它们分配到合适的传输请求之上？\r\n<ul>\r\n<li>也许你有个复杂的传输规则以帮助代码复用。我们就是如此。</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<p>你还需要一个策略来应对以下问题：</p>\r\n<ul>\r\n<li>为无法序列化的对象单独维护和配置以及单独地导入定制和工作台传输\r\n<ul>\r\n<li>听起来像一团糟</li>\r\n\r\n\r\n\r\n\r\n</ul>\r\n\r\n\r\n\r\n\r\n</li>\r\n<li>开发系统的复制（只复制SAP）\r\n<ul>\r\n<li>只是为了给你定制数据</li>\r\n\r\n\r\n\r\n\r\n</ul>\r\n\r\n\r\n\r\n\r\n</li>\r\n<li>克隆主开发系统运行的虚拟机（OS+SAP）\r\n<ul>\r\n<li>并且重命名SID和全称域名（Full Qualified Domain Name），否则你会遇到网络问题</li>\r\n\r\n\r\n\r\n\r\n</ul>\r\n\r\n\r\n\r\n\r\n</li>\r\n<li>……　</li>\r\n\r\n\r\n\r\n\r\n</ul>\r\n<p>并且，更新的频率是？</p>\r\n<ul>\r\n<li>按需</li>\r\n<li>在创建一个新分支前</li>\r\n<li>在一个新的发布循环开始的时候</li>\r\n<li>……</li>\r\n\r\n\r\n\r\n\r\n</ul>\r\n<h3>Hosted VMs</h3>\r\n<p>升级看起来是个大问题，也许不用一个本地虚拟机、而是托管虚拟机会好点。</p>\r\n<p>这样的话，无论采取何种策略来更新，都可以更轻松地执行。</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/994049/201710/994049-20171031170708605-1139461668.png\" alt=\"\"></p>\r\n<h4>优势：</h4>\r\n<ul>\r\n<li>管理员可以在任何时间访问机器</li>\r\n\r\n\r\n</ul>\r\n<h4>劣势：</h4>\r\n<ul>\r\n<li>运行开发虚拟机带来的托管成本</li>\r\n\r\n\r\n</ul>\r\n<h2>结论</h2>\r\n<p>所以，进行这一切的优点是什么？</p>\r\n<p>我们的看法是：</p>\r\n<ul>\r\n<li>真正的分支成为可能，编码时不干涉其它开发者</li>\r\n<li>由于merge request和多个commit的结合，更加有利于代码审查</li>\r\n<li>对多个发行版本的良好支持，容易切换到一个发行分支上去</li>\r\n<li>……</li>\r\n\r\n</ul>\r\n<p><strong>值得为此做出很多的努力吗？</strong></p>\r\n<p>我们的团队并不知道答案。系统同步带来的成本，看起来是巨大的。</p>\r\n<p>在这点上我们感到不舒服，因此转向社区，希望听到你们在这个话题上的的意见和经验。</p>\r\n<p> </p>\r\n<p>非常感谢，</p>\r\n<p>André</p>\r\n<p> </p>\r\n<p>参考文章：<a href=\"http://www.cnblogs.com/hhelibeb/p/7735421.html\" target=\"_blank\">abapGit简介</a></p>\r\n<p> </p>\r\n<div id=\"icibaCirclePointer\" style=\"position: absolute; top: 1304px; left: -20px;\"> </div>\r\n<div id=\"icibaCirclePointer\" style=\"position: absolute; top: 1297px; left: -19px;\"> </div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 20:37</span> <a href=\"http://www.cnblogs.com/hhelibeb/\">氢氦</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7754487\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7754487);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=294925,cb_entryId=7754487,cb_blogApp=currentBlogApp,cb_blogUserGuid='cc68a22b-914c-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/31 20:37:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 79, "image_url": ["https://pic.cnblogs.com/face/994049/20160719131059.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "SpringBoot初体验（续）", "url": "http://www.cnblogs.com/huhu1203/p/7676488.html", "author": "呼呼呼呼呼65", "article_desc": "1.如果你还不知道SpringBoot的厉害之处，或者你不知道SpringBoot的初级用法，请移步我的上一篇文章，传送门 2.SpringBoot中的表单验证 所谓验证，无非就是检验，对比，正如javax.validation.constraints包中的各种注解，从名字上我们可以看出来： 我就用 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/huhu1203/p/7676488.html\">SpringBoot初体验（续）</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>1.如果你还不知道SpringBoot的厉害之处，或者你不知道SpringBoot的初级用法，请移步我的上一篇文章，<a href=\"http://www.cnblogs.com/huhu1203/p/7638054.html\">传送门</a></p>\n<p>2.SpringBoot中的表单验证</p>\n<p>所谓验证，无非就是检验，对比，正如javax.validation.constraints包中的各种注解，从名字上我们可以看出来：</p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/959267/201710/959267-20171016130010474-262961684.png\" alt=\"\"></p>\n<p>我就用这个包中的Min做例子：</p>\n<p>我给我们的数据持久化层Dril类的age属性加上注解@Min</p>\n<p>a.Dril.java</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\">数据持久化</span>\n<span style=\"color: #000000\">@Entity\n</span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Dril {\n    \n    @Id\n    @GeneratedValue\n    </span><span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> Integer id;\n    \n    </span><span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> String name;\n    \n    @Min(value</span>=18,message=\"未成年！\"<span style=\"color: #000000\">)\n    </span><span style=\"color: #0000ff\">private</span><span style=\"color: #000000\"> Integer age;\n\n    </span><span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Dril() {\n\n    }\n\n    </span><span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Integer getId() {\n        </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> id;\n    }\n\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setId(Integer id) {\n        </span><span style=\"color: #0000ff\">this</span>.id =<span style=\"color: #000000\"> id;\n    }\n\n    </span><span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> String getName() {\n        </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> name;\n    }\n\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setName(String name) {\n        </span><span style=\"color: #0000ff\">this</span>.name =<span style=\"color: #000000\"> name;\n    }\n\n    </span><span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Integer getAge() {\n        </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> age;\n    }\n\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> setAge(Integer age) {\n        </span><span style=\"color: #0000ff\">this</span>.age =<span style=\"color: #000000\"> age;\n    }\n    \n    \n    \n}</span></pre>\n</div>\n<p>b.DrilController.java</p>\n<div class=\"cnblogs_code\">\n<pre>@RequestMapping(value=\"addDril.do\",method=<span style=\"color: #000000\">RequestMethod.POST)\n</span><span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Dril getDrilName(@Valid Dril dril,BindingResult bindingResult){\n        \n    </span><span style=\"color: #0000ff\">if</span><span style=\"color: #000000\"> (bindingResult.hasErrors()) {\n        logger.info(bindingResult.getFieldError().getDefaultMessage());\n        </span><span style=\"color: #0000ff\">return</span> <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">;\n    }\n    </span><span style=\"color: #0000ff\">return</span> drilService2.addDril(dril);</pre>\n</div>\n<p>c.运行结果</p>\n<p>当我们插入age小于18的数据的时候出现</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/959267/201710/959267-20171016131544349-384152916.png\" alt=\"\"></p>\n<p>console输出：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/959267/201710/959267-20171016131730599-1299376655.png\" alt=\"\"></p>\n<p>如果我们输入的对象年龄大于18的话出现</p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/959267/201710/959267-20171016132520365-1705468329.png\" alt=\"\"></p>\n<p>其他方法自行测试。</p>\n<p>2.AOP统一处理请求日志</p>\n<p>a.简单介绍AOP</p>\n<p>面向对象将对象垂直划分，并且每个都有自己的方法，AOP将面向对象的庞大体系进行水平分割，并将影响到多个类的公共行为做成可重用的模块。正如AOP的核心思想，将通用逻辑从业务逻辑分离出来。</p>\n<p>b.AOP的运用场景</p>\n<p>权限控制，缓存控制，事务控制，审计日志，性能监控，分布式追踪，异常处理</p>\n<p>b.使用Aspectj注解</p>\n<p>@Aspect：用于声明当前类是一个切面</p>\n<p>@Pointcut：用于描述在哪些类、哪些方法上执行切面的代码</p>\n<p>Advice：描述想要在这些方法执行的什么时机进行拦截</p>\n<p>在介绍5种Advice之前，我先说说切面表达式</p>\n<p>c.切面表达式</p>\n<p>1.designators（指示器）<br>    描述通过什么样的方式去匹配哪些类、哪些方法。如匹配方法 execution()，匹配注解 @target() @args() @within() @annotation()，匹配包/类型 @within()，匹配对象 this() bean()target()，匹配参数 args()。<br>2.wildcards（通配符）<br>    * .. +<br>    使用通配符进行描述，如* 匹配任意数量的字符 ，+ 匹配指定类及其子类， .. 一般用于匹配任意参数的子包或参数<br>3.operators（运算符）<br>    &amp;&amp; || !<br>    使用运算符进行多条件的判断，如&amp;&amp; 与操作符， || 或操作符 ，! 非操作符</p>\n<p><span style=\"font-size: 16px\">d.5种advice</span>1.匹配包类</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">  //</span><span style=\"color: #008000\"> 匹配 ProductServiceAop 类里面的所有方法</span>\n  @Pointcut(\"within(com.myimooc.springaopguide.service.ProductServiceAop)\") <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> matchType(){\n  } \n  </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配 com.myimooc.springaopguide.service 包及子包下所有类的方法</span>\n  @Pointcut(\"within(com.myimooc.springaopguide.service..*)\"<span style=\"color: #000000\">) \n  </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> matchPackage(){\n  }</span></pre>\n</div>\n<p>2.匹配对象</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">    //</span><span style=\"color: #008000\"> 匹配AOP对象的目标对象为指定类型的方法，即DemoDao的aop代理对象的方法</span>\n    @Pointcut(\"this(com.myimooc.springaopguide.dao.DemoDao)\"<span style=\"color: #000000\">)\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> testDemo() {\n    } \n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配实现IDao接口的目标对象（而不是aop代理后的对象）的方法，这里即DemoDao的方法</span>\n    @Pointcut(\"target(com.myimooc.springaopguide.dao.IDao)\"<span style=\"color: #000000\">)\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> targetDemo() {\n    } \n    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配所有以Service结尾的bean里面的方法</span>\n    @Pointcut(\"bean(*Service)\"<span style=\"color: #000000\">)\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> beanDemo() {\n    }</span></pre>\n</div>\n<p>3.匹配参数</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配任何以find开头而且只有一个Long参数的方法 </span>\n@Pointcut(\"execution(* *..find*(Long))\"<span style=\"color: #000000\">) \n</span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> argsDemo1(){}\n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配任何只有一个Long参数的方法 </span>\n@Pointcut(\"args(Long)\"<span style=\"color: #000000\">) \n</span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> argsDemo2(){} \n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配任何以find开头而且第一个参数为Long型的方法 </span>\n@Pointcut(\"execution(* *..find*(Long,..))\") <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> argsDemo3(){} \n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配第一个参数为Long型的方法 </span>\n@Pointcut(\"args(Long,..))\"<span style=\"color: #000000\">) \n</span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span> argsDemo4(){}</pre>\n</div>\n<p>4.匹配注解</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配方法标注有AdminOnly的注解的方法 </span>\n@Pointcut(\"@annotation(com.myimooc.springaopguide.security.AdminOnly)\") <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> annoDemo(){\n} \n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配标注有Beta的类底下的方法，要求的annotation的RetentionPolicy级别为CLASS @Pointcut(\"@within(com.google.common.annotations.Beta)\")</span>\n <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> annoWithDemo(){\n} \n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配标注有Repository的类底下的方法，要求的RetentionPolicy级别为RUNTIME @Pointcut(\"@target(org.springframework.stereotype.Repository)\")</span>\n <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> annoTargetDemo(){\n} \n</span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 匹配传入的参数类标注有Repository注解的方法</span>\n @Pointcut(\"@args(org.springframework.stereotype.Repository)\"<span style=\"color: #000000\">)\n </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> annoArgsDemo(){\n}</span></pre>\n</div>\n<p>5.匹配方法</p>\n<p>execution()格式</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">execution( \nmodifier</span>-pattern? <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 修饰符匹配 </span>\nret-type-pattern <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 返回值匹配 </span>\ndeclaring-type-pattern? <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 描述值包名 </span>\nname-pattern(param-pattern) <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 方法名匹配（参数匹配） </span>\n<span style=\"color: #0000ff\">throws</span>-pattern?<span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 抛出异常匹配 </span>\n)</pre>\n</div>\n<p>实例：</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">    /**</span><span style=\"color: #008000\">\n     * 切点\n     * 使用public修饰符匹配，任意返回值，在com.huhu.controller包下以Controller结尾的类名下的getDrils()方法\n     </span><span style=\"color: #008000\">*/</span><span style=\"color: #000000\">\n    @Pointcut(</span>\"execution(public * com.huhu.controller..*Controller.getDrils(..))\"<span style=\"color: #000000\">)\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Log() {\n        \n    }</span></pre>\n</div>\n<p>e.AOP所需要的注解</p>\n<p>@Before，前置通知</p>\n<p>@After（finally）后置通知，方法执行完之后</p>\n<p>@AfterReturning，返回通知，成功执行之后</p>\n<p>@AfterThrowing，异常通知，抛出异常之后</p>\n<p>@Around，环绕通知</p>\n<p>f.请开始我们的表演</p>\n<p>代码接着上篇的代码，我们给在controller运行前输出访问的URL，METHOD，IP，类方法以及参数</p>\n<p>HttpAspect.java</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">@Aspect\n@Component\n</span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> HttpAspect {\n    Logger logger</span>=LoggerFactory.getLogger(HttpAspect.<span style=\"color: #0000ff\">class</span><span style=\"color: #000000\">);\n    \n    </span><span style=\"color: #008000\">/**</span><span style=\"color: #008000\">\n     * 切点\n     * 使用public修饰符匹配，任意返回值，在com.huhu.controller包下以Controller结尾的类名下的getDrils()方法\n     </span><span style=\"color: #008000\">*/</span><span style=\"color: #000000\">\n    @Pointcut(</span>\"execution(public * com.huhu.controller..*Controller.getDrils(..))\"<span style=\"color: #000000\">)\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Log() {\n        \n    }\n    \n    </span><span style=\"color: #008000\">/**</span><span style=\"color: #008000\">\n     * 用于匹配方法执行的连接点\n     * </span><span style=\"color: #808080\">@param</span><span style=\"color: #008000\"> joinpoint(为org.aspectj.lang.JoinPoint的对象)\n     </span><span style=\"color: #008000\">*/</span><span style=\"color: #000000\">\n    @Before(</span>\"Log()\"<span style=\"color: #000000\">)\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> before(JoinPoint joinpoint) {\n        logger.info(</span>\"AOP的before()方法\"<span style=\"color: #000000\">);\n        \n        ServletRequestAttributes attributes</span>=<span style=\"color: #000000\">(ServletRequestAttributes)RequestContextHolder.getRequestAttributes();\n        HttpServletRequest request </span>=<span style=\"color: #000000\"> attributes.getRequest();\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">url</span>\n        logger.info(\"url={}\"<span style=\"color: #000000\">,request.getRequestURL());\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">method</span>\n        logger.info(\"method={}\"<span style=\"color: #000000\">,request.getMethod());\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">ip</span>\n        logger.info(\"ip={}\"<span style=\"color: #000000\">,request.getRemoteAddr());\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">类方法</span>\n        logger.info(\"class_method= {}\",joinpoint.getSignature().getDeclaringTypeName()+\".\"+<span style=\"color: #000000\">joinpoint.getSignature().getName());\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">参数</span>\n        logger.info(\"args={}\"<span style=\"color: #000000\">,joinpoint.getArgs());\n    }\n\n    @After(</span>\"Log()\"<span style=\"color: #000000\">)\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> after() {\n        logger.info(</span>\"AOP的after()方法\"<span style=\"color: #000000\">);\n    }  \n}</span></pre>\n</div>\n<p>为了知道是运行controller前输出的，我们给controller加上</p>\n<div class=\"cnblogs_code\">\n<pre>@RequestMapping(value=\"getDrils\",method=<span style=\"color: #000000\">RequestMethod.GET)\n    </span><span style=\"color: #0000ff\">public</span> List&lt;Dril&gt;<span style=\"color: #000000\"> getDrils(){\n        logger.info(</span>\"getDrils\"<span style=\"color: #000000\">);\n        List</span>&lt;Dril&gt; drils =<span style=\"color: #000000\">drilService.findAll();\n        </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> drils;\n    }</span></pre>\n</div>\n<p>运行结果：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/959267/201710/959267-20171031124615886-1921681944.png\" alt=\"\"></p>\n<p>结果向我们展示了使用AOP的结果，所以AOP显然能做权限控制，缓存控制，事务控制，审计日志，性能监控，分布式追踪，异常处理这些事了。</p>\n<p>参考资料：</p>\n<p><a href=\"http://www.imooc.com/article/20366\">《探秘Spring AOP》学习总结</a></p>\n<p>慕课网--Spring Boot进阶之Web进阶</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 21:02</span> <a href=\"http://www.cnblogs.com/huhu1203/\">呼呼呼呼呼65</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7676488\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7676488);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=345408,cb_entryId=7676488,cb_blogApp=currentBlogApp,cb_blogUserGuid='ca789fe9-a01c-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/31 21:02:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 277, "image_url": ["https://pic.cnblogs.com/face/959267/20170719220808.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "双十一临近，怎样让买家流畅地秒杀？ ——腾讯WeTest独家开放电商产品压测服务", "url": "http://www.cnblogs.com/wetest/p/7763058.html", "author": "腾讯WeTest", "article_desc": "WeTest 导读 十一月临近，一年一度的电商大戏“双十一”又将隆重出场，目前各大商家已经开始各类优惠券的发放，各类大促的商品表单也已经提前流出，即将流入各个用户的购物车中。 作为这些活动的载体，产品宣传、商品购买、交易结算、客户反馈以及售后服务都是电商产品（包括网站、APP、小程序等形式）非常重要 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/wetest/p/7763058.html\">双十一临近，怎样让买家流畅地秒杀？ ——腾讯WeTest独家开放电商产品压测服务</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><div id=\"csdnEditor\" class=\" ltr\">\n<div class=\"layout-wrapper-l1\">\n<div class=\"layout-wrapper-l2\">\n<div class=\"layout-wrapper-l3\">\n<div class=\"preview-panel\">\n<div class=\"preview-container\">\n<div id=\"preview-contents\">\n<div id=\"wmd-preview-section-44\" class=\"wmd-preview-section preview-content\">\n<p><span style=\"font-size: 14pt\"><strong>WeTest 导读</strong></span></p>\n</div>\n<div id=\"wmd-preview-section-30\" class=\"wmd-preview-section preview-content\">\n<p>十一月临近，一年一度的电商大戏“双十一”又将隆重出场，目前各大商家已经开始各类优惠券的发放，各类大促的商品表单也已经提前流出，即将流入各个用户的购物车中。</p>\n<p>作为这些活动的载体，产品宣传、商品购买、交易结算、客户反馈以及售后服务都是电商产品（包括网站、APP、小程序等形式）非常重要的功能，但当双十一临近，电商产品要面对大量级用户群体涌入，流量猛增的局面，性能表现往往就成为了成功的关键。</p>\n<hr></div>\n<div id=\"wmd-preview-section-52\" class=\"wmd-preview-section preview-content\">\n<h2 id=\"双十一的流量挑战\"><strong>双十一的流量挑战</strong></h2>\n<p>在优化电商产品的性能表现前，首先要了解一下电商产品的访问逻辑，以电商网站为例：</p>\n<p>电商网站的核心内容，包括了Web服务器、应用服务器和数据库服务器，其中前端Web服务器负责接收并处理来自用户的HTTP请求，并生成Web页面反馈给用户；中间的应用服务器负责执行其中的业务逻辑；后台数据库和文件服务器负责存储用户、产品信息及状态。</p>\n<p>为了提升访问的性能，有的网站会在数据库服务器前部署数据缓存设备。外围部署负载均衡服务器，负责在海量用户访问与多台服务器间进行负载分担。</p>\n<p>对于电商产品来说，当流量变高，成百上千的服务器和其他设备面对海量用户的访问，会遇到这样的场景：有的用户在不断查询商品信息，有的用户在注册会员，有的用户在修改购物车信息，有的用户在下单付款，有的用户在秒抢商品，等等。</p>\n<p>此时若不重视承载能力，会造成严重的后果。比如国庆期间鹿晗公布恋情导致微博宕机，以及过去几年iPhone新机发布导致官网崩溃，都是由于对流量突增没有足够的承载能力导致的。</p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031173921371-425933992.png\" alt=\"\"></p>\n<p> </p>\n<p>而这些现象，都给用户带来了很大的困扰，而且用户体量越大，影响的波及面就越广，不仅影响用户口碑，也影响产品收入。如果把产品的月收入平摊到每一分钟的话，大家可以通过30分钟，60分钟，乃至12小时，24小时计算具体的损失金额，还要加上因此产生的用户流失以及品牌口碑影响。</p>\n<p>所以，如何在“双十一”这样火热的节点保证用户顺畅访问网站，成了一个重大的挑战。</p>\n<p> </p>\n</div>\n<div id=\"wmd-preview-section-80\" class=\"wmd-preview-section preview-content\">\n<h2 id=\"电商产品的压测方案\"><strong>电商产品的压测方案</strong></h2>\n<p>那么，怎么样才能让电商网站在面对活动流量高峰的时候能够提供正常服务呢？容量规划，压力测试以及压测环境的配置是电商网站必须要经历的考验。</p>\n<p>尤其是压力测试，是整个电商网站活动前的实战演习，能够提前预知网站性能表现的瓶颈与故障点。</p>\n<p> </p>\n</div>\n<div id=\"wmd-preview-section-109\" class=\"wmd-preview-section preview-content\">\n<h3 id=\"一预估流量情况\"><strong>一、预估流量情况</strong></h3>\n<p>电商网站背后的系统通常分为两部分，一部分是导购，主要的作用是为用户推荐各式各样的商品，提供搜索服务，给用户挑选商品带来便利；另一部分就是交易，简单来说就是电商网站下单、抢购等活动的过程。</p>\n<p> </p>\n<p>两部分的流量形式是不同的。导购部分的流量会呈现为一个慢慢上涨的曲线，对于服务器来说，流量的压力是慢慢增加的；而交易部分的流量，却是陡然上升的，特别是在某个抢购活动中，压力会瞬间增长到一个高峰，没有给人和机器任何的反应和决策时间，这也是电商产品承载能力要求比其他的产品高的重要原因之一。</p>\n<p> </p>\n<p>但是这个高峰会是多少？很多人在事前并不知道，如果要模拟真实的压力场景，不同的压力造成的测试成本都不同，定高了，成本高，定低了，没效果，因此要想让压力测试既能满足足够的流量压力，又把测试的成本压缩到最小，活动筹备之前对于流量的预估非常重要。</p>\n<p> </p>\n<p>阿里巴巴在双十一活动前通常也会进行压力的预估，将其叫做”容量规划“。活动流量会有多少？峰值会到多少？电商网站的开发人员需要心里有数。</p>\n<p> </p>\n</div>\n<div id=\"wmd-preview-section-188\" class=\"wmd-preview-section preview-content\">\n<h3 id=\"二场景化压测\"><strong>二、场景化压测</strong></h3>\n<p>在实际电商活动开始后，用户会从四面八方涌入产品，如何去模拟用户的真实行为，形成一个最接近真实的压测场景是电商产品压测第二件需要做的事情。</p>\n<p>电商产品通常有很多接口，用户在访问过程中可能接触其中的某几个接口，一种压测的方式就是针对这所有的接口进行统一的压测，增加相同的压力，算出一个系统的容量，然后再根据这个系统的容量情况扩展到一个个集群。</p>\n<p>这种方法有一个缺陷，就是如果这个系统某个接口出现了问题，整个集群都会崩溃。</p>\n<p>而场景化压测可以避免这类问题。在实际的压测场景中，流量很大一部分都会被分流，由于每个用户的购物流程都不一样，因此对于电商网站上的接口受到的压力都会不同，可以实现用最少的服务器支撑最大的流量。</p>\n<p> </p>\n<p>那么，一般电商购物会有哪些场景呢？以下举三个例子。</p>\n<p><strong>场景一：登录注册，访问个人中心</strong></p>\n<p>用户在进入电商产品后，会有查看自己订单情况的需求，因此，“登录“”注册“以及”个人中心“会成为流量较高的接口。</p>\n<p> </p>\n<p><strong>场景二：商品遍历</strong></p>\n<p>“商品遍历“指的是用户在下单购买前，对不同的商品页进行访问的过程，而此时用户已经进入了登录状态，会带着登录态对不同的页面进行访问，此时不同的商品页面接口会承受比较大的压力。</p>\n<p> </p>\n<p><strong>场景三：购买下单</strong></p>\n<p>这可能是电商网站并发压力最高的一个接口，购买按钮，购物车页面以及付费接口都会面临很大的瞬时压力。</p>\n<p>在确认完“双十一“活动中承受压力可能最高的几个场景之后，产品开发或测试人员就可以根据场景配置相应的测试用例了。</p>\n<p> </p>\n</div>\n<div id=\"wmd-preview-section-249\" class=\"wmd-preview-section preview-content\">\n<h3 id=\"三线上压测配置\"><strong>三、线上压测配置</strong></h3>\n<p>配置测试用例，实现真实压力，通常需要一个能够真实模拟海量用户的测试工具，WeTest压测大师为电商行业提供了一个适用的测试环境，提供了”上下文变量“、”全局参数化“等功能，可以满足电商产品大部分的测试需求。</p>\n</div>\n<div id=\"wmd-preview-section-374\" class=\"wmd-preview-section preview-content\">\n<h4 id=\"上下文变量实现用户登录购买下单场景\"><strong>“上下文变量“实现”用户登录”、”购买下单“场景</strong></h4>\n<p>“上下文变量“实现的是将用户登录时的用户信息传输到下一个页面中，对于电商平台来说，可以真实模拟用户登录后，点击了”购买“，进入了购买页面。以下是操作介绍：</p>\n<p>1、进入压测大师首页，选择一个已有的项目进入，如没有项目可以新建项目 <br><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174008433-1292102103.png\" alt=\"\"></p>\n<p> </p>\n<p>2、创建一个新的URL测试，如下图： <br><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174017777-769609835.png\" alt=\"\"></p>\n<p> </p>\n<p>3、在测试设置部分，填写压力预估的最大人数 <br><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174026465-1878579879.png\" alt=\"\"></p>\n<p> </p>\n<p>这里当配置人数大于400时，为防范非法攻击等现象，需要对被测域名进行认证，点击域名认证按照提示认证即可。</p>\n<p> </p>\n<p>4、在“客户端请求“点击”上下文变量“，开始配置 <br><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174044621-113472006.png\" alt=\"\"></p>\n<p> </p>\n<p>5、 “上下文变量设置“是为了实现URL之间参数信息的传递，因此需要点击右下角的”+一个URL请求“增加一个URL，然后保证第一个URL的”变量名“与第二个URL的字段保持一致 <br><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174059246-1481919404.png\" alt=\"\"></p>\n<p> </p>\n<p>6、“提取方式“通常选择”键值对“较多（具体使用可根据实际情况），选择想要传递信息的”header名称“，确定”提取规则“。”提取规则“中所填写的就是传递到下一个页面的信息，比如电商平台用户的会员信息。 <br><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174109058-1013944144.png\" alt=\"\"></p>\n<p> </p>\n<p><strong>那么”提取规则“应该填写什么呢？我们需要在URL页面中去寻找这个”键值“。</strong></p>\n<p>首先在chrome浏览器中输入第一个URL，点击F12，点击Network，刷新一下页面之后点击最左侧的”setcookie_prep.php“，找到对应的header“Set-Cookie“,后面order_id后的值，就是我们将要传输给下一个URL的信息。 <br><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174127965-307764485.png\" alt=\"\"></p>\n<p> </p>\n<p>7、完成了”上下文变量“的设置之后，在“测试模型“中的场景中选择”上下文“模式，分别输入两个URL。 <br><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174137308-977717089.png\" alt=\"\"></p>\n<p> </p>\n<p>8、 如果自有服务器，则可以在“服务器监控“的”添加监控“中设置服务器信息；如果没有，则可以点击”立即执行“开始测试 <br><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174145324-456091887.png\" alt=\"\"></p>\n<p> </p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</div>\n<div id=\"wmd-preview-section-483\" class=\"wmd-preview-section preview-content\">\n<h4 id=\"全局参数化实现商品遍历场景\"><strong>“全局参数化“实现”商品遍历“场景</strong></h4>\n<p>“全局参数化“实现的是通过自动更改”index“字段中的参数，实现遍历电商平台上所有商品页面，对电商平台上所有的商品页面模拟真实的用户压力。</p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174152902-1330156438.png\" alt=\"\"></p>\n<p> </p>\n<p>1、点击右上角的“全局参数化“的设置按钮，开始设置全局参数化 <br><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174205261-1140985582.png\" alt=\"\"></p>\n<p> </p>\n<p>2、点击“添加“，添加参数，将参数名修改为想要测试的字段，比如上面的”index“字段。另外参数化形式中有”自增“、”随机值“和”定长“三种配置方式。</p>\n<p><strong>“自增“</strong>可以设置”最大值“和”最小值“，比如最小值设置1，最大值设置100，就可以自定义服务器压力，遍历电商平台上参数值为1-100的所有商品；</p>\n<p><strong>“随机值“</strong>可以实现在自定义范围内随机对某商品页面进行压力测试；</p>\n<p><strong>“定长“</strong>通过设置一定长度下的数值，在这个范围内的所有商品页面进行随机的压力测试，比如定长设置为3，则会在”000-999“”aaa-zzz“之间进行随机的压力测试。</p>\n<p> </p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174232277-1173484243.png\" alt=\"\"></p>\n<p style=\"text-align: center\">“全局参数化“可以设置”自增“、”随机值“和”定长“三种形式</p>\n<p style=\"text-align: center\"> </p>\n<p><img style=\"display: block; margin-left: auto; margin-right: auto\" src=\"http://images2017.cnblogs.com/blog/992994/201710/992994-20171031174253824-291960971.png\" alt=\"\"></p>\n<p style=\"text-align: center\">“全局参数化“下的”定长“参数设置</p>\n<p style=\"text-align: center\"> </p>\n<p>对电商平台来说，要进行压测的部分不止是遍历所有商品页还有模拟真实用户购买那么简单，还会有搜索，聊天，收货，评价等更多的功能，本文通过两个简单的场景示例，可以帮助电商网站把测试成本降到最小，把测试效果放到最大，避免让电商平台的买家因为无法付款而流失。</p>\n<p>做好这些，才能做出完整的电商产品。</p>\n<hr>\n<p><span style=\"font-size: 18px\"><strong>WeTest压测大师</strong> </span>服务了包括王者荣耀、龙之谷手游、火影忍者等多款高星级手游， QQ、NOW直播等明星产品，更是服务了携程、京东、特仑苏以及各类规模的电商产品，<strong>此次推出”电商行业压测解决方案“</strong>，希望能够帮助开发者真实模拟电商用户使用场景，帮助开发者发现服务器端的性能瓶颈，进行针对性的性能调优。在保证用户流畅体验的同时，也能降低服务器采购和维护成本，实现用户与电商开发者的技术共赢！</p>\n<p> </p>\n<p><strong>“压测大师”目前已经开放对外，目前更有<span style=\"font-size: 18px; color: #ff0000\">低至四折的时效资源包优惠</span>，欢迎大家的使用！</strong></p>\n<p><strong>体验地址：<a href=\"http://wetest.qq.com/gaps?from=content_cnblogs\" target=\"_blank\">http://wetest.qq.com/gaps/</a></strong></p>\n<p>如果对使用当中有任何疑问，欢迎联系腾讯WeTest企业qq：800024531</p>\n<p> </p>\n<p> </p>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 19:05</span> <a href=\"http://www.cnblogs.com/wetest/\">腾讯WeTest</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7763058\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7763058);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=307146,cb_entryId=7763058,cb_blogApp=currentBlogApp,cb_blogUserGuid='8dad08e7-554a-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/31 19:05:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 330, "image_url": ["https://pic.cnblogs.com/face/992994/20170504141151.png"], "date_pub": "2017-10-31", "article_common": 2}
{"title": "原生js+css实现重力模拟弹跳系统的登录页面", "url": "http://www.cnblogs.com/yingzi1028/p/7763450.html", "author": "爱喝酸奶的吃货", "article_desc": "今天小颖把之前保存的js特效视频看了一遍，跟着视频敲了敲嘻嘻，用原生js实现一个炫酷的登录页面。怎么个炫酷法呢，看看下面的图片大家就知道啦。 效果图： 不过在看代码之前呢，大家先和小颖看看css中的opacity、transition、box-shadow这三个属性。 1.opacity 作用：设置 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/yingzi1028/p/7763450.html\">原生js+css实现重力模拟弹跳系统的登录页面</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>   今天小颖把之前保存的js特效视频看了一遍，跟着视频敲了敲嘻嘻，用原生js实现一个炫酷的登录页面。怎么个炫酷法呢，看看下面的图片大家就知道啦。</p>\r\n<h1>效果图：</h1>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/813088/201710/813088-20171031201425404-1406962117.gif\" alt=\"\"></p>\r\n<p><span style=\"font-size: 18pt; color: #ff0000;\">不过在看代码之前呢，大家先和小颖看看css中的opacity、transition、box-shadow这三个属性。</span></p>\r\n<h2>1.opacity</h2>\r\n<p>作用：设置一个元素的透明度</p>\r\n<p><span style=\"font-size: 16px; color: #ff00ff;\"><strong>定义和用法</strong></span></p>\r\n<p>opacity 属性设置元素的不透明级别。</p>\r\n<table class=\"dataintable\">\r\n<tbody>\r\n<tr><th style=\"width: 25%;\">默认值：</th>\r\n<td style=\"width: 75%;\">1</td>\r\n</tr>\r\n<tr><th>继承性：</th>\r\n<td>no</td>\r\n</tr>\r\n<tr><th>版本：</th>\r\n<td>CSS3</td>\r\n</tr>\r\n<tr><th>JavaScript 语法：</th>\r\n<td><em>object</em>.style.opacity=0.5</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p><span style=\"font-size: 16px;\"><strong><span style=\"color: #ff00ff;\">语法</span></strong></span></p>\r\n<pre>opacity: <em>value</em>|inherit;</pre>\r\n<table class=\"dataintable\">\r\n<tbody>\r\n<tr><th style=\"width: 25%;\">值</th><th>描述</th><th style=\"width: 8%;\">测试</th></tr>\r\n<tr>\r\n<td><em>value</em></td>\r\n<td>规定不透明度。从 0.0 （完全透明）到 1.0（完全不透明）。</td>\r\n<td><a href=\"http://www.w3school.com.cn/tiy/c.asp?f=css_opacity\" target=\"_blank\">测试</a></td>\r\n</tr>\r\n<tr>\r\n<td>inherit</td>\r\n<td>应该从父元素继承 opacity 属性的值。</td>\r\n<td> </td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p><span style=\"font-size: 16px;\"><a href=\"http://www.w3school.com.cn/tiy/t.asp?f=css3_opacity_js\" target=\"_blank\">亲自试一试 - 实例</a></span></p>\r\n<h2>2.transition</h2>\r\n<p>作用：将元素从一种样式逐渐改变为另一种的效果。</p>\r\n<p><span style=\"font-size: 16px;\"><strong><span style=\"color: #ff00ff;\">定义和用法</span></strong></span></p>\r\n<p>transition 属性是一个简写属性，用于设置四个过渡属性：</p>\r\n<ul>\r\n<li>transition-property</li>\r\n<li>transition-duration</li>\r\n<li>transition-timing-function</li>\r\n<li>transition-delay</li>\r\n</ul>\r\n<p class=\"note\">注释：请始终设置 <a title=\"CSS3 transition-duration 属性\" href=\"http://www.w3school.com.cn/cssref/pr_transition-duration.asp\">transition-duration</a> 属性，否则时长为 0，就不会产生过渡效果。</p>\r\n<table class=\"dataintable\">\r\n<tbody>\r\n<tr><th style=\"width: 25%;\">默认值：</th>\r\n<td style=\"width: 75%;\">all 0 ease 0</td>\r\n</tr>\r\n<tr><th>继承性：</th>\r\n<td>no</td>\r\n</tr>\r\n<tr><th>版本：</th>\r\n<td>CSS3</td>\r\n</tr>\r\n<tr><th>JavaScript 语法：</th>\r\n<td><em>object</em>.style.transition=\"width 2s\"</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p><span style=\"font-size: 16px;\"><strong><span style=\"color: #ff00ff;\">语法</span></strong></span></p>\r\n<pre>transition: <em>property</em> <em>duration</em> <em>timing-function</em> <em>delay</em>;</pre>\r\n<table class=\"dataintable\">\r\n<tbody>\r\n<tr><th style=\"width: 30%;\">值</th><th>描述</th></tr>\r\n<tr>\r\n<td><a title=\"CSS3 transition-property 属性\" href=\"http://www.w3school.com.cn/cssref/pr_transition-property.asp\">transition-property</a></td>\r\n<td>规定设置过渡效果的 CSS 属性的名称。</td>\r\n</tr>\r\n<tr>\r\n<td><a title=\"CSS3 transition-duration 属性\" href=\"http://www.w3school.com.cn/cssref/pr_transition-duration.asp\">transition-duration</a></td>\r\n<td>规定完成过渡效果需要多少秒或毫秒。</td>\r\n</tr>\r\n<tr>\r\n<td><a title=\"CSS3 transition-timing-function 属性\" href=\"http://www.w3school.com.cn/cssref/pr_transition-timing-function.asp\">transition-timing-function</a></td>\r\n<td>规定速度效果的速度曲线。</td>\r\n</tr>\r\n<tr>\r\n<td><a title=\"CSS3 transition-delay 属性\" href=\"http://www.w3school.com.cn/cssref/pr_transition-delay.asp\">transition-delay</a></td>\r\n<td>定义过渡效果何时开始。</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p><span style=\"font-size: 16px;\"><a href=\"http://www.w3school.com.cn/tiy/t.asp?f=css3_transition1\" target=\"_blank\">亲自试一试 - 实例</a></span></p>\r\n<h2>3.box-shadow</h2>\r\n<p>作用：给元素添加阴影效果。</p>\r\n<div>\r\n<p><span style=\"font-size: 16px;\"><strong><span style=\"color: #ff00ff;\">定义和用法</span></strong></span></p>\r\n<p>box-shadow 属性向框添加一个或多个阴影。</p>\r\n<p class=\"tip\">提示：请使用 border-image-* 属性来构造漂亮的可伸缩按钮！</p>\r\n<table class=\"dataintable\">\r\n<tbody>\r\n<tr><th style=\"width: 25%;\">默认值：</th>\r\n<td style=\"width: 75%;\">none</td>\r\n</tr>\r\n<tr><th>继承性：</th>\r\n<td>no</td>\r\n</tr>\r\n<tr><th>版本：</th>\r\n<td>CSS3</td>\r\n</tr>\r\n<tr><th>JavaScript 语法：</th>\r\n<td><em>object</em>.style.boxShadow=\"10px 10px 5px #888888\"</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n<p><span style=\"font-size: 16px;\"><strong><span style=\"color: #ff00ff;\">语法</span></strong></span></p>\r\n<pre>box-shadow: <em>h-shadow</em> <em>v-shadow</em> <em>blur</em> <em>spread</em> <em>color</em> inset;</pre>\r\n<p class=\"note\">注释：box-shadow 向框添加一个或多个阴影。该属性是由逗号分隔的阴影列表，每个阴影由 2-4 个长度值、可选的颜色值以及可选的 inset 关键词来规定。省略长度的值是 0。</p>\r\n<table class=\"dataintable\">\r\n<tbody>\r\n<tr><th style=\"width: 25%;\">值</th><th>描述</th><th style=\"width: 8%;\">测试</th></tr>\r\n<tr>\r\n<td><em>h-shadow</em></td>\r\n<td>必需。水平阴影的位置。允许负值。</td>\r\n<td><a href=\"http://www.w3school.com.cn/tiy/c.asp?f=css_box-shadow\" target=\"_blank\">测试</a></td>\r\n</tr>\r\n<tr>\r\n<td><em>v-shadow</em></td>\r\n<td>必需。垂直阴影的位置。允许负值。</td>\r\n<td><a href=\"http://www.w3school.com.cn/tiy/c.asp?f=css_box-shadow\" target=\"_blank\">测试</a></td>\r\n</tr>\r\n<tr>\r\n<td><em>blur</em></td>\r\n<td>可选。模糊距离。</td>\r\n<td><a href=\"http://www.w3school.com.cn/tiy/c.asp?f=css_box-shadow&amp;p=3\" target=\"_blank\">测试</a></td>\r\n</tr>\r\n<tr>\r\n<td><em>spread</em></td>\r\n<td>可选。阴影的尺寸。</td>\r\n<td><a href=\"http://www.w3school.com.cn/tiy/c.asp?f=css_box-shadow&amp;p=7\" target=\"_blank\">测试</a></td>\r\n</tr>\r\n<tr>\r\n<td><em>color</em></td>\r\n<td>可选。阴影的颜色。请参阅 CSS 颜色值。</td>\r\n<td><a href=\"http://www.w3school.com.cn/tiy/c.asp?f=css_box-shadow&amp;p=10\" target=\"_blank\">测试</a></td>\r\n</tr>\r\n<tr>\r\n<td>inset</td>\r\n<td>可选。将外部阴影 (outset) 改为内部阴影。</td>\r\n<td><a href=\"http://www.w3school.com.cn/tiy/c.asp?f=css_box-shadow&amp;p=15\" target=\"_blank\">测试</a></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p><span style=\"font-size: 16px;\"><a href=\"http://www.w3school.com.cn/tiy/t.asp?f=css3_image_gallery\" target=\"_blank\">亲自试一试 - 实例</a></span></p>\r\n<h2>怎么实现的呢，哈哈哈，代码看这里：</h2>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:html;gutter:true;\">&lt;!DOCTYPE html&gt;\r\n&lt;html&gt;\r\n\r\n&lt;head&gt;\r\n    &lt;meta charset=\"utf-8\"&gt;\r\n    &lt;title&gt;梦幻登录&lt;/title&gt;\r\n    &lt;style type=\"text/css\"&gt;\r\n    * {\r\n        margin: 0;\r\n        padding: 0;\r\n        list-style: none;\r\n    }\r\n\r\n    body {\r\n        overflow: hidden;\r\n    }\r\n\r\n    #bg_wrap {\r\n        width: 100%;\r\n        height: 100%;\r\n        position: absolute;\r\n        left: 0;\r\n        top: 0;\r\n        overflow: hidden;\r\n    }\r\n\r\n    #bg_wrap div {\r\n        width: 100%;\r\n        height: 100%;\r\n        position: absolute;\r\n        left: 0;\r\n        top: 0;\r\n        opacity: 0;\r\n        /* 设置透明度 */\r\n        transition: opacity 3s;\r\n    }\r\n    /* nth-of-type(1) *筛选选择器选择第一个*/\r\n\r\n    #bg_wrap div:nth-of-type(1) {\r\n        opacity: 1;\r\n    }\r\n\r\n    #Login {\r\n        width: 272px;\r\n        height: 300px;\r\n        margin: 200px auto;\r\n    }\r\n\r\n    #Login .move {\r\n        position: absolute;\r\n        top: -100px;\r\n        z-index: 999;\r\n    }\r\n\r\n    #Login h3 {\r\n        width: 270px;\r\n        font-size: 30px;\r\n        font-weight: 700;\r\n        color: #fff;\r\n        font-family: '微软雅黑';\r\n        text-align: center;\r\n        margin-bottom: 30px;\r\n        cursor: move;\r\n        /* top: 100px; */\r\n    }\r\n    /*  #username {\r\n        top: 170px;\r\n    }\r\n\r\n    #password {\r\n        top: 225px;\r\n    } */\r\n\r\n    #Login input.text {\r\n        width: 270px;\r\n        height: 42px;\r\n        color: #fff;\r\n        background: rgba(45, 45, 45, 0.15);\r\n        border-radius: 6px;\r\n        border: 1px solid rgba(255, 255, 255, 0.15);\r\n        box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 1.0) inset;\r\n        text-indent: 10px;\r\n    }\r\n\r\n    #Login input.btn {\r\n        /* top: 280px; */\r\n        background: #ef4300;\r\n        width: 272px;\r\n        height: 44px;\r\n        border-radius: 6px;\r\n        color: #fff;\r\n        box-shadow: 0 15px 30px 0 rgba(255, 255, 255, 0.25) inset, 0 2px 7px 0 rgba(0, 0, 0, 0.2);\r\n        /* -webkit-box-shadow: 0 15px 30px 0 rgba(255, 255, 255, 0.25) inset, 0 2px 7px 0 rgba(0, 0, 0, 0.2);\r\n        -moz-box-shadow: 0 15px 30px 0 rgba(255, 255, 255, 0.25) inset, 0 2px 7px 0 rgba(0, 0, 0, 0.2); */\r\n        border: 0;\r\n        text-align: center;\r\n    }\r\n    /* #Login input.focus {\r\n        outline: none;\r\n        box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.2) inset;\r\n    } */\r\n\r\n    input::-webkit-input-placeholder {\r\n        color: #fff;\r\n    }\r\n    &lt;/style&gt;\r\n&lt;/head&gt;\r\n\r\n&lt;body&gt;\r\n    &lt;div id=\"bg_wrap\"&gt;\r\n        &lt;div&gt;&lt;img src=\"images/1.jpg\" width=\"100%\" height=\"100%\"&gt;&lt;/div&gt;\r\n        &lt;div&gt;&lt;img src=\"images/2.jpg\" width=\"100%\" height=\"100%\"&gt;&lt;/div&gt;\r\n        &lt;div&gt;&lt;img src=\"images/3.jpg\" width=\"100%\" height=\"100%\"&gt;&lt;/div&gt;\r\n    &lt;/div&gt;\r\n    &lt;div id=\"Login\"&gt;\r\n        &lt;h3 id=\"title\" class=\"move\"&gt;User Login&lt;/h3&gt;\r\n        &lt;form action=\"#\" method=\"post\" target=\"_blank\"&gt;\r\n            &lt;input type=\"text\" placeholder=\"UserName\" name=\"username\" id=\"username\" class=\"text move\"&gt;\r\n            &lt;input type=\"password\" placeholder=\"PassWord\" name=\"password\" id=\"password\" class=\"text move\"&gt;\r\n            &lt;input type=\"submit\" value=\"Sign in\" class=\"btn move\" id=\"submit\"&gt;\r\n        &lt;/form&gt;\r\n    &lt;/div&gt;\r\n    &lt;script type=\"text/javascript\"&gt;\r\n    /*背景渐变*/\r\n    /*function(){}   匿名函数\r\n      ()()           IIFE匿名函数立刻执行，函数自执行体*/\r\n    (function() {\r\n        var timer = null; //声明定时器\r\n        var oImg = document.querySelectorAll('#bg_wrap div') //h5最新元素获取写法获取到的是一组元素\r\n        //querySelector获取单个元素的   兼容ie8\r\n        var len = oImg.length; //3\r\n        var index = 0;\r\n        timer = setInterval(function() {\r\n            oImg[index].style.opacity = 0;\r\n            index++;\r\n            // if(index&gt;=3){\r\n            // \tindex=0;\r\n            // }\r\n            index %= len; //index=index%len求模取余 0%3=0; 1%3=1; 2%3=2; 3%3=0;\r\n            oImg[index].style.opacity = 1;\r\n        }, 2000);\r\n    })();\r\n    // 重力模拟弹跳系统\r\n    (function() {\r\n        /*\r\n        改变定位元素的top值\r\n        达到指定位置之后进行弹跳一次\r\n        多个元素一次运动\r\n        动画序列*/\r\n        var oMove = document.querySelectorAll('.move');\r\n        var oLen = oMove.length;\r\n        var timer = null;\r\n        var timeout = null;\r\n        var speed = 3; //移动距离\r\n        move(oLen - 1);\r\n\r\n        function move(index) {\r\n            if (index &lt; 0) {\r\n                clearInterval(timer); //清除循环定时器\r\n                clearTimeout(timeout); //清除延时定时器\r\n                return; //终止函数\r\n            }\r\n            var endTop = 150 + (index * 60); //根据下标计算endTop值\r\n            timer = setInterval(function() {\r\n                speed += 3;\r\n                var T = oMove[index].offsetTop + speed; //设置每一次的top值\r\n                if (T &gt; endTop) {\r\n                    T = endTop;\r\n                    speed *= -1 //取反，让移动距离变为负数\r\n                    speed *= 0.4;\r\n                    //慢慢停下来\r\n                }\r\n                oMove[index].style.top = T + 'px';\r\n            }, 20);\r\n            timeout = setTimeout(function() {\r\n                clearInterval(timer);\r\n                index--;\r\n                console.log(9);\r\n                move(index);\r\n                console.log(index);\r\n            }, 900) //过900毫秒之后再执行方法里的代码\r\n        }\r\n    })()\r\n    &lt;/script&gt;\r\n&lt;/body&gt;\r\n\r\n&lt;/html&gt;\r\n</pre>\r\n</div>\r\n<h2><a href=\"https://gitee.com/lucy1028/loginDemo\" target=\"_blank\"> git地址</a></h2></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 20:46</span> <a href=\"http://www.cnblogs.com/yingzi1028/\">爱喝酸奶的吃货</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7763450\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7763450);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=258636,cb_entryId=7763450,cb_blogApp=currentBlogApp,cb_blogUserGuid='d8687c06-d15d-e511-b908-9dcfd8948a71',cb_entryCreatedDate='2017/10/31 20:46:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 407, "image_url": ["https://pic.cnblogs.com/face/813088/20170615152718.png"], "date_pub": "2017-10-31", "article_common": 2}
{"title": "TDD 之 Dojo coding", "url": "http://www.cnblogs.com/by-dream/p/7762537.html", "author": "胖喵~", "article_desc": "dojo和kata的练习记录： 进入 http://cyber-dojo.org/ 由一个人进行 setup a default practice，然后创建： 这里支持各种语言和各种测试框架，这里我们选择C++和GoogleTest 这里是选择一个题目进行联系，我们选择“网球记分规则”来练习。 成功 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/by-dream/p/7762537.html\">TDD 之 Dojo coding</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><div>　　dojo和kata的练习记录：</div>\r\n<div>\r\n<div><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031225733591-144868964.png\" alt=\"\"></div>\r\n<div>　　进入 http://cyber-dojo.org/</div>\r\n<div><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031182857558-833836710.png\" alt=\"\">\r\n<p>　　由一个人进行 setup a default practice，然后创建：<br><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031183003808-115782089.png\" alt=\"\"></p>\r\n<p>　　这里支持各种语言和各种测试框架，这里我们选择C++和GoogleTest<br><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031184951293-714026204.png\" alt=\"\"></p>\r\n<p>　　这里是选择一个题目进行联系，我们选择“网球记分规则”来练习。</p>\r\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031183553996-1519990446.png\" alt=\"\"></p>\r\n<p>　　成功之后，他会给每个人都分配一个动物头像，下面的三个圈，红色代表case执行失败，黄色代表编译失败，绿色代表case执行通过。</p>\r\n<p>　　第一个创建的人，把生成的url中的http://cyber-dojo.org/kata/edit/52E43B0082?avatar=raccoon “<strong>52E43B0082</strong>” 提取出即可，这样其他人可以通过enter a practice进入：<br><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031191036920-757494372.png\" alt=\"\"></p>\r\n<p>　　所有人进入后，我们可以通过首页的看到所有人的一个状态：</p>\r\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031191152545-1413200654.png\" alt=\"\"></p>\r\n<p>　　每个人进入后，都是如下界面：</p>\r\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031183917605-325458727.png\" alt=\"\"></p>\r\n<p>　　这就是我们用来练习的IDE</p>\r\n<p> 　　默认会帮你生成一个失败的case，我们点击上方的test就会失败。</p>\r\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031185141902-321682911.png\" alt=\"\"></p>\r\n<p>　　于是我们需要修改case，让它变为成功状态，变为绿色。</p>\r\n<p><img style=\"display: block; margin-left: auto; margin-right: auto;\" src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031185255574-2036918606.png\" alt=\"\"></p>\r\n<p>　　这是我修改成功后，点击test之后，得到了绿色的小球，然后再点击绿色小球的结果，这里可以看到你每次的修改。</p>\r\n<p>　　后面的流程基本就是写一个case，然后再实现一个逻辑的代码，然后在run。如此反复，我第一次完成的时候的代码：</p>\r\n<p>　　先看测试代码：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>#include \"hiker.hpp\"<span>\r\n#include &lt;gtest/gtest.h&gt;\r\n\r\nusing namespace<span> ::testing;\r\n\r\nTEST(Hiker, player0_0)\r\n{\r\n    ASSERT_EQ(\"Love-All\", score(0, 0<span>));\r\n}\r\nTEST(Hiker, player1_1)\r\n{\r\n    ASSERT_EQ(\"Fifteen-All\", score(1, 1<span>));\r\n}\r\nTEST(Hiker, player2_2)\r\n{\r\n    ASSERT_EQ(\"Thirty-All\", score(2, 2<span>));\r\n}\r\nTEST(Hiker, player0_1)\r\n{\r\n    ASSERT_EQ(\"Love-Fifteen\", score(0, 1<span>));\r\n}\r\nTEST(Hiker, player1_0)\r\n{\r\n    ASSERT_EQ(\"Fifteen-Love\", score(1, 0<span>));\r\n}\r\nTEST(Hiker, player1_2)\r\n{\r\n    ASSERT_EQ(\"Fifteen-Thirty\", score(1, 2<span>));\r\n}\r\nTEST(Hiker, player3_1)\r\n{\r\n    ASSERT_EQ(\"Forty-Fifteen\", score(3, 1<span>));\r\n}\r\nTEST(Hiker, player0_3)\r\n{\r\n    ASSERT_EQ(\"Love-Forty\", score(0, 3<span>));\r\n}\r\nTEST(Hiker, player4_4)\r\n{\r\n    ASSERT_EQ(\"Deuce\", score(4, 4<span>));\r\n}\r\nTEST(Hiker, player5_4)\r\n{\r\n    ASSERT_EQ(\"Advantage Player1\", score(5, 4<span>));\r\n}\r\nTEST(Hiker, player4_5)\r\n{\r\n   ASSERT_EQ(\"Advantage Player2\", score(4, 5<span>));\r\n}\r\nTEST(Hiker, player6_4)\r\n{\r\n   ASSERT_EQ(\"Win for Player1\", score(6, 4<span>));\r\n}\r\nTEST(Hiker, player4_6)\r\n{\r\n   ASSERT_EQ(\"Win for Player2\", score(4, 6<span>));\r\n}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\r\n</div>\r\n<p>　　再看业务代码</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>#include <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">hiker.hpp</span><span style=\"color: #800000;\">\"</span>\r\n \r\n<span style=\"color: #0000ff;\">string</span> score(<span style=\"color: #0000ff;\">int</span> p1, <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> p2)\r\n{\r\n    </span><span style=\"color: #0000ff;\">string</span> so[<span style=\"color: #800080;\">4</span>]={<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Love</span><span style=\"color: #800000;\">\"</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Fifteen</span><span style=\"color: #800000;\">\"</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Thirty</span><span style=\"color: #800000;\">\"</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Forty</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">};\r\n    \r\n    cout</span>&lt;&lt;p1&lt;&lt;p2&lt;&lt;<span style=\"color: #000000;\">endl;\r\n    </span><span style=\"color: #0000ff;\">if</span> (p1 &lt; <span style=\"color: #800080;\">4</span> &amp;&amp; p2 &lt; <span style=\"color: #800080;\">4</span><span style=\"color: #000000;\">)\r\n    {\r\n        </span><span style=\"color: #0000ff;\">if</span> (p1==<span style=\"color: #800080;\">0</span> &amp;&amp; p2==<span style=\"color: #800080;\">0</span><span style=\"color: #000000;\">)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Love-All</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">if</span> (p1==<span style=\"color: #800080;\">1</span> &amp;&amp; p2==<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Fifteen-All</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n        {\r\n            </span><span style=\"color: #0000ff;\">return</span> so[p1]+<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">-</span><span style=\"color: #800000;\">\"</span>+<span style=\"color: #000000;\">so[p2];\r\n        }\r\n    }\r\n    </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n    {\r\n        </span><span style=\"color: #0000ff;\">if</span> (p1==<span style=\"color: #000000;\">p2)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Deuce</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">int</span> cha = p1-<span style=\"color: #000000;\">p2;\r\n        </span><span style=\"color: #0000ff;\">if</span> (cha&gt;<span style=\"color: #800080;\">0</span> &amp;&amp; cha&lt;<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Advantage Player1</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">if</span>(cha&gt;<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">return</span>  <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Win for Player1</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">if</span>(cha&lt;<span style=\"color: #800080;\">0</span> &amp;&amp; cha&gt;-<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">return</span>  <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Advantage Player2</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">if</span>(cha&lt;-<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">return</span>  <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Win for Player2</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n        }\r\n    }\r\n    </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">hello world</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n}</span></pre>\r\n</div>\r\n<p>　　是不是看起来逻辑好乱啊。没错我也是这样的感觉，特别想重构，一般说到重构，很多人心有余悸，没关系，我们有测试用例不用担心。　</p>\r\n<p>　　重构完成的代码和测试用例：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>#include <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">hiker.hpp</span><span style=\"color: #800000;\">\"</span>\r\n\r\n<span style=\"color: #0000ff;\">string</span> score(<span style=\"color: #0000ff;\">int</span> p1, <span style=\"color: #0000ff;\">int</span><span style=\"color: #000000;\"> p2)\r\n{\r\n    </span><span style=\"color: #0000ff;\">string</span> s_score[<span style=\"color: #800080;\">4</span>]={<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Love</span><span style=\"color: #800000;\">\"</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Fifteen</span><span style=\"color: #800000;\">\"</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Thirty</span><span style=\"color: #800000;\">\"</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Forty</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">};\r\n    </span><span style=\"color: #0000ff;\">string</span> s_same[<span style=\"color: #800080;\">4</span>]={<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Love-All</span><span style=\"color: #800000;\">\"</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Fifteen-All</span><span style=\"color: #800000;\">\"</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Thirty-All</span><span style=\"color: #800000;\">\"</span>,<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Deuce</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">};\r\n    map</span>&lt;<span style=\"color: #0000ff;\">int</span>,<span style=\"color: #0000ff;\">string</span>&gt;<span style=\"color: #000000;\"> m_res;\r\n    m_res.insert(pair</span>&lt;<span style=\"color: #0000ff;\">int</span>, <span style=\"color: #0000ff;\">string</span>&gt;(<span style=\"color: #800080;\">1</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Advantage Player1</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">));\r\n    m_res.insert(pair</span>&lt;<span style=\"color: #0000ff;\">int</span>, <span style=\"color: #0000ff;\">string</span>&gt;(<span style=\"color: #800080;\">2</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Win for Player1</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">));\r\n    m_res.insert(pair</span>&lt;<span style=\"color: #0000ff;\">int</span>, <span style=\"color: #0000ff;\">string</span>&gt;(-<span style=\"color: #800080;\">1</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Advantage Player2</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">));\r\n    m_res.insert(pair</span>&lt;<span style=\"color: #0000ff;\">int</span>, <span style=\"color: #0000ff;\">string</span>&gt;(-<span style=\"color: #800080;\">2</span>, <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Win for Player2</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">));\r\n           \r\n    cout</span>&lt;&lt;p1&lt;&lt;p2&lt;&lt;<span style=\"color: #000000;\">endl;\r\n    \r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 处理相等的情况</span>\r\n    <span style=\"color: #0000ff;\">if</span> (p1 ==<span style=\"color: #000000;\"> p2) \r\n    {\r\n        </span><span style=\"color: #0000ff;\">if</span> (p1 &gt; <span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">)\r\n            </span><span style=\"color: #0000ff;\">return</span> s_same[<span style=\"color: #800080;\">3</span><span style=\"color: #000000;\">];\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> s_same[p1];\r\n    }\r\n    \r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 处理赢球数都在3以下的情况</span>\r\n    <span style=\"color: #0000ff;\">if</span> (p1 &lt; <span style=\"color: #800080;\">4</span> &amp;&amp; p2 &lt; <span style=\"color: #800080;\">4</span><span style=\"color: #000000;\">)\r\n    {\r\n        </span><span style=\"color: #0000ff;\">return</span> s_score[p1]+<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">-</span><span style=\"color: #800000;\">\"</span>+<span style=\"color: #000000;\">s_score[p2];\r\n    }\r\n    \r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 处理赢球数都在3以上的情况</span>\r\n    <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n    {\r\n        </span><span style=\"color: #0000ff;\">return</span> m_res[p1-<span style=\"color: #000000;\">p2];\r\n     \r\n    }\r\n    </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">error</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n}</span></pre>\r\n</div>\r\n<p>　　可以看到我一共提交了48次<br><img src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031181542308-980615843.png\" alt=\"\"></p>\r\n<p>　　大家的结果 http://cyber-dojo.org/dashboard/show/D9D934A59E：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/626346/201710/626346-20171031182053636-903339891.png\" alt=\"\"></p>\r\n<p> </p>\r\n<p>　　通过这次Dojo Coding，总结如下：</p>\r\n<p>　　　　1、先写case，再实现代码；</p>\r\n<p>　　　　2、每实现一个功能，run一次测试代码；</p>\r\n<p>　　　　3、重构的时候，每个小的单元重构一次，run一次测试代码。</p>\r\n<p>　　这样就可以保证，你在重构完成之后，所有的功能是可以通过的。也就是TDD的思想。</p>\r\n<p> </p>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</div>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</div></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 19:14</span> <a href=\"http://www.cnblogs.com/by-dream/\">胖喵~</a> Views(<span id=\"post_view_count\">...</span>) Comments(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7762537\" rel=\"nofollow\">Edit</a> <a href=\"#\" onclick=\"AddToWz(7762537);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=183531,cb_entryId=7762537,cb_blogApp=currentBlogApp,cb_blogUserGuid='d2affb02-55c9-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/10/31 19:14:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div>\r\n</div>", "article_view": 52, "image_url": ["https://pic.cnblogs.com/face/626346/20150708141807.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "阿里巴巴Java开发手册思维导图", "url": "http://www.cnblogs.com/liaoweipeng/p/7759907.html", "author": "鹏&鹏", "article_desc": "趁着有时间把阿里巴巴Java开发手册又看了一遍了，很多时候觉得看完之后，发现自己好像一点都不记得了里面的内容了。只能把大概内容画一遍在脑子里形成一张图方便记忆，这样就更能够记得自己的看完的内容了。其中有许多是比较基础的内容，我就只画了自己相对不熟悉的内容，方便自己学习记忆。 一、总图 二、编程规约  ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/liaoweipeng/p/7759907.html\">阿里巴巴Java开发手册思维导图</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　趁着有时间把阿里巴巴Java开发手册又看了一遍了，很多时候觉得看完之后，发现自己好像一点都不记得了里面的内容了。只能把大概内容画一遍在脑子里形成一张图方便记忆，这样就更能够记得自己的看完的内容了。其中有许多是比较基础的内容，我就只画了自己相对不熟悉的内容，方便自己学习记忆。</p>\r\n<p>一、总图</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/717907/201710/717907-20171031085921230-1477874500.png\" alt=\"\"></p>\r\n<p>二、编程规约</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/717907/201710/717907-20171031090245683-1660283435.png\" alt=\"\"></p>\r\n<p>三、异常日志</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/717907/201710/717907-20171031090325152-154085744.png\" alt=\"\"></p>\r\n<p>四、单元测试</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/717907/201710/717907-20171031090412918-607524233.png\" alt=\"\"></p>\r\n<p>五、安全规约</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/717907/201710/717907-20171031090451543-1152425679.png\" alt=\"\"></p>\r\n<p>六、MySQL数据库</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/717907/201710/717907-20171031090542668-1656172481.png\" alt=\"\"></p>\r\n<p>七、工程结构</p>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/717907/201710/717907-20171031090633027-962376905.png\" alt=\"\"></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 21:01</span> <a href=\"http://www.cnblogs.com/liaoweipeng/\">鹏&amp;鹏</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7759907\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7759907);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=213402,cb_entryId=7759907,cb_blogApp=currentBlogApp,cb_blogUserGuid='f5c9c4de-14a5-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/10/31 21:01:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 586, "image_url": ["https://pic.cnblogs.com/face/717907/20160910141932.png"], "date_pub": "2017-10-31", "article_common": 20}
{"title": "[Bayesian] “我是bayesian我怕谁”系列 - Latent Variables", "url": "http://www.cnblogs.com/jesse123/p/7762362.html", "author": "郝一二三", "article_desc": "下一章有意讲讲EM和变分推断的内容。 EM和变分推断的内容能Google到很多，虽然质量乘次不齐，但也无意再赘述那么些个细节。 有意记录一些核心思想，帮助菜鸡形成整体上的认识。不过，变分推断也不是一篇博文能讲述通透的技术，希望读者至少知道自己将要学一个什么好东西，能用它来做什么。 私以为，变分的理解 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/jesse123/p/7762362.html\">[Bayesian] “我是bayesian我怕谁”系列 - Latent Variables</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>下一章有意讲讲EM和变分推断的内容。</p>\r\n<p>EM和变分推断的内容能Google到很多，虽然质量乘次不齐，但也无意再赘述那么些个细节。</p>\r\n<p>有意记录一些核心思想，帮助菜鸡形成整体上的认识。不过，变分推断也不是一篇博文能讲述通透的技术，希望读者至少知道自己将要学一个什么好东西，能用它来做什么。</p>\r\n<p>私以为，变分的理解就是统计机器学习的核心，那么，</p>\r\n<ul>\r\n<li>不懂变分怎么能说学会了统计机器学习？  P(统计机器学习 | 变分)</li>\r\n<li>不会统计机器学习怎么自诩会机器学习？  P(机器学习 | 统计机器学习)</li>\r\n<li>不懂机器学习如何有资格研究深度学习？  P(深度学习 | 机器学习)</li>\r\n<li>不懂深度学习又怎么能从事人工智能呢？  P(人工智能 | 深度学习)</li>\r\n<li>求边缘条件概率分布：P(人工智能 | 变分=False) = ?</li>\r\n</ul>\r\n<p> </p>\r\n<p>但在此之前，需要提提<span style=\"color: #ff0000;\"><strong>Latent Variables隐变量</strong></span>。</p>\r\n<p>隐变量，潜在的隐藏的变量，这个东西非常好，同时也能启迪你一些人生哲学。</p>\r\n<p>“若能肯定自己，需要之前有一段否定自己的过程。“</p>\r\n<p>看到的，即使看似合理也要抱着怀疑自己的态度，寻求背后的真实状态，比如hmm。</p>\r\n<p style=\"text-align: center;\"> <img src=\"http://images2017.cnblogs.com/blog/310015/201710/310015-20171031190527748-196997595.png\" alt=\"\"></p>\r\n<p style=\"text-align: center;\">hmm PGM</p>\r\n<p>看到了表象y，y之间貌似相关性也很强，但就是要先怀疑自己，反问：是否有”幕后黑手x“控制着整个局面？</p>\r\n<p>然后，假设了隐变量以及之间的概率关系，剩下的问题就是如何求解概率关系的过程，即各个边（条件概率分布）咯。</p>\r\n<p> </p>\r\n<p>因为要用到隐变量，所以更需要概率图来给读者以直观的感受，不同场景不同模型中的隐变量设计又有很多的共性，概率图中对这些共性的研究也可以形成一种”定理”类似的东西，发现某个新问题的概率图有某种共性出现，直接使用对应的性质即可，而不是重新造轮子。</p>\r\n<p>有菜鸡问了，加那么多隐变量，边自然就多了，也就是需要估计的概率关系（变量）多了，自找麻烦么？</p>\r\n<p>麻烦确实不少，所以不能加太多，但也有变态的事情，比如头几年的日本学界，据说有人在模型中加了二十多个圈圈，然后论文就容易发表了。（不可考证，笑笑即可）</p>\r\n<p>变分推断就是估参的一个利器，既然是估计参数，就不必在精度上斤斤计较，渐进就好，当然”逼近真实“，“逼近的程度”也是一门艺术，更是技术。提到渐进，也就是常说的”优化“，其实机器学习整个领域都充斥着优化方法，你说不学“优化理论”能混下去么？</p>\r\n<p>菜鸡菜鸡，不学习《多元变量分析》、《优化》，如何登榜提名，好发愁。</p>\r\n<p>哎，到处都是潜规则。</p>\r\n<p> </p>\r\n<p>还有一个原因，隐变量都是自己设计的，当然要设计一个<span style=\"color: #008000;\">友好的</span>，<span style=\"color: #008000;\">隐变量间关系比较强</span>，<span style=\"color: #008000;\">容易计算</span>，且<span style=\"color: #008000;\">相对通用</span>的结构。</p>\r\n<p>而变分推断中假设了一些友好的分布来尽可能的逼近实际分布，在这个逼近的过程中，当然希望承载在一个相对友好的变量关系上面。</p>\r\n<p>如此看来，似乎明了了许多。</p>\r\n<p> </p>\r\n<p>变分推断的目的是逼近真实分布，mcmc采样方法也是同样的目的，二者选其一皆可。</p>\r\n<p>至于两者的优劣，可以百度之，内容散布烂大街。</p>\r\n<p>EM可以理解为变分推断的一种狭义情况，好比二项分布是狭义的多项分布。</p>\r\n<p>说到底， Latent Variables真没什么，多几个圈圈又能如何呢。</p>\r\n<p> </p>\r\n<p> </p>\r\n<p>最近，cmu的Machine Learning 10-702刷屏，互联网带来的教育共享就是好啊，好东西就在网上，你能嗅得到么？让我们瞧上一瞧。</p>\r\n<h2>Schedule</h2>\r\n<p>Here is the estimated class schedule. It is subject to change, depending on time and class interests. <br><br></p>\r\n<table id=\"bord\">\r\n<tbody>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Jan 17</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Linear regression</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/LinearRegression.pdf\">Notes</a>, <a href=\"https://youtu.be/Z1cSby8ZzhA?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Jan 19</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Linear classification</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/linearclassification.pdf\">Notes</a>, <a href=\"https://youtu.be/ngAOF4ikBhk?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a>, <a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/LogisticConformal.pdf\">cool plot</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Jan 24</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">R</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Nonparametric regression</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/nonpar.pdf\">Notes</a>, <a href=\"https://youtu.be/xFvnbFq5yNA?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Jan 26</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">R</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Nonparametric regression</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/nonpar.pdf\">Notes</a>, <a href=\"https://youtu.be/89ymQHrvOks?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Jan 31</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">R</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Nonparametric regression</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/nonpar.pdf\">Notes</a>, <a href=\"https://youtu.be/aM1JfBq5YPk?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Feb 2</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">R</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Nonparametric classification</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/nonpar.pdf\">Notes</a>, <a href=\"https://youtu.be/U_Vqb7bUKv0?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Hw 1 due Fri Feb 3</span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Feb 7</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Reproducing kernel Hilbert spaces</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/RKHSnotes.pdf\">Notes</a>, <a href=\"https://youtu.be/gb25CfVZm3Q?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Feb 9</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Density estimation</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/densityestimation.pdf\">Notes</a>, <a href=\"https://youtu.be/iCEVfnfv5fs?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Feb 14</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Clustering</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/clustering.pdf\">Notes</a>, <a href=\"https://youtu.be/ByUwKWY_xlw?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Feb 16</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Clustering</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/clustering.pdf\">Notes</a>, <a href=\"https://youtu.be/-2QK3BiUEvg?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Project milestone 1 due Fri Feb 17</span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Feb 21</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Clustering</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/clustering.pdf\">Notes</a>, <a href=\"https://youtu.be/hbTNNz3CaK8?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Feb 23</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">High-dimensional testing</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/TwoSample.pdf\">Notes</a>, <a href=\"https://youtu.be/8zEOARsNH9A?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Feb 28</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Concentration of measure</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/Concentration-of-Measure.pdf\">Notes</a>, <a href=\"https://youtu.be/Gx3p94j_088?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Mar 2</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Concentration of measure</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/Concentration-of-Measure.pdf\">Notes</a>, <a href=\"https://youtu.be/K0H_eQcLsWM?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Hw 2 due Fri Mar 3</span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Mar 7</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">-</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Midterm</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Mar 9</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">-</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Spring break (no class)</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Mar 14</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">-</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Spring break (no class)</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Mar 16</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">-</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Spring break (no class)</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Mar 21</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Minimax theory</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/minimax.pdf\">Notes</a>, <a href=\"https://youtu.be/bdkuAyFmUt8?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Mar 23</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Minimax theory</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/minimax.pdf\">Notes</a>, <a href=\"https://youtu.be/kezCd4prM7Q?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Mar 28</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">R</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Sparsity and the lasso</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/sparsity.pdf\">Notes</a>, <a href=\"https://youtu.be/Qa9fmocsEvE?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Mar 30</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">R</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Sparsity and the lasso</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/sparsity.pdf\">Notes</a>, <a href=\"https://youtu.be/4Jddwwdk3sI?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Hw 3 due Mon Apr 3</span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Apr 4</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">R</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Sparsity and the lasso</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/sparsity.pdf\">Notes</a>, <a href=\"https://youtu.be/DQTv8_aoztc?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Apr 6</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">R</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Sparsity and the lasso</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/sparsity.pdf\">Notes</a>, <a href=\"https://youtu.be/Hn8NtydkeDs?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Project milestone 2 due Mon Apr 10</span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Apr 11</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Graphical models</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/GraphicalModels.pdf\">Notes</a>, <a href=\"https://youtu.be/wfHKBktMdDU?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Apr 13</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Graphical models</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/GraphicalModels.pdf\">Notes</a>, <a href=\"https://youtu.be/Cdpfpy4bXPI?list=PLjbUi5mgii6B7A0nM74zHTOVQtTC9DaCv\">video</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Apr 18</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">L</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Advanced topic</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/Lei-Robins-Wasserman.pdf\">Lei, Robins, and Wasserman</a>, and</span><br><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/Lei-Wasserman.pdf\">Lei and Wasserman</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Apr 20</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">-</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Spring Carnival (no class)</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues Apr 25</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">R</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Advanced topic</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/Lei-Robins-Wasserman.pdf\">Lei, Robins, and Wasserman</a>, and</span><br><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/Lei-Wasserman.pdf\">Lei and Wasserman</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Hw 4 due Wed Apr 26</span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs Apr 27</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">R</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Advanced topic</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/Lee-Sun-Sun-Taylor.pdf\">Lee, Sun, Sun, and Taylor</a>, and</span><br><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/lectures/Tibshirani-Taylor-Lockhart-Tibshirani.pdf\">Tibs, Taylor, Lockhart, and Tibs</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Tues May 2</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">-</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Course conference</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/conference/CCML_S17_Tue.pdf\">Slides</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"> </span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr id=\"bord\">\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Thurs May 4</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">-</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Course conference</span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\"><a href=\"http://www.stat.cmu.edu/~ryantibs/statml/conference/CCML_S17_Thu.pdf\">Slides</a></span></td>\r\n<td id=\"bord\"><span style=\"font-size: 14px;\">Project writeup due Fri May 5</span></td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tbody>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</table>\r\n<p>\r\n<br>从大纲看去，跟我的计划内容大有区别。真可谓：你有隐变量，我有潜规则。</p>\r\n<p>如果你是数学系的同学，对数据分析感兴趣，学成之后，千万不要在计算机系的同学面前自夸数据分析；搞数据分析（机器学习）的计算机的同学们也不要在数学系面前卖弄算法。</p>\r\n<p>很可能，很可能，很可能。。。　你们争辩的不是一个东西，但名字却都叫“统计学习”或者相关的名字。</p>\r\n<p>不要纠结我的说法，自个儿瞧瞧各大院校统计学习课程的大纲，然后对比，玩味。</p>\r\n<p>那么问题来了，为什么会如此？</p>\r\n<p>数学系做数据分析很正常，往往从Linear regression，Linear classification这些考验数学基础的地方入手，如cmu的这份教学大纲；计算机系则更注重实用性更强的模型学习。</p>\r\n<p>统计机器学习内部也有派别，一派的代表就是prml，似乎更强调工程实践性，下图左；另一派的代表就是小黄书《The Elements of Statistical Learning》，偏重数学系口味（翻开高数小绿书的感觉），下图右。</p>\r\n<p> </p>\r\n<p style=\"text-align: center;\"><img src=\"http://images2017.cnblogs.com/blog/310015/201710/310015-20171031181642168-906256367.png\" alt=\"\" width=\"170\" height=\"228\"><img src=\"http://images2017.cnblogs.com/blog/310015/201710/310015-20171031181537965-1018840330.png\" alt=\"\" width=\"152\" height=\"228\"></p>\r\n<p style=\"text-align: center;\">　　　左, prml;                 　右, little yellow book</p>\r\n<p style=\"text-align: center;\"> </p>\r\n<p>当然了，到底学习的是哪个派别跟课程设在cse or math没有太多相关，主要还是看讲课教授的品味。</p>\r\n<ul>\r\n<li>不要问我学哪一本比较好，我觉得都学了比较好。</li>\r\n<li>不要问我哪一本更有优势，正妹从哪个角度看都是正妹。</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<p>正所谓知己知彼百战不殆，你若有心干掉数学系出身的竞争对手，建议“深入敌后，趁其课，学其书，使其优势化为乌有”。</p>\r\n<p>这也是交叉学科领域的生存之道。</p>\r\n<p>最后，cmu的课程设计更偏重数学修炼，这也是名校的潜规则。</p>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 19:41</span> <a href=\"http://www.cnblogs.com/jesse123/\">郝一二三</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7762362\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7762362);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=91377,cb_entryId=7762362,cb_blogApp=currentBlogApp,cb_blogUserGuid='e2944e26-7d9c-e011-a53f-842b2b196315',cb_entryCreatedDate='2017/10/31 19:41:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 42, "image_url": ["https://pic.cnblogs.com/face/u310015.jpg?id=23163453"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "从零使用Python测试。Testing Using Python.", "url": "http://www.cnblogs.com/lovesoo/p/7762148.html", "author": "lovesoo", "article_desc": "本人使用Python测试已有多年，略有些皮毛经验。每次有新员工入职，都会从头教一遍如何入门上手使用Python进行测试。趁这段有空，整理成文档，也好方便后续新员工学习。文章如有不妥之处，也请各位不吝赐教^ ^ ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/lovesoo/p/7762148.html\">从零使用Python测试。Testing Using Python.</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h1 id=\"0-写在前面\" data-source-line=\"1\">0. 写在前面</h1>\r\n<p data-source-line=\"2\">本人使用Python测试已有多年，略有些皮毛经验。每次有新员工入职，都会从头教一遍如何入门上手使用Python进行测试。趁这段有空，整理成文档，也好方便后续新员工学习。文章如有不妥之处，也请各位不吝赐教^ ^</p>\r\n<h1 id=\"1-测试在哪用到python\" data-source-line=\"4\">1. 测试在哪用到Python?</h1>\r\n<p data-source-line=\"5\">我的答案是：基本哪都可以用到，尤其是有重复的费时费力的任务时。大概罗列一下：</p>\r\n<ol data-source-line=\"6\">\r\n<li>持续集成CI (自动部署，测试)</li>\r\n<li>自动化测试(后端、前端及客户端自动化测试)</li>\r\n<li>爬虫、日志分析等工具</li>\r\n</ol>\r\n<h1 id=\"2-入门教程及ide\" data-source-line=\"11\">2. 入门教程及IDE</h1>\r\n<ol data-source-line=\"12\">\r\n<li>\r\n<p>Python2.7在线教程</p>\r\n<p><a href=\"http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000\">http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000</a></p>\r\n</li>\r\n<li>\r\n<p>《Python核心编程》</p>\r\n<p>PDF链接：<a href=\"http://pan.baidu.com/s/1bpzpY6j\">http://pan.baidu.com/s/1bpzpY6j</a> 提取码：bk6w</p>\r\n</li>\r\n<li>\r\n<p>pip</p>\r\n<p>pip是一款非常方便的python包管理工具，安装教程：<a href=\"http://lovesoo.org/windows-install-the-pip-method.html\">http://lovesoo.org/windows-install-the-pip-method.html</a></p>\r\n<p>常用命令如下：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\">安装包</span>\r\n<span style=\"color: #000000;\">pip install xxx\r\n \r\n</span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\">升级包，可以使用-U 或者 --upgrade</span>\r\npip install -<span style=\"color: #000000;\">U xxx\r\n \r\n</span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\">卸载包</span>\r\n<span style=\"color: #000000;\">pip uninstall xxx\r\n \r\n</span><span style=\"color: #008000;\">#</span><span style=\"color: #008000;\">列出已安装的包</span>\r\npip list</pre>\r\n</div>\r\n</li>\r\n<li>\r\n<p>pycharm</p>\r\n<p>官网：<a href=\"http://www.jetbrains.com/pycharm/\">http://www.jetbrains.com/pycharm/</a></p>\r\n<p>下载安装完成后，注册时选择License server,输入：<a href=\"http://idea.imsxm.com/\">http://idea.imsxm.com</a></p>\r\n<p>即可激活^ ^</p>\r\n</li>\r\n</ol>\r\n<h1 id=\"3-持续集成\" data-source-line=\"46\">3. 持续集成</h1>\r\n<p data-source-line=\"47\">目前常用的持续集成工具一般是Jenkins，使用Python可以轻松完成版本构建后的自动部署、自动化测试(主要是BVT测试，功能自动化测试及回归测试)。</p>\r\n<p data-source-line=\"49\">《Jenkins集成taffy进行自动化测试并输出测试报告》详见：<a href=\"http://www.cnblogs.com/lovesoo/p/7719138.html\">http://www.cnblogs.com/lovesoo/p/7719138.html</a></p>\r\n<p data-source-line=\"51\">常用的自动部署工具有fabric及ansible。</p>\r\n<h2 id=\"31-fabric\" data-source-line=\"53\">3.1 fabric</h2>\r\n<p data-source-line=\"55\">fabric官网：<a href=\"https://github.com/fabric\">https://github.com/fabric</a></p>\r\n<p data-source-line=\"57\">fabric入门教程：<a href=\"http://lovesoo.org/python-fabric-yuan-cheng-zi-dong-bu-shu-jian-jie.html\">http://lovesoo.org/python-fabric-yuan-cheng-zi-dong-bu-shu-jian-jie.html</a></p>\r\n<h2 id=\"32-ansible\" data-source-line=\"59\">3.2 ansible</h2>\r\n<p data-source-line=\"61\">ansible官网：<a href=\"https://github.com/ansible\">https://github.com/ansible</a></p>\r\n<p data-source-line=\"63\">ansible中文教程：<a href=\"http://www.ansible.com.cn/\">http://www.ansible.com.cn/</a></p>\r\n<h1 id=\"4-自动化测试\" data-source-line=\"65\">4. 自动化测试</h1>\r\n<p data-source-line=\"66\">由于本人主要从事后端及部分WEB前端测试，对于客户端(ios/android)的自动化测试不甚了解，所以在此着重介绍Python在后端接口测试中的应用。</p>\r\n<h2 id=\"41-后端测试\" data-source-line=\"68\">4.1 后端测试</h2>\r\n<h3 id=\"411-基本流程\" data-source-line=\"69\">4.1.1 基本流程</h3>\r\n<p data-source-line=\"71\">后端测试主要时通过测试http,webservice,dubbo(hessian)等类型接口，从而完成对后端组件的功能测试。一般接口基本测试流程如下：</p>\r\n<ol>\r\n<li>用例设计,主要使用MindManager/XMind等脑图软件设计接口测试用例，如一个简单视频搜索接口(输入name返回videoName)的用例设计示例如下：<img src=\"http://images2017.cnblogs.com/blog/445074/201710/445074-20171031161824902-518582703.png\" alt=\"\"></li>\r\n<li>转换为python测试脚本，主要包括用例管理，接口调用及结果校验等</li>\r\n<li>执行脚本完成接口自动化测试</li>\r\n</ol>\r\n<h3 id=\"412-常用框架\" data-source-line=\"82\">4.1.2 常用框架</h3>\r\n<p data-source-line=\"84\">这里只介绍目前主流的两种框架：</p>\r\n<ol data-source-line=\"86\">\r\n<li>\r\n<p>RobotFramework</p>\r\n<p>官网：<a href=\"http://robotframework.org/\">http://robotframework.org</a></p>\r\n<p>入门教程：<a href=\"http://www.cnblogs.com/lovesoo/p/7748487.html\">http://www.cnblogs.com/lovesoo/p/7748487.html</a></p>\r\n</li>\r\n<li>\r\n<p>Nose</p>\r\n<p>官网：<a href=\"http://nose.readthedocs.org/\">http://nose.readthedocs.org</a></p>\r\n</li>\r\n</ol>\r\n<p data-source-line=\"96\">目前我们主要使用Nose框架，之前调研了RF框架并实现了几个接口的自动化测试，个人感觉而言RF上手相对较难，在基础类库(keyword)稳定后测试人员只需简单编写测试数据驱动即可,对测试人员成长不是很有利，而且Nose框架与pycharm无缝连接，使用更加便捷直观。</p>\r\n<p data-source-line=\"98\">另外，（小小的打个广告）Taffy是在nose框架基础进行的二次封装，可以实现对不同类型的后台接口及WEB页面自动化测试及性能测试，详见：<a href=\"https://github.com/lovesoo/Taffy\">https://github.com/lovesoo/Taffy</a></p>\r\n<p data-source-line=\"100\">关于不同类型的测试框架选择，请参考：<a href=\"http://www.infoq.com/cn/news/2012/06/robot-author-suggest-autotest/\">http://www.infoq.com/cn/news/2012/06/robot-author-suggest-autotest/</a></p>\r\n<h3 id=\"413-python常用lib库\" data-source-line=\"102\">4.1.3 Python常用lib库</h3>\r\n<p data-source-line=\"104\">下面介绍使用Python编写后端接口测试代码中常用的lib库：</p>\r\n<ol data-source-line=\"106\">\r\n<li>\r\n<p>通用lib库</p>\r\n<ol>\r\n<li>\r\n<p>json: <a href=\"https://docs.python.org/2.7/tutorial/inputoutput.html#saving-structured-data-with-json\">https://docs.python.org/2.7/tutorial/inputoutput.html#saving-structured-data-with-json</a></p>\r\n</li>\r\n<li>\r\n<p>日志模块：logging <a href=\"https://docs.python.org/2.7/library/logging.html\">https://docs.python.org/2.7/library/logging.html</a></p>\r\n</li>\r\n<li>\r\n<p>异步并发模块：concurrent.futures</p>\r\n<p>入门教程：<a href=\"http://www.cnblogs.com/lovesoo/p/7741576.html\">http://www.cnblogs.com/lovesoo/p/7741576.html</a></p>\r\n</li>\r\n<li>\r\n<p>excel相关操作库：读取 xlrd、写入 xlwt、修改 xlutils</p>\r\n</li>\r\n<li>\r\n<p>正则表达式模块：re</p>\r\n</li>\r\n<li>\r\n<p>日期模块：time,datetime</p>\r\n</li>\r\n<li>\r\n<p>PyMySQL：<a href=\"https://github.com/PyMySQL/PyMySQL\">https://github.com/PyMySQL/PyMySQL</a></p>\r\n</li>\r\n<li>\r\n<p>redis：<a href=\"https://pypi.python.org/pypi/redis\">https://pypi.python.org/pypi/redis</a></p>\r\n</li>\r\n<li>\r\n<p>pymongo: <a href=\"http://api.mongodb.org/python/current/\">http://api.mongodb.org/python/current/</a></p>\r\n</li>\r\n</ol></li>\r\n<li>\r\n<p>http接口</p>\r\n<p>requests: <a href=\"http://cn.python-requests.org/zh_CN/latest/\">http://cn.python-requests.org/zh_CN/latest/</a></p>\r\n</li>\r\n<li>\r\n<p>dubbo接口(hessian协议)</p>\r\n<p>python-hessian：<a href=\"https://github.com/theatlantic/python-hessian\">https://github.com/theatlantic/python-hessian</a></p>\r\n<p>Python调用Hessian协议接口示例：<a href=\"http://lovesoo.org/python-called-dubbo-hessian-protocol-interface-example.html\">http://lovesoo.org/python-called-dubbo-hessian-protocol-interface-example.html</a></p>\r\n</li>\r\n</ol>\r\n<h3 id=\"414-示例demo\" data-source-line=\"138\">4.1.4 示例demo</h3>\r\n<p data-source-line=\"140\">以百度首页搜索为例，写了比较简单的Nose框架接口测试demo</p>\r\n<p data-source-line=\"142\">详见：<a href=\"https://github.com/lovesoo/test_demo/blob/master/test_baiduSearch/test_baiduSearch.py\">https://github.com/lovesoo/test_demo/blob/master/test_baiduSearch/test_baiduSearch.py</a></p>\r\n<h2 id=\"42-前端web测试\" data-source-line=\"145\">4.2 前端(WEB)测试</h2>\r\n<p data-source-line=\"147\">Selenium几乎是现在Python WEB自动化测框架的唯一选择了</p>\r\n<p data-source-line=\"149\">官网地址：<a href=\"http://www.seleniumhq.org/\">http://www.seleniumhq.org/</a></p>\r\n<p data-source-line=\"151\">PDF教程: <a href=\"https://pan.baidu.com/s/1c2IXJWW\">https://pan.baidu.com/s/1c2IXJWW</a> 密码: 4r5v</p>\r\n<h2 id=\"43-客户端iosandroid测试\" data-source-line=\"153\">4.3 客户端(ios/android)测试</h2>\r\n<p data-source-line=\"154\">Python客户端(ios/android)自动化主要框架主要有Appium,uiautomator等</p>\r\n<p data-source-line=\"156\">Appium: <a href=\"http://appium.io/\">http://appium.io/</a></p>\r\n<p data-source-line=\"158\">uiautomator： <a href=\"https://github.com/xiaocong/uiautomator\">https://github.com/xiaocong/uiautomator</a></p>\r\n<h1 id=\"5-工具开发\" data-source-line=\"161\">5. 工具开发</h1>\r\n<p data-source-line=\"162\">我们经常会遇到一些需要手工操作、比较繁琐且耗时的重复性工作。这时就可以考虑是否可以通过现有工具或自己编写脚本来代替手工操作。在提升工作效率、效果的同时还可以提升自己的编程水平，何乐而不为？</p>\r\n<p data-source-line=\"164\">举例：之前做的一个搜索引擎项目，其中有一个功能是根据歌手的别名搜索歌手，而别名确定需要通过搜索网上的几大音乐网站来确定。大致简单梳理逻辑就会发现这是一个完全可以用Python实现的功能，如下：</p>\r\n<div class=\"mermaid\" data-source-line=\"166\" data-processed=\"true\"><img src=\"http://images2017.cnblogs.com/blog/445074/201710/445074-20171031161905340-837272978.png\" alt=\"\">\r\n<p> </p>\r\n</div>\r\n<p data-source-line=\"178\">示例代码详见：<a href=\"https://github.com/lovesoo/test_demo/tree/master/SearchArtist\">https://github.com/lovesoo/test_demo/tree/master/SearchArtist</a></p>\r\n<h1 id=\"6-qa\" data-source-line=\"180\">6. Q&amp;A</h1>\r\n<h2 id=\"61-学习python过程时遇到问题如何解决\" data-source-line=\"181\">6.1 学习Python过程时遇到问题如何解决？</h2>\r\n<ol data-source-line=\"183\">\r\n<li>\r\n<p>lib库及函数相关问题，建议查看官方文档或书籍</p>\r\n</li>\r\n<li>\r\n<p>其次，百度Google一般基本可以解决问题，另外强烈推荐去stackoverflow搜索提问</p>\r\n</li>\r\n</ol>\r\n<h2 id=\"62-入门后如何提高\" data-source-line=\"189\">6.2 入门后如何提高？</h2>\r\n<ol data-source-line=\"191\">\r\n<li>\r\n<p>实践 - 总结 - 提高</p>\r\n</li>\r\n<li>\r\n<p>照抄 - 照抄之后的理解 - 重新自己实现</p>\r\n</li>\r\n</ol></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 16:46</span> <a href=\"http://www.cnblogs.com/lovesoo/\">lovesoo</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7762148\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7762148);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=127424,cb_entryId=7762148,cb_blogApp=currentBlogApp,cb_blogUserGuid='30de04d9-e9f7-e111-aa3f-842b2b196315',cb_entryCreatedDate='2017/10/31 16:46:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 352, "image_url": ["https://pic.cnblogs.com/face/445074/20171023190913.png"], "date_pub": "2017-10-31", "article_common": 3}
{"title": "67、django之模型层（model）--查询补充及cookie", "url": "http://www.cnblogs.com/liluning/p/7762600.html", "author": "布吉岛丶", "article_desc": "已经连续写了好几篇django的模型层（model）增删改查的随笔了，没篇大篇幅都是查询相关的操作，可以看出查询在数据的操作中是多么的重要，而本篇最后再补充一点关于关于查询的一些方法，模型层基本的操作也就结束了。然后会有一部分cookie的知识点，你可以为上篇随笔的图书管理小练习加上简单的登录。一个... ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/liluning/p/7762600.html\">67、django之模型层（model）--查询补充及cookie</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p> 已经连续写了好几篇django的模型层（model）增删改查的随笔了，没篇大篇幅都是查询相关的操作，可以看出查询在数据的操作中是多么的重要，而本篇最后再补充一点关于关于查询的一些方法，模型层基本的操作也就结束了。然后会有一部分cookie的知识点，你可以为上篇随笔的图书管理小练习加上简单的登录。一个当然所有的讲解都是django一些浅显的知识，希望可以对读者有所帮助。</p>\n<p> </p>\n<p><span style=\"font-size: 14pt\"><strong>本篇导航：</strong></span></p>\n<ul>\n<li><a href=\"#yi\"><span style=\"font-size: 16px\">F查询与Q查询</span></a></li>\n<li><a href=\"#er\"><span style=\"font-size: 16px\">cookie</span></a></li>\n</ul>\n<p> </p>\n<p><span style=\"font-size: 14pt\"><strong><a name=\"yi\"></a>一、</strong></span><span style=\"font-size: 14pt\"><strong>F查询与Q查询</strong></span></p>\n<p><strong><span style=\"font-size: 16px\">1、以Book表为例</span></strong></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Book(models.Model) :\n    title </span>= models.CharField(max_length=32<span style=\"color: #000000\">)\n    publish </span>=<span style=\"color: #000000\"> models.DateField()\n    price </span>= models.DecimalField(max_digits=5,decimal_places=2<span style=\"color: #000000\">)\n    commnetNum </span>=<span style=\"color: #000000\"> models.IntegerField()\n    keepNum </span>= models.IntegerField()</pre>\n</div>\n<p><span style=\"font-size: 16px\"><strong>2、F 查询</strong></span></p>\n<p><span style=\"font-size: 16px\">在之前所有的例子中，我们查询条件都只是将字段值与某个常量做比较。如果我们要对两个字段的值做比较，用以前的语法是无法实现的会飘红想要实现字段与字段相比较就只有用一个新的语法 F 查询（使用前需要使用import导入F）</span></p>\n<p><span style=\"font-size: 16px\">1）字段比较</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">#</span><span style=\"color: #008000\"> 查询评论数大于收藏数的书籍</span>\n \n<span style=\"color: #0000ff\">from</span> django.db.models <span style=\"color: #0000ff\">import</span><span style=\"color: #000000\"> F\nBook.objects.filter(commnetNum__lt</span>=F(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">keepNum</span><span style=\"color: #800000\">'</span>))</pre>\n</div>\n<p><span style=\"font-size: 16px\">2）Django 支持 F() 对象之间以及 F() 对象和常数之间的加减乘除和取模的操作。</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">#</span><span style=\"color: #008000\"> 查询评论数大于收藏数2倍的书籍</span>\nBook.objects.filter(commnetNum__lt=F(<span style=\"color: #800000\">'</span><span style=\"color: #800000\">keepNum</span><span style=\"color: #800000\">'</span>)*2)</pre>\n</div>\n<p><span style=\"font-size: 16px\">3）修改操作也可以使用F函数</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">#</span><span style=\"color: #008000\">将每一本书的价格提高30元</span>\nBook.objects.all().update(price=F(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">price</span><span style=\"color: #800000\">\"</span>)+30)　</pre>\n</div>\n<p><span style=\"font-size: 16px\"><strong>3、Q 查询</strong></span></p>\n<p><span style=\"font-size: 16px\">如果有多条查询条件我们想要实现 ‘与’ 的效果只需要用逗号将每个条件隔开就好，那么怎么实现 ‘或’ ‘非’ 呢 这就用到Q语句了（使用前需要使用import导入Q）</span></p>\n<p><span style=\"font-size: 16px\"><tt class=\"docutils literal\"><span class=\"pre\">Q</span></tt> 对象可以使用<tt class=\"docutils literal\"><span class=\"pre\">&amp;</span></tt> 和<tt class=\"docutils literal\"><span class=\"pre\">|</span></tt> 操作符组合起来。同时，<tt class=\"docutils literal\"><span class=\"pre\">Q</span></tt> 对象可以使用<tt class=\"docutils literal\"><span class=\"pre\">~</span></tt> 操作符取反，这允许组合正常的查询和取反(<tt class=\"docutils literal\"><span class=\"pre\">NOT</span></tt>) 查询</span></p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">#</span><span style=\"color: #008000\">书名是西游或水浒 |</span>\nBook.objects.filter(Q(title=<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">西游</span><span style=\"color: #800000\">\"</span>)|Q(title=<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">水浒</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">))\n\n</span><span style=\"color: #008000\">#</span><span style=\"color: #008000\">作者是布吉岛或者不是2017年出版的书籍 &amp; ~</span><span style=\"color: #008000\">\n#</span><span style=\"color: #008000\">这个例子涉及多表关联可以用上篇随笔中的表结构</span>\nbookList=Book.objects.filter(Q(authorlish__name=<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">布吉岛</span><span style=\"color: #800000\">\"</span>) &amp; ~Q(publishDate__year=2017)).values_list(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">title</span><span style=\"color: #800000\">\"</span>)</pre>\n</div>\n<hr>\n<p> </p>\n<p><span style=\"font-size: 14pt\"><strong><a name=\"er\"></a>二、cookie</strong></span></p>\n<p><span style=\"font-size: 16px\"><strong>1、cookie简述</strong></span></p>\n<p><span style=\"font-size: 16px\">1）cookie不属于http协议范围，由于http协议无法保持状态，但实际情况，我们却又需要“保持状态”，因此cookie就是在这样一个场景下诞生。</span></p>\n<p><span style=\"font-size: 16px\">2）cookie的工作原理是：由服务器产生内容，浏览器收到请求后保存在本地；当浏览器再次访问时，浏览器会自动带上cookie，这样服务器就能通过cookie的内容来判断这个是“谁”了。</span></p>\n<p><span style=\"font-size: 16px\">3）cookie虽然在一定程度上解决了“保持状态”的需求，但是由于cookie本身最大支持4096字节，以及cookie本身保存在客户端，可能被拦截或窃取，因此就需要有一种新的东西，它能支持更多的字节，并且他保存在服务器，有较高的安全性。这就是session。（下篇随笔介绍session）</span></p>\n<p><span style=\"font-size: 16px\">4）</span><span style=\"font-size: 16px\">我们可以给每个客户端的cookie分配一个唯一的id，这样用户在访问时，通过cookie，服务器就知道来的人是“谁”。然后我们再根据不同的cookie的id，在服务器上保存一段时间的私密资料，如“账号密码”等等。</span></p>\n<p><span style=\"font-size: 16px\">cookie弥补了http无状态的不足，让服务器知道来的人是“谁”；但是cookie以文本的形式保存在本地，自身安全性较差；所以我们就通过cookie识别不同的用户，对应的在session里保存私密的信息以及超过4096字节的文本。</span></p>\n<p><strong><span style=\"font-size: 16px\">2、简单实现登录效果</span></strong></p>\n<p><span style=\"font-size: 16px\">1）cookie的获取</span></p>\n<div class=\"cnblogs_code\">\n<pre>request.COOKIES[<span style=\"color: #800000\">'</span><span style=\"color: #800000\">key</span><span style=\"color: #800000\">'</span><span style=\"color: #000000\">]\n或\nrequest.COOKIES.get(</span><span style=\"color: #800000\">'</span><span style=\"color: #800000\">key</span><span style=\"color: #800000\">'</span>)</pre>\n</div>\n<p><span style=\"font-size: 16px\">2）cookie的设置</span></p>\n<div class=\"cnblogs_code\">\n<pre>rep =<span style=\"color: #000000\"> HttpResponse(...) 或 rep ＝ render(request, ...) 或 rep ＝ redirect()\n \nrep.set_cookie()</span></pre>\n</div>\n<p><span style=\"font-size: 16px\">3）参数</span></p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_b576d9c2-67a8-49a2-a682-d13885d30cb8\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_b576d9c2-67a8-49a2-a682-d13885d30cb8\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_b576d9c2-67a8-49a2-a682-d13885d30cb8\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #800000\">'''</span><span style=\"color: #800000\">\ndef set_cookie(self, key,                 键\n　　　　　　　　　　　　 value='',            值\n　　　　　　　　　　　　 max_age=None,        超长时间\n　　　　　　　　　　　　 expires=None,        超长时间\n　　　　　　　　　　　　 path='/',           Cookie生效的路径，\n                                         浏览器只会把cookie回传给带有该路径的页面，这样可以避免将\n                                         cookie传给站点中的其他的应用。\n                                         / 表示根路径，特殊的：根路径的cookie可以被任何url的页面访问\n　　　　　　　　　　　　 \n                     domain=None,         Cookie生效的域名\n                                        \n                                          你可用这个参数来构造一个跨站cookie。\n                                          如， domain=\".example.com\"\n                                          所构造的cookie对下面这些站点都是可读的：\n                                          www.example.com 、 www2.example.com \n　　　　　　　　　　　　　　　　　　　　　　　　　和an.other.sub.domain.example.com 。\n                                          如果该参数设置为 None ，cookie只能由设置它的站点读取。\n\n　　　　　　　　　　　　 secure=False,        如果设置为 True ，浏览器将通过HTTPS来回传cookie。\n　　　　　　　　　　　　 httponly=False       只能http协议传输，无法被JavaScript获取\n                                         （不是绝对，底层抓包可以获取到也可以被覆盖）\n　　　　　　　　　　): pass\n</span><span style=\"color: #800000\">'''</span></pre>\n</div>\n<span class=\"cnblogs_code_collapse\" style=\"font-size: 16px\">View Code</span></div>\n<p><span style=\"font-size: 16px\">4）实例</span></p>\n<p><span style=\"font-size: 16px\">主页和登录页面 cookie可以保存20秒</span></p>\n<div class=\"cnblogs_code\"><img id=\"code_img_closed_b66cd26c-7d8b-4a0c-8c97-942a980b41d3\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_b66cd26c-7d8b-4a0c-8c97-942a980b41d3\" class=\"code_img_opened\" style=\"display: none\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\n<div id=\"cnblogs_code_open_b66cd26c-7d8b-4a0c-8c97-942a980b41d3\" class=\"cnblogs_code_hide\">\n<pre><span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> login(requset):\n    </span><span style=\"color: #0000ff\">if</span> requset.method==<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">POST</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">:\n        username</span>=requset.POST.get(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">user</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)\n        password</span>=requset.POST.get(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">pwd</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)\n        ret</span>=models.UserInfo.objects.filter(username=username,password=<span style=\"color: #000000\">password)\n        </span><span style=\"color: #0000ff\">if</span><span style=\"color: #000000\"> ret:\n            obj</span>=redirect(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">/home/</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)\n            obj.set_cookie(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">is_login</span><span style=\"color: #800000\">\"</span>,True,20<span style=\"color: #000000\">)\n            obj.set_cookie(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">username</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,username)\n            </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> obj\n        </span><span style=\"color: #0000ff\">else</span><span style=\"color: #000000\">:\n            </span><span style=\"color: #0000ff\">return</span> redirect(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">/login/</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)\n    </span><span style=\"color: #0000ff\">return</span> render(requset,<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">login.html</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)\n\n\n</span><span style=\"color: #0000ff\">def</span><span style=\"color: #000000\"> index(request):\n    is_login</span>=request.COOKIES.get(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">is_login</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,None)\n    </span><span style=\"color: #0000ff\">if</span><span style=\"color: #000000\"> is_login:\n        username</span>=request.COOKIES.get(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">username</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)\n        </span><span style=\"color: #0000ff\">return</span> render(request, <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">index.html</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">,locals())\n    </span><span style=\"color: #0000ff\">else</span><span style=\"color: #000000\">:\n        </span><span style=\"color: #0000ff\">return</span> redirect(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">/login/</span><span style=\"color: #800000\">\"</span>)</pre>\n</div>\n<span class=\"cnblogs_code_collapse\" style=\"font-size: 16px\">View Code</span></div>\n<p><span style=\"font-size: 16px\"><strong>3、删除cookie</strong></span></p>\n<div class=\"cnblogs_code\">\n<pre>response.delete_cookie()</pre>\n</div>\n<p><span style=\"font-size: 16px\"><strong>4、cookie存储到客户端</strong></span><br><span style=\"font-size: 16px\">优点：</span><span style=\"font-size: 16px\">数据存在在客户端，减轻服务器端的压力，提高网站的性能。</span><br><span style=\"font-size: 16px\">缺点：</span><span style=\"font-size: 16px\">安全性不高：在客户端机很容易被查看或破解用户会话信息</span></p>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 17:21</span> <a href=\"http://www.cnblogs.com/liluning/\">布吉岛丶</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7762600\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7762600);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=314456,cb_entryId=7762600,cb_blogApp=currentBlogApp,cb_blogUserGuid='30f50613-169f-e611-845c-ac853d9f53ac',cb_entryCreatedDate='2017/10/31 17:21:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 91, "image_url": ["https://pic.cnblogs.com/face/1054024/20161031172341.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "数据权限设计——基于EntityFramework的数据权限设计方案：一种设计思路", "url": "http://www.cnblogs.com/landeanfen/p/7760803.html", "author": "懒得安分", "article_desc": "前言：“我们有一个订单列表，希望能够根据当前登陆的不同用户看到不同类型的订单数据”、“我们希望不同的用户能看到不同时间段的扫描报表数据”、“我们系统需要不同用户查看不同的生产报表列”。诸如此类，最近经常收到项目上面的客户提出的这种问题，即所谓的“数据权限”，经过开会讨论决定：在目前的开发框架上面搭建 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/landeanfen/p/7760803.html\">数据权限设计——基于EntityFramework的数据权限设计方案：一种设计思路</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p> 前言：“我们有一个订单列表，希望能够根据当前登陆的不同用户看到不同类型的订单数据”、“我们希望不同的用户能看到不同时间段的扫描报表数据”、“我们系统需要不同用户查看不同的生产报表列”。诸如此类，最近经常收到项目上面的客户提出的这种问题，即所谓的“数据权限”，经过开会讨论决定：在目前的开发框架上面搭建一套通用的数据权限功能。</p>\r\n<p>本文原创地址：<a href=\"http://www.cnblogs.com/landeanfen/p/7760803.html\" target=\"_blank\">http://www.cnblogs.com/landeanfen/p/7760803.html</a></p>\r\n<h1>一、大话权限模块</h1>\r\n<p>有了上面的引言，自然而然就引出了今天需要和大家讨论的话题——数据权限。作为开发人员，我们肯定知道，一般的系统都离不开权限模块，它是支撑整个系统运行的基础模块。而根据项目类型和需求的不同，权限模块的设计更是大相径庭。但不管怎么变，权限模块从大的方面来说，可以分为两种大的类型：<strong>功能权限</strong> 和 <strong>数据权限</strong>。</p>\r\n<ul>\r\n<li><strong>功能权限</strong>：主要控制不同的资源主体（用户、角色、组织等）有操作不同的资源的权限。比如常见的不同的角色能访问不同的页面（菜单权限），以及具有操作同一页面的不同功能（按钮权限）等等，都数据功能权限的范畴，这种设计相对比较简单，也比较为大多数系统所通用。当然网上资料、设计思路也可以找到很多。</li>\r\n<li><strong>数据权限</strong>：主要控制不同的资源主体（用户、角色、组织等）有查看不同的数据信息的权限，一般来说，数据权限又分为<strong>数据行权限</strong>和<strong>数据列权限</strong>，通过字面意思不难理解这两者的区别，比如上文“我们有一个订单列表，希望能够根据当前登陆的不同用户看到不同类型的订单数据” 这就是一个典型的数据行权限，而“我们系统需要不同用户查看不同的生产报表列”这就是数据列权限的范畴。由于数据权限和系统的业务逻辑关系非常密切，所以不同的系统设计差异性会非常大。从另一方面来说，由于数据权限和业务逻辑关联性非常强，如果系统的业务逻辑非常复杂，数据权限设计起来也会相对复杂，所以关于数据权限的设计一直没有一种相对通用和使用简单的设计方案。</li>\r\n</ul>\r\n<p>如果你动手去设计数据权限，当你去各大平台、百度、谷歌查找设计思路的时候，你会发现很难找到有用的资料，很多设计思路局限性非常大。其实原因很简单：数据权限的设计和他人系统关系紧密，一般不太容易拿到你的项目上面直接使用。</p>\r\n<p>当然也有另外部分人说“数据权限并不能作为权限模块去设计”，比如博主看到这样一条评论</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/459756/201710/459756-20171031143537933-412942461.png\" alt=\"\"></p>\r\n<p>从一定程度上来说，这样理解也不为过，如果你觉得你的系统灵活性和配置性不需要那么高，把数据权限的规则在代码里面写死又何妨，博主所在公司的另外一个部门就是这么干的，除了编码量大一点，其实也没什么太大的问题！其实博主说这么多无非是想表达一个观点：没有绝对通用的数据权限设计思路，关键看合不合你用！当然本文的设计思路也是一样，不强制要求，不提通用。设计思路供你参考！</p>\r\n<h1>二、一种设计思路</h1>\r\n<p>关于权限设计的杂谈就告一段落，凡是点到即止，再说了多了就说烂了。到目前为止，博主找到的一篇写得相对比较好的文章 <a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/leoxie2011/archive/2012/03/20/2408542.html\" target=\"_blank\">通用权限管理设计 之 数据权限</a>。这位博主是用sql去实现的，如果是把这个运用到EF里面的话，考虑到EF复杂的导航属性，会有一些问题。接下来说说博主这边想到的设计思路。</p>\r\n<p>先说说博主所在项目的情况，和数据打交道的部分采用EntityFramework+Repository的传统模式去实现的，整个项目从上到下，就是一种典型的\"伪DDD\"，什么是”伪DDD“？这里不做过多说明，使用过DDD的同仁应该很清楚。下面是设计思路流程图：</p>\r\n<p>第一步：配置数据规则<br><img src=\"http://images2017.cnblogs.com/blog/459756/201710/459756-20171031162024058-830272626.png\" alt=\"\"></p>\r\n<p>第二步：页面使用数据规则</p>\r\n<p> <img src=\"http://images2017.cnblogs.com/blog/459756/201710/459756-20171031161952949-496729394.png\" alt=\"\"></p>\r\n<p> 以上是一个大致的思路图，总的来说，要实现基于EF的数据权限设计，主要分为两大步骤</p>\r\n<h2>1、配置数据规则</h2>\r\n<p>配置数据规则这里有三个大的方面：<strong>功能模块</strong>、<strong>数据资源</strong>、<strong>角色</strong></p>\r\n<ul>\r\n<li><strong>功能模块：</strong>为什么这里要加上功能模块的约束？是因为博主觉得我们某一个页面在查询数据的时候，会有一个查询的范围，比如订单查询页面肯定只能查询和订单有关联的实体功能，而不可能查询和它没有任何关联的业务。<strong>加这个约束更大的意义在于我们动态的构造Lambda去查询实体的时候不会产生”找不到相关联的实体“之类的错误</strong>。</li>\r\n<li><strong>数据资源：</strong>具体对哪种数据资源做数据权限，比如订单的状态不等于取消状态、订单的下单时间小于当前月份等等。</li>\r\n<li><strong>角色：</strong>数据资源的主体，还可以是用户、部门、组织等等。</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<p>这三者配置之后得到的一个结果就是某一类角色的某一个功能模块对哪个数据资源的数据规则是什么样的。比如有一条销售总监的数据规则，配置销售总监在订单模块里面订单这个实体的订单类型是销售订单的所有数据，这就是针对销售总监在订单模块的数据规则。可能最终数据库存储得到的数据类似这样：</p>\r\n<table style=\"height: 202px; width: 1224px;\" border=\"0\">\r\n<tbody>\r\n<tr>\r\n<td>RoleId</td>\r\n<td>FunctionCode</td>\r\n<td>Rules</td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr>\r\n<td>2</td>\r\n<td>OrderQuery</td>\r\n<td>\r\n<p>{\"rules\":[{\"field\":\"Order_Status\",\"operate\":\"in\",\"value\":\"[0,1,2]\"},{\"field\":\"Order_Type\",\"op\":\"equal\",\"value\":\"1\"}],\"logicoperate\":\"and\"}</p>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr>\r\n<td>3</td>\r\n<td>OrderQuery</td>\r\n<td>\r\n<p>{\"rules\":[{\"field\":\"Order_Status\",\"operate\":\"in\",\"value\":\"[0]\"},{\"field\":\"Product.Categary.Type\",\"equal\":\"equal\",\"value\":\"1\"}],\"logicoperate\":\"and\"}</p>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n<tr>\r\n<td>5</td>\r\n<td>Product</td>\r\n<td>\r\n<p>{\"groups\":[</p>\r\n<p>{\"rules\":[{\"field\":\"Order_Status\",\"operate\":\"in\",\"value\":\"[0,5,10]\"},{\"field\":\"Order_Type\",\"op\":\"equal\",\"value\":\"1 \"}],\"logicoperate\":\"and\"},</p>\r\n<p>{\"rules\":[{\"field\":\"LineName\",\"operate\":\"equal\",\"value\":\"fenzhuangxian\"}]}</p>\r\n<p>],\"logicoperate\":\"or\"}</p>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tr>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</tbody>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</table>\r\n<p> </p>\r\n<p><strong>需要特别说明的是：由于EF有导航属性，这里的Rules在保存的时候如果遇到导航属性，我们的字段值需要这样保存——Product.Categary.Type。因为在我们转换成为lambda表达式的时候导航属性会是这样写：x=&gt;x.Product.Categary.Type==1。这个我们在后面使用这个规则的时候加以说明。</strong></p>\r\n<p> </p>\r\n<h2>2、使用数据规则</h2>\r\n<p> 有了上面的数据规则，接下来就是我们在取数据的时候如何使用了，这里有一点需要说明的是：我们这里需要传两个参数，一个是模块的名称，比如上面的OrderQuery、Product等；第二个是当前用户的角色id，这个可以通过当前登陆用户的id获取到角色。</p>\r\n<p>要使用数据规则，之前博主分享过两篇关于<a href=\"http://www.cnblogs.com/landeanfen/p/4923216.html\" target=\"_blank\">动态Lambda的文章</a>，现在派上用场了。只不过原来只是一些基础类型转lambda，现在涉及到了导航属性，不知道是否可行。博主查阅了一些资料，最终找到了解决方案。</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">　　　　 //</span><span style=\"color: #008000;\">遍历得到属性（包括遍历导航属性）</span>\r\n        <span style=\"color: #0000ff;\">public</span> Expression GetProperty(Expression source, ParameterExpression para, <span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\"> Name)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">string</span>[] propertys = Name.Split(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">.</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">);\r\n            </span><span style=\"color: #0000ff;\">if</span> (source == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            {\r\n                source </span>= Expression.Property(para, <span style=\"color: #0000ff;\">typeof</span><span style=\"color: #000000;\">(Entity).GetProperty(propertys.First()));\r\n            }\r\n            </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n            {\r\n                source </span>=<span style=\"color: #000000;\"> Expression.Property(source, propertys.First());\r\n            }\r\n            </span><span style=\"color: #0000ff;\">foreach</span> (<span style=\"color: #0000ff;\">var</span> item <span style=\"color: #0000ff;\">in</span> propertys.Skip(<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">))\r\n            {\r\n                source </span>=<span style=\"color: #000000;\"> GetProperty(source, para, item);\r\n            }\r\n            </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> source;\r\n        }</span></pre>\r\n</div>\r\n<p>然后测试如下</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">　　　　　　　　　　　　var</span> oLamadaExtention = <span style=\"color: #0000ff;\">new</span> LambdaExpression&lt;Order&gt;<span style=\"color: #000000;\">();\r\n                    </span><span style=\"color: #0000ff;\">var</span> left = oLamadaExtention.GetProperty(<span style=\"color: #0000ff;\">null</span>, Expression.Parameter(<span style=\"color: #0000ff;\">typeof</span>(Order), <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">x</span><span style=\"color: #800000;\">\"</span>), <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Product.Categary.Type</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n                    </span><span style=\"color: #0000ff;\">var</span> value = Expression.Constant(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">1</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, left.Type);\r\n                    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">动态转换类型</span>\r\n                    <span style=\"color: #0000ff;\">var</span> right =<span style=\"color: #000000;\"> Expression.Constant(value, left.Type);\r\n                    Expression expRes </span>= Expression.Equal(left, right);</pre>\r\n</div>\r\n<p>测试得到的查询lambda结果为x=&gt;x.Product.Categary.Type==\"1\"，测试成功！</p>\r\n<h2>3、补充一点</h2>\r\n<p>对于配置数据规则的时候还有一点比较麻烦的是，如果如何知道哪个功能模块使用哪些实体？不可能直接让用户去写Product.Categary.Type这些复杂的功能吧，如果是这样，谈何体验。那么只有使用另外一种解决思路了——反射EF实体。</p>\r\n<p>反射EF实体的时候如果是导航属性，还得继续反射导航属性的实体，这样一层一层反射下去，最终确实是可以得到形如Product.Categary.Type这个的结构体，但界面如何展现还有待思考。比如思路如下：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/459756/201710/459756-20171031173733683-1622245167.png\" alt=\"\"></p>\r\n<h1>三、总结</h1>\r\n<p>以上只是一个设计思路，理论上来说是可以实现的，如有不足，欢迎斧正，谢谢。如果思路没有问题，后续博主会抽时间将这种设计的实现过程展现出来供大家参考，欢迎关注。其中的难点有两个：</p>\r\n<p>1、逐级反射EF的导航属性，以及这个过程如何展现。是通过特性标记，还是开发人员配置；</p>\r\n<p>2、动态Expression在构造Lambda的时候和配置数据的兼容性问题，比如数据类型的兼容性有点难控制。</p>\r\n<p>本文原创出处：<a href=\"http://www.cnblogs.com/landeanfen/\" target=\"_blank\">http://www.cnblogs.com/landeanfen/</a></p>\r\n<p>欢迎各位转载，但是未经作者本人同意，转载文章之后<strong>必须在文章页面明显位置给出作者和原文连接</strong>，否则保留追究法律责任的权利</p>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 17:52</span> <a href=\"http://www.cnblogs.com/landeanfen/\">懒得安分</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7760803\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7760803);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=131448,cb_entryId=7760803,cb_blogApp=currentBlogApp,cb_blogUserGuid='19347013-e91c-e211-aa8f-842b2b196315',cb_entryCreatedDate='2017/10/31 17:52:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 526, "image_url": ["https://pic.cnblogs.com/face/459756/20150629145137.png"], "date_pub": "2017-10-31", "article_common": 3}
{"title": "我只是想获取access_token而已", "url": "http://www.cnblogs.com/anyhoo/p/7760917.html", "author": "anyhoo", "article_desc": "起因是想在微信小程序中获取access_token。 之前资源只有一个阿里云虚拟主机和一个域名，于是用C#后端写了GET请求的接口，准备调用自己域名下的接口获取access_token 使用微信的wx.request接口 发现报错，提示该域名不在服务器合法域名中 于是去微信小程序的开发设置中的服务器 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/anyhoo/p/7760917.html\">我只是想获取access_token而已</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>   起因是想在微信小程序中<span style=\"color: #ff0000\">获取access_token</span>。</p>\n<p>   <img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031104540902-221126972.png\" alt=\"\"></p>\n<p>  之前资源只有<span style=\"color: #ff0000\">一个阿里云虚拟主机和一个域名</span>，于是用C#后端写了GET请求的接口，准备调用自己域名下的接口获取access_token</p>\n<p>  使用微信的<span style=\"color: #ff0000\">wx.request</span>接口</p>\n<div class=\"cnblogs_Highlighter\">\n<pre class=\"brush:javascript;gutter:true;\">    wx.request({\n      url: \"www.xxxxxx.com/home/gettoken\",\n      success:function(res){\n        console.log(res)\n      }\n    })\n</pre>\n</div>\n<p>　　发现报错，提示<span style=\"color: #ff0000\">该域名不在服务器合法域名中</span></p>\n<p>  于是去微信小程序的开发设置中的服务器域名配置</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031105308886-720462443.png\" alt=\"\"></p>\n<p>  添加了request合法域名为 xxxxx.com；</p>\n<p>  仍然提示不在合法域名中，仔细一看，原来小程序要求配<span style=\"color: #ff0000\">置的服务器域名必须是https</span>的</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031105825449-571222868.png\" alt=\"\"></p>\n<p> </p>\n<p>  行，那就去阿里云搞一个证书，登录阿里云管理控制台，列表选择安全（云盾）-》CA证书服务，购买证书</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031110106761-785520115.png\" alt=\"\"></p>\n<p>   等几分钟证书就申请好了，点【下载】</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031110210230-594518191.png\" alt=\"\"></p>\n<p> 本人的是云虚拟主机啊，只是服务器上的一个文件夹而已，根本没办法去配置证书，怎么办，然后去查资料，发现可以通过CDN加速或者上负载均衡来实现</p>\n<p> 如果你觉得上面两种方式能满足你的需求，请另行百度，总之我是放弃了。</p>\n<p> 之后本人就去买了个ECS服务器最低配的那种，选择windows server 2008 R2</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031110955152-2132090609.png\" alt=\"\"></p>\n<p>准备拿着公网ip在自己的电脑上远程连接桌面，结果提示：</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031111153761-1912926434.png\" alt=\"\"></p>\n<p> 然后就去查安全组配置，发现该有的都有了</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031111314933-1625814277.png\" alt=\"\"></p>\n<p>后面升级https需要加一条规则</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031134123418-1458372228.png\" alt=\"\"></p>\n<p> </p>\n<p>用网页版的远程连接到服务器上查看是否开启了允许远程连接，是可以的</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031111551308-625697151.png\" alt=\"\"></p>\n<p>查看防火墙，关了的，讲道理应该能远程上才对。</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031111627402-475756489.png\" alt=\"\"></p>\n<p> 最后发现cmd-》ipconfig发现没有分配Ip地址，于是修改成静态内网Ip,终于远程上了。<span style=\"color: #ff0000\">远程连接不上会有很多种原因，如果按照查询的方法仍然不行的话，建议提交阿里云工单，还是很靠谱的</span>。</p>\n<p> 安装IIS，这一步没有任何坑</p>\n<p> 安装证书</p>\n<p> 发布代码，添加网站绑定</p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031112328777-1323965881.png\" alt=\"\"></p>\n<p>添加HTTPS绑定，选择ssl证书</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031112413558-2057524718.png\" alt=\"\"></p>\n<p>iis上浏览网站（https）的，发现地址栏是本地，并没有指到我的域名，上面的框里也没有办法修改添加主机名</p>\n<p>iis7下面默认HTTPS绑定是无法指定主机头的，但我们可以通过手工修改IIS配置来实现主机头绑定</p>\n<p> 打开<span style=\"color: #ed1c24\">C:\\Windows\\system32\\inetsrv\\config\\applicationHost.config</span></p>\n<p> 搜索https</p>\n<p>         &lt;bindings&gt;<br>                    <span style=\"color: #ed1c24\">&lt;binding protocol=\"https\" bindingInformation=\"*:443\" /&gt;<br></span>　　　　　　xxxxxxx</p>\n<p>　　　　　　xxxxxx<br>        &lt;/bindings&gt;</p>\n<p>修改成：</p>\n<p> &lt;binding protocol=\"https\" bindingInformation=\"*:443:你的域名\" /&gt;</p>\n<p>域名解析中添加服务器ip的解析</p>\n<p> <img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031133927808-1395868622.png\" alt=\"\"></p>\n<p>  一切完毕之后，准备开始调用access_token大展身手，结果又提示<span style=\"color: #ff0000\">TLS版本为1.0，至少需要1.2及以上版本</span></p>\n<p> 经查询发现，在IIS7中TLS1.2协议是默认关闭的。</p>\n<p>所以我们需要对IIS做下设置，来开启TLS1.2协议。</p>\n<p>可使用ssltools工具</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031134627636-2064583613.png\" alt=\"\"></p>\n<p> 该升级的也升级了</p>\n<p>终于，接口通了</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/1000047/201710/1000047-20171031135023324-1374943415.png\" alt=\"\"></p>\n<p> </p>\n<p> </p>\n<p> </p>\n<p> </p>\n<h3 id=\"wxrequestobject\"> </h3>\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 13:51</span> <a href=\"http://www.cnblogs.com/anyhoo/\">anyhoo</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7760917\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7760917);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=297291,cb_entryId=7760917,cb_blogApp=currentBlogApp,cb_blogUserGuid='558b840b-8954-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/31 13:51:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 708, "image_url": ["https://pic.cnblogs.com/face/1000047/20171101113330.png"], "date_pub": "2017-10-31", "article_common": 9}
{"title": "浅析Entity Framework Core中的并发处理", "url": "http://www.cnblogs.com/GuZhenYin/p/7761352.html", "author": "GuZhenYin", "article_desc": "前言 Entity Framework Core 2.0更新也已经有一段时间了,园子里也有不少的文章.. 本文主要是浅析一下Entity Framework Core的并发处理方式. 1.常见的并发处理策略 要了解如何处理并发,就要知道并发的一般处理策略 悲观并发策略 悲观并发策略,正如其名,它指的 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/GuZhenYin/p/7761352.html\">浅析Entity Framework Core中的并发处理</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><div style=\"text-align: center; background-color: #888888\"><span style=\"font-size: 23.9999980926514px; line-height: 40px\">前言</span></div>\n<p>Entity Framework Core 2.0更新也已经有一段时间了,园子里也有不少的文章..</p>\n<p>本文主要是浅析一下Entity Framework Core的并发处理方式.</p>\n<p> </p>\n<p> </p>\n<div style=\"text-align: center; background-color: #888888\"><span style=\"font-size: 23.9999980926514px; line-height: 40px\">1.常见的并发处理策略</span></div>\n<p>要了解如何处理并发,就要知道并发的一般处理策略</p>\n<p><strong>悲观并发策略<br></strong></p>\n<p>悲观并发策略,正如其名,它指的是对数据被外界（包括本系统当前的其他事务,以及来自外部系统的事务处理）修改持保守悲观的态度,因此,在整个数据处理过程中,将数据处于锁定状态。悲观并发策略大多数情况下依靠数据库的锁机制实现，以保证操作最大程度的独占性。但随之而来的就是数据库性能的巨大开销,特别是对长事务而言,这样的开销在大量的并发情况下往往无法承受。</p>\n<p><br><strong>乐观并发<strong>策略</strong></strong></p>\n<p>乐观并发策略,一般是基于数据版本 Version记录机制实现。何谓数据版本？即为数据增加一个版本标识,在基于数据库表的版本解决方案中,一般是通过为数据库表增加一个 “version” 字段来实现.读取出数据时,将此版本号一同读出,之后更新时,对此版本号加一。此时,将提交数据的版本数据与数据库表对应记录的当前版本信息进行比对，<strong>如果提交的数据版本号大于数据库表当前版本号，则予以更新，否则认为是过期数据。</strong>需要注意的是，乐观并发策略机制往往基于系统中的数据存储逻辑，因此也具备一定的局限性.</p>\n<p>本篇就是讲解,如何在我们的Entity Framework Core中来使用和<strong>自定义我们的并发策略</strong></p>\n<p> </p>\n<p> </p>\n<div style=\"text-align: center; background-color: #888888\"><span style=\"font-size: 23.9999980926514px; line-height: 40px\">2.Entity Framework Core并发令牌</span></div>\n<p>要使用Entity Framework Core中的并发策略,就需要使用我们的<strong>并发令牌(ConcurrencyCheck)</strong></p>\n<p>在Entity Framework Core中,并发的默认处理方式是无视并发冲突的,任何修改语句在条件符合的情况下,都可以修改成功.</p>\n<p>在高并发的情况下这种处理方式,肯定会给我们的数据库带来很多脏数据,所以,Entity Framework Core提供了<strong>并发令牌(ConcurrencyCheck)</strong>这个特性.</p>\n<p>如果一个属性被配置为并发令牌，则EF将在保存这条记录时，会检查没有其他用户修改过数据库中的这个属性的值。EF使用了乐观并发策略，这意味着它将假定值没有改变，并尝试保存数据,但如果发现值已更改,则抛出异常。</p>\n<p>举个例子,我们有一个用户类(User),我们配置 User中的 Name为并发令牌。这意味着，如果一个用户试图保存一个有些变化的 User，但另一个用户已经改变了 <code class=\"prettyprint prettyprinted\"><span class=\"typ\">Name</span></code>那么将抛出一个异常。这在应用中一般是可取的，以便我们的应用程序可以提示用户，在保存他们的改变之前，以确保此记录仍然代表同一个姓名的人。</p>\n<h2 id=\"how-concurrency-tokens-work-in-ef\"><span>2.1并发令牌在EF中工作的原理</span></h2>\n<p>当我们配置User中的Name为令牌的时候,EF会<span><span>将并发令牌包含在Where、Update</span></span><span><span>或delete</span></span><span><span>命令</span><span>的</span><span>子句中</span><span>并检查受影响的行数来</span><span>实现验证</span><span>。</span><span>如果并发令牌仍然匹配，则一行将被更新。</span><span>如果数据库中的值已更改，则不会更新任何行。</span></span></p>\n<p><strong>比如,当我们设置Name为并发令牌,然后通过ID来修改User的PassWord的时候,</strong>EF会生成如下的修改语句:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">UPDATE</span> <span style=\"color: #ff0000\">[</span><span style=\"color: #ff0000\">User</span><span style=\"color: #ff0000\">]</span> <span style=\"color: #0000ff\">SET</span> <span style=\"color: #ff0000\">[</span><span style=\"color: #ff0000\">PassWord</span><span style=\"color: #ff0000\">]</span> <span style=\"color: #808080\">=</span> <span style=\"color: #008000\">@p1</span>\n<span style=\"color: #0000ff\">WHERE</span> <span style=\"color: #ff0000\">[</span><span style=\"color: #ff0000\">ID</span><span style=\"color: #ff0000\">]</span> <span style=\"color: #808080\">=</span> <span style=\"color: #008000\">@p0</span> <span style=\"color: #808080\">AND</span> <span style=\"color: #ff0000\">[</span><span style=\"color: #ff0000\">Name</span><span style=\"color: #ff0000\">]</span> <span style=\"color: #808080\">=</span> <span style=\"color: #008000\">@p2</span>;</pre>\n</div>\n<p>当然,这时候,Name不匹配了,受影响的行数返回为0.</p>\n<h2>2.2并发令牌的使用约定</h2>\n<p>    属性默认不被配置为并发令牌。</p>\n<p> </p>\n<h2>2.3并发令牌的使用方式</h2>\n<p>1.直接使用特性,如下配置UserName为并发令牌:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">partial</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> UserTable\n    {\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">int</span> Id { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        [ConcurrencyCheck]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> UserName { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> PassWord { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">int</span>? ClassId { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n}</span></pre>\n</div>\n<p> 2.使用FluentAPI配置属性为并发令牌</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> MyContext : DbContext\n{\n    </span><span style=\"color: #0000ff\">public</span> DbSet&lt;UserTable&gt; People { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n    </span><span style=\"color: #0000ff\">protected</span> <span style=\"color: #0000ff\">override</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> OnModelCreating(ModelBuilder modelBuilder)\n    {\n        modelBuilder.Entity</span>&lt;UserTable&gt;<span style=\"color: #000000\">()\n            .Property(p </span>=&gt;<span style=\"color: #000000\"> p.UserName)\n            .IsConcurrencyToken();\n    }\n}</span></pre>\n</div>\n<p> </p>\n<p><strong>以上2种方式,效果是一样的.</strong></p>\n<p> </p>\n<h2>2.4使用时间戳和行级版本号</h2>\n<p>我们知道,SQL Server给我们提供了时间戳的属性(当然,几乎所有的关系数据库都有这个).下面举个SQL Server的例子</p>\n<p>我们加一个<strong>时间戳字段为TimestampV,加上特性Timestamp,</strong>实体代码如下:</p>\n<div class=\"cnblogs_code\">\n<pre>  <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">partial</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> UserTable\n    {\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">int</span> Id { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> UserName { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> PassWord { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">int</span>? ClassId { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n\n        </span><span style=\"color: #0000ff\">public</span> ClassTable Class { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n\n        [Timestamp]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">byte</span>[] TimestampV { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n    }</span></pre>\n</div>\n<p> </p>\n<p>CodeFrist生成的表如下:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/653851/201710/653851-20171031134635355-632021605.png\" alt=\"\"></p>\n<p>自动帮我们生成的Timestamp类型的一个字段.</p>\n<p>配置时间戳属性的方式也有2种,上面已经说了一种..特性的..</p>\n<p>同样我们也可以使用Fluent API配置属性为时间戳,代码如下:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> MyContext : DbContext\n{\n    </span><span style=\"color: #0000ff\">public</span> DbSet&lt;UserTable&gt; Blogs { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n\n    </span><span style=\"color: #0000ff\">protected</span> <span style=\"color: #0000ff\">override</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> OnModelCreating(ModelBuilder modelBuilder)\n    {\n        modelBuilder.Entity</span>&lt;UserTable&gt;<span style=\"color: #000000\">()\n            .Property(p </span>=&gt;<span style=\"color: #000000\"> p.TimestampV)\n            .ValueGeneratedOnAddOrUpdate()\n            .IsConcurrencyToken();\n    }\n}</span></pre>\n</div>\n<p> </p>\n<p> </p>\n<div style=\"text-align: center; background-color: #888888\"><span style=\"font-size: 23.9999980926514px; line-height: 40px\">3.如何根据需求自定义处理并发冲突</span></div>\n<p>上面,我们已经配置好了需要并发处理的表,也配置好了相关的特性,下面我们就来讲讲如何使用它.</p>\n<p>使用之前,我们先来了解一下,<strong>并发过程中所产生的3个值,也是我们需要处理的3个值</strong></p>\n<p>       1.<strong>当前值</strong>是应用程序尝试写入数据库的值。</p>\n<p>       2.<strong>原始值</strong>是在进行任何编辑之前最初从数据库检索的值。</p>\n<p>       3.<strong>数据库值</strong>是当前存储在数据库中的值。</p>\n<p>当我们配置好上面的并发令牌时,在EF执行SaveChanges()操作并产生并发的时候,我们会得到<strong>DbUpdateConcurrencyException</strong>的异常信息,(<strong>注意:在不配置并发令牌时,这个异常一般不会触发)</strong></p>\n<p>前面,我们已经讲过乐观并发策略是一种性能较高,也比较实用的处理方式,所以我们就通过时间戳来处理这个并发的问题.</p>\n<p>示例测试代码如下:</p>\n<div class=\"cnblogs_code\">\n<pre> <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Test()\n {\n            </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">重新创建数据库,并新增一条数据</span>\n            <span style=\"color: #0000ff\">using</span> (<span style=\"color: #0000ff\">var</span> context = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> School_TestContext())\n            {\n                context.Database.EnsureDeleted();\n                context.Database.EnsureCreated();\n\n                context.UserTable.Add(</span><span style=\"color: #0000ff\">new</span> UserTable { UserName = <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">John</span><span style=\"color: #800000\">\"</span>, PassWord = <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Doe</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\"> });\n                context.SaveChanges();\n            }\n\n            </span><span style=\"color: #0000ff\">using</span> (<span style=\"color: #0000ff\">var</span> context = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> School_TestContext())\n            {\n                </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 修改id为1的用户名称</span>\n                <span style=\"color: #0000ff\">var</span> person = context.UserTable.Single(p =&gt; p.Id == <span style=\"color: #800080\">1</span><span style=\"color: #000000\">);\n                person.UserName </span>= <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">555-555-5555</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">;\n\n                </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 直接通过访问数据库来修改同一条数据 (这里是为了模拟并发)</span>\n                context.Database.ExecuteSqlCommand(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">UPDATE dbo.UserTable SET UserName = 'Jane' WHERE ID = 1</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">);\n\n                </span><span style=\"color: #0000ff\">try</span><span style=\"color: #000000\">\n                {\n                    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">尝试保存修改</span>\n                    <span style=\"color: #0000ff\">int</span> a =<span style=\"color: #000000\"> context.SaveChanges();\n                }\n                </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">获取并发异常</span>\n                <span style=\"color: #0000ff\">catch</span><span style=\"color: #000000\"> (DbUpdateConcurrencyException ex)\n                {\n                    </span><span style=\"color: #0000ff\">foreach</span> (<span style=\"color: #0000ff\">var</span> entry <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> ex.Entries)\n                    {\n                        </span><span style=\"color: #0000ff\">if</span> (entry.Entity <span style=\"color: #0000ff\">is</span><span style=\"color: #000000\"> UserTable)\n                        {\n                            </span><span style=\"color: #0000ff\">var</span> databaseEntity = context.UserTable.AsNoTracking().Single(p =&gt; p.Id ==<span style=\"color: #000000\"> ((UserTable)entry.Entity).Id);\n                            </span><span style=\"color: #0000ff\">var</span> databaseEntry =<span style=\"color: #000000\"> context.Entry(databaseEntity);\n\n                            </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">当前上下文时间戳</span>\n                            <span style=\"color: #0000ff\">var</span> date = ConvertToTimeSpanString(entry.Property(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">TimestampV</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">).CurrentValue);\n                            </span><span style=\"color: #0000ff\">var</span> dateint =<span style=\"color: #000000\"> Int32.Parse(date, System.Globalization.NumberStyles.HexNumber);\n\n                            </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">数据库时间戳</span>\n                            <span style=\"color: #0000ff\">var</span> datebase = ConvertToTimeSpanString(databaseEntry.Property(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">TimestampV</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">).CurrentValue);\n                            </span><span style=\"color: #0000ff\">var</span> dateint2 =<span style=\"color: #000000\"> Int32.Parse(datebase, System.Globalization.NumberStyles.HexNumber);\n                            </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">如果当前上下文时间戳与数据库相同,或者更加新,则使用当前</span>\n                            <span style=\"color: #0000ff\">if</span> (dateint &gt;=<span style=\"color: #000000\"> dateint2)\n                            {\n                                </span><span style=\"color: #0000ff\">foreach</span> (<span style=\"color: #0000ff\">var</span> property <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> entry.Metadata.GetProperties())\n                                {\n                                    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">当前值</span>\n                                    <span style=\"color: #0000ff\">var</span> proposedValue =<span style=\"color: #000000\"> entry.Property(property.Name).CurrentValue;\n\n                                    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">原始值</span>\n                                    <span style=\"color: #0000ff\">var</span> originalValue =<span style=\"color: #000000\"> entry.Property(property.Name).OriginalValue;\n\n                                    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">数据库值</span>\n                                    <span style=\"color: #0000ff\">var</span> databaseValue =<span style=\"color: #000000\"> databaseEntry.Property(property.Name).CurrentValue;\n\n                                    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">更新当前值</span>\n                                    entry.Property(property.Name).CurrentValue =<span style=\"color: #000000\"> proposedValue;\n\n                                    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\">更新原始值来保证修改成功</span>\n                                    entry.Property(property.Name).OriginalValue =<span style=\"color: #000000\"> databaseEntry.Property(property.Name).CurrentValue;\n                                    </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> 尝试重新保存数据</span>\n                                    <span style=\"color: #0000ff\">int</span> aa =<span style=\"color: #000000\"> context.SaveChanges();\n                                }\n                            }\n                        }\n                        </span><span style=\"color: #0000ff\">else</span><span style=\"color: #000000\">\n                        {\n                            </span><span style=\"color: #0000ff\">throw</span> <span style=\"color: #0000ff\">new</span> NotSupportedException(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">无法处理并发,</span><span style=\"color: #800000\">\"</span> +<span style=\"color: #000000\"> entry.Metadata.Name);\n                        }\n                    }\n\n\n                }\n            }\n\n        }</span></pre>\n</div>\n<p> </p>\n<p>执行这段代码,会发现,符合我们乐观并发策略的要求.</p>\n<p>值为最后修改的UserName,为Jane,如图:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/653851/201710/653851-20171031141454058-1708350609.png\" alt=\"\"></p>\n<p>解释一下,为何最终结果为Jane.</p>\n<p>首先,我们添加了一条UserName为John的数据,我们在上下文中修改它为\"555-555-5555\",</p>\n<p>这时候,产生并发,另一个上下文在这个SaveChang之前,就执行完成了,把值修改为了Jane,所以EF通过并发令牌发现匹配失败.则会触发异常.</p>\n<p>在异常中,我们将当前上下文的版本号和数据库现有的版本号进行对比,发现当前上下文的版本号为过期数据,则不更新,并返回失败.</p>\n<p>请仔细看代码中的注释.</p>\n<p><strong>注意:这里的例子是根据乐观并发处理策略要进行处理的.你可以根据你的业务,来任意处理当前值,原始值和数据库值,选择你需要的值保存.</strong></p>\n<p> </p>\n<p> </p>\n<p> </p>\n<div style=\"text-align: center; background-color: #888888\"><span style=\"font-size: 23.9999980926514px; line-height: 40px\">写在最后</span></div>\n<p>.net core已经2.0版本了,Asp.net Core也2.0了..EFcore也2.0了..功能已经越来越强大,越来越完善.完全可以投入生产了.园子里对这些新技术也很关注,真的...我感觉很棒..从未如此的棒!!!!</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 14:30</span> <a href=\"http://www.cnblogs.com/GuZhenYin/\">GuZhenYin</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7761352\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7761352);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=192523,cb_entryId=7761352,cb_blogApp=currentBlogApp,cb_blogUserGuid='5838ad94-dd12-e411-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/10/31 14:30:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 1918, "image_url": ["https://pic.cnblogs.com/face/653851/20170727102407.png"], "date_pub": "2017-10-31", "article_common": 23}
{"title": "斩荆披棘，我们走的关于程序的路", "url": "http://www.cnblogs.com/ztfjs/p/fast.html", "author": "张泰峰", "article_desc": "写在前面 （图片来自网络，侵删） 忙，也不忙，时间在指缝之中溜走，光阴在暮色里消沉。繁杂的城市外景衬托坐在电脑前的人，屏幕上闪烁着的字符码愈来愈像外面的世界了——至少在那个人的眼睛里面，它们区别更小了。 秋天是收获的季节，似乎是因为刚刚过去的夏天，流过的汗水已经足够。 距离我开通博客园快两年。这两年 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/ztfjs/p/fast.html\">斩荆披棘，我们走的关于程序的路</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><h2 id=\"w1\" class=\"wtitle\">写在前面</h2>\r\n<p>　　<img src=\"http://images2017.cnblogs.com/blog/893115/201710/893115-20171031171417090-806984324.jpg\" alt=\"\" width=\"524\" height=\"327\"></p>\r\n<p>　　　　　　　　　　　　　　（图片来自网络，侵删）</p>\r\n<p> </p>\r\n<p>　　忙，也不忙，时间在指缝之中溜走，光阴在暮色里消沉。繁杂的城市外景衬托坐在电脑前的人，屏幕上闪烁着的字符码愈来愈像外面的世界了——至少在那个人的眼睛里面，它们区别更小了。</p>\r\n<p>　　秋天是收获的季节，似乎是因为刚刚过去的夏天，流过的汗水已经足够。</p>\r\n<p>　　距离我开通博客园快两年。这两年、我也从小白经历到了大白，见过无数的代码，啃过无数的方便面，也在某个深夜期待着更好的未来。</p>\r\n<p>　　代码写了三年，道路走了几十载，最大的感触是，生活越来越难了，社会的不公，财富的增加减少，都无时无刻刺激着这艰难的旅程。</p>\r\n<p>　　可是旅人啊，他知道爱和希望可能就在前方，不顾一切朝着那个方向前进。</p>\r\n<p>　　<strong>人生艰难，我们需要一个方向</strong>。</p>\r\n<p>　　自从接触软件工程，我便准备在这个方向一路向前，这条路上的荆棘，这条路上的坑，见证成长。</p>\r\n<p>　　我相信有很多和我一样的人，一样的努力，不论遇到什么样的艰难险阻，他们也不曾放弃。但是路上难免起雾，雾起四周迷茫，生活上的，工作上的，无法越过的坎儿，那个被妻子欺骗的程序员，他选择跳楼，半空中他在想什么呢？那个绝望的起跳前，一个理性居多的程序员，他在想什么？</p>\r\n<p>　　<strong>他被生活击败了。</strong></p>\r\n<p><strong>　　</strong>不！我们要抗争！</p>\r\n<h2 id=\"w1\" class=\"wtitle\">生活的挫败感</h2>\r\n<p>　　似乎在群众的眼中，程序员，刻板、呆、人傻钱多、理性、不会恋爱等等，总之就是情商低，嘿，我觉得自己情商挺高的。意外的是，今天早晨在地铁屏幕广告上，在那个关于程序员采访的视频上，他们都说“嗯 我觉得自己情商还不错”。<strong>你觉得自己情商还不错吗？ </strong>你可以评论告诉大家</p>\r\n<p>　　情商，一种关于对生活事件的理解能力，追女孩的能力，爱的能力。目前为止，我觉得我的大部分程序员朋友，还是不够的，这种不够是相对于生活中情商一般的人的。地铁广告上的几个哥们，在说那句话的时候，说服力太低了... </p>\r\n<p>　　很多程序员关于生活的挫败感，很大一部分来自情商问题。在程序世界中解决问题的依靠-‘逻辑’，往往在生活中不是那么的可靠。女朋友是不能靠逻辑搞定的，丈母娘你跟她谈逻辑她只会感觉晕头转向，问题是，你有意识到自己有这种问题么？</p>\r\n<p>===========================================================</p>\r\n<p>　　今天加班，夜好深了，她应该睡了吧。我这么想。手上键盘的敲击节奏慢下来了，审视着这一行行代码，内心充满成就感，今天这个功能完成了，真是个完美的架构。嗯哼？女票给我发消息了，打开手机，最快的速度点开首屏的特别关心推送。</p>\r\n<p>　　girl: “今晚回来吗？”，</p>\r\n<p>　　看看时间，已经一点了，想想，嗯，现在回去那么晚，搞搞也不能休息几个小时，不回了吧。</p>\r\n<p>　　boy: “宝贝，今晚不回了，太晚了，你快点睡觉哈”。</p>\r\n<p>　　girl: “哦”。</p>\r\n<p>-------------------------------------------------------------------------</p>\r\n<p>嗯，这段对话，有没有问题？有没有问题？有没有问题？</p>\r\n<p>有！一点钟还在等你回家的人，那个爱你的人，从感情上讲，必须回家。</p>\r\n<p>------------------------------------------------------------------------------</p>\r\n<p>第二天下班回到家，你冲到girl面前张开双臂，意外的是，她看起来热情不那么高，这突如其来的情绪让你不知所措，</p>\r\n<p>一番纠结之后，你觉得她无理取闹，</p>\r\n<p>她觉得你无可救药。</p>\r\n<p>============================================================</p>\r\n<p>这个故事，以前的同事吐槽的。他说他有一股挫败感，明明那么努力工作了，也努力挣钱养家了，为什么她就是不能理解他。</p>\r\n<p>在看故事的视角，这就是一个情商不够的案例之一而已，如果你自己身处其中，我想很可能会变成他一样，觉得自己被生活欺骗了，努力没有好的回报。</p>\r\n<p>事实是你的方向错了，生活和工作本身就是两回事，情商不是你想的那样简单。</p>\r\n<h2 id=\"w1\" class=\"wtitle\">真理</h2>\r\n<p> 　　我有一个感觉，大部分程序员，在非理性事件中过分追求真理，或者说较真。追求真理是程序中的好习惯，在生活中可能就不那么好使了，过分追求真理的结果往往是被结果弄得遍体鳞伤。在获得一个错误之后，深层review获得一个答案。可生活几乎只有一次review的机会，这种不是事实的真理没什么用处。</p>\r\n<p>　　只能纯粹依靠感觉，凭借着爱的判断，告诉你自己，为什么girl生气了。你不知道，那立刻去哄她，如果你足够珍惜的话。</p>\r\n<p>　　你刨根问底，追问她为什么生气，你醒醒吧，她不会说的。</p>\r\n<p>　　---------------------------</p>\r\n<p>　　回到那个跳楼的可怜程序员，后面的事实令人愤怒。他跳的不值啊。难道他没有怀疑过翟某吗？作为程序员，这么理性的人，翟某利用的是事实之外的东西掩盖了事实。一个人爱不爱你，这是事实没有办法告诉你的，你只能反之用爱来感觉，我相信更多的人能感觉到这种赤裸裸的欺骗。他缺少的是<strong>爱的感知能力</strong>。</p>\r\n<p> 　　</p>\r\n<h2 id=\"w1\" class=\"wtitle\">斗争</h2>\r\n<p>　　无论怎么样，生活出现了挫折，我们需要做什么？斗争！</p>\r\n<p>　　和生活斗争，</p>\r\n<p>　　和未来斗争，</p>\r\n<p>       和阶层斗争。</p>\r\n<p>　　不要放弃你坚持的。</p>\r\n<p>　　跳下去的那一瞬间，你就真的变成了一个情商里的loser了</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/893115/201710/893115-20171031175919027-2043928017.jpg\" alt=\"\" width=\"694\" height=\"694\"></p>\r\n<p>（图片来自网络，侵删）</p>\r\n<h2 id=\"w1\" class=\"wtitle\">最后</h2>\r\n<p>　　有些地方短短续续写了很久，有些地方写的不够好，见谅。喜欢可以给我点个赞，谢谢。</p>\r\n<p><strong> </strong></p>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 18:00</span> <a href=\"http://www.cnblogs.com/ztfjs/\">张泰峰</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7754546\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7754546);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=266672,cb_entryId=7754546,cb_blogApp=currentBlogApp,cb_blogUserGuid='a8f323bc-8fd3-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/31 18:00:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 287, "image_url": ["https://pic.cnblogs.com/face/893115/20160215105951.png"], "date_pub": "2017-10-31", "article_common": 2}
{"title": "ArrayList 源码（基于Java1.8）", "url": "http://www.cnblogs.com/xiao2shiqi/p/7761622.html", "author": "黑色的鸟", "article_desc": "\r\n    ArrayList 基于数组实现，也就是类对变量 Object[]系列操作，封装为常用的add，remove，indexOf, contains本质是通过 size 计数器对数组进行系列的操作实现 add 方法和 toArray 也是借助 Arrays 工具类完成 还有很有意思的地方就是add的扩容 ...\r\n    ", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/xiao2shiqi/p/7761622.html\">ArrayList 源码（基于Java1.8）</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>ArrayList 基于数组实现，也就是类对变量 Object[]系列操作，封装为常用的add，remove，indexOf, contains本质是通过 size 计数器对数组进行系列的操作实现</p>\n<p>add 方法和 toArray 也是借助 Arrays 工具类完成</p>\n<p>还有很有意思的地方就是add的扩容方法 ensureCapacityInternal() 就会增加50%容量，</p>\n<p>因为底层数组是不可变的，所以add实际上是通过Arrays工具再拷贝扩容后长度的数组，然后覆盖当前数组</p>\n<p>预设集合长度是最优的操作，今天看源码才明白原理，ArrayList默认构造器为内部数组定义的长度为10，当list超出指定集合的时候，ArrayList会操作自动扩容，</p>\n<p>扩容的方法是使用Arrays.copyOf方法重新构造新的数组，然后将旧数组的数据全部拷贝到新的数组里面，重新生成，再拷贝数组，消耗是巨大的，这也导致了 ArrayList 天生的缺点，插入删除元素慢</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span> ArrayList&lt;E&gt; <span style=\"color: #0000ff\">extends</span> AbstractList&lt;E&gt; <span style=\"color: #0000ff\">implements</span> List&lt;E&gt;<span style=\"color: #000000\">, RandomAccess, Cloneable, java.io.Serializable {\n\n    </span><span style=\"color: #0000ff\">private</span> <span style=\"color: #0000ff\">static</span> <span style=\"color: #0000ff\">final</span> <span style=\"color: #0000ff\">long</span> serialVersionUID = 8683452581122892189L<span style=\"color: #000000\">;\n\n    </span><span style=\"color: #0000ff\">private</span> <span style=\"color: #0000ff\">static</span> <span style=\"color: #0000ff\">final</span> <span style=\"color: #0000ff\">int</span> DEFAULT_CAPACITY = 10<span style=\"color: #000000\">;\n\n    </span><span style=\"color: #0000ff\">private</span> <span style=\"color: #0000ff\">static</span> <span style=\"color: #0000ff\">final</span> Object[] EMPTY_ELEMENTDATA =<span style=\"color: #000000\"> {};\n\n    </span><span style=\"color: #0000ff\">private</span> <span style=\"color: #0000ff\">static</span> <span style=\"color: #0000ff\">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA =<span style=\"color: #000000\"> {};\n\n    </span><span style=\"color: #0000ff\">transient</span> Object[] elementData; <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> non-private to simplify nested class access</span>\n\n    <span style=\"color: #0000ff\">private</span> <span style=\"color: #0000ff\">int</span> size;</pre>\n</div>\n<p>源码中可以看到，ArrayList继承抽象类AbstractList，实现List接口，RandomAccess, Cloneable, Serializable等接口主要用于标识，并没有很大作用</p>\n<p>DEFAULT_CAPACITY = 10 是集合的默认初始化长度，我们常用new ArrayList&lt;&gt;()构造，其实就是创建一个长度为10的Object[]数组</p>\n<p>size 为计数器，记录当前数组的长度</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">public</span> ArrayList(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> initialCapacity) {\n        </span><span style=\"color: #0000ff\">if</span> (initialCapacity &gt; 0<span style=\"color: #000000\">) {\n            </span><span style=\"color: #0000ff\">this</span>.elementData = <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> Object[initialCapacity];\n        } </span><span style=\"color: #0000ff\">else</span> <span style=\"color: #0000ff\">if</span> (initialCapacity == 0<span style=\"color: #000000\">) {\n            </span><span style=\"color: #0000ff\">this</span>.elementData =<span style=\"color: #000000\"> EMPTY_ELEMENTDATA;\n        } </span><span style=\"color: #0000ff\">else</span><span style=\"color: #000000\"> {\n            </span><span style=\"color: #0000ff\">throw</span> <span style=\"color: #0000ff\">new</span> IllegalArgumentException(\"Illegal Capacity: \"+<span style=\"color: #000000\">\n                                               initialCapacity);\n        }\n    }\n\n    </span><span style=\"color: #008000\">/**</span><span style=\"color: #008000\">\n     * Constructs an empty list with an initial capacity of ten.\n     </span><span style=\"color: #008000\">*/</span>\n    <span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> ArrayList() {\n        </span><span style=\"color: #0000ff\">this</span>.elementData =<span style=\"color: #000000\"> DEFAULTCAPACITY_EMPTY_ELEMENTDATA;\n    }</span></pre>\n</div>\n<p>构造器的代码中，看下最常用的两个构造器，带参数initialCapacity的构造器，直接就让变量创建对应长度的数组，如果initialCapacity == 0 就直接赋值为空数组 Object[] elementData = {};</p>\n<p>下面无参构造器，就直接初始化容量为10的空列表</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">private</span> <span style=\"color: #0000ff\">void</span> grow(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> minCapacity) {\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> overflow-conscious code</span>\n        <span style=\"color: #0000ff\">int</span> oldCapacity =<span style=\"color: #000000\"> elementData.length;\n        </span><span style=\"color: #0000ff\">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1<span style=\"color: #000000\">);\n        </span><span style=\"color: #0000ff\">if</span> (newCapacity - minCapacity &lt; 0<span style=\"color: #000000\">)\n            newCapacity </span>=<span style=\"color: #000000\"> minCapacity;\n        </span><span style=\"color: #0000ff\">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; 0<span style=\"color: #000000\">)\n            newCapacity </span>=<span style=\"color: #000000\"> hugeCapacity(minCapacity);\n        </span><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> minCapacity is usually close to size, so this is a win:</span>\n        elementData =<span style=\"color: #000000\"> Arrays.copyOf(elementData, newCapacity);\n    }</span></pre>\n</div>\n<p>上面的自动扩展数组容量的方法，每次添加元素都会调用该方法，确保集合的长度足够用，上面代码中最有趣的是2行</p>\n<p>newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1)， 既每次扩大容量为当前容量的50%，这里的扩容是固定的，和HashMap有负载因子不同</p>\n<p>然后调用 Arrays.copyOf() 将旧数组内容和新长度作为参数，创建新的Object[]数组，并且将原数组的元素，拷贝到新的数组里面</p>\n<p>因为数组长度是不可变的，所以这里的做法是，创建新的数组，再拷贝元素，这里也是ArrayList性能最低的地方</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> size() {\n        </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> size;\n}\n\n</span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">boolean</span><span style=\"color: #000000\"> isEmpty() {\n        </span><span style=\"color: #0000ff\">return</span> size == 0<span style=\"color: #000000\">;\n}\n\n</span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">boolean</span><span style=\"color: #000000\"> contains(Object o) {\n        </span><span style=\"color: #0000ff\">return</span> indexOf(o) &gt;= 0<span style=\"color: #000000\">;\n}\n\n</span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> indexOf(Object o) {\n        </span><span style=\"color: #0000ff\">if</span> (o == <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">) {\n            </span><span style=\"color: #0000ff\">for</span> (<span style=\"color: #0000ff\">int</span> i = 0; i &lt; size; i++<span style=\"color: #000000\">)\n                </span><span style=\"color: #0000ff\">if</span> (elementData[i]==<span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">)\n                    </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> i;\n        } </span><span style=\"color: #0000ff\">else</span><span style=\"color: #000000\"> {\n            </span><span style=\"color: #0000ff\">for</span> (<span style=\"color: #0000ff\">int</span> i = 0; i &lt; size; i++<span style=\"color: #000000\">)\n                </span><span style=\"color: #0000ff\">if</span><span style=\"color: #000000\"> (o.equals(elementData[i]))\n                    </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> i;\n        }\n        </span><span style=\"color: #0000ff\">return</span> -1<span style=\"color: #000000\">;\n}\n\n</span><span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> Object[] toArray() {\n    </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> Arrays.copyOf(elementData, size);\n}\n\nE elementData(</span><span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> index) {\n        </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> (E) elementData[index];\n}</span></pre>\n</div>\n<p>常用的size，isEmpty，contains，indexOf 也只是对Object[] 进行系列的循环判断操作</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">public</span> E get(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> index) {\n        rangeCheck(index);\n        </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> elementData(index);\n}\n\n</span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">boolean</span><span style=\"color: #000000\"> add(E e) {\n        ensureCapacityInternal(size </span>+ 1);  <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> Increments modCount!!</span>\n        elementData[size++] =<span style=\"color: #000000\"> e;\n        </span><span style=\"color: #0000ff\">return</span> <span style=\"color: #0000ff\">true</span><span style=\"color: #000000\">;\n}\n\n</span><span style=\"color: #0000ff\">public</span> E remove(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> index) {\n        rangeCheck(index);\n        modCount</span>++<span style=\"color: #000000\">;\n        E oldValue </span>=<span style=\"color: #000000\"> elementData(index);\n        </span><span style=\"color: #0000ff\">int</span> numMoved = size - index - 1<span style=\"color: #000000\">;\n        </span><span style=\"color: #0000ff\">if</span> (numMoved &gt; 0<span style=\"color: #000000\">)\n            System.arraycopy(elementData, index</span>+1<span style=\"color: #000000\">, elementData, index, numMoved);\n        elementData[</span>--size] = <span style=\"color: #0000ff\">null</span>; <span style=\"color: #008000\">//</span><span style=\"color: #008000\"> clear to let GC do its work</span>\n        <span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> oldValue;\n}</span></pre>\n</div>\n<p>get方法，也是指通过下标，从Object[]数组中获取对象，然后转型 Object -&gt; E</p>\n<p>add末尾添加元素方法步骤，先判断容量是否够用，然后在数组末尾elementData[size++] == e，加入新的元素，size为数组长度</p>\n<p>remove 方法，也是通过循环equals匹配，找到下标，然后通过下标删除，—size，减去计数器长度，并没有实际减少数组长度</p>\n<p>clear方法也相同，把数组的值都设为null，然后 size = 0;</p>\n<p> </p>\n<p>总结：</p>\n<p>通过以上对ArrayList关键部分源码分析，通晓ArrayList原理，我们可以得出结论：</p>\n<ol>\n<li>ArrayList 底层来自数组，通过下标随机访问元素速度非常快，但是插入和删除要频繁的移动数组元素，改变数组长度，效率比较低</li>\n<li>ArrayList 主要性能问题在于当数组元素达到容量上限，扩容的成本很大，所以能够预先知道元素，然后使用 new ArrayList(int initialCapacity) 手动设置容量是最好的</li>\n</ol></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 15:08</span> <a href=\"http://www.cnblogs.com/xiao2shiqi/\">黑色的鸟</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7761622\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7761622);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=297415,cb_entryId=7761622,cb_blogApp=currentBlogApp,cb_blogUserGuid='ba5863bb-c08d-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/31 15:08:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 217, "image_url": ["https:"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "VS调试技巧之附加进程", "url": "http://www.cnblogs.com/yechangzhong-826217795/p/7762920.html", "author": "叶长种", "article_desc": "用过VS一段时间的程序猿们相信都有过这种调试经历：每次按下F5进行断点调试时，都要等待好长时间：先让解决方式编译通过，然后启动VS自带的简版IIS作为server启动，进而开启浏览器，最后进行对应的操作进入我们的断点。假如我们的解决方式有30个项目，能够想象得等待多长时间。再想想。合作开发的时候假设 ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/yechangzhong-826217795/p/7762920.html\">VS调试技巧之附加进程</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>      用过VS一段时间的程序猿们相信都有过这种调试经历：每次按下F5进行断点调试时，都要等待好长时间：先让解决方式编译通过，然后启动VS自带的简版IIS作为server启动，进而开启浏览器，最后进行对应的操作进入我们的断点。假如我们的解决方式有30个项目，能够想象得等待多长时间。再想想。合作开发的时候假设我们的解决方式一个地方出错了。那么其它人仅仅能干着急，浪费了非常多宝贵的时间，那么，有没有办法解决呢？答案就是接下来我要说的附加进程调试。</p>\n<p>      事实上原理还是一样的。仅仅只是用F5的时候VS自己主动的把各种动作运行完成。如今我们来手动操作而已。</p>\n<p>      大致的过程例如以下：</p>\n<h3>    1. 将站点部署到本地IIS</h3>\n<p>      部署站点的话，不是这里的重点，假设不太会的话能够进行百度。教程非常多。我这次的測试是通过建立虚文件夹，然后将目标项目转换为应用程序进行的。</p>\n<h3>    2. 在IIS中浏览要调试的页面</h3>\n<p>      在IIS加入的项目中右键目标页，选择浏览，等待浏览器响应就可以（这个时候相当于启动了IIS进程）：</p>\n<p>          <img src=\"http://images2017.cnblogs.com/blog/586292/201710/586292-20171031182750980-1302781959.png\" alt=\"\"></p>\n<h3>    3. 将IIS的进程附加到VS中</h3>\n<p>      在VS中找到“调试”菜单，选择“加入到进程”。之后弹出例如以下对话框。将“显示全部回话中的进程”打勾，找到IIS的相关进程“w3wp.exe”，之后点击“附加”就可以。</p>\n<p>        <img src=\"http://images2017.cnblogs.com/blog/586292/201710/586292-20171031182800058-305762064.png\" alt=\"\"></p>\n<p>        假设我们不是以管理员执行的VS，它会提示你须要权限。我们右键VS的图标选择“以管理员执行”就可以。有一个更为彻底的方法，找到VS程序，右键，选择“兼容性”选项卡，将“特权等级”中的“以管理员身份执行此程序”打勾，确认。以后每次执行VS都将是管理员身份。</p>\n<p>        <img src=\"http://images2017.cnblogs.com/blog/586292/201710/586292-20171031182820340-1978448817.png\" alt=\"\"></p>\n<p>        加入进程之后我们就会发现自己的VS已经处于调试状态，之后就能够依照我们曾经的方法进行对应的调试了。               </p>\n<p>        <img src=\"http://images2017.cnblogs.com/blog/586292/201710/586292-20171031182830886-1679443747.png\" alt=\"\"></p>\n<p>        这样的调试感觉有点麻烦，在解决方式中的项目不多以及合作开发者比較少的情况下F5调试感觉更为省事一些。这样的调试的优点是。我们不须要等待VS每次慢吞吞的启动，然后进入调试状态。由于把步骤分别给了IIS和VS，启动起来更为快捷。并且对于常常被更新就出错的麻烦这么的人来说。这种方法无疑是个福音。</p>\n<p>       我们能够将其它人的错误打搅尽可能的减少。</p>\n<p>      “不怕不知道。就怕不知道”，存在即是合理。在我们为一个问题抓狂的时候或许别人正在用一个看似笨拙的方法，所以。我们要尽可能的开阔自己的眼界。加油啊！</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 18:30</span> <a href=\"http://www.cnblogs.com/yechangzhong-826217795/\">叶长种</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7762920\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7762920);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=170031,cb_entryId=7762920,cb_blogApp=currentBlogApp,cb_blogUserGuid='63dc8c0d-0e57-e311-8d02-90b11c0b17d6',cb_entryCreatedDate='2017/10/31 18:30:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 327, "image_url": ["https://pic.cnblogs.com/face/586292/20171023104509.png"], "date_pub": "2017-10-31", "article_common": 3}
{"title": "Unity3D手机斗地主游戏开发实战（01）_发牌功能实现(不定期更新中~~~)", "url": "http://www.cnblogs.com/lizzie-xhu/p/7761586.html", "author": "Lancel0t", "article_desc": "系列目录 Unity3D手机斗地主游戏开发实战（01）_发牌功能实现 Unity3D手机斗地主游戏开发实战（02）_叫地主功能实现 Unity3D手机斗地主游戏开发实战（01）_发牌功能实现 Unity3D手机斗地主游戏开发实战（02）_叫地主功能实现 园子荒废多年，闲来无事，用Unity3D来尝试 ...", "content": "<div id=\"post_detail\">\r\n\t<div class=\"post\">\r\n\t\t<div class=\"posthead\">\r\n\t\t\t<h2>\r\n\t\t\t\t<a id=\"cb_post_title_url\" class=\"singleposttitle\" href=\"http://www.cnblogs.com/lizzie-xhu/p/7761586.html\">Unity3D手机斗地主游戏开发实战（01）_发牌功能实现(不定期更新中~~~)</a>\r\n\t\t\t</h2>\r\n \t\t\tPosted on <span id=\"post-date\">2017-10-31 15:03</span> <a href=\"http://www.cnblogs.com/lizzie-xhu/\">Lancel0t</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7761586\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7761586);return false;\">收藏</a>\r\n\t\t\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=107624,cb_entryId=7761586,cb_blogApp=currentBlogApp,cb_blogUserGuid='49d7f472-3b4d-e111-aa3f-842b2b196315',cb_entryCreatedDate='2017/10/31 15:03:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<div class=\"postbody\"><div id=\"cnblogs_post_body\"><h3>系列目录</h3>\r\n<ul>\r\n<li>\r\n<p><a id=\"cb_post_title_url\" href=\"http://www.cnblogs.com/lizzie-xhu/p/7761586.html\">Unity3D手机斗地主游戏开发实战（01）_发牌功能实现</a></p>\r\n</li>\r\n<li>\r\n<p><a id=\"cb_post_title_url\" class=\"singleposttitle\" href=\"http://www.cnblogs.com/lizzie-xhu/p/7771713.html\">Unity3D手机斗地主游戏开发实战（02）_叫地主功能实现</a></p>\r\n</li>\r\n</ul>\r\n<p>园子荒废多年，闲来无事，用Unity3D来尝试做一个简单的小游戏，一方面是对最近研究的Unity3D有点总结，一方面跟广大的园友相互学习和提高。话不多说，进入正题~</p>\r\n<h3>一、创建项目</h3>\r\n<p>1.创建Unity2017的2D项目，暂且叫做ChinesePoker吧，就用自带的UGUI来编辑UI， 目前只导入iTween插件，用来方便控制动画效果。</p>\r\n<p>目录结构如下：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/371995/201710/371995-20171031112256418-143063490.png\" alt=\"\">  <img src=\"http://images2017.cnblogs.com/blog/371995/201710/371995-20171031112750886-150146473.png\" alt=\"\" width=\"247\" height=\"181\"></p>\r\n<p>考虑卡牌需要动态生成，我把图片资源放到Resource目录，并按照Card_类型（大小王，红桃，黑桃，方片，梅花 ）_数字（卡牌所在类型中的数字）命名。</p>\r\n<p>素材都是网上找的，没有美工基础，就是这么个意思，大家将就看吧，：）</p>\r\n<p>2.建第一个场景，默认叫001_Playing，作为主要玩牌的场景，暂时作为第1个场景，后期新场景添加进来，我们可能再调整场景的顺序。</p>\r\n<p>添加一个UI-&gt;Image,选择一个背景图片；</p>\r\n<p>添加3个UI-&gt;Canvas，分别取名叫Player0,Player1,Player2,代表玩家，对手1，对手2；</p>\r\n<p>每个Player底下，添加一个Image，选择卡牌背面图片，分别表示发牌时各自牌堆的位置，并在桌面放置一个总牌堆的位置，默认not active；</p>\r\n<p>建一个卡牌的图片，命名为Card，并作为预制件，放入Player0中间一个，稍微偏移一定位置再放置一个，用来计算每张牌跟临牌相对位置，设置not active；</p>\r\n<p>建一个卡牌的背面图片，命名Cover，也作为预制件；</p>\r\n<p>添加一个测试按钮TestButton;</p>\r\n<p>差不多了，大概结构如下：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/371995/201710/371995-20171031115250402-1107019040.png\" alt=\"\"></p>\r\n<h3>二、创建卡牌、玩家信息</h3>\r\n<p>1.新建CardInfo类，主要不要继承默认的MonoBehaviour类，用来作为卡牌的实体类；</p>\r\n<p>实现IComparable接口，后面手牌排序会用到。</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('25467a74-1e71-4be1-88bb-4e93355ff774')\"><img id=\"code_img_closed_25467a74-1e71-4be1-88bb-4e93355ff774\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_25467a74-1e71-4be1-88bb-4e93355ff774\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('25467a74-1e71-4be1-88bb-4e93355ff774',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_25467a74-1e71-4be1-88bb-4e93355ff774\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> CardInfo : IComparable\r\n{\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">string</span> cardName; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">卡牌图片名</span>\r\n    <span style=\"color: #0000ff;\">public</span> CardTypes cardType; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">牌的类型</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">int</span> cardIndex;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">牌在所在类型的索引1-13</span>\r\n\r\n    <span style=\"color: #0000ff;\">public</span> CardInfo(<span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\"> cardName)\r\n    {\r\n        </span><span style=\"color: #0000ff;\">this</span>.cardName =<span style=\"color: #000000;\"> cardName;\r\n        </span><span style=\"color: #0000ff;\">var</span> splits = cardName.Split(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">_</span><span style=\"color: #800000;\">'</span><span style=\"color: #000000;\">);\r\n\r\n        </span><span style=\"color: #0000ff;\">switch</span> (splits[<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">])\r\n        {\r\n            </span><span style=\"color: #0000ff;\">case</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">1</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">:\r\n                cardType </span>=<span style=\"color: #000000;\"> CardTypes.Hearts;\r\n                cardIndex </span>= <span style=\"color: #0000ff;\">int</span>.Parse(splits[<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">]);\r\n                </span><span style=\"color: #0000ff;\">break</span><span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #0000ff;\">case</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">2</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">:\r\n                cardType </span>=<span style=\"color: #000000;\"> CardTypes.Spades;\r\n                cardIndex </span>= <span style=\"color: #0000ff;\">int</span>.Parse(splits[<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">]);\r\n                </span><span style=\"color: #0000ff;\">break</span><span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #0000ff;\">case</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">3</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">:\r\n                cardType </span>=<span style=\"color: #000000;\"> CardTypes.Diamonds;\r\n                cardIndex </span>= <span style=\"color: #0000ff;\">int</span>.Parse(splits[<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">]);\r\n                </span><span style=\"color: #0000ff;\">break</span><span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #0000ff;\">case</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">4</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">:\r\n                cardType </span>=<span style=\"color: #000000;\"> CardTypes.Clubs;\r\n                cardIndex </span>= <span style=\"color: #0000ff;\">int</span>.Parse(splits[<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">]);\r\n                </span><span style=\"color: #0000ff;\">break</span><span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #0000ff;\">case</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">joker</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">:\r\n                cardType </span>=<span style=\"color: #000000;\"> CardTypes.Joker;\r\n                cardIndex </span>= <span style=\"color: #0000ff;\">int</span>.Parse(splits[<span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">]);\r\n                </span><span style=\"color: #0000ff;\">break</span><span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #0000ff;\">default</span><span style=\"color: #000000;\">:\r\n                </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span> Exception(<span style=\"color: #0000ff;\">string</span>.Format(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">卡牌文件名{0}非法！</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, cardName));\r\n        }\r\n    }\r\n\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">卡牌大小比较</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">int</span> CompareTo(<span style=\"color: #0000ff;\">object</span><span style=\"color: #000000;\"> obj)\r\n    {\r\n        CardInfo other </span>= obj <span style=\"color: #0000ff;\">as</span><span style=\"color: #000000;\"> CardInfo;\r\n\r\n        </span><span style=\"color: #0000ff;\">if</span> (other == <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            </span><span style=\"color: #0000ff;\">throw</span> <span style=\"color: #0000ff;\">new</span> Exception(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">比较对象类型非法！</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果当前是大小王</span>\r\n        <span style=\"color: #0000ff;\">if</span> (cardType ==<span style=\"color: #000000;\"> CardTypes.Joker)\r\n        {\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">对方也是大小王</span>\r\n            <span style=\"color: #0000ff;\">if</span> (other.cardType ==<span style=\"color: #000000;\"> CardTypes.Joker)\r\n            {\r\n                </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> cardIndex.CompareTo(other.cardIndex);\r\n            }\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">对方不是大小王</span>\r\n            <span style=\"color: #0000ff;\">return</span> <span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">;\r\n        }\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果是一般的牌</span>\r\n        <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n        {\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">对方是大小王</span>\r\n            <span style=\"color: #0000ff;\">if</span> (other.cardType ==<span style=\"color: #000000;\"> CardTypes.Joker)\r\n            {\r\n                </span><span style=\"color: #0000ff;\">return</span> -<span style=\"color: #800080;\">1</span><span style=\"color: #000000;\">;\r\n            }\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果对方也是一般的牌</span>\r\n            <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n            {\r\n                </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">计算牌力</span>\r\n                <span style=\"color: #0000ff;\">var</span> thisNewIndex = (cardIndex == <span style=\"color: #800080;\">1</span> || cardIndex == <span style=\"color: #800080;\">2</span>) ? <span style=\"color: #800080;\">13</span> +<span style=\"color: #000000;\"> cardIndex : cardIndex;\r\n                </span><span style=\"color: #0000ff;\">var</span> otherNewIndex = (other.cardIndex == <span style=\"color: #800080;\">1</span> || other.cardIndex == <span style=\"color: #800080;\">2</span>) ? <span style=\"color: #800080;\">13</span> +<span style=\"color: #000000;\"> other.cardIndex : other.cardIndex;\r\n\r\n                </span><span style=\"color: #0000ff;\">if</span> (thisNewIndex ==<span style=\"color: #000000;\"> otherNewIndex)\r\n                {\r\n                    </span><span style=\"color: #0000ff;\">return</span> -<span style=\"color: #000000;\">cardType.CompareTo(other.cardType);\r\n                }\r\n\r\n                </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> thisNewIndex.CompareTo(otherNewIndex);\r\n            }\r\n        }\r\n    }\r\n\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<p>2.Card预制件上，添加Card脚本，主要保存对应CardInfo信息、选中状态，并加载卡牌图片；</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('a558112f-a8ad-4b33-a9da-0047d0741452')\"><img id=\"code_img_closed_a558112f-a8ad-4b33-a9da-0047d0741452\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_a558112f-a8ad-4b33-a9da-0047d0741452\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('a558112f-a8ad-4b33-a9da-0047d0741452',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_a558112f-a8ad-4b33-a9da-0047d0741452\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Card : MonoBehaviour\r\n{\r\n    </span><span style=\"color: #0000ff;\">private</span> Image image;        <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">牌的图片</span>\r\n    <span style=\"color: #0000ff;\">private</span> CardInfo cardInfo;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">卡牌信息</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">bool</span> isSelected;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">是否选中</span>\r\n\r\n    <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Awake()\r\n    {\r\n        image </span>= GetComponent&lt;Image&gt;<span style=\"color: #000000;\">();\r\n    }\r\n\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 初始化图片\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"cardInfo\"&gt;&lt;/param&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> InitImage(CardInfo cardInfo)\r\n    {\r\n        </span><span style=\"color: #0000ff;\">this</span>.cardInfo =<span style=\"color: #000000;\"> cardInfo;\r\n        image.sprite </span>= Resources.Load(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Images/Cards/</span><span style=\"color: #800000;\">\"</span> + cardInfo.cardName, <span style=\"color: #0000ff;\">typeof</span>(Sprite)) <span style=\"color: #0000ff;\">as</span><span style=\"color: #000000;\"> Sprite;\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 设置选择状态\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> SetSelectState()\r\n    {\r\n        </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (isSelected)\r\n        {\r\n            iTween.MoveTo(gameObject, transform.position </span>- Vector3.up *<span style=\"color: #000000;\"> 10f, 1f);\r\n        }\r\n        </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n        {\r\n            iTween.MoveTo(gameObject, transform.position </span>+ Vector3.up *<span style=\"color: #000000;\"> 10f, 1f);\r\n        }\r\n\r\n        isSelected </span>= !<span style=\"color: #000000;\">isSelected;\r\n    }\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<p>3.考虑玩家分为2种类型，先创建一个公共的基类，实现玩家公共的方法，比如增加一张卡牌、清空所有卡片、排序等；</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('6936d30f-8cf0-4160-9e46-9e5c55a90327')\"><img id=\"code_img_closed_6936d30f-8cf0-4160-9e46-9e5c55a90327\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_6936d30f-8cf0-4160-9e46-9e5c55a90327\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('6936d30f-8cf0-4160-9e46-9e5c55a90327',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_6936d30f-8cf0-4160-9e46-9e5c55a90327\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> Player : MonoBehaviour\r\n{\r\n    </span><span style=\"color: #0000ff;\">protected</span> List&lt;CardInfo&gt; cardInfos = <span style=\"color: #0000ff;\">new</span> List&lt;CardInfo&gt;();  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">个人所持卡牌</span>\r\n\r\n    <span style=\"color: #0000ff;\">private</span><span style=\"color: #000000;\"> Text cardCoutText;\r\n\r\n    </span><span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Start()\r\n    {\r\n        cardCoutText </span>= transform.Find(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">HeapPos/Text</span><span style=\"color: #800000;\">\"</span>).GetComponent&lt;Text&gt;<span style=\"color: #000000;\">();\r\n    }\r\n\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 增加一张卡牌\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"cardName\"&gt;&lt;/param&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span> AddCard(<span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\"> cardName)\r\n    {\r\n        cardInfos.Add(</span><span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> CardInfo(cardName));\r\n        cardCoutText.text </span>=<span style=\"color: #000000;\"> cardInfos.Count.ToString();\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 清空所有卡片\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> DropCards()\r\n    {\r\n        cardInfos.Clear();\r\n    }\r\n\r\n    </span><span style=\"color: #0000ff;\">protected</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Sort()\r\n    {\r\n        cardInfos.Sort();\r\n        cardInfos.Reverse();\r\n    }\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<p>4.添加第一种玩家（自身玩家）PlayerSelf，继承Player，并挂载到Player0对象上；</p>\r\n<p>实现整理手牌的逻辑：发牌后，从中间的位置，根据大小依次将牌展开；</p>\r\n<p>获取牌面点击事件，将牌选中或取消选中；</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('55a16181-d0db-4e99-85ea-210599093ed5')\"><img id=\"code_img_closed_55a16181-d0db-4e99-85ea-210599093ed5\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_55a16181-d0db-4e99-85ea-210599093ed5\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('55a16181-d0db-4e99-85ea-210599093ed5',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_55a16181-d0db-4e99-85ea-210599093ed5\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> PlayerSelf : Player\r\n{\r\n    </span><span style=\"color: #0000ff;\">public</span> GameObject prefab;   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">预制件</span>\r\n\r\n    <span style=\"color: #0000ff;\">private</span> Transform originPos1; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">牌的初始位置</span>\r\n    <span style=\"color: #0000ff;\">private</span> Transform originPos2; <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">牌的初始位置</span>\r\n    <span style=\"color: #0000ff;\">private</span> List&lt;GameObject&gt;  cards=<span style=\"color: #0000ff;\">new</span> List&lt;GameObject&gt;<span style=\"color: #000000;\">();\r\n\r\n    </span><span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Awake()\r\n    {\r\n        originPos1 </span>= transform.Find(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">OriginPos1</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n        originPos2 </span>= transform.Find(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">OriginPos2</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">);\r\n    }\r\n\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">整理手牌</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> GenerateAllCards()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">排序</span>\r\n<span style=\"color: #000000;\">        Sort();\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">计算每张牌的偏移</span>\r\n        <span style=\"color: #0000ff;\">var</span> offsetX = originPos2.position.x -<span style=\"color: #000000;\"> originPos1.position.x;\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取最左边的起点</span>\r\n        <span style=\"color: #0000ff;\">int</span> leftCount = (cardInfos.Count / <span style=\"color: #800080;\">2</span><span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #0000ff;\">var</span> startPos = originPos1.position + Vector3.left * offsetX *<span style=\"color: #000000;\"> leftCount;\r\n\r\n        </span><span style=\"color: #0000ff;\">for</span> (<span style=\"color: #0000ff;\">int</span> i = <span style=\"color: #800080;\">0</span>; i &lt; cardInfos.Count; i++<span style=\"color: #000000;\">)\r\n        {\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">生成卡牌</span>\r\n            <span style=\"color: #0000ff;\">var</span> card =<span style=\"color: #000000;\"> Instantiate(prefab, originPos1.position, Quaternion.identity, transform);\r\n            card.GetComponent</span>&lt;RectTransform&gt;().localScale = Vector3.one * <span style=\"color: #800080;\">0.6f</span><span style=\"color: #000000;\">;\r\n            card.GetComponent</span>&lt;Card&gt;<span style=\"color: #000000;\">().InitImage(cardInfos[i]);\r\n\r\n            </span><span style=\"color: #0000ff;\">var</span> targetPos = startPos + Vector3.right * offsetX *<span style=\"color: #000000;\"> i;\r\n            card.transform.SetAsLastSibling();\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">动画移动</span>\r\n<span style=\"color: #000000;\">            iTween.MoveTo(card, targetPos, 2f);\r\n\r\n            cards.Add(card);\r\n        }\r\n    }\r\n\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> DestroyAllCards()\r\n    {\r\n        cards.ForEach(Destroy);\r\n        cards.Clear();\r\n    }\r\n\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 点击卡牌处理\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;param name=\"data\"&gt;&lt;/param&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> CardClick(BaseEventData data)\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">叫牌或出牌阶段才可以选牌</span>\r\n        <span style=\"color: #0000ff;\">if</span> (CardManager._instance.cardManagerState == CardManagerStates.Bid ||<span style=\"color: #000000;\">\r\n            CardManager._instance.cardManagerState </span>==<span style=\"color: #000000;\"> CardManagerStates.Playing)\r\n        {\r\n            </span><span style=\"color: #0000ff;\">var</span> eventData = data <span style=\"color: #0000ff;\">as</span><span style=\"color: #000000;\"> PointerEventData;\r\n            </span><span style=\"color: #0000ff;\">if</span> (eventData == <span style=\"color: #0000ff;\">null</span>) <span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\">;\r\n\r\n            </span><span style=\"color: #0000ff;\">var</span> card = eventData.pointerCurrentRaycast.gameObject.GetComponent&lt;Card&gt;<span style=\"color: #000000;\">();\r\n            </span><span style=\"color: #0000ff;\">if</span> (card == <span style=\"color: #0000ff;\">null</span>) <span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\">;\r\n\r\n            card.SetSelectState();\r\n        }\r\n    }\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<p>5.添加另一种玩家（对手玩家）PlayerOther，继承Player，并挂载到Player1，Player2对象上；</p>\r\n<p>暂时没有实现任何其他功能：</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('6cb1f348-3412-4d8d-accf-1bf56ad123a4')\"><img id=\"code_img_closed_6cb1f348-3412-4d8d-accf-1bf56ad123a4\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_6cb1f348-3412-4d8d-accf-1bf56ad123a4\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('6cb1f348-3412-4d8d-accf-1bf56ad123a4',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_6cb1f348-3412-4d8d-accf-1bf56ad123a4\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> PlayerOther : Player\r\n{\r\n   \r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<h3>三、实现发牌逻辑</h3>\r\n<p>在Camera上添加卡牌管理脚本：CardManager</p>\r\n<p>1.实现洗牌逻辑，这里用生成GUID随机性后排序，达到洗牌的目的；</p>\r\n<p>2.记录当前发牌回合，每发一张牌，跳转给下一个玩家；</p>\r\n<p>3.记录当前玩牌回合（将来可能用到），每玩一局，跳转下个玩家开始发牌；</p>\r\n<p>4.发牌逻辑：</p>\r\n<p>设置牌堆的显示，动画依次给每位玩家发一张卡牌，发完牌后，隐藏牌堆，并将玩家的卡牌排序并展示；</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('5388b442-16bc-467e-99a3-4a96912f01f5')\"><img id=\"code_img_closed_5388b442-16bc-467e-99a3-4a96912f01f5\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_5388b442-16bc-467e-99a3-4a96912f01f5\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('5388b442-16bc-467e-99a3-4a96912f01f5',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_5388b442-16bc-467e-99a3-4a96912f01f5\" class=\"cnblogs_code_hide\">\r\n<pre><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> CardManager : MonoBehaviour\r\n{\r\n    </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">float</span> dealCardSpeed = <span style=\"color: #800080;\">20</span>;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">发牌速度</span>\r\n    <span style=\"color: #0000ff;\">public</span> Player[] Players;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">玩家的集合</span>\r\n\r\n    <span style=\"color: #0000ff;\">public</span> GameObject coverPrefab;      <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">背面排预制件</span>\r\n    <span style=\"color: #0000ff;\">public</span> Transform heapPos;           <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">牌堆位置</span>\r\n    <span style=\"color: #0000ff;\">public</span> Transform[] playerHeapPos;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">玩家牌堆位置</span>\r\n\r\n\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> CardManager _instance;    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">单例</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> CardManagerStates cardManagerState;\r\n\r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">string</span>[] cardNames;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">所有牌集合</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">int</span> termStartIndex = <span style=\"color: #800080;\">0</span>;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">回合开始玩家索引</span>\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">int</span> termCurrentIndex = <span style=\"color: #800080;\">0</span>;  <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">回合当前玩家索引</span>\r\n    <span style=\"color: #0000ff;\">private</span> List&lt;GameObject&gt; covers = <span style=\"color: #0000ff;\">new</span> List&lt;GameObject&gt;();   <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">背面卡牌对象，发牌结束后销毁</span>\r\n\r\n    <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> Awake()\r\n    {\r\n        _instance </span>= <span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">;\r\n\r\n        cardNames </span>=<span style=\"color: #000000;\"> GetCardNames();\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 洗牌\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> ShuffleCards()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">进入洗牌阶段</span>\r\n        cardManagerState =<span style=\"color: #000000;\"> CardManagerStates.ShuffleCards;\r\n        cardNames </span>= cardNames.OrderBy(c =&gt;<span style=\"color: #000000;\"> Guid.NewGuid()).ToArray();\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 发牌\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span><span style=\"color: #000000;\"> IEnumerator DealCards()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">进入发牌阶段</span>\r\n        cardManagerState =<span style=\"color: #000000;\"> CardManagerStates.DealCards;\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">显示牌堆</span>\r\n        heapPos.gameObject.SetActive(<span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">);\r\n        playerHeapPos.ToList().ForEach(s </span>=&gt; { s.gameObject.SetActive(<span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">); });\r\n\r\n        </span><span style=\"color: #0000ff;\">foreach</span> (<span style=\"color: #0000ff;\">var</span> cardName <span style=\"color: #0000ff;\">in</span><span style=\"color: #000000;\"> cardNames)\r\n        {\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">给当前玩家发一张牌</span>\r\n<span style=\"color: #000000;\">            Players[termCurrentIndex].AddCard(cardName);\r\n\r\n            </span><span style=\"color: #0000ff;\">var</span> cover =<span style=\"color: #000000;\"> Instantiate(coverPrefab, heapPos.position, Quaternion.identity, heapPos.transform);\r\n            cover.GetComponent</span>&lt;RectTransform&gt;().localScale =<span style=\"color: #000000;\"> Vector3.one;\r\n            covers.Add(cover);\r\n            iTween.MoveTo(cover, playerHeapPos[termCurrentIndex].position, </span><span style=\"color: #800080;\">0.3f</span><span style=\"color: #000000;\">);\r\n\r\n            </span><span style=\"color: #0000ff;\">yield</span> <span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">new</span> WaitForSeconds(<span style=\"color: #800080;\">1</span> /<span style=\"color: #000000;\"> dealCardSpeed);\r\n\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">下一个需要发牌者</span>\r\n<span style=\"color: #000000;\">            SetNextPlayer();\r\n        }\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">隐藏牌堆</span>\r\n        heapPos.gameObject.SetActive(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n        playerHeapPos[</span><span style=\"color: #800080;\">0</span>].gameObject.SetActive(<span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">);\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">显示玩家手牌</span>\r\n        Players.ToList().ForEach(s =&gt;<span style=\"color: #000000;\">\r\n        {\r\n            </span><span style=\"color: #0000ff;\">var</span> player0 = s <span style=\"color: #0000ff;\">as</span><span style=\"color: #000000;\"> PlayerSelf;\r\n            </span><span style=\"color: #0000ff;\">if</span> (player0 != <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            {\r\n                player0.GenerateAllCards();\r\n            }\r\n        });\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">动画结束，进入叫牌阶段</span>\r\n        <span style=\"color: #0000ff;\">yield</span> <span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> WaitForSeconds(2f);\r\n        covers.ForEach(Destroy);\r\n        cardManagerState </span>=<span style=\"color: #000000;\"> CardManagerStates.Bid;\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 清空牌局\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> ClearCards()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">清空所有玩家卡牌</span>\r\n        Players.ToList().ForEach(s =&gt;<span style=\"color: #000000;\"> s.DropCards());\r\n\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">显示玩家手牌</span>\r\n        Players.ToList().ForEach(s =&gt;<span style=\"color: #000000;\">\r\n        {\r\n            </span><span style=\"color: #0000ff;\">var</span> player0 = s <span style=\"color: #0000ff;\">as</span><span style=\"color: #000000;\"> PlayerSelf;\r\n            </span><span style=\"color: #0000ff;\">if</span> (player0 != <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">)\r\n            {\r\n                player0.DestroyAllCards();\r\n            }\r\n        });\r\n    }\r\n\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 获取下个玩家\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;returns&gt;&lt;/returns&gt;</span>\r\n\r\n    <span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> SetNextPlayer()\r\n    {\r\n        termCurrentIndex </span>= (termCurrentIndex + <span style=\"color: #800080;\">1</span>) %<span style=\"color: #000000;\"> Players.Length;\r\n    }\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;summary&gt;</span>\r\n    <span style=\"color: #808080;\">///</span><span style=\"color: #008000;\"> 切换开始回合玩家\r\n    </span><span style=\"color: #808080;\">///</span> <span style=\"color: #808080;\">&lt;/summary&gt;</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> SetNextTerm()\r\n    {\r\n        termStartIndex </span>= (termStartIndex + <span style=\"color: #800080;\">1</span>) %<span style=\"color: #000000;\"> Players.Length;\r\n    }\r\n    </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">string</span><span style=\"color: #000000;\">[] GetCardNames()\r\n    {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">路径  </span>\r\n        <span style=\"color: #0000ff;\">string</span> fullPath = <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Assets/Resources/Images/Cards/</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n\r\n        </span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\"> (Directory.Exists(fullPath))\r\n        {\r\n            DirectoryInfo direction </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> DirectoryInfo(fullPath);\r\n            FileInfo[] files </span>= direction.GetFiles(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.png</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, SearchOption.AllDirectories);\r\n\r\n            </span><span style=\"color: #0000ff;\">return</span> files.Select(s =&gt;<span style=\"color: #000000;\"> Path.GetFileNameWithoutExtension(s.Name)).ToArray();\r\n        }\r\n        </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n    }\r\n\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">for test</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">void</span><span style=\"color: #000000;\"> OnTestClick()\r\n    {\r\n        ClearCards();\r\n        ShuffleCards();\r\n        StartCoroutine(DealCards());\r\n    }\r\n\r\n}</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<h3><span style=\"line-height: 1.5;\"> 四、总结</span></h3>\r\n<p>其实发牌后的动画，可以由override基类的方法，交由Player子类处理，不用CardManager集中管理，大家可以优化一下。</p>\r\n<p><span style=\"line-height: 1.5;\">大体逻辑完成，我们验证下效果吧：</span></p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/371995/201710/371995-20171031110939215-299047755.gif\" alt=\"\"></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n</div>\r\n\t</div></div>", "article_view": 1259, "image_url": ["https://pic.cnblogs.com/face/371995/20171031151026.png"], "date_pub": "2017-10-31", "article_common": 25}
{"title": "使用angular4和asp.net core 2 web api做个练习项目(一)", "url": "http://www.cnblogs.com/cgzl/p/7755801.html", "author": "solenovex", "article_desc": "这是一篇学习笔记. angular 5 正式版都快出了, 不过主要是性能升级. 我认为angular 4还是很适合企业的, 就像.net一样. 我用的是windows 10 安装工具: git for windows: 官网很慢, 所以找一个镜像站下载: https://github.com/way ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/cgzl/p/7755801.html\">使用angular4和asp.net core 2 web api做个练习项目(一)</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>这是一篇学习笔记. angular 5 正式版都快出了, 不过主要是性能升级.</p>\n<p>我认为angular 4还是很适合企业的, 就像.net一样.</p>\n<p>我用的是windows 10</p>\n<h1>安装工具:</h1>\n<p><strong>git for windows</strong>: 官网很慢, 所以找一个镜像站下载: <a href=\"https://github.com/waylau/git-for-win\" target=\"_blank\">https://github.com/waylau/git-for-win</a>, 淘宝镜像的速度还是蛮快的:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030183003043-1772215704.png\" alt=\"\"></p>\n<p>安装的时候, 建议选择这个, 会添加很多命令行工具: </p>\n<h1><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030183057886-1280169230.png\" alt=\"\"></h1>\n<p><strong>nodejs</strong>: 去官网下载就行: <a href=\"https://nodejs.org/en/\" target=\"_blank\">https://nodejs.org/en/</a></p>\n<p>正常安装即可. npm的版本不要低于5.0吧:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030183250574-784531447.png\" alt=\"\"></p>\n<p><strong>angular-cli</strong>, 官网: <a href=\"https://github.com/angular/angular-cli\" target=\"_blank\">https://github.com/angular/angular-cli</a></p>\n<div class=\"cnblogs_code\">\n<pre>npm install -g @angular/cli</pre>\n</div>\n<p><strong>visual studio code</strong>: <a href=\"https://code.visualstudio.com/\" target=\"_blank\">https://code.visualstudio.com/</a></p>\n<p>and <strong>visual studio 2017</strong> of course.</p>\n<h1>建立angular项目</h1>\n<p>进入命令行在某个地方执行命令:</p>\n<div class=\"cnblogs_code\">\n<pre>ng new client-panel</pre>\n</div>\n<p>这就会建立一个client-panel文件夹, 里面是该项目的文件, 然后它会立即执行npm install命令(<strong>这里不要使用淘宝的cnpm进行安装, 有bug</strong>), 稍等一会就会结束.</p>\n<p>使用vscode打开该目录, 然后在vscode里面打开terminal:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030184306293-308019642.png\" alt=\"\"></p>\n<p>terminal默认的可能是powershell, 如果你感觉powershell有点慢的话, 可以换成bash(安装git时候带的)或者windows command line等.</p>\n<p>第一次打开terminal的时候, vscode上方会提示你配置terminal, 这时就可以更换默认的terminal. 否则的话, 你可以点击菜单file-reference-settings, 自己选择一个terminal应用:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030184645293-1795474809.png\" alt=\"\"></p>\n<p>同样可以安装几个vscode的插件:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030184824965-887814084.png\" alt=\"\"></p>\n<p>然后试运行一下项目, 在terminal执行 ng serve, 如果没问题的话, 大概是这样: </p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030184927199-269511505.png\" alt=\"\"></p>\n<p>浏览器运行: <a href=\"http://localhost:4200/\" target=\"_blank\">http://localhost:4200</a></p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030185102840-1859921815.png\" alt=\"\"></p>\n<p> </p>\n<h1>安装bootstrap4等:</h1>\n<p>安装bootstrap4, tether, jquery等:</p>\n<div class=\"cnblogs_code\">\n<pre>npm install bootstrap@4.0.0-beta.2 tether jquery --save</pre>\n</div>\n<p>安装成功后, 打开 .angular-cli.json, 把相关的css和js添加进去:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030185903558-1559438928.png\" alt=\"\"></p>\n<p>然后在运行试试 ng serve, 刷新:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030185948871-1376201928.png\" alt=\"\"></p>\n<p>字体已经改变, bootstrap起作用了.</p>\n<h1>建立Components</h1>\n<h3>建立dashboard:</h3>\n<p>terminal执行</p>\n<div class=\"cnblogs_code\">\n<pre>ng g component components/dashboard</pre>\n</div>\n<p>执行成功后会生成4个文件:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030190254308-770157233.png\" alt=\"\"></p>\n<p>并且会自动在app.module.ts里面声明:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030190332058-1710679429.png\" alt=\"\"></p>\n<h3>建立其他 components:</h3>\n<div class=\"cnblogs_code\">\n<pre>ng g component components/<span style=\"color: #000000\">clients\nng g component components</span>/<span style=\"color: #000000\">clientDetails\nng g component components</span>/<span style=\"color: #000000\">addClient\nng g component components</span>/<span style=\"color: #000000\">editClient\nng g component components</span>/<span style=\"color: #000000\">navbar\nng g component components</span>/sidebar<br>ng g component components/login<br>ng g component components/register<br>ng g component components/settings<br>ng g component components/pageNotFound</pre>\n</div>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030190855715-601011819.png\" alt=\"\"></p>\n<h1>建立Route路由</h1>\n<div class=\"cnblogs_code\">\n<pre>import { BrowserModule } from '@angular/platform-browser'<span style=\"color: #000000\">;\nimport { NgModule } from </span>'@angular/core'<span style=\"color: #000000\">;\n<span style=\"color: #ff0000\">import { RouterModule, Routes } from </span></span><span style=\"color: #ff0000\">'@angular/router'</span><span style=\"color: #000000\"><span style=\"color: #ff0000\">;</span>\n\nimport { AppComponent } from </span>'./app.component'<span style=\"color: #000000\">;\nimport { DashboardComponent } from </span>'./components/dashboard/dashboard.component'<span style=\"color: #000000\">;\nimport { ClientsComponent } from </span>'./components/clients/clients.component'<span style=\"color: #000000\">;\nimport { ClientDetailsComponent } from </span>'./components/client-details/client-details.component'<span style=\"color: #000000\">;\nimport { AddClientComponent } from </span>'./components/add-client/add-client.component'<span style=\"color: #000000\">;\nimport { EditClientComponent } from </span>'./components/edit-client/edit-client.component'<span style=\"color: #000000\">;\nimport { NavbarComponent } from </span>'./components/navbar/navbar.component'<span style=\"color: #000000\">;\nimport { SidebarComponent } from </span>'./components/sidebar/sidebar.component'<span style=\"color: #000000\">;\nimport { LoginComponent } from </span>'./components/login/login.component'<span style=\"color: #000000\">;\nimport { RegisterComponent } from </span>'./components/register/register.component'<span style=\"color: #000000\">;\nimport { SettingsComponent } from </span>'./components/settings/settings.component'<span style=\"color: #000000\">;\nimport { PageNotFoundComponent } from </span>'./components/page-not-found/page-not-found.component'<span style=\"color: #000000\">;\n\n<span style=\"color: #ff0000\">const appRoutes: Routes </span></span><span style=\"color: #ff0000\">= [\n  { path: '', component: DashboardComponent },\n  { path: 'register', component: RegisterComponent },\n  { path: 'login'</span><span style=\"color: #000000\"><span style=\"color: #ff0000\">, component: LoginComponent }\n];\n</span>\n@NgModule({\n  declarations: [\n    AppComponent,\n    DashboardComponent,\n    ClientsComponent,\n    ClientDetailsComponent,\n    AddClientComponent,\n    EditClientComponent,\n    NavbarComponent,\n    SidebarComponent,\n    LoginComponent,\n    RegisterComponent,\n    SettingsComponent,\n    PageNotFoundComponent\n  ],\n  imports: [\n    BrowserModule,\n    <span style=\"color: #ff0000\">RouterModule.forRoot(appRoutes)</span>\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }</span></pre>\n</div>\n<h3>添加router-outlet:</h3>\n<p>打开app.component.html, 清空内容, 添加一个div(<span style=\"color: #ff0000\">可以输入div.container然后按tab健</span>):</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">div </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"container\"</span><span style=\"color: #0000ff\">&gt;</span>\n  <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">router-outlet</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">router-outlet</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">div</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p>现在刷新浏览器, 大约这样:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030191459668-1364864561.png\" alt=\"\"></p>\n<h3>添加navbar:</h3>\n<p>修改navbar.component.html:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">nav </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"navbar navbar-expand-md navbar-light bg-light\"</span><span style=\"color: #0000ff\">&gt;</span>\n  <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">div </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"container\"</span><span style=\"color: #0000ff\">&gt;</span>\n    <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">a </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"navbar-brand\"</span><span style=\"color: #ff0000\"> href</span><span style=\"color: #0000ff\">=\"#\"</span><span style=\"color: #0000ff\">&gt;</span>Client Panel<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">a</span><span style=\"color: #0000ff\">&gt;</span>\n    <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">button </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"navbar-toggler\"</span><span style=\"color: #ff0000\"> type</span><span style=\"color: #0000ff\">=\"button\"</span><span style=\"color: #ff0000\"> data-toggle</span><span style=\"color: #0000ff\">=\"collapse\"</span><span style=\"color: #ff0000\"> data-target</span><span style=\"color: #0000ff\">=\"#navbarsExampleDefault\"</span><span style=\"color: #ff0000\"> aria-controls</span><span style=\"color: #0000ff\">=\"navbarsExampleDefault\"</span><span style=\"color: #ff0000\">\n      aria-expanded</span><span style=\"color: #0000ff\">=\"false\"</span><span style=\"color: #ff0000\"> aria-label</span><span style=\"color: #0000ff\">=\"Toggle navigation\"</span><span style=\"color: #0000ff\">&gt;</span>\n      <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">span </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"navbar-toggler-icon\"</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">span</span><span style=\"color: #0000ff\">&gt;</span>\n    <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">button</span><span style=\"color: #0000ff\">&gt;</span>\n\n    <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">div </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"collapse navbar-collapse\"</span><span style=\"color: #ff0000\"> id</span><span style=\"color: #0000ff\">=\"navbarsExampleDefault\"</span><span style=\"color: #0000ff\">&gt;</span>\n      <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">ul </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"navbar-nav mr-auto\"</span><span style=\"color: #0000ff\">&gt;</span>\n        <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">li </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"nav-item\"</span><span style=\"color: #0000ff\">&gt;</span>\n          <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">a </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"nav-link\"</span><span style=\"color: #ff0000\"> href</span><span style=\"color: #0000ff\">=\"#\"</span><span style=\"color: #ff0000\"> routerLink</span><span style=\"color: #0000ff\">=\"/\"</span><span style=\"color: #0000ff\">&gt;</span>Dashboard <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">a</span><span style=\"color: #0000ff\">&gt;</span>\n        <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">li</span><span style=\"color: #0000ff\">&gt;</span>\n      <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">ul</span><span style=\"color: #0000ff\">&gt;</span>\n      <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">ul </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"navbar-nav ml-auto\"</span><span style=\"color: #0000ff\">&gt;</span>\n        <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">li </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"nav-item\"</span><span style=\"color: #0000ff\">&gt;</span>\n          <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">a </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"nav-link\"</span><span style=\"color: #ff0000\"> href</span><span style=\"color: #0000ff\">=\"#\"</span><span style=\"color: #ff0000\"> routerLink</span><span style=\"color: #0000ff\">=\"/register\"</span><span style=\"color: #0000ff\">&gt;</span>Register <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">a</span><span style=\"color: #0000ff\">&gt;</span>\n        <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">li</span><span style=\"color: #0000ff\">&gt;</span>\n        <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">li </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"nav-item\"</span><span style=\"color: #0000ff\">&gt;</span>\n          <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">a </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"nav-link\"</span><span style=\"color: #ff0000\"> href</span><span style=\"color: #0000ff\">=\"#\"</span><span style=\"color: #ff0000\"> routerLink</span><span style=\"color: #0000ff\">=\"/login\"</span><span style=\"color: #0000ff\">&gt;</span>Login <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">a</span><span style=\"color: #0000ff\">&gt;</span>\n        <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">li</span><span style=\"color: #0000ff\">&gt;</span>\n      <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">ul</span><span style=\"color: #0000ff\">&gt;</span>\n    <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">div</span><span style=\"color: #0000ff\">&gt;</span>\n  <span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">div</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">nav</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p> </p>\n<p>修改app.component.html:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #ff0000\">&lt;app-navbar&gt;&lt;/app-navbar&gt;</span>\n<span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">div </span><span style=\"color: #ff0000\">class</span><span style=\"color: #0000ff\">=\"container\"</span><span style=\"color: #0000ff\">&gt;</span>\n  <span style=\"color: #0000ff\">&lt;</span><span style=\"color: #800000\">router-outlet</span><span style=\"color: #0000ff\">&gt;&lt;/</span><span style=\"color: #800000\">router-outlet</span><span style=\"color: #0000ff\">&gt;</span>\n<span style=\"color: #0000ff\">&lt;/</span><span style=\"color: #800000\">div</span><span style=\"color: #0000ff\">&gt;</span></pre>\n</div>\n<p>运行:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171030192320965-1485867070.png\" alt=\"\"></p>\n<h1>建立Service</h1>\n<p>建立一个client.service:</p>\n<div class=\"cnblogs_code\">\n<pre>ng g service services/client</pre>\n</div>\n<p>然后在app.module.ts添加引用:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #008000\">//</span><span style=\"color: #008000\"> Services Imports</span>\nimport { ClientService } from \"./services/client.service\";</pre>\n</div>\n<p>并添加在providers里:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #000000\">  providers: [\n    ClientService\n  ],</span></pre>\n</div>\n<p>前端先暂时到这, 现在开始搞后端 web api.</p>\n<h1><span style=\"color: #ff0000\">建立asp.net core 2.0 的 Web api项目</span></h1>\n<p>web api项目源码: <a href=\"https://github.com/solenovex/asp.net-core-2.0-web-api-boilerplate\" target=\"_blank\">https://github.com/solenovex/asp.net-core-2.0-web-api-boilerplate</a></p>\n<p>项目列表如图:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171031142158621-439319124.jpg\" alt=\"\"></p>\n<p>AspNetIdentityAuthorizationServer是一个单独的authorization server, 这里暂时还没用到, 它的端口是5000, 默认不启动.</p>\n<p>CoreApi.Infrastructure 里面有一些基类和接口, 还放了一个公共的工具类等.</p>\n<p>CoreApi.Models就是 models/entities</p>\n<p>CoreApi.DataContext 里面就是DbContext相关的</p>\n<p>CoreApi.Repositories 里面是Repositories</p>\n<p>CoreApi.Services 里面就是各种services</p>\n<p>CoreApi.ViewModels 里面就是各种ViewModels或者叫Dtos</p>\n<p>CoreApi.Web是web启动项目.</p>\n<p>SharedSettings是横跨authorization server和 web api的一些公共设置.</p>\n<p>上面说的这些都没什么用, 下面开始建立Client的api.</p>\n<h1>建立Client Model(或者叫Entity)</h1>\n<p>在CoreApi.Models建立文件夹Angular, 然后建立Client.cs:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">using</span><span style=\"color: #000000\"> CoreApi.Infrastructure.Features.Common;\n</span><span style=\"color: #0000ff\">using</span><span style=\"color: #000000\"> Microsoft.EntityFrameworkCore;\n</span><span style=\"color: #0000ff\">using</span><span style=\"color: #000000\"> Microsoft.EntityFrameworkCore.Metadata.Builders;\n\n</span><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.Models.Angular\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> Client : EntityBase\n    {\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">decimal</span> Balance { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> Email { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> FirstName { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> LastName { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> Phone { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n    }\n\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span> ClientConfiguration : EntityBaseConfiguration&lt;Client&gt;<span style=\"color: #000000\">\n    {\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">override</span> <span style=\"color: #0000ff\">void</span> ConfigureDerived(EntityTypeBuilder&lt;Client&gt;<span style=\"color: #000000\"> builder)\n        {\n            builder.Property(x </span>=&gt; x.Balance).HasColumnType(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">decimal(18,2)</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">);\n            builder.Property(x </span>=&gt; x.Email).IsRequired().HasMaxLength(<span style=\"color: #800080\">100</span><span style=\"color: #000000\">);\n            builder.Property(x </span>=&gt; x.FirstName).IsRequired().HasMaxLength(<span style=\"color: #800080\">50</span><span style=\"color: #000000\">);\n            builder.Property(x </span>=&gt; x.LastName).IsRequired().HasMaxLength(<span style=\"color: #800080\">50</span><span style=\"color: #000000\">);\n            builder.Property(x </span>=&gt; x.Phone).HasMaxLength(<span style=\"color: #800080\">50</span><span style=\"color: #000000\">);\n        }\n    }\n}</span></pre>\n</div>\n<p>其中父类EntityBase里面含有一些通用属性,Id, CreateUser, UpdateUser, CreateTime, UpdateTime, LastAction, 这些是我公司做项目必须的, 你们随意.</p>\n<p>下面ClientConfiguration是针对Client的fluent api配置类. 他的父类EntityBaseConfiguration实现了EF的IEntityTypeConfiguration接口, 并在父类里面针对EntityBase那些属性使用fluent api做了限制:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.Infrastructure.Features.Common\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">abstract</span> <span style=\"color: #0000ff\">class</span> EntityBaseConfiguration&lt;T&gt; : IEntityTypeConfiguration&lt;T&gt; <span style=\"color: #0000ff\">where</span><span style=\"color: #000000\"> T : EntityBase\n    {\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">void</span> Configure(EntityTypeBuilder&lt;T&gt;<span style=\"color: #000000\"> builder)\n        {\n            builder.HasKey(e </span>=&gt;<span style=\"color: #000000\"> e.Id);\n            builder.Property(x </span>=&gt;<span style=\"color: #000000\"> x.CreateTime).IsRequired();\n            builder.Property(x </span>=&gt;<span style=\"color: #000000\"> x.UpdateTime).IsRequired();\n            builder.Property(x </span>=&gt; x.CreateUser).IsRequired().HasMaxLength(<span style=\"color: #800080\">50</span><span style=\"color: #000000\">);\n            builder.Property(x </span>=&gt; x.UpdateUser).IsRequired().HasMaxLength(<span style=\"color: #800080\">50</span><span style=\"color: #000000\">);\n            builder.Property(x </span>=&gt; x.LastAction).IsRequired().HasMaxLength(<span style=\"color: #800080\">50</span><span style=\"color: #000000\">);\n\n            ConfigureDerived(builder);\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">abstract</span> <span style=\"color: #0000ff\">void</span> ConfigureDerived(EntityTypeBuilder&lt;T&gt;<span style=\"color: #000000\"> b);\n    }\n}</span></pre>\n</div>\n<p>弄完Model和它的配置之后, 就添加到DbContext里面. 打开CoreApi.DataContext的CoreContext, 添加Model和配置:</p>\n<div class=\"cnblogs_code\">\n<pre>        <span style=\"color: #0000ff\">protected</span> <span style=\"color: #0000ff\">override</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> OnModelCreating(ModelBuilder modelBuilder)\n        {\n            </span><span style=\"color: #0000ff\">base</span><span style=\"color: #000000\">.OnModelCreating(modelBuilder);\n            modelBuilder.HasDefaultSchema(AppSettings.DefaultSchema);\n\n            modelBuilder.ApplyConfiguration(</span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> UploadedFileConfiguration());\n            <span style=\"color: #ff0000\">modelBuilder.ApplyConfiguration(</span></span><span style=\"color: #ff0000\">new</span><span style=\"color: #000000\"><span style=\"color: #ff0000\"> ClientConfiguration());</span>\n        }</span></pre>\n</div>\n<div class=\"cnblogs_code\">\n<pre>        <span style=\"color: #0000ff\">public</span> DbSet&lt;UploadedFile&gt; UploadedFiles { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #ff0000\">public DbSet&lt;Client&gt; Clients { get; set; }</span></pre>\n</div>\n<h1>然后建立ClientRepository</h1>\n<p>在CoreApi.Repositories里面建立Angular目录, 建立ClientRepository.cs:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.Repositories.Angular\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">interface</span> IClientRepository : IEntityBaseRepository&lt;Client&gt;<span style=\"color: #000000\"> { }\n\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span> ClientRepository : EntityBaseRepository&lt;Client&gt;<span style=\"color: #000000\">, IClientRepository\n    {\n        </span><span style=\"color: #0000ff\">public</span> ClientRepository(IUnitOfWork unitOfWork) : <span style=\"color: #0000ff\">base</span><span style=\"color: #000000\">(unitOfWork)\n        {\n        }\n    }\n}</span></pre>\n</div>\n<p>图省事, 我把repository和它的interface放在一个文件了.</p>\n<p>IEntityBaseRepository&lt;T&gt;定义了一些常用的方法:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.DataContext.Infrastructure\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">interface</span> IEntityBaseRepository&lt;T&gt; <span style=\"color: #0000ff\">where</span> T : <span style=\"color: #0000ff\">class</span>, IEntityBase, <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\">()\n    {\n        IQueryable</span>&lt;T&gt; All { <span style=\"color: #0000ff\">get</span><span style=\"color: #000000\">; }\n        IQueryable</span>&lt;T&gt; AllIncluding(<span style=\"color: #0000ff\">params</span> Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">object</span>&gt;&gt;<span style=\"color: #000000\">[] includeProperties);\n\n        </span><span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> Count();\n        Task</span>&lt;<span style=\"color: #0000ff\">int</span>&gt;<span style=\"color: #000000\"> CountAsync();\n        T GetSingle(</span><span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> id);\n        Task</span>&lt;T&gt; GetSingleAsync(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> id);\n        T GetSingle(Expression</span>&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt;<span style=\"color: #000000\"> predicate);\n        Task</span>&lt;T&gt; GetSingleAsync(Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt;<span style=\"color: #000000\"> predicate);\n        T GetSingle(Expression</span>&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt; predicate, <span style=\"color: #0000ff\">params</span> Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">object</span>&gt;&gt;<span style=\"color: #000000\">[] includeProperties);\n        Task</span>&lt;T&gt; GetSingleAsync(Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt; predicate, <span style=\"color: #0000ff\">params</span> Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">object</span>&gt;&gt;<span style=\"color: #000000\">[] includeProperties);\n        IQueryable</span>&lt;T&gt; FindBy(Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt;<span style=\"color: #000000\"> predicate);\n        </span><span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Add(T entity);\n        </span><span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Update(T entity);\n        </span><span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Delete(T entity);\n        </span><span style=\"color: #0000ff\">void</span> DeleteWhere(Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt;<span style=\"color: #000000\"> predicate);\n        </span><span style=\"color: #0000ff\">void</span> AddRange(IEnumerable&lt;T&gt;<span style=\"color: #000000\"> entities);\n        </span><span style=\"color: #0000ff\">void</span> DeleteRange(IEnumerable&lt;T&gt;<span style=\"color: #000000\"> entities);\n        </span><span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Attach(T entity);\n        </span><span style=\"color: #0000ff\">void</span> AttachRange(IEnumerable&lt;T&gt;<span style=\"color: #000000\"> entities);\n        </span><span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Detach(T entity);\n        </span><span style=\"color: #0000ff\">void</span> DetachRange(IEnumerable&lt;T&gt;<span style=\"color: #000000\"> entities);\n        </span><span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> AttachAsModified(T entity);\n    }\n}</span></pre>\n</div>\n<p>EntityBaseRepository&lt;T&gt;是它的实现:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.DataContext.Infrastructure\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span> EntityBaseRepository&lt;T&gt; : IEntityBaseRepository&lt;T&gt;\n        <span style=\"color: #0000ff\">where</span> T : <span style=\"color: #0000ff\">class</span>, IEntityBase, <span style=\"color: #0000ff\">new</span><span style=\"color: #000000\">()\n    {\n        </span><span style=\"color: #0000ff\">#region</span> Properties\n        <span style=\"color: #0000ff\">protected</span> CoreContext Context { <span style=\"color: #0000ff\">get</span><span style=\"color: #000000\">; }\n\n        </span><span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> EntityBaseRepository(IUnitOfWork unitOfWork)\n        {\n            Context </span>= unitOfWork <span style=\"color: #0000ff\">as</span><span style=\"color: #000000\"> CoreContext;\n        }\n        </span><span style=\"color: #0000ff\">#endregion</span>\n\n        <span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> IQueryable&lt;T&gt; All =&gt; Context.Set&lt;T&gt;<span style=\"color: #000000\">();\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> IQueryable&lt;T&gt; AllIncluding(<span style=\"color: #0000ff\">params</span> Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">object</span>&gt;&gt;<span style=\"color: #000000\">[] includeProperties)\n        {\n            IQueryable</span>&lt;T&gt; query = Context.Set&lt;T&gt;<span style=\"color: #000000\">();\n            </span><span style=\"color: #0000ff\">foreach</span> (<span style=\"color: #0000ff\">var</span> includeProperty <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> includeProperties)\n            {\n                query </span>=<span style=\"color: #000000\"> query.Include(includeProperty);\n            }\n            </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> query;\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> Count()\n        {\n            </span><span style=\"color: #0000ff\">return</span> Context.Set&lt;T&gt;<span style=\"color: #000000\">().Count();\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;<span style=\"color: #0000ff\">int</span>&gt;<span style=\"color: #000000\"> CountAsync()\n        {\n            </span><span style=\"color: #0000ff\">return</span> <span style=\"color: #0000ff\">await</span> Context.Set&lt;T&gt;<span style=\"color: #000000\">().CountAsync();\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> T GetSingle(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> id)\n        {\n            </span><span style=\"color: #0000ff\">return</span> Context.Set&lt;T&gt;().FirstOrDefault(x =&gt; x.Id ==<span style=\"color: #000000\"> id);\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;T&gt; GetSingleAsync(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> id)\n        {\n            </span><span style=\"color: #0000ff\">return</span> <span style=\"color: #0000ff\">await</span> Context.Set&lt;T&gt;().FirstOrDefaultAsync(x =&gt; x.Id ==<span style=\"color: #000000\"> id);\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> T GetSingle(Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt;<span style=\"color: #000000\"> predicate)\n        {\n            </span><span style=\"color: #0000ff\">return</span> Context.Set&lt;T&gt;<span style=\"color: #000000\">().FirstOrDefault(predicate);\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;T&gt; GetSingleAsync(Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt;<span style=\"color: #000000\"> predicate)\n        {\n            </span><span style=\"color: #0000ff\">return</span> <span style=\"color: #0000ff\">await</span> Context.Set&lt;T&gt;<span style=\"color: #000000\">().FirstOrDefaultAsync(predicate);\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> T GetSingle(Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt; predicate, <span style=\"color: #0000ff\">params</span> Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">object</span>&gt;&gt;<span style=\"color: #000000\">[] includeProperties)\n        {\n            IQueryable</span>&lt;T&gt; query = Context.Set&lt;T&gt;<span style=\"color: #000000\">();\n            </span><span style=\"color: #0000ff\">foreach</span> (<span style=\"color: #0000ff\">var</span> includeProperty <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> includeProperties)\n            {\n                query </span>=<span style=\"color: #000000\"> query.Include(includeProperty);\n            }\n            </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> query.Where(predicate).FirstOrDefault();\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;T&gt; GetSingleAsync(Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt; predicate, <span style=\"color: #0000ff\">params</span> Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">object</span>&gt;&gt;<span style=\"color: #000000\">[] includeProperties)\n        {\n            IQueryable</span>&lt;T&gt; query = Context.Set&lt;T&gt;<span style=\"color: #000000\">();\n            </span><span style=\"color: #0000ff\">foreach</span> (<span style=\"color: #0000ff\">var</span> includeProperty <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> includeProperties)\n            {\n                query </span>=<span style=\"color: #000000\"> query.Include(includeProperty);\n            }\n\n            </span><span style=\"color: #0000ff\">return</span> <span style=\"color: #0000ff\">await</span><span style=\"color: #000000\"> query.Where(predicate).FirstOrDefaultAsync();\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> IQueryable&lt;T&gt; FindBy(Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt;<span style=\"color: #000000\"> predicate)\n        {\n            </span><span style=\"color: #0000ff\">return</span> Context.Set&lt;T&gt;<span style=\"color: #000000\">().Where(predicate);\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Add(T entity)\n        {\n            Context.Set</span>&lt;T&gt;<span style=\"color: #000000\">().Add(entity);\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Update(T entity)\n        {\n            EntityEntry</span>&lt;T&gt; dbEntityEntry =<span style=\"color: #000000\"> Context.Entry(entity);\n            dbEntityEntry.State </span>=<span style=\"color: #000000\"> EntityState.Modified;\n\n            dbEntityEntry.Property(x </span>=&gt; x.Id).IsModified = <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">;\n            dbEntityEntry.Property(x </span>=&gt; x.CreateUser).IsModified = <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">;\n            dbEntityEntry.Property(x </span>=&gt; x.CreateTime).IsModified = <span style=\"color: #0000ff\">false</span><span style=\"color: #000000\">;\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Delete(T entity)\n        {\n            Context.Set</span>&lt;T&gt;<span style=\"color: #000000\">().Remove(entity);\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">void</span> AddRange(IEnumerable&lt;T&gt;<span style=\"color: #000000\"> entities)\n        {\n            Context.Set</span>&lt;T&gt;<span style=\"color: #000000\">().AddRange(entities);\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">void</span> DeleteRange(IEnumerable&lt;T&gt;<span style=\"color: #000000\"> entities)\n        {\n            </span><span style=\"color: #0000ff\">foreach</span> (<span style=\"color: #0000ff\">var</span> entity <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> entities)\n            {\n                Context.Set</span>&lt;T&gt;<span style=\"color: #000000\">().Remove(entity);\n            }\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">virtual</span> <span style=\"color: #0000ff\">void</span> DeleteWhere(Expression&lt;Func&lt;T, <span style=\"color: #0000ff\">bool</span>&gt;&gt;<span style=\"color: #000000\"> predicate)\n        {\n            IEnumerable</span>&lt;T&gt; entities = Context.Set&lt;T&gt;<span style=\"color: #000000\">().Where(predicate);\n\n            </span><span style=\"color: #0000ff\">foreach</span> (<span style=\"color: #0000ff\">var</span> entity <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> entities)\n            {\n                Context.Entry</span>&lt;T&gt;(entity).State =<span style=\"color: #000000\"> EntityState.Deleted;\n            }\n        }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Attach(T entity)\n        {\n            Context.Set</span>&lt;T&gt;<span style=\"color: #000000\">().Attach(entity);\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span> AttachRange(IEnumerable&lt;T&gt;<span style=\"color: #000000\"> entities)\n        {\n            </span><span style=\"color: #0000ff\">foreach</span> (<span style=\"color: #0000ff\">var</span> entity <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> entities)\n            {\n                Attach(entity);\n            }\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> Detach(T entity)\n        {\n            Context.Entry</span>&lt;T&gt;(entity).State =<span style=\"color: #000000\"> EntityState.Detached;\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span> DetachRange(IEnumerable&lt;T&gt;<span style=\"color: #000000\"> entities)\n        {\n            </span><span style=\"color: #0000ff\">foreach</span> (<span style=\"color: #0000ff\">var</span> entity <span style=\"color: #0000ff\">in</span><span style=\"color: #000000\"> entities)\n            {\n                Detach(entity);\n            }\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> AttachAsModified(T entity)\n        {\n            Attach(entity);\n            Update(entity);\n        }\n        \n    }\n}</span></pre>\n</div>\n<h1>建立Client的ViewModels</h1>\n<p>在CoreApi.ViewModels建立Angular文件夹, 分别针对查询, 新增, 修改建立3个ViewModel(Dto):</p>\n<p>ClientViewModel:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.ViewModels.Angular\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> ClientViewModel : EntityBase\n    {\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">decimal</span> Balance { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> Email { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> FirstName { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> LastName { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> Phone { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n    }\n}</span></pre>\n</div>\n<p>ClientCreationViewModel:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.ViewModels.Angular\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> ClientCreationViewModel\n    {\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">decimal</span> Balance { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        \n        [Required]\n        [MaxLength(</span><span style=\"color: #800080\">100</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> Email { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        \n        [Required]\n        [MaxLength(</span><span style=\"color: #800080\">50</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> FirstName { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        \n        [Required]\n        [MaxLength(</span><span style=\"color: #800080\">50</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> LastName { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n\n        [Required]\n        [MaxLength(</span><span style=\"color: #800080\">50</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> Phone { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n    }\n}</span></pre>\n</div>\n<p>ClientModificationViewModel:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.ViewModels.Angular\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> ClientModificationViewModel\n    {\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">decimal</span> Balance { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n\n        [Required]\n        [MaxLength(</span><span style=\"color: #800080\">100</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> Email { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n\n        [Required]\n        [MaxLength(</span><span style=\"color: #800080\">50</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> FirstName { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n\n        [Required]\n        [MaxLength(</span><span style=\"color: #800080\">50</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> LastName { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n\n        [Required]\n        [MaxLength(</span><span style=\"color: #800080\">50</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">string</span> Phone { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n    }\n}</span></pre>\n</div>\n<h1>配置AutoMapper</h1>\n<p>针对Client和它的Viewmodels, 分别从两个方向进行配置:</p>\n<p>DomainToViewModelMappingProfile:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.Web.MyConfigurations\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> DomainToViewModelMappingProfile : Profile\n    {\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">override</span> <span style=\"color: #0000ff\">string</span> ProfileName =&gt; <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">DomainToViewModelMappings</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">;\n\n        </span><span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> DomainToViewModelMappingProfile()\n        {\n            CreateMap</span>&lt;UploadedFile, UploadedFileViewModel&gt;<span style=\"color: #000000\">();\n            <span style=\"color: #ff0000\">CreateMap</span></span><span style=\"color: #ff0000\">&lt;Client, ClientViewModel&gt;();\n            CreateMap&lt;Client, ClientModificationViewModel&gt;</span><span style=\"color: #000000\"><span style=\"color: #ff0000\">();</span>\n        }\n    }\n}</span></pre>\n</div>\n<p>ViewModelToDomainMappingProfile:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.Web.MyConfigurations\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> ViewModelToDomainMappingProfile : Profile\n    {\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">override</span> <span style=\"color: #0000ff\">string</span> ProfileName =&gt; <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">ViewModelToDomainMappings</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">;\n\n        </span><span style=\"color: #0000ff\">public</span><span style=\"color: #000000\"> ViewModelToDomainMappingProfile()\n        {\n            CreateMap</span>&lt;UploadedFileViewModel, UploadedFile&gt;<span style=\"color: #000000\">();\n            <span style=\"color: #ff0000\">CreateMap</span></span><span style=\"color: #ff0000\">&lt;ClientViewModel, Client&gt;();\n            CreateMap&lt;ClientCreationViewModel, Client&gt;();\n            CreateMap&lt;ClientModificationViewModel, Client&gt;</span><span style=\"color: #000000\"><span style=\"color: #ff0000\">();</span>\n        }\n    }\n}</span></pre>\n</div>\n<h1>注册Repository的DI:</h1>\n<p>在web项目的StartUp.cs的ConfigureServices里面为ClientRepository注册DI:</p>\n<div class=\"cnblogs_code\">\n<pre>services.AddScoped&lt;IClientRepository, ClientRepository&gt;();</pre>\n</div>\n<h1>建立Controller</h1>\n<p>在controllers目录建立Angular/ClientController.cs:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.Web.Controllers.Angular\n{\n    [Route(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">api/[controller]</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)]\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span> ClientController : BaseController&lt;ClientController&gt;<span style=\"color: #000000\">\n    {\n        </span><span style=\"color: #0000ff\">private</span> <span style=\"color: #0000ff\">readonly</span><span style=\"color: #000000\"> IClientRepository _clientRepository;\n        </span><span style=\"color: #0000ff\">public</span> ClientController(ICoreService&lt;ClientController&gt;<span style=\"color: #000000\"> coreService,\n            IClientRepository clientRepository) : </span><span style=\"color: #0000ff\">base</span><span style=\"color: #000000\">(coreService)\n        {\n            _clientRepository </span>=<span style=\"color: #000000\"> clientRepository;\n        }\n\n        [HttpGet]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;IActionResult&gt;<span style=\"color: #000000\"> GetAll()\n        {\n            </span><span style=\"color: #0000ff\">var</span> items = <span style=\"color: #0000ff\">await</span><span style=\"color: #000000\"> _clientRepository.All.ToListAsync();\n            </span><span style=\"color: #0000ff\">var</span> results = Mapper.Map&lt;IEnumerable&lt;ClientViewModel&gt;&gt;<span style=\"color: #000000\">(items);\n            </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> Ok(results);\n        }\n\n        [HttpGet]\n        [Route(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">{id}</span><span style=\"color: #800000\">\"</span>, Name = <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">GetClient</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;IActionResult&gt; Get(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> id)\n        {\n            </span><span style=\"color: #0000ff\">var</span> item = <span style=\"color: #0000ff\">await</span><span style=\"color: #000000\"> _clientRepository.GetSingleAsync(id);\n            </span><span style=\"color: #0000ff\">if</span> (item == <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">)\n            {\n                </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> NotFound();\n            }\n            </span><span style=\"color: #0000ff\">var</span> result = Mapper.Map&lt;ClientViewModel&gt;<span style=\"color: #000000\">(item);\n            </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> Ok(result);\n        }\n\n        [HttpPost]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;IActionResult&gt;<span style=\"color: #000000\"> Post([FromBody] ClientCreationViewModel clientVm)\n        {\n            </span><span style=\"color: #0000ff\">if</span> (clientVm == <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">)\n            {\n                </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> BadRequest();\n            }\n\n            </span><span style=\"color: #0000ff\">if</span> (!<span style=\"color: #000000\">ModelState.IsValid)\n            {\n                </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> BadRequest(ModelState);\n            }\n\n            </span><span style=\"color: #0000ff\">var</span> newItem = Mapper.Map&lt;Client&gt;<span style=\"color: #000000\">(clientVm);\n            newItem.SetCreation(UserName);\n            _clientRepository.Add(newItem);\n            </span><span style=\"color: #0000ff\">if</span> (!<span style=\"color: #0000ff\">await</span><span style=\"color: #000000\"> UnitOfWork.SaveAsync())\n            {\n                </span><span style=\"color: #0000ff\">return</span> StatusCode(<span style=\"color: #800080\">500</span>, <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">保存客户时出错</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">);\n            }\n\n            </span><span style=\"color: #0000ff\">var</span> vm = Mapper.Map&lt;ClientViewModel&gt;<span style=\"color: #000000\">(newItem);\n\n            </span><span style=\"color: #0000ff\">return</span> CreatedAtRoute(<span style=\"color: #800000\">\"</span><span style=\"color: #800000\">GetClient</span><span style=\"color: #800000\">\"</span>, <span style=\"color: #0000ff\">new</span> { id =<span style=\"color: #000000\"> vm.Id }, vm);\n        }\n\n        [HttpPut(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">{id}</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;IActionResult&gt; Put(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> id, [FromBody] ClientModificationViewModel clientVm)\n        {\n            </span><span style=\"color: #0000ff\">if</span> (clientVm == <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">)\n            {\n                </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> BadRequest();\n            }\n\n            </span><span style=\"color: #0000ff\">if</span> (!<span style=\"color: #000000\">ModelState.IsValid)\n            {\n                </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> BadRequest(ModelState);\n            }\n            </span><span style=\"color: #0000ff\">var</span> dbItem = <span style=\"color: #0000ff\">await</span><span style=\"color: #000000\"> _clientRepository.GetSingleAsync(id);\n            </span><span style=\"color: #0000ff\">if</span> (dbItem == <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">)\n            {\n                </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> NotFound();\n            }\n            Mapper.Map(clientVm, dbItem);\n            dbItem.SetModification(UserName);\n            _clientRepository.Update(dbItem);\n            </span><span style=\"color: #0000ff\">if</span> (!<span style=\"color: #0000ff\">await</span><span style=\"color: #000000\"> UnitOfWork.SaveAsync())\n            {\n                </span><span style=\"color: #0000ff\">return</span> StatusCode(<span style=\"color: #800080\">500</span>, <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">保存客户时出错</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">);\n            }\n\n            </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> NoContent();\n        }\n\n        [HttpPatch(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">{id}</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;IActionResult&gt; Patch(<span style=\"color: #0000ff\">int</span> id, [FromBody] JsonPatchDocument&lt;ClientModificationViewModel&gt;<span style=\"color: #000000\"> patchDoc)\n        {\n            </span><span style=\"color: #0000ff\">if</span> (patchDoc == <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">)\n            {\n                </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> BadRequest();\n            }\n            </span><span style=\"color: #0000ff\">var</span> dbItem = <span style=\"color: #0000ff\">await</span><span style=\"color: #000000\"> _clientRepository.GetSingleAsync(id);\n            </span><span style=\"color: #0000ff\">if</span> (dbItem == <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">)\n            {\n                </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> NotFound();\n            }\n            </span><span style=\"color: #0000ff\">var</span> toPatchVm = Mapper.Map&lt;ClientModificationViewModel&gt;<span style=\"color: #000000\">(dbItem);\n            patchDoc.ApplyTo(toPatchVm, ModelState);\n\n            TryValidateModel(toPatchVm);\n            </span><span style=\"color: #0000ff\">if</span> (!<span style=\"color: #000000\">ModelState.IsValid)\n            {\n                </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> BadRequest(ModelState);\n            }\n\n            Mapper.Map(toPatchVm, dbItem);\n\n            </span><span style=\"color: #0000ff\">if</span> (!<span style=\"color: #0000ff\">await</span><span style=\"color: #000000\"> UnitOfWork.SaveAsync())\n            {\n                </span><span style=\"color: #0000ff\">return</span> StatusCode(<span style=\"color: #800080\">500</span>, <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">更新的时候出错</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">);\n            }\n\n            </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> NoContent();\n        }\n\n        [HttpDelete(</span><span style=\"color: #800000\">\"</span><span style=\"color: #800000\">{id}</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">)]\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;IActionResult&gt; Delete(<span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> id)\n        {\n            </span><span style=\"color: #0000ff\">var</span> model = <span style=\"color: #0000ff\">await</span><span style=\"color: #000000\"> _clientRepository.GetSingleAsync(id);\n            </span><span style=\"color: #0000ff\">if</span> (model == <span style=\"color: #0000ff\">null</span><span style=\"color: #000000\">)\n            {\n                </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> NotFound();\n            }\n            _clientRepository.Delete(model);\n            </span><span style=\"color: #0000ff\">if</span> (!<span style=\"color: #0000ff\">await</span><span style=\"color: #000000\"> UnitOfWork.SaveAsync())\n            {\n                </span><span style=\"color: #0000ff\">return</span> StatusCode(<span style=\"color: #800080\">500</span>, <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">删除的时候出错</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">);\n            }\n            </span><span style=\"color: #0000ff\">return</span><span style=\"color: #000000\"> NoContent();\n        }\n    }\n}</span></pre>\n</div>\n<p>首先, Controller继承了ControllerBase这个类, ControllerBase是自己写的类, 里面可以放置一些公用的方法或属性, 目前里面的东西都没用:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.Web.Controllers.Bases\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">abstract</span> <span style=\"color: #0000ff\">class</span> BaseController&lt;T&gt;<span style=\"color: #000000\"> : Controller\n    {\n        </span><span style=\"color: #0000ff\">protected</span> <span style=\"color: #0000ff\">readonly</span><span style=\"color: #000000\"> IUnitOfWork UnitOfWork;\n        </span><span style=\"color: #0000ff\">protected</span> <span style=\"color: #0000ff\">readonly</span> ILogger&lt;T&gt;<span style=\"color: #000000\"> Logger;\n        </span><span style=\"color: #0000ff\">protected</span> <span style=\"color: #0000ff\">readonly</span><span style=\"color: #000000\"> IFileProvider FileProvider;\n        </span><span style=\"color: #0000ff\">protected</span> <span style=\"color: #0000ff\">readonly</span> ICoreService&lt;T&gt;<span style=\"color: #000000\"> CoreService;\n\n        </span><span style=\"color: #0000ff\">protected</span> BaseController(ICoreService&lt;T&gt;<span style=\"color: #000000\"> coreService)\n        {\n            CoreService </span>=<span style=\"color: #000000\"> coreService;\n            UnitOfWork </span>=<span style=\"color: #000000\"> coreService.UnitOfWork;\n            Logger </span>=<span style=\"color: #000000\"> coreService.Logger;\n            FileProvider </span>=<span style=\"color: #000000\"> coreService.FileProvider;\n        }\n\n        </span><span style=\"color: #0000ff\">#region</span> Current Information\n\n        <span style=\"color: #0000ff\">protected</span> DateTime Now =&gt;<span style=\"color: #000000\"> DateTime.Now;\n        </span><span style=\"color: #0000ff\">protected</span> <span style=\"color: #0000ff\">string</span> UserName =&gt; User.Identity.Name ?? <span style=\"color: #800000\">\"</span><span style=\"color: #800000\">Anonymous</span><span style=\"color: #800000\">\"</span><span style=\"color: #000000\">;\n\n        </span><span style=\"color: #0000ff\">#endregion</span><span style=\"color: #000000\">\n\n    }\n}</span></pre>\n</div>\n<p>由于父类构造函数依赖的类太多了, 所以我建立了一个CoreService, 里面包含着这些依赖, 然后用一个变量就注入进去了, 这种写法不一定正确:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">interface</span> ICoreService&lt;<span style=\"color: #0000ff\">out</span> T&gt;<span style=\"color: #000000\"> : IDisposable\n    {\n        IUnitOfWork UnitOfWork { </span><span style=\"color: #0000ff\">get</span><span style=\"color: #000000\">; }\n        ILogger</span>&lt;T&gt; Logger { <span style=\"color: #0000ff\">get</span><span style=\"color: #000000\">; }\n        IFileProvider FileProvider { </span><span style=\"color: #0000ff\">get</span><span style=\"color: #000000\">; }\n    }</span></pre>\n</div>\n<p>Controller里面的方法应该都能看明白吧. 需要提一下的是UnitOfWork. </p>\n<h1>Unit Of Work</h1>\n<p>我才用的是UnitOfWork和Repository模式, 多个Repository挂起的数据库操作, 可以使用一个UnitOfWork一次性提交.</p>\n<p>由于DBContext已经实现了UnitOfWork模式, 所以可以直接在Controller里面使用DbContext, 但是我还是做了一个接口 IUnitOfWork:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.DataContext.Infrastructure\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">interface</span><span style=\"color: #000000\"> IUnitOfWork: IDisposable\n    {\n        </span><span style=\"color: #0000ff\">int</span><span style=\"color: #000000\"> SaveChanges();\n        </span><span style=\"color: #0000ff\">int</span> SaveChanges(<span style=\"color: #0000ff\">bool</span><span style=\"color: #000000\"> acceptAllChangesOnSuccess);\n        Task</span>&lt;<span style=\"color: #0000ff\">int</span>&gt; SaveChangesAsync(<span style=\"color: #0000ff\">bool</span> acceptAllChangesOnSuccess, CancellationToken cancellationToken = <span style=\"color: #0000ff\">default</span><span style=\"color: #000000\">(CancellationToken));\n        Task</span>&lt;<span style=\"color: #0000ff\">int</span>&gt; SaveChangesAsync(CancellationToken cancellationToken = <span style=\"color: #0000ff\">default</span><span style=\"color: #000000\">(CancellationToken));\n\n        </span><span style=\"color: #0000ff\">bool</span><span style=\"color: #000000\"> Save();\n        </span><span style=\"color: #0000ff\">bool</span> Save(<span style=\"color: #0000ff\">bool</span><span style=\"color: #000000\"> acceptAllChangesOnSuccess);\n        Task</span>&lt;<span style=\"color: #0000ff\">bool</span>&gt; SaveAsync(<span style=\"color: #0000ff\">bool</span> acceptAllChangesOnSuccess, CancellationToken cancellationToken = <span style=\"color: #0000ff\">default</span><span style=\"color: #000000\">(CancellationToken));\n        Task</span>&lt;<span style=\"color: #0000ff\">bool</span>&gt; SaveAsync(CancellationToken cancellationToken = <span style=\"color: #0000ff\">default</span><span style=\"color: #000000\">(CancellationToken));\n    }\n}</span></pre>\n</div>\n<p>里面前4个方法就是DbContext内置的方法, 后面4个方法可有可无, 就是上面4个方法的简单变形.</p>\n<p>看一下CoreContext:</p>\n<div class=\"cnblogs_code\">\n<pre><span style=\"color: #0000ff\">namespace</span><span style=\"color: #000000\"> CoreApi.DataContext.Core\n{\n    </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">class</span><span style=\"color: #000000\"> CoreContext : DbContext, IUnitOfWork\n    {\n        </span><span style=\"color: #0000ff\">public</span> CoreContext(DbContextOptions&lt;CoreContext&gt;<span style=\"color: #000000\"> options)\n            : </span><span style=\"color: #0000ff\">base</span><span style=\"color: #000000\">(options)\n        {\n        }\n\n        </span><span style=\"color: #0000ff\">protected</span> <span style=\"color: #0000ff\">override</span> <span style=\"color: #0000ff\">void</span><span style=\"color: #000000\"> OnModelCreating(ModelBuilder modelBuilder)\n        {\n            </span><span style=\"color: #0000ff\">base</span><span style=\"color: #000000\">.OnModelCreating(modelBuilder);\n            modelBuilder.HasDefaultSchema(AppSettings.DefaultSchema);\n\n            modelBuilder.ApplyConfiguration(</span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> UploadedFileConfiguration());\n            modelBuilder.ApplyConfiguration(</span><span style=\"color: #0000ff\">new</span><span style=\"color: #000000\"> ClientConfiguration());\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> DbSet&lt;UploadedFile&gt; UploadedFiles { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n        </span><span style=\"color: #0000ff\">public</span> DbSet&lt;Client&gt; Clients { <span style=\"color: #0000ff\">get</span>; <span style=\"color: #0000ff\">set</span><span style=\"color: #000000\">; }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">bool</span><span style=\"color: #000000\"> Save()\n        {\n            </span><span style=\"color: #0000ff\">return</span> SaveChanges() &gt;= <span style=\"color: #800080\">0</span><span style=\"color: #000000\">;\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">bool</span> Save(<span style=\"color: #0000ff\">bool</span><span style=\"color: #000000\"> acceptAllChangesOnSuccess)\n        {\n            </span><span style=\"color: #0000ff\">return</span> SaveChanges(acceptAllChangesOnSuccess) &gt;= <span style=\"color: #800080\">0</span><span style=\"color: #000000\">;\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;<span style=\"color: #0000ff\">bool</span>&gt; SaveAsync(<span style=\"color: #0000ff\">bool</span> acceptAllChangesOnSuccess, CancellationToken cancellationToken = <span style=\"color: #0000ff\">default</span><span style=\"color: #000000\">(CancellationToken))\n        {\n            </span><span style=\"color: #0000ff\">return</span> <span style=\"color: #0000ff\">await</span> SaveChangesAsync(acceptAllChangesOnSuccess, cancellationToken) &gt;= <span style=\"color: #800080\">0</span><span style=\"color: #000000\">;\n        }\n\n        </span><span style=\"color: #0000ff\">public</span> <span style=\"color: #0000ff\">async</span> Task&lt;<span style=\"color: #0000ff\">bool</span>&gt; SaveAsync(CancellationToken cancellationToken = <span style=\"color: #0000ff\">default</span><span style=\"color: #000000\">(CancellationToken))\n        {\n            </span><span style=\"color: #0000ff\">return</span> <span style=\"color: #0000ff\">await</span> SaveChangesAsync(cancellationToken) &gt;= <span style=\"color: #800080\">0</span><span style=\"color: #000000\">;\n        }\n    }\n}</span></pre>\n</div>\n<p>差不多了, 开始</p>\n<h1>迁移数据库</h1>\n<p>在Package Manager Console分别执行 Add-Migration XXX和 Update-database命令.</p>\n<p>注意这个时候 解决方案的启动项目必须是Web项目, 如果设置了多个启动项目, 迁移命令会不太好用.</p>\n<p>然后运行一下: 选择CoreApi.Web而不是IISExpress, 这样的话端口应该是 <a href=\"http://localhost:5001/api/values\" target=\"_blank\">http://localhost:5001/api/values</a></p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171031150149824-1591551701.jpg\" alt=\"\"></p>\n<h1>到Swagger里简单测试下</h1>\n<p>然后进入swagger简单测试一下ClientController: <a href=\"http://localhost:5001/swagger/\" target=\"_blank\">http://localhost:5001/swagger/</a></p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171031150407340-137427366.jpg\" alt=\"\"></p>\n<h2>先添加数据 POST:</h2>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171031150543683-1718872411.jpg\" alt=\"\"></p>\n<p>先点击右侧, 然后会把数据的json模板复制到左边的框里, 然后修改值, 然后点击try It out, 结果如下:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171031150700277-2057194380.jpg\" alt=\"\"></p>\n<p>然后两个Get, Delete, Put您都应该会测试.</p>\n<p>这里试一下 Patch:</p>\n<p><img src=\"http://images2017.cnblogs.com/blog/986268/201710/986268-20171031151113918-511411108.jpg\" alt=\"\"></p>\n<p>再查询一下, 应该没有什么问题.</p>\n<p>先写到这, 明天就能差不多写完了吧.</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 15:14</span> <a href=\"http://www.cnblogs.com/cgzl/\">solenovex</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7755801\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7755801);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=292394,cb_entryId=7755801,cb_blogApp=currentBlogApp,cb_blogUserGuid='12320adf-fa3f-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/31 15:14:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 411, "image_url": ["https://pic.cnblogs.com/face/986268/20171006090042.png"], "date_pub": "2017-10-31", "article_common": 7}
{"title": "Java 中冷门的 synthetic 关键字原理解读", "url": "http://www.cnblogs.com/bethunebtj/p/7761596.html", "author": "道德楷模周鸿祎", "article_desc": "看JAVA的反射时，看到有个synthetic ，还有一个方法isSynthetic() 很好奇，就了解了一下： 1.定义 Any constructs introduced by a Java compiler that do not have a corresponding construct  ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/bethunebtj/p/7761596.html\">Java 中冷门的 synthetic 关键字原理解读</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>看JAVA的反射时，看到有个synthetic ，还有一个方法isSynthetic() 很好奇，就了解了一下：</p>\r\n<h2>1.定义</h2>\r\n<p>Any constructs introduced by a Java compiler that do not have a corresponding construct in the source code must be marked as synthetic, except for default constructors, the class initialization method, and the values and valueOf methods of the Enum class.</p>\r\n<p>大意为：由java编译器生成的（除了像默认构造函数这一类的）方法，或者类</p>\r\n<h2>2.实例</h2>\r\n<p>既然知道synthetic方法和synthetic类是由编译器生成的，那到底编译器会怎么生成这些东西，又在什么情况下会生成这些东西呢？</p>\r\n<p><span class=\"hljs-keyword\">先看一段代码：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">import</span> <span style=\"color: #0000ff;\">static</span><span style=\"color: #000000;\"> java.lang.System.out;\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">final</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> DemonstrateSyntheticMethods\r\n{\r\n   </span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> main(<span style=\"color: #0000ff;\">final</span><span style=\"color: #000000;\"> String[] arguments)\r\n   {\r\n      DemonstrateSyntheticMethods.NestedClass nested </span>=\r\n         <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> DemonstrateSyntheticMethods.NestedClass();\r\n      out.println(</span>\"String: \" +<span style=\"color: #000000;\"> nested.highlyConfidential);\r\n   }\r\n\r\n   </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">final</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> NestedClass\r\n   {\r\n      </span><span style=\"color: #0000ff;\">private</span> String highlyConfidential = \"Don't tell anyone about me\"<span style=\"color: #000000;\">;\r\n      </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">int</span> highlyConfidentialInt = 42<span style=\"color: #000000;\">;\r\n      </span><span style=\"color: #0000ff;\">private</span> Calendar highlyConfidentialCalendar =<span style=\"color: #000000;\"> Calendar.getInstance();\r\n      </span><span style=\"color: #0000ff;\">private</span> <span style=\"color: #0000ff;\">boolean</span> highlyConfidentialBoolean = <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n   }\r\n}</span></pre>\r\n</div>\r\n<p>编译之后，可以看到三个文件：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/789443/201710/789443-20171031141809886-1329498577.png\" alt=\"\"></p>\r\n<p>其中，最下面的这个类文件很好解释，就是我们的主class，中间的文件，是我们的内部类，上面的文件，后面再讲，我们先看一下中间这个内部类</p>\r\n<h3>2.1 内部类的反编译结果</h3>\r\n<p>用javap 反编译DemonstrateSyntheticMethods$NestedClass.class，得到如下结果：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>javap DemonstrateSyntheticMethods\\$NestedClass.<span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\">\r\nCompiled from </span>\"DemonstrateSyntheticMethods.java\"\r\n<span style=\"color: #0000ff;\">final</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> DemonstrateSyntheticMethods$NestedClass {\r\n  DemonstrateSyntheticMethods$NestedClass(DemonstrateSyntheticMethods$</span>1<span style=\"color: #000000;\">);<br>\r\n  </span><span style=\"font-size: 14px;\"><strong><span style=\"color: #0000ff;\">static</span> java.lang.String access$100</strong></span><span style=\"color: #000000;\"><span style=\"font-size: 14px;\"><strong>(DemonstrateSyntheticMethods$NestedClass);</strong></span>\r\n}</span></pre>\r\n</div>\r\n<p>先把构造函数放一边，我们来看这个标黑的方法access$100 这个是怎么回事呢？我们的源文件里找不到这个access方法啊？</p>\r\n<h3>2.2 synthetic方法</h3>\r\n<p>这个方法就是编译器生成的synthetic方法，读者不信的话，可以用method.isSynthetic() 去验证一下。</p>\r\n<p>为何要生成这样一个方法呢？</p>\r\n<p>可以看到，我们的NestedClass类中，highConfidential是一个私有属性，而我们在外部类DemonstrateSyntheticMethods中，直接引用了这个属性。作为一个内部类，NestedClass的属性被外部类引用，在语义上毫无问题，但是这却苦了编译器。</p>\r\n<p>为了能让一个private的变量被引用到，编译器生成了一个package scope的access方法，这个方法就是一个get方法，在外部类使用highConfidential这个属性时，实际是使用了这个access方法。</p>\r\n<p>在javap中可以看到直接的证据：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/789443/201710/789443-20171031143315199-2133275841.png\" alt=\"\"></p>\r\n<p>图中红框的位置，可以很清楚的看到main方法实际上调用了access$100这个方法。</p>\r\n<p>所以，结论很清楚了，编译器为了方便内部类的私有成员被外部类引用，生成了一个get方法，这可以被理解为一个trick，绕开了private成员变量的限制。</p>\r\n<h3>2.3 synthetic类</h3>\r\n<p>定义已经提到，编译器不仅仅会生成方法，也会生成synthetic类。</p>\r\n<p>我们回过头来看2.1提到的最后一个类DemonstrateSyntheticMethods$1.class</p>\r\n<p>这个类是一个完全的空类，反编译后是这个样子：</p>\r\n<div class=\"cnblogs_Highlighter\">\r\n<pre class=\"brush:java;gutter:true;\">// $FF: synthetic class\r\nclass DemonstrateSyntheticMethods$1 {\r\n}</pre>\r\n</div>\r\n<p>这个类只出场了一次，作为内部类NestedClass的package scope的构造函数，如图所示：</p>\r\n<p><img src=\"http://images2017.cnblogs.com/blog/789443/201710/789443-20171031144333949-2079438791.png\" alt=\"\"></p>\r\n<p> </p>\r\n<p> 那么，这个类的作用呢？笔者查了很多资料，都没有明确的说明这个类的用途，只能根据代码做推测如下：</p>\r\n<p><strong>NestedClass作为一个private类，其默认构造函数也是private的。那么，事实上，作为外部类的DemonstrateSyntheticMethods类，没有办法new这个内部类的对象，而这和我们需要的语义相违背。</strong></p>\r\n<p><strong>那么，为了实现语义，编译器又用了一个trick，悄悄的生成了一个构造函数NestedClass(DemonstrateSyntheticMethods$1 obj), 这个构造函数是包可见的。</strong></p>\r\n<p><strong>那么，外部类则可以通过new NestedClass(null)的方式，得到内部类的对象。如果读者检查一下main方法的话，可以看到这个方法的调用如下图所示。</strong></p>\r\n<p><strong>这就是这个synthetic类的作用。如果我们给我们的NestedClass 增加一个public级别的默认构造函数的话，则可以看到编译器不会再生成这个synthetic类。</strong></p>\r\n<p><strong><img src=\"http://images2017.cnblogs.com/blog/789443/201710/789443-20171031145107543-1847314320.png\" alt=\"\"></strong></p>\r\n<h2>3.结论</h2>\r\n<p>编译器通过生成一些在源代码中不存在的synthetic方法和类的方式，实现了对private级别的字段和类的访问，从而绕开了语言限制，这可以算是一种trick。</p>\r\n<p>在实际生产和应用中，基本不存在程序员需要考虑synthetic的地方。</p>\r\n<p>PS: 在此<strong>提一个的常见的存在synthetic的案例。</strong></p>\r\n<p>如果同时用到了Enum和switch，如先定义一个enum枚举，然后用switch遍历这个枚举，java编译器会偷偷生成一个synthetic的数组，数组内容是enum的实例。</p>\r\n<p>对于这种情况，笔者找到了一个资料，可供参考：</p>\r\n<p class=\"article-title\"><a href=\"http://www.hankcs.com/program/java/enum-java-examples-of-dynamic-modification.html\">Java动态修改Enum实例</a></p>\r\n<hr>\r\n<p class=\"article-title\"> </p>\r\n<p class=\"article-title\">完。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-10-31 15:04</span> <a href=\"http://www.cnblogs.com/bethunebtj/\">道德楷模周鸿祎</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=7761596\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(7761596);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=236949,cb_entryId=7761596,cb_blogApp=currentBlogApp,cb_blogUserGuid='d449779e-4031-e511-b908-9dcfd8948a71',cb_entryCreatedDate='2017/10/31 15:04:00';loadViewCount(cb_entryId);var cb_postType=1;</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div>", "article_view": 210, "image_url": ["https://pic.cnblogs.com/face/789443/20150723215337.png"], "date_pub": "2017-10-31", "article_common": 0}
{"title": "vuex的简易入门", "url": "http://www.cnblogs.com/vensent-Onion/p/7761724.html", "author": "唱歌的小洋葱", "article_desc": "vuex学习 Vuex入门其实很简单 当我们项目数据量很庞大的时候 比如一个接口数据在多个组件之间重复使用多次 我们这里采用的是vue-cli构建的项目目录 当然前面的npm install vux什么的就不说了 我们创建好store模块之后 首先你要确保你的实例上面有store 1.引入store ...", "content": "<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/vensent-Onion/p/7761724.html\">vuex的简易入门</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><style>p.p1 { margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px \"Helvetica Neue\"; color: #454545 }\np.p2 { margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px \".PingFang SC\"; color: #454545 }\np.p3 { margin: 0.0px 0.0px 2.0px 0.0px; font: 14.0px \"Helvetica Neue\"; color: #454545; min-height: 17.0px }\np.p4 { margin: 0.0px 0.0px 2.0px 0.0px; font: 14.0px \".PingFang SC\"; color: #454545 }\np.p5 { margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px \"Helvetica Neue\"; color: #454545; min-height: 14.0px }\np.p6 { margin: 0.0px 0.0px 0.0px 0.0px; font: 17.0px \".PingFang SC\"; color: #454545 }\nspan.s1 { font: 12.0px \".PingFang SC\" }\nspan.s2 { font: 12.0px \"Helvetica Neue\" }\nspan.s3 { font: 14.0px \"Helvetica Neue\" }\nspan.s4 { font: 17.0px \".Apple Color Emoji UI\" }</style>\n<p class=\"p1\">vuex<span class=\"s1\">学习</span></p>\n<p class=\"p2\"><span class=\"s2\">Vuex入门其实很简单<span class=\"s2\"> 当我们项目数据量很庞大的时候</span></span></p>\n<p class=\"p2\">比如一个接口数据在多个组件之间重复使用多次</p>\n<p class=\"p2\">我们这里采用的是<span class=\"s2\">vue-cli构建的项目目录<span class=\"s2\"> </span></span></p>\n<p class=\"p1\"><span class=\"s1\">当然前面的npm install vux<span class=\"s1\">什么的就不说了</span></span></p>\n<p class=\"p2\">我们创建好<span class=\"s2\">store模块之后<span class=\"s2\"> 首先你要确保你的实例上面有<span class=\"s2\">store</span></span></span></p>\n<p class=\"p3\"><strong> </strong></p>\n<p class=\"p4\"><span class=\"s3\"><strong>1.</strong>引入<span class=\"s3\"><strong>store </strong>并且挂载在实例上</span></span></p>\n<p class=\"p5\"> <img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151144449-1573719046.png\" alt=\"\"></p>\n<p class=\"p5\"><img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151219496-1353344796.png\" alt=\"\"></p>\n<p class=\"p2\">好，然后，创建目录我们的<span class=\"s2\">store的目录大概就是下面这样子</span></p>\n<p class=\"p2\"><span class=\"s1\">你可以使用单独的actions getters mutations <span class=\"s1\">也可以使用模块化【modules】</span></span></p>\n<p class=\"p2\">我们这里采用的是模块化<span class=\"s2\"> modules 比如我们有一个狗【<span class=\"s2\">dog】的模块</span></span></p>\n<p class=\"p2\">【<span class=\"s2\">modules】<span class=\"s2\"> 对象允许将单一的<span class=\"s2\"> Store 拆分为多个<span class=\"s2\"> Store 的同时保存在单一的状态树中。随着应用复杂度的增加，这种拆分能够更好地组织代码</span></span></span></span></p>\n<p class=\"p5\"> </p>\n<p class=\"p5\"><img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151309371-1793466187.png\" alt=\"\"></p>\n<p class=\"p1\"><span class=\"s1\">先来看我们的【store/index.js<span class=\"s1\">】</span></span></p>\n<p class=\"p1\"><span class=\"s1\">这里我们就export<span class=\"s1\">一下store store<span class=\"s1\">里面是按照模块来的</span></span></span></p>\n<p class=\"p5\"> <img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151420027-819035106.png\" alt=\"\"></p>\n<p>继续<span class=\"s2\"> 我们开始进入模块【<span class=\"s2\">dog.js】</span></span></p>\n<p class=\"p2\">首先你得有一个<span class=\"s2\">types吧<span class=\"s2\"> 对不对<span class=\"s2\"> 放在外面统一管理就好<span class=\"s2\"> 后面引入即可</span></span></span></span></p>\n<p class=\"p2\"><span class=\"s2\"><span class=\"s2\"><span class=\"s2\"><span class=\"s2\"><img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151501277-623615771.png\" alt=\"\"> </span></span></span></span></p>\n<p class=\"p2\">然后先看一下整体的代码结构</p>\n<p class=\"p2\"><img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151519511-1987986378.png\" alt=\"\"></p>\n<p class=\"p2\"> </p>\n<p class=\"p2\">【别着急】我们依次展开了哈</p>\n<p class=\"p1\"><span class=\"s1\">【state<span class=\"s1\">】</span></span></p>\n<p class=\"p2\"><span class=\"s2\">state 定义了应用状态的数据结构，同样可以在这里设置默认的初始状态</span></p>\n<p class=\"p5\"> <img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151631777-1647279781.png\" alt=\"\"></p>\n<p><span class=\"s1\">【mutations<span class=\"s1\">】</span></span></p>\n<p class=\"p2\">调用<span class=\"s2\"> mutations 是唯一允许更新应用状态的地方。</span></p>\n<p class=\"p2\"><span class=\"s2\"><img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151647215-1390527708.png\" alt=\"\"></span></p>\n<p class=\"p5\"> </p>\n<p class=\"p1\"><span class=\"s1\">【actions<span class=\"s1\">】</span></span></p>\n<p class=\"p2\"><span class=\"s2\">Actions 即是定义提交触发更改信息的描述，常见的例子有从服务端获取数据，在数据获取完成后会调用<span class=\"s2\">store.commit()来调用更改<span class=\"s2\"> Store 中的状态。可以在组件中使用<span class=\"s2\">dispatch来发出<span class=\"s2\"> Actions。</span></span></span></span></span></p>\n<p class=\"p5\"> <img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151707590-490074640.png\" alt=\"\"></p>\n<p><span class=\"s1\">【getters<span class=\"s1\">】</span></span></p>\n<p class=\"p2\"><span class=\"s2\">Getters 允许组件从<span class=\"s2\"> Store 中获取数据，可以进行筛选等等<span class=\"s2\"> 这里是可以进行数据操作的</span></span></span></p>\n<p class=\"p5\"> <img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151729511-1089286268.png\" alt=\"\"></p>\n<p>最后<span class=\"s2\"> 【输出一下】</span></p>\n<p><span class=\"s2\"><img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151752090-419033221.png\" alt=\"\"></span></p>\n<p class=\"p2\"><span class=\"s2\">OK了<span class=\"s2\"> 一个简单的额<span class=\"s2\">vuex我们搭建完毕<span class=\"s2\"> 我们回到我们的组件开始调用<span class=\"s2\"> 怎么用呢</span></span></span></span></span></p>\n<p class=\"p2\">首先我们需要引入<span class=\"s2\">vuex的辅助函数<span class=\"s2\"> 这里的话我引入三个<span class=\"s2\"> 方便都看一下效果</span></span></span></p>\n<p class=\"p1\"><span class=\"s1\">辅助函数【mapState<span class=\"s1\">】【mapActions<span class=\"s1\">】【mapgetters<span class=\"s1\">】</span></span></span></span></p>\n<p class=\"p1\"><span class=\"s1\">我们在时间周期 computed<span class=\"s1\">的时候引入mapState mapGetters</span></span></p>\n<p class=\"p5\"><img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151805605-1502343997.png\" alt=\"\"></p>\n<p><img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151815996-49943816.png\" alt=\"\"></p>\n<p class=\"p6\">【注意<span class=\"s4\">⚠️】</span></p>\n<p class=\"p2\">为什么要把<span class=\"s2\">mapState放在这里讲<span class=\"s2\"> 是因为又个坑</span></span></p>\n<p class=\"p2\">一般而言<span class=\"s2\"> 我们是直接 是不是很多人都这么做啊 嘻嘻嘻 也没错 前提是你不使用modules</span></p>\n<p class=\"p5\"> <img src=\"http://images2017.cnblogs.com/blog/982725/201710/982725-20171031151830730-532570878.png\" alt=\"\"></p>\n<p class=\"p1\"><span class=\"s1\">我们发现 <span class=